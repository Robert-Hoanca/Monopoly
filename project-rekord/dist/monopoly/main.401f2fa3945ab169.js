"use strict";(self.webpackChunkmonopoly=self.webpackChunkmonopoly||[]).push([[179],{2011:(kn,At,se)=>{se.d(At,{Dh:()=>Oe,GT:()=>st,cc:()=>Ot,hO:()=>Kt,on:()=>Te,pX:()=>Ke,xv:()=>ct});var $=se(4650),c=se(127),J=se(5813);kn=se.hmd(kn);const je=["ngOnDestroy"],Ke=(et,vn,_n,Nt={})=>new Proxy(et,{get:(Dt,wt)=>_n.runOutsideAngular(()=>{var an;if(et[wt])return!(null===(an=Nt?.spy)||void 0===an)&&an.get&&Nt.spy.get(wt,et[wt]),et[wt];if(je.indexOf(wt)>-1)return()=>{};const ze=vn.toPromise().then(ot=>{const _t=ot&&ot[wt];return"function"==typeof _t?_t.bind(ot):_t&&_t.then?_t.then(ke=>_n.run(()=>ke)):_n.run(()=>_t)});return new Proxy(()=>{},{get:(ot,_t)=>ze[_t],apply:(ot,_t,ke)=>ze.then(He=>{var Ze;const ut=He&&He(...ke);return!(null===(Ze=Nt?.spy)||void 0===Ze)&&Ze.apply&&Nt.spy.apply(wt,ke,ut),ut})})})}),st=(et,vn)=>{vn.forEach(_n=>{Object.getOwnPropertyNames(_n.prototype||_n).forEach(Nt=>{Object.defineProperty(et.prototype,Nt,Object.getOwnPropertyDescriptor(_n.prototype||_n,Nt))})})};class Tt{constructor(vn){return vn}}const Oe=new $.OlP("angularfire2.app.options"),ct=new $.OlP("angularfire2.app.name");function Te(et,vn,_n){const Dt="object"==typeof _n&&_n||{};Dt.name=Dt.name||"string"==typeof _n&&_n||"[DEFAULT]";const an=c.Z.apps.filter(ze=>ze&&ze.name===Dt.name)[0]||vn.runOutsideAngular(()=>c.Z.initializeApp(et,Dt));try{JSON.stringify(et)!==JSON.stringify(an.options)&&Me("error",`${an.name} Firebase App already initialized with different options${kn.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new Tt(an)}const Me=(et,...vn)=>{(0,$.X6Q)()&&typeof console<"u"&&console[et](...vn)},Ne={provide:Tt,useFactory:Te,deps:[Oe,$.R0b,[new $.FiY,ct]]};let Kt=(()=>{class et{constructor(_n){c.Z.registerVersion("angularfire",J.q4.full,"core"),c.Z.registerVersion("angularfire",J.q4.full,"app-compat"),c.Z.registerVersion("angular",$.q4F.full,_n.toString())}static initializeApp(_n,Nt){return{ngModule:et,providers:[{provide:Oe,useValue:_n},{provide:ct,useValue:Nt}]}}}return et.\u0275fac=function(_n){return new(_n||et)($.LFG($.Lbi))},et.\u0275mod=$.oAB({type:et}),et.\u0275inj=$.cJS({providers:[Ne]}),et})();function Ot(et,vn,_n,Nt,Dt){const[,wt,an]=globalThis.\u0275AngularfireInstanceCache.find(ze=>ze[0]===et)||[];if(wt)return function yt(et,vn){try{return et.toString()===vn.toString()}catch{return et===vn}}(Dt,an)||(dt("error",`${vn} was already initialized on the ${_n} Firebase App with different settings.${Pn?" You may need to reload as Firebase is not HMR aware.":""}`),dt("warn",{is:Dt,was:an})),wt;{const ze=Nt();return globalThis.\u0275AngularfireInstanceCache.push([et,ze,Dt]),ze}}const Pn=!!kn.hot,dt=(et,...vn)=>{(0,$.X6Q)()&&typeof console<"u"&&console[et](...vn)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},5813:(kn,At,se)=>{se.d(At,{q4:()=>Rv,iC:()=>Xd,HU:()=>El,vb:()=>Wc,JM:()=>zu,u3:()=>sc});var $=se(4650),c=se(5867),J=se(5861),je=se(9681),Ke=se(2090),st=se(4859),Tt=se(1877),Oe=se(8766);const ct="@firebase/installations",Te="0.5.12",Ne=`w:${Te}`,Kt="FIS_v2",vn=new Ke.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function _n(j){return j instanceof Ke.ZR&&j.code.includes("request-failed")}function Nt({projectId:j}){return`https://firebaseinstallations.googleapis.com/v1/projects/${j}/installations`}function Dt(j){return{token:j.token,requestStatus:2,expiresIn:He(j.expiresIn),creationTime:Date.now()}}function wt(j,V){return an.apply(this,arguments)}function an(){return(an=(0,J.Z)(function*(j,V){const pe=(yield V.json()).error;return vn.create("request-failed",{requestName:j,serverCode:pe.code,serverMessage:pe.message,serverStatus:pe.status})})).apply(this,arguments)}function ze({apiKey:j}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":j})}function ot(j,{refreshToken:V}){const Y=ze(j);return Y.append("Authorization",function Ze(j){return`${Kt} ${j}`}(V)),Y}function _t(j){return ke.apply(this,arguments)}function ke(){return(ke=(0,J.Z)(function*(j){const V=yield j();return V.status>=500&&V.status<600?j():V})).apply(this,arguments)}function He(j){return Number(j.replace("s","000"))}function ut(j,V){return Xe.apply(this,arguments)}function Xe(){return(Xe=(0,J.Z)(function*({appConfig:j,heartbeatServiceProvider:V},{fid:Y}){const pe=Nt(j),Fe=ze(j),Ye=V.getImmediate({optional:!0});if(Ye){const ai=yield Ye.getHeartbeatsHeader();ai&&Fe.append("x-firebase-client",ai)}const ln={method:"POST",headers:Fe,body:JSON.stringify({fid:Y,authVersion:Kt,appId:j.appId,sdkVersion:Ne})},qn=yield _t(()=>fetch(pe,ln));if(qn.ok){const ai=yield qn.json();return{fid:ai.fid||Y,registrationStatus:2,refreshToken:ai.refreshToken,authToken:Dt(ai.authToken)}}throw yield wt("Create Installation",qn)})).apply(this,arguments)}function zt(j){return new Promise(V=>{setTimeout(V,j)})}const Ni=/^[cdef][\w-]{21}$/;function nn(){try{const j=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(j),j[0]=112+j[0]%16;const Y=function er(j){return function zn(j){return btoa(String.fromCharCode(...j)).replace(/\+/g,"-").replace(/\//g,"_")}(j).substr(0,22)}(j);return Ni.test(Y)?Y:""}catch{return""}}function Nr(j){return`${j.appName}!${j.appId}`}const sr=new Map;function Ui(j,V){const Y=Nr(j);gr(Y,V),function za(j,V){const Y=function Cr(){return!oo&&"BroadcastChannel"in self&&(oo=new BroadcastChannel("[Firebase] FID Change"),oo.onmessage=j=>{gr(j.data.key,j.data.fid)}),oo}();Y&&Y.postMessage({key:j,fid:V}),function gl(){0===sr.size&&oo&&(oo.close(),oo=null)}()}(Y,V)}function gr(j,V){const Y=sr.get(j);if(Y)for(const pe of Y)pe(V)}let oo=null;const Br="firebase-installations-store";let _l=null;function Un(){return _l||(_l=(0,Oe.X3)("firebase-installations-database",1,{upgrade:(j,V)=>{0===V&&j.createObjectStore(Br)}})),_l}function ao(j,V){return _r.apply(this,arguments)}function _r(){return(_r=(0,J.Z)(function*(j,V){const Y=Nr(j),Fe=(yield Un()).transaction(Br,"readwrite"),Ye=Fe.objectStore(Br),Rt=yield Ye.get(Y);return yield Ye.put(V,Y),yield Fe.done,(!Rt||Rt.fid!==V.fid)&&Ui(j,V.fid),V})).apply(this,arguments)}function Li(j){return ms.apply(this,arguments)}function ms(){return(ms=(0,J.Z)(function*(j){const V=Nr(j),pe=(yield Un()).transaction(Br,"readwrite");yield pe.objectStore(Br).delete(V),yield pe.done})).apply(this,arguments)}function To(j,V){return Ls.apply(this,arguments)}function Ls(){return(Ls=(0,J.Z)(function*(j,V){const Y=Nr(j),Fe=(yield Un()).transaction(Br,"readwrite"),Ye=Fe.objectStore(Br),Rt=yield Ye.get(Y),ln=V(Rt);return void 0===ln?yield Ye.delete(Y):yield Ye.put(ln,Y),yield Fe.done,ln&&(!Rt||Rt.fid!==ln.fid)&&Ui(j,ln.fid),ln})).apply(this,arguments)}function vr(j){return Os.apply(this,arguments)}function Os(){return(Os=(0,J.Z)(function*(j){let V;const Y=yield To(j.appConfig,pe=>{const Fe=zl(pe),Ye=Ai(j,Fe);return V=Ye.registrationPromise,Ye.installationEntry});return""===Y.fid?{installationEntry:yield V}:{installationEntry:Y,registrationPromise:V}})).apply(this,arguments)}function zl(j){return lo(j||{fid:nn(),registrationStatus:0})}function Ai(j,V){if(0===V.registrationStatus){if(!navigator.onLine)return{installationEntry:V,registrationPromise:Promise.reject(vn.create("app-offline"))};const Y={fid:V.fid,registrationStatus:1,registrationTime:Date.now()},pe=function un(j,V){return Dn.apply(this,arguments)}(j,Y);return{installationEntry:Y,registrationPromise:pe}}return 1===V.registrationStatus?{installationEntry:V,registrationPromise:Ea(j)}:{installationEntry:V}}function Dn(){return(Dn=(0,J.Z)(function*(j,V){try{const Y=yield ut(j,V);return ao(j.appConfig,Y)}catch(Y){throw _n(Y)&&409===Y.customData.serverCode?yield Li(j.appConfig):yield ao(j.appConfig,{fid:V.fid,registrationStatus:0}),Y}})).apply(this,arguments)}function Ea(j){return gs.apply(this,arguments)}function gs(){return(gs=(0,J.Z)(function*(j){let V=yield li(j.appConfig);for(;1===V.registrationStatus;)yield zt(100),V=yield li(j.appConfig);if(0===V.registrationStatus){const{installationEntry:Y,registrationPromise:pe}=yield vr(j);return pe||Y}return V})).apply(this,arguments)}function li(j){return To(j,V=>{if(!V)throw vn.create("installation-not-found");return lo(V)})}function lo(j){return function yr(j){return 1===j.registrationStatus&&j.registrationTime+1e4<Date.now()}(j)?{fid:j.fid,registrationStatus:0}:j}function br(j,V){return Hi.apply(this,arguments)}function Hi(){return(Hi=(0,J.Z)(function*({appConfig:j,heartbeatServiceProvider:V},Y){const pe=rs(j,Y),Fe=ot(j,Y),Ye=V.getImmediate({optional:!0});if(Ye){const ai=yield Ye.getHeartbeatsHeader();ai&&Fe.append("x-firebase-client",ai)}const ln={method:"POST",headers:Fe,body:JSON.stringify({installation:{sdkVersion:Ne,appId:j.appId}})},qn=yield _t(()=>fetch(pe,ln));if(qn.ok)return Dt(yield qn.json());throw yield wt("Generate Auth Token",qn)})).apply(this,arguments)}function rs(j,{fid:V}){return`${Nt(j)}/${V}/authTokens:generate`}function xe(j){return we.apply(this,arguments)}function we(){return(we=(0,J.Z)(function*(j,V=!1){let Y;const pe=yield To(j.appConfig,Ye=>{if(!Qn(Ye))throw vn.create("not-registered");const Rt=Ye.authToken;if(!V&&Gi(Rt))return Ye;if(1===Rt.requestStatus)return Y=ve(j,V),Ye;{if(!navigator.onLine)throw vn.create("app-offline");const ln=_s(Ye);return Y=Ct(j,ln),ln}});return Y?yield Y:pe.authToken})).apply(this,arguments)}function ve(j,V){return Ae.apply(this,arguments)}function Ae(){return(Ae=(0,J.Z)(function*(j,V){let Y=yield Ce(j.appConfig);for(;1===Y.authToken.requestStatus;)yield zt(100),Y=yield Ce(j.appConfig);const pe=Y.authToken;return 0===pe.requestStatus?xe(j,V):pe})).apply(this,arguments)}function Ce(j){return To(j,V=>{if(!Qn(V))throw vn.create("not-registered");return function Re(j){return 1===j.requestStatus&&j.requestTime+1e4<Date.now()}(V.authToken)?Object.assign(Object.assign({},V),{authToken:{requestStatus:0}}):V})}function Ct(j,V){return $t.apply(this,arguments)}function $t(){return($t=(0,J.Z)(function*(j,V){try{const Y=yield br(j,V),pe=Object.assign(Object.assign({},V),{authToken:Y});return yield ao(j.appConfig,pe),Y}catch(Y){if(!_n(Y)||401!==Y.customData.serverCode&&404!==Y.customData.serverCode){const pe=Object.assign(Object.assign({},V),{authToken:{requestStatus:0}});yield ao(j.appConfig,pe)}else yield Li(j.appConfig);throw Y}})).apply(this,arguments)}function Qn(j){return void 0!==j&&2===j.registrationStatus}function Gi(j){return 2===j.requestStatus&&!function Bi(j){const V=Date.now();return V<j.creationTime||j.creationTime+j.expiresIn<V+36e5}(j)}function _s(j){const V={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},j),{authToken:V})}function ye(){return(ye=(0,J.Z)(function*(j){const V=j,{installationEntry:Y,registrationPromise:pe}=yield vr(V);return pe?pe.catch(console.error):xe(V).catch(console.error),Y.fid})).apply(this,arguments)}function Xt(){return(Xt=(0,J.Z)(function*(j,V=!1){const Y=j;return yield St(Y),(yield xe(Y,V)).token})).apply(this,arguments)}function St(j){return rn.apply(this,arguments)}function rn(){return(rn=(0,J.Z)(function*(j){const{registrationPromise:V}=yield vr(j);V&&(yield V)})).apply(this,arguments)}function ui(j){return vn.create("missing-app-config-values",{valueName:j})}const Sh="installations",Id=j=>{const V=j.getProvider("app").getImmediate(),Y=function wc(j){if(!j||!j.options)throw ui("App Configuration");if(!j.name)throw ui("App Name");const V=["projectId","apiKey","appId"];for(const Y of V)if(!j.options[Y])throw ui(Y);return{appName:j.name,projectId:j.options.projectId,apiKey:j.options.apiKey,appId:j.options.appId}}(V);return{app:V,appConfig:Y,heartbeatServiceProvider:(0,je._getProvider)(V,"heartbeat"),_delete:()=>Promise.resolve()}},vl=j=>{const V=j.getProvider("app").getImmediate(),Y=(0,je._getProvider)(V,Sh).getImmediate();return{getId:()=>function Se(j){return ye.apply(this,arguments)}(Y),getToken:Fe=>function gt(j){return Xt.apply(this,arguments)}(Y,Fe)}};(function ks(){(0,je._registerComponent)(new st.wA(Sh,Id,"PUBLIC")),(0,je._registerComponent)(new st.wA("installations-internal",vl,"PRIVATE"))})(),(0,je.registerVersion)(ct,Te),(0,je.registerVersion)(ct,Te,"esm2017");const Mc="@firebase/remote-config",vi=new Ke.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Xm{constructor(V,Y,pe,Fe){this.client=V,this.storage=Y,this.storageCache=pe,this.logger=Fe}isCachedDataFresh(V,Y){if(!Y)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const pe=Date.now()-Y,Fe=pe<=V;return this.logger.debug(`Config fetch cache check. Cache age millis: ${pe}. Cache max age millis (minimumFetchIntervalMillis setting): ${V}. Is cache hit: ${Fe}.`),Fe}fetch(V){var Y=this;return(0,J.Z)(function*(){const[pe,Fe]=yield Promise.all([Y.storage.getLastSuccessfulFetchTimestampMillis(),Y.storage.getLastSuccessfulFetchResponse()]);if(Fe&&Y.isCachedDataFresh(V.cacheMaxAgeMillis,pe))return Fe;V.eTag=Fe&&Fe.eTag;const Ye=yield Y.client.fetch(V),Rt=[Y.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===Ye.status&&Rt.push(Y.storage.setLastSuccessfulFetchResponse(Ye)),yield Promise.all(Rt),Ye})()}}function Wa(j=navigator){return j.languages&&j.languages[0]||j.language}class ql{constructor(V,Y,pe,Fe,Ye,Rt){this.firebaseInstallations=V,this.sdkVersion=Y,this.namespace=pe,this.projectId=Fe,this.apiKey=Ye,this.appId=Rt}fetch(V){var Y=this;return(0,J.Z)(function*(){var pe,Fe,Ye;const[Rt,ln]=yield Promise.all([Y.firebaseInstallations.getId(),Y.firebaseInstallations.getToken()]),ai=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${Y.projectId}/namespaces/${Y.namespace}:fetch?key=${Y.apiKey}`,hi={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":V.eTag||"*"},Hn={sdk_version:Y.sdkVersion,app_instance_id:Rt,app_instance_id_token:ln,app_id:Y.appId,language_code:Wa()},Bs={method:"POST",headers:hi,body:JSON.stringify(Hn)},Ao=fetch(ai,Bs),el=new Promise((ga,tl)=>{V.signal.addEventListener(()=>{const Pv=new Error("The operation was aborted.");Pv.name="AbortError",tl(Pv)})});let Dl;try{yield Promise.race([Ao,el]),Dl=yield Ao}catch(ga){let tl="fetch-client-network";throw"AbortError"===(null===(pe=ga)||void 0===pe?void 0:pe.name)&&(tl="fetch-timeout"),vi.create(tl,{originalErrorMessage:null===(Fe=ga)||void 0===Fe?void 0:Fe.message})}let Zc=Dl.status;const Qd=Dl.headers.get("ETag")||void 0;let Yc,Hh;if(200===Dl.status){let ga;try{ga=yield Dl.json()}catch(tl){throw vi.create("fetch-client-parse",{originalErrorMessage:null===(Ye=tl)||void 0===Ye?void 0:Ye.message})}Yc=ga.entries,Hh=ga.state}if("INSTANCE_STATE_UNSPECIFIED"===Hh?Zc=500:"NO_CHANGE"===Hh?Zc=304:("NO_TEMPLATE"===Hh||"EMPTY_CONFIG"===Hh)&&(Yc={}),304!==Zc&&200!==Zc)throw vi.create("fetch-status",{httpStatus:Zc});return{status:Zc,eTag:Qd,config:Yc}})()}}class xl{constructor(V,Y){this.client=V,this.storage=Y}fetch(V){var Y=this;return(0,J.Z)(function*(){const pe=(yield Y.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return Y.attemptFetch(V,pe)})()}attemptFetch(V,{throttleEndTimeMillis:Y,backoffCount:pe}){var Fe=this;return(0,J.Z)(function*(){yield function pv(j,V){return new Promise((Y,pe)=>{const Fe=Math.max(V-Date.now(),0),Ye=setTimeout(Y,Fe);j.addEventListener(()=>{clearTimeout(Ye),pe(vi.create("fetch-throttle",{throttleEndTimeMillis:V}))})})}(V.signal,Y);try{const Ye=yield Fe.client.fetch(V);return yield Fe.storage.deleteThrottleMetadata(),Ye}catch(Ye){if(!function qa(j){if(!(j instanceof Ke.ZR&&j.customData))return!1;const V=Number(j.customData.httpStatus);return 429===V||500===V||503===V||504===V}(Ye))throw Ye;const Rt={throttleEndTimeMillis:Date.now()+(0,Ke.$s)(pe),backoffCount:pe+1};return yield Fe.storage.setThrottleMetadata(Rt),Fe.attemptFetch(V,Rt)}})()}}class Eb{constructor(V,Y,pe,Fe,Ye){this.app=V,this._client=Y,this._storageCache=pe,this._storage=Fe,this._logger=Ye,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function Tu(j,V){var Y;const pe=j.target.error||void 0;return vi.create(V,{originalErrorMessage:pe&&(null===(Y=pe)||void 0===Y?void 0:Y.message)})}const wu="app_namespace_store";class Od{constructor(V,Y,pe,Fe=function Db(){return new Promise((j,V)=>{var Y;try{const pe=indexedDB.open("firebase_remote_config",1);pe.onerror=Fe=>{V(Tu(Fe,"storage-open"))},pe.onsuccess=Fe=>{j(Fe.target.result)},pe.onupgradeneeded=Fe=>{0===Fe.oldVersion&&Fe.target.result.createObjectStore(wu,{keyPath:"compositeKey"})}}catch(pe){V(vi.create("storage-open",{originalErrorMessage:null===(Y=pe)||void 0===Y?void 0:Y.message}))}})}()){this.appId=V,this.appName=Y,this.namespace=pe,this.openDbPromise=Fe}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(V){return this.set("last_fetch_status",V)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(V){return this.set("last_successful_fetch_timestamp_millis",V)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(V){return this.set("last_successful_fetch_response",V)}getActiveConfig(){return this.get("active_config")}setActiveConfig(V){return this.set("active_config",V)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(V){return this.set("active_config_etag",V)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(V){return this.set("throttle_metadata",V)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(V){var Y=this;return(0,J.Z)(function*(){const pe=yield Y.openDbPromise;return new Promise((Fe,Ye)=>{var Rt;const qn=pe.transaction([wu],"readonly").objectStore(wu),ai=Y.createCompositeKey(V);try{const hi=qn.get(ai);hi.onerror=Hn=>{Ye(Tu(Hn,"storage-get"))},hi.onsuccess=Hn=>{const Bs=Hn.target.result;Fe(Bs?Bs.value:void 0)}}catch(hi){Ye(vi.create("storage-get",{originalErrorMessage:null===(Rt=hi)||void 0===Rt?void 0:Rt.message}))}})})()}set(V,Y){var pe=this;return(0,J.Z)(function*(){const Fe=yield pe.openDbPromise;return new Promise((Ye,Rt)=>{var ln;const ai=Fe.transaction([wu],"readwrite").objectStore(wu),hi=pe.createCompositeKey(V);try{const Hn=ai.put({compositeKey:hi,value:Y});Hn.onerror=Bs=>{Rt(Tu(Bs,"storage-set"))},Hn.onsuccess=()=>{Ye()}}catch(Hn){Rt(vi.create("storage-set",{originalErrorMessage:null===(ln=Hn)||void 0===ln?void 0:ln.message}))}})})()}delete(V){var Y=this;return(0,J.Z)(function*(){const pe=yield Y.openDbPromise;return new Promise((Fe,Ye)=>{var Rt;const qn=pe.transaction([wu],"readwrite").objectStore(wu),ai=Y.createCompositeKey(V);try{const hi=qn.delete(ai);hi.onerror=Hn=>{Ye(Tu(Hn,"storage-delete"))},hi.onsuccess=()=>{Fe()}}catch(hi){Ye(vi.create("storage-delete",{originalErrorMessage:null===(Rt=hi)||void 0===Rt?void 0:Rt.message}))}})})()}createCompositeKey(V){return[this.appId,this.appName,this.namespace,V].join()}}class Tl{constructor(V){this.storage=V}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var V=this;return(0,J.Z)(function*(){const Y=V.storage.getLastFetchStatus(),pe=V.storage.getLastSuccessfulFetchTimestampMillis(),Fe=V.storage.getActiveConfig(),Ye=yield Y;Ye&&(V.lastFetchStatus=Ye);const Rt=yield pe;Rt&&(V.lastSuccessfulFetchTimestampMillis=Rt);const ln=yield Fe;ln&&(V.activeConfig=ln)})()}setLastFetchStatus(V){return this.lastFetchStatus=V,this.storage.setLastFetchStatus(V)}setLastSuccessfulFetchTimestampMillis(V){return this.lastSuccessfulFetchTimestampMillis=V,this.storage.setLastSuccessfulFetchTimestampMillis(V)}setActiveConfig(V){return this.activeConfig=V,this.storage.setActiveConfig(V)}}function Su(){return Ch.apply(this,arguments)}function Ch(){return(Ch=(0,J.Z)(function*(){if(!(0,Ke.hl)())return!1;try{return yield(0,Ke.eu)()}catch{return!1}})).apply(this,arguments)}!function Rb(){(0,je._registerComponent)(new st.wA("remote-config",function j(V,{instanceIdentifier:Y}){const pe=V.getProvider("app").getImmediate(),Fe=V.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw vi.create("registration-window");if(!(0,Ke.hl)())throw vi.create("indexed-db-unavailable");const{projectId:Ye,apiKey:Rt,appId:ln}=pe.options;if(!Ye)throw vi.create("registration-project-id");if(!Rt)throw vi.create("registration-api-key");if(!ln)throw vi.create("registration-app-id");const qn=new Od(ln,pe.name,Y=Y||"firebase"),ai=new Tl(qn),hi=new Tt.Yd(Mc);hi.logLevel=Tt.in.ERROR;const Hn=new ql(Fe,je.SDK_VERSION,Y,Ye,Rt,ln),Bs=new xl(Hn,qn),Ao=new Xm(Bs,qn,ai,hi),el=new Eb(pe,Ao,ai,qn,hi);return function Zs(j){const V=(0,Ke.m9)(j);V._initializePromise||(V._initializePromise=V._storageCache.loadFromStorage().then(()=>{V._isInitializationComplete=!0}))}(el),el},"PUBLIC").setMultipleInstances(!0)),(0,je.registerVersion)(Mc,"0.3.11"),(0,je.registerVersion)(Mc,"0.3.11","esm2017")}();const Aa="/firebase-messaging-sw.js",Zl="/firebase-cloud-messaging-push-scope",Cu="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",op="google.c.a.c_id",kd="google.c.a.c_l",ap="google.c.a.ts",Yl="google.c.a.e";var or=(()=>{return(j=or||(or={})).PUSH_RECEIVED="push-received",j.NOTIFICATION_CLICKED="notification-clicked",or;var j})();function da(j){const V=new Uint8Array(j);return btoa(String.fromCharCode(...V)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Jm(j){const Y=(j+"=".repeat((4-j.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),pe=atob(Y),Fe=new Uint8Array(pe.length);for(let Ye=0;Ye<pe.length;++Ye)Fe[Ye]=pe.charCodeAt(Ye);return Fe}const Ec="fcm_token_details_db",Kl="fcm_token_object_Store";function ar(j){return Nd.apply(this,arguments)}function Nd(){return Nd=(0,J.Z)(function*(j){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(Ye=>Ye.name).includes(Ec))return null;let V=null;return(yield(0,Oe.X3)(Ec,5,{upgrade:(pe=(0,J.Z)(function*(Fe,Ye,Rt,ln){var qn;if(Ye<2||!Fe.objectStoreNames.contains(Kl))return;const ai=ln.objectStore(Kl),hi=yield ai.index("fcmSenderId").get(j);if(yield ai.clear(),hi)if(2===Ye){const Hn=hi;if(!Hn.auth||!Hn.p256dh||!Hn.endpoint)return;V={token:Hn.fcmToken,createTime:null!==(qn=Hn.createTime)&&void 0!==qn?qn:Date.now(),subscriptionOptions:{auth:Hn.auth,p256dh:Hn.p256dh,endpoint:Hn.endpoint,swScope:Hn.swScope,vapidKey:"string"==typeof Hn.vapidKey?Hn.vapidKey:da(Hn.vapidKey)}}}else if(3===Ye){const Hn=hi;V={token:Hn.fcmToken,createTime:Hn.createTime,subscriptionOptions:{auth:da(Hn.auth),p256dh:da(Hn.p256dh),endpoint:Hn.endpoint,swScope:Hn.swScope,vapidKey:da(Hn.vapidKey)}}}else if(4===Ye){const Hn=hi;V={token:Hn.fcmToken,createTime:Hn.createTime,subscriptionOptions:{auth:da(Hn.auth),p256dh:da(Hn.p256dh),endpoint:Hn.endpoint,swScope:Hn.swScope,vapidKey:da(Hn.vapidKey)}}}}),function(Ye,Rt,ln,qn){return pe.apply(this,arguments)})})).close(),yield(0,Oe.Lj)(Ec),yield(0,Oe.Lj)("fcm_vapid_details_db"),yield(0,Oe.Lj)("undefined"),eg(V)?V:null;var pe}),Nd.apply(this,arguments)}function eg(j){if(!j||!j.subscriptionOptions)return!1;const{subscriptionOptions:V}=j;return"number"==typeof j.createTime&&j.createTime>0&&"string"==typeof j.token&&j.token.length>0&&"string"==typeof V.auth&&V.auth.length>0&&"string"==typeof V.p256dh&&V.p256dh.length>0&&"string"==typeof V.endpoint&&V.endpoint.length>0&&"string"==typeof V.swScope&&V.swScope.length>0&&"string"==typeof V.vapidKey&&V.vapidKey.length>0}const Ac="firebase-messaging-store";let Xl=null;function Za(){return Xl||(Xl=(0,Oe.X3)("firebase-messaging-database",1,{upgrade:(j,V)=>{0===V&&j.createObjectStore(Ac)}})),Xl}function co(j){return Dc.apply(this,arguments)}function Dc(){return(Dc=(0,J.Z)(function*(j){const V=Ya(j),pe=yield(yield Za()).transaction(Ac).objectStore(Ac).get(V);if(pe)return pe;{const Fe=yield ar(j.appConfig.senderId);if(Fe)return yield $l(j,Fe),Fe}})).apply(this,arguments)}function $l(j,V){return Eu.apply(this,arguments)}function Eu(){return(Eu=(0,J.Z)(function*(j,V){const Y=Ya(j),Fe=(yield Za()).transaction(Ac,"readwrite");return yield Fe.objectStore(Ac).put(V,Y),yield Fe.done,V})).apply(this,arguments)}function Mo(j){return Eh.apply(this,arguments)}function Eh(){return(Eh=(0,J.Z)(function*(j){const V=Ya(j),pe=(yield Za()).transaction(Ac,"readwrite");yield pe.objectStore(Ac).delete(V),yield pe.done})).apply(this,arguments)}function Ya({appConfig:j}){return j.appId}const Ur=new Ke.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function gv(j,V){return Ah.apply(this,arguments)}function Ah(){return(Ah=(0,J.Z)(function*(j,V){var Y;const pe=yield Pt(j),Fe=Du(V),Ye={method:"POST",headers:pe,body:JSON.stringify(Fe)};let Rt;try{Rt=yield(yield fetch(jd(j.appConfig),Ye)).json()}catch(ln){throw Ur.create("token-subscribe-failed",{errorInfo:null===(Y=ln)||void 0===Y?void 0:Y.toString()})}if(Rt.error)throw Ur.create("token-subscribe-failed",{errorInfo:Rt.error.message});if(!Rt.token)throw Ur.create("token-subscribe-no-token");return Rt.token})).apply(this,arguments)}function tg(j,V){return Dh.apply(this,arguments)}function Dh(){return(Dh=(0,J.Z)(function*(j,V){var Y;const pe=yield Pt(j),Fe=Du(V.subscriptionOptions),Ye={method:"PATCH",headers:pe,body:JSON.stringify(Fe)};let Rt;try{Rt=yield(yield fetch(`${jd(j.appConfig)}/${V.token}`,Ye)).json()}catch(ln){throw Ur.create("token-update-failed",{errorInfo:null===(Y=ln)||void 0===Y?void 0:Y.toString()})}if(Rt.error)throw Ur.create("token-update-failed",{errorInfo:Rt.error.message});if(!Rt.token)throw Ur.create("token-update-no-token");return Rt.token})).apply(this,arguments)}function Au(j,V){return Ql.apply(this,arguments)}function Ql(){return(Ql=(0,J.Z)(function*(j,V){var Y;const Fe={method:"DELETE",headers:yield Pt(j)};try{const Rt=yield(yield fetch(`${jd(j.appConfig)}/${V}`,Fe)).json();if(Rt.error)throw Ur.create("token-unsubscribe-failed",{errorInfo:Rt.error.message})}catch(Ye){throw Ur.create("token-unsubscribe-failed",{errorInfo:null===(Y=Ye)||void 0===Y?void 0:Y.toString()})}})).apply(this,arguments)}function jd({projectId:j}){return`https://fcmregistrations.googleapis.com/v1/projects/${j}/registrations`}function Pt(j){return mi.apply(this,arguments)}function mi(){return(mi=(0,J.Z)(function*({appConfig:j,installations:V}){const Y=yield V.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":j.apiKey,"x-goog-firebase-installations-auth":`FIS ${Y}`})})).apply(this,arguments)}function Du({p256dh:j,auth:V,endpoint:Y,vapidKey:pe}){const Fe={web:{endpoint:Y,auth:V,p256dh:j}};return pe!==Cu&&(Fe.web.applicationPubKey=pe),Fe}const Rc=6048e5;function Vr(j){return Ic.apply(this,arguments)}function Ic(){return(Ic=(0,J.Z)(function*(j){const V=yield _v(j.swRegistration,j.vapidKey),Y={vapidKey:j.vapidKey,swScope:j.swRegistration.scope,endpoint:V.endpoint,auth:da(V.getKey("auth")),p256dh:da(V.getKey("p256dh"))},pe=yield co(j.firebaseDependencies);if(pe){if(vs(pe.subscriptionOptions,Y))return Date.now()>=pe.createTime+Rc?lp(j,{token:pe.token,createTime:Date.now(),subscriptionOptions:Y}):pe.token;try{yield Au(j.firebaseDependencies,pe.token)}catch(Fe){console.warn(Fe)}return ng(j.firebaseDependencies,Y)}return ng(j.firebaseDependencies,Y)})).apply(this,arguments)}function Pc(j){return So.apply(this,arguments)}function So(){return(So=(0,J.Z)(function*(j){const V=yield co(j.firebaseDependencies);V&&(yield Au(j.firebaseDependencies,V.token),yield Mo(j.firebaseDependencies));const Y=yield j.swRegistration.pushManager.getSubscription();return!Y||Y.unsubscribe()})).apply(this,arguments)}function lp(j,V){return Fc.apply(this,arguments)}function Fc(){return(Fc=(0,J.Z)(function*(j,V){try{const Y=yield tg(j.firebaseDependencies,V),pe=Object.assign(Object.assign({},V),{token:Y,createTime:Date.now()});return yield $l(j.firebaseDependencies,pe),Y}catch(Y){throw yield Pc(j),Y}})).apply(this,arguments)}function ng(j,V){return Jl.apply(this,arguments)}function Jl(){return(Jl=(0,J.Z)(function*(j,V){const pe={token:yield gv(j,V),createTime:Date.now(),subscriptionOptions:V};return yield $l(j,pe),pe.token})).apply(this,arguments)}function _v(j,V){return Lc.apply(this,arguments)}function Lc(){return(Lc=(0,J.Z)(function*(j,V){return(yield j.pushManager.getSubscription())||j.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Jm(V)})})).apply(this,arguments)}function vs(j,V){return V.vapidKey===j.vapidKey&&V.endpoint===j.endpoint&&V.auth===j.auth&&V.p256dh===j.p256dh}function Co(j){const V={from:j.from,collapseKey:j.collapse_key,messageId:j.fcmMessageId};return function ig(j,V){if(!V.notification)return;j.notification={};const Y=V.notification.title;Y&&(j.notification.title=Y);const pe=V.notification.body;pe&&(j.notification.body=pe);const Fe=V.notification.image;Fe&&(j.notification.image=Fe)}(V,j),function Oc(j,V){!V.data||(j.data=V.data)}(V,j),function pa(j,V){var Y,pe,Fe,Ye,Rt;if(!(V.fcmOptions||null!==(Y=V.notification)&&void 0!==Y&&Y.click_action))return;j.fcmOptions={};const ln=null!==(Fe=null===(pe=V.fcmOptions)||void 0===pe?void 0:pe.link)&&void 0!==Fe?Fe:null===(Ye=V.notification)||void 0===Ye?void 0:Ye.click_action;ln&&(j.fcmOptions.link=ln);const qn=null===(Rt=V.fcmOptions)||void 0===Rt?void 0:Rt.analytics_label;qn&&(j.fcmOptions.analyticsLabel=qn)}(V,j),V}function vv(j){return"object"==typeof j&&!!j&&op in j}function cp(j,V){const Y=[];for(let pe=0;pe<j.length;pe++)Y.push(j.charAt(pe)),pe<V.length&&Y.push(V.charAt(pe));return Y.join("")}function Ud(j){return Ur.create("missing-app-config-values",{valueName:j})}cp("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),cp("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Rh{constructor(V,Y,pe){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const Fe=function up(j){if(!j||!j.options)throw Ud("App Configuration Object");if(!j.name)throw Ud("App Name");const V=["projectId","apiKey","appId","messagingSenderId"],{options:Y}=j;for(const pe of V)if(!Y[pe])throw Ud(pe);return{appName:j.name,projectId:Y.projectId,apiKey:Y.apiKey,appId:Y.appId,senderId:Y.messagingSenderId}}(V);this.firebaseDependencies={app:V,appConfig:Fe,installations:Y,analyticsProvider:pe}}_delete(){return Promise.resolve()}}function Vd(j){return kc.apply(this,arguments)}function kc(){return(kc=(0,J.Z)(function*(j){var V;try{j.swRegistration=yield navigator.serviceWorker.register(Aa,{scope:Zl}),j.swRegistration.update().catch(()=>{})}catch(Y){throw Ur.create("failed-service-worker-registration",{browserErrorMessage:null===(V=Y)||void 0===V?void 0:V.message})}})).apply(this,arguments)}function hp(j,V){return Ih.apply(this,arguments)}function Ih(){return(Ih=(0,J.Z)(function*(j,V){if(!V&&!j.swRegistration&&(yield Vd(j)),V||!j.swRegistration){if(!(V instanceof ServiceWorkerRegistration))throw Ur.create("invalid-sw-registration");j.swRegistration=V}})).apply(this,arguments)}function rg(j,V){return wl.apply(this,arguments)}function wl(){return(wl=(0,J.Z)(function*(j,V){V?j.vapidKey=V:j.vapidKey||(j.vapidKey=Cu)})).apply(this,arguments)}function Ph(){return(Ph=(0,J.Z)(function*(j,V){if(!navigator)throw Ur.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw Ur.create("permission-blocked");return yield rg(j,V?.vapidKey),yield hp(j,V?.serviceWorkerRegistration),Vr(j)})).apply(this,arguments)}function og(j,V,Y){return Ru.apply(this,arguments)}function Ru(){return(Ru=(0,J.Z)(function*(j,V,Y){const pe=dp(V);(yield j.firebaseDependencies.analyticsProvider.get()).logEvent(pe,{message_id:Y[op],message_name:Y[kd],message_time:Y[ap],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function dp(j){switch(j){case or.NOTIFICATION_CLICKED:return"notification_open";case or.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function Gd(){return(Gd=(0,J.Z)(function*(j,V){const Y=V.data;if(!Y.isFirebaseMessaging)return;j.onMessageHandler&&Y.messageType===or.PUSH_RECEIVED&&("function"==typeof j.onMessageHandler?j.onMessageHandler(Co(Y)):j.onMessageHandler.next(Co(Y)));const pe=Y.data;vv(pe)&&"1"===pe[Yl]&&(yield og(j,Y.messageType,pe))})).apply(this,arguments)}const ss="@firebase/messaging",nr=j=>{const V=new Rh(j.getProvider("app").getImmediate(),j.getProvider("installations-internal").getImmediate(),j.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",Y=>function ag(j,V){return Gd.apply(this,arguments)}(V,Y)),V},zd=j=>{const V=j.getProvider("messaging").getImmediate();return{getToken:pe=>function sg(j,V){return Ph.apply(this,arguments)}(V,pe)}};function fp(){return lg.apply(this,arguments)}function lg(){return(lg=(0,J.Z)(function*(){try{yield(0,Ke.eu)()}catch{return!1}return typeof window<"u"&&(0,Ke.hl)()&&(0,Ke.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function Ib(){(0,je._registerComponent)(new st.wA("messaging",nr,"PUBLIC")),(0,je._registerComponent)(new st.wA("messaging-internal",zd,"PRIVATE")),(0,je.registerVersion)(ss,"0.9.16"),(0,je.registerVersion)(ss,"0.9.16","esm2017")}();const Xa="analytics",Wd="firebase_id",Pu="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",gp="https://www.googletagmanager.com/gtag/js",Ys=new Tt.Yd("@firebase/analytics");function ug(j){return Promise.all(j.map(V=>V.catch(Y=>Y)))}function eM(j,V){const Y=document.createElement("script");Y.src=`${gp}?l=${j}&id=${V}`,Y.async=!0,document.head.appendChild(Y)}function Lh(j,V,Y,pe,Fe,Ye){return _p.apply(this,arguments)}function _p(){return(_p=(0,J.Z)(function*(j,V,Y,pe,Fe,Ye){const Rt=pe[Fe];try{if(Rt)yield V[Rt];else{const qn=(yield ug(Y)).find(ai=>ai.measurementId===Fe);qn&&(yield V[qn.appId])}}catch(ln){Ys.error(ln)}j("config",Fe,Ye)})).apply(this,arguments)}function qd(j,V,Y,pe,Fe){return Nc.apply(this,arguments)}function Nc(){return(Nc=(0,J.Z)(function*(j,V,Y,pe,Fe){try{let Ye=[];if(Fe&&Fe.send_to){let Rt=Fe.send_to;Array.isArray(Rt)||(Rt=[Rt]);const ln=yield ug(Y);for(const qn of Rt){const ai=ln.find(Hn=>Hn.measurementId===qn),hi=ai&&V[ai.appId];if(!hi){Ye=[];break}Ye.push(hi)}}0===Ye.length&&(Ye=Object.values(V)),yield Promise.all(Ye),j("event",pe,Fe||{})}catch(Ye){Ys.error(Ye)}})).apply(this,arguments)}function Oh(){const j=window.document.getElementsByTagName("script");for(const V of Object.values(j))if(V.src&&V.src.includes(gp))return V;return null}const ys=new Ke.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),Zd=new class Pb{constructor(V={},Y=1e3){this.throttleMetadata=V,this.intervalMillis=Y}getThrottleMetadata(V){return this.throttleMetadata[V]}setThrottleMetadata(V,Y){this.throttleMetadata[V]=Y}deleteThrottleMetadata(V){delete this.throttleMetadata[V]}};function kh(j){return new Headers({Accept:"application/json","x-goog-api-key":j})}function dr(j){return Pi.apply(this,arguments)}function Pi(){return(Pi=(0,J.Z)(function*(j){var V;const{appId:Y,apiKey:pe}=j,Fe={method:"GET",headers:kh(pe)},Ye=Pu.replace("{app-id}",Y),Rt=yield fetch(Ye,Fe);if(200!==Rt.status&&304!==Rt.status){let ln="";try{const qn=yield Rt.json();null!==(V=qn.error)&&void 0!==V&&V.message&&(ln=qn.error.message)}catch{}throw ys.create("config-fetch-failed",{httpStatus:Rt.status,responseMessage:ln})}return Rt.json()})).apply(this,arguments)}function Tn(j){return Bn.apply(this,arguments)}function Bn(){return(Bn=(0,J.Z)(function*(j,V=Zd,Y){const{appId:pe,apiKey:Fe,measurementId:Ye}=j.options;if(!pe)throw ys.create("no-app-id");if(!Fe){if(Ye)return{measurementId:Ye,appId:pe};throw ys.create("no-api-key")}const Rt=V.getThrottleMetadata(pe)||{backoffCount:0,throttleEndTimeMillis:Date.now()},ln=new hg;return setTimeout((0,J.Z)(function*(){ln.abort()}),void 0!==Y?Y:6e4),Ks({appId:pe,apiKey:Fe,measurementId:Ye},Rt,ln,V)})).apply(this,arguments)}function Ks(j,V,Y){return Bc.apply(this,arguments)}function Bc(){return(Bc=(0,J.Z)(function*(j,{throttleEndTimeMillis:V,backoffCount:Y},pe,Fe=Zd){var Ye,Rt;const{appId:ln,measurementId:qn}=j;try{yield jc(pe,V)}catch(ai){if(qn)return Ys.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${qn} provided in the "measurementId" field in the local Firebase config. [${null===(Ye=ai)||void 0===Ye?void 0:Ye.message}]`),{appId:ln,measurementId:qn};throw ai}try{const ai=yield dr(j);return Fe.deleteThrottleMetadata(ln),ai}catch(ai){const hi=ai;if(!bs(hi)){if(Fe.deleteThrottleMetadata(ln),qn)return Ys.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${qn} provided in the "measurementId" field in the local Firebase config. [${hi?.message}]`),{appId:ln,measurementId:qn};throw ai}const Hn=503===Number(null===(Rt=hi?.customData)||void 0===Rt?void 0:Rt.httpStatus)?(0,Ke.$s)(Y,Fe.intervalMillis,30):(0,Ke.$s)(Y,Fe.intervalMillis),Bs={throttleEndTimeMillis:Date.now()+Hn,backoffCount:Y+1};return Fe.setThrottleMetadata(ln,Bs),Ys.debug(`Calling attemptFetch again in ${Hn} millis`),Ks(j,Bs,pe,Fe)}})).apply(this,arguments)}function jc(j,V){return new Promise((Y,pe)=>{const Fe=Math.max(V-Date.now(),0),Ye=setTimeout(Y,Fe);j.addEventListener(()=>{clearTimeout(Ye),pe(ys.create("fetch-throttle",{throttleEndTimeMillis:V}))})})}function bs(j){if(!(j instanceof Ke.ZR&&j.customData))return!1;const V=Number(j.customData.httpStatus);return 429===V||500===V||503===V||504===V}class hg{constructor(){this.listeners=[]}addEventListener(V){this.listeners.push(V)}abort(){this.listeners.forEach(V=>V())}}let Yd,Tr;function Bh(){return(Bh=(0,J.Z)(function*(j,V,Y,pe,Fe){if(Fe&&Fe.global)j("event",Y,pe);else{const Ye=yield V;j("event",Y,Object.assign(Object.assign({},pe),{send_to:Ye}))}})).apply(this,arguments)}function vp(j){Tr=j}function Ou(j){Yd=j}function Fb(){return ku.apply(this,arguments)}function ku(){return(ku=(0,J.Z)(function*(){var j;if(!(0,Ke.hl)())return Ys.warn(ys.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,Ke.eu)()}catch(V){return Ys.warn(ys.create("indexeddb-unavailable",{errorInfo:null===(j=V)||void 0===j?void 0:j.toString()}).message),!1}return!0})).apply(this,arguments)}function nc(){return(nc=(0,J.Z)(function*(j,V,Y,pe,Fe,Ye,Rt){var ln;const qn=Tn(j);qn.then(Ao=>{Y[Ao.measurementId]=Ao.appId,j.options.measurementId&&Ao.measurementId!==j.options.measurementId&&Ys.warn(`The measurement ID in the local Firebase config (${j.options.measurementId}) does not match the measurement ID fetched from the server (${Ao.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(Ao=>Ys.error(Ao)),V.push(qn);const ai=Fb().then(Ao=>{if(Ao)return pe.getId()}),[hi,Hn]=yield Promise.all([qn,ai]);Oh()||eM(Ye,hi.measurementId),Tr&&(Fe("consent","default",Tr),vp(void 0)),Fe("js",new Date);const Bs=null!==(ln=Rt?.config)&&void 0!==ln?ln:{};return Bs.origin="firebase",Bs.update=!0,null!=Hn&&(Bs[Wd]=Hn),Fe("config",hi.measurementId,Bs),Yd&&(Fe("set",Yd),Ou(void 0)),hi.measurementId})).apply(this,arguments)}class $a{constructor(V){this.app=V}_delete(){return delete Fr[this.app.options.appId],Promise.resolve()}}let Fr={},Nu=[];const jh={};let Sl,ei,os="dataLayer",Zr=!1;function Gr(j,V,Y){!function Ev(){const j=[];if((0,Ke.ru)()&&j.push("This is a browser extension environment."),(0,Ke.zI)()||j.push("Cookies are not available."),j.length>0){const V=j.map((pe,Fe)=>`(${Fe+1}) ${pe}`).join(" "),Y=ys.create("invalid-analytics-context",{errorInfo:V});Ys.warn(Y.message)}}();const pe=j.options.appId;if(!pe)throw ys.create("no-app-id");if(!j.options.apiKey){if(!j.options.measurementId)throw ys.create("no-api-key");Ys.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${j.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Fr[pe])throw ys.create("already-exists",{id:pe});if(!Zr){!function Tv(j){let V=[];Array.isArray(window[j])?V=window[j]:window[j]=V}(os);const{wrappedGtag:Ye,gtagCore:Rt}=function Mv(j,V,Y,pe,Fe){let Ye=function(...Rt){window[pe].push(arguments)};return window[Fe]&&"function"==typeof window[Fe]&&(Ye=window[Fe]),window[Fe]=function wv(j,V,Y,pe){function Ye(){return(Ye=(0,J.Z)(function*(Rt,ln,qn){try{"event"===Rt?yield qd(j,V,Y,ln,qn):"config"===Rt?yield Lh(j,V,Y,pe,ln,qn):"consent"===Rt?j("consent","update",qn):j("set",ln)}catch(ai){Ys.error(ai)}})).apply(this,arguments)}return function Fe(Rt,ln,qn){return Ye.apply(this,arguments)}}(Ye,j,V,Y),{gtagCore:Ye,wrappedGtag:window[Fe]}}(Fr,Nu,jh,os,"gtag");ei=Ye,Sl=Rt,Zr=!0}return Fr[pe]=function Vc(j,V,Y,pe,Fe,Ye,Rt){return nc.apply(this,arguments)}(j,Nu,jh,V,Sl,os,Y),new $a(j)}function fr(){return Ar.apply(this,arguments)}function Ar(){return(Ar=(0,J.Z)(function*(){if((0,Ke.ru)()||!(0,Ke.zI)()||!(0,Ke.hl)())return!1;try{return yield(0,Ke.eu)()}catch{return!1}})).apply(this,arguments)}const Xs="@firebase/analytics";!function ju(){(0,je._registerComponent)(new st.wA(Xa,(V,{options:Y})=>Gr(V.getProvider("app").getImmediate(),V.getProvider("installations-internal").getImmediate(),Y),"PUBLIC")),(0,je._registerComponent)(new st.wA("analytics-internal",function j(V){try{const Y=V.getProvider(Xa).getImmediate();return{logEvent:(pe,Fe,Ye)=>function Lr(j,V,Y,pe){j=(0,Ke.m9)(j),function Nh(j,V,Y,pe,Fe){return Bh.apply(this,arguments)}(ei,Fr[j.app.options.appId],V,Y,pe).catch(Fe=>Ys.error(Fe))}(Y,pe,Fe,Ye)}}catch(Y){throw ys.create("interop-component-reg-failed",{reason:Y})}},"PRIVATE")),(0,je.registerVersion)(Xs,"0.8.0"),(0,je.registerVersion)(Xs,"0.8.0","esm2017")}();var Uh=se(4408),Uu=se(7565);const Ti=new class Vu extends Uu.v{}(class Gc extends Uh.o{constructor(V,Y){super(V,Y),this.scheduler=V,this.work=Y}schedule(V,Y=0){return Y>0?super.schedule(V,Y):(this.delay=Y,this.state=V,this.scheduler.flush(this),this)}execute(V,Y){return Y>0||this.closed?super.execute(V,Y):this._execute(V,Y)}requestAsyncId(V,Y,pe=0){return null!=pe&&pe>0||null==pe&&this.delay>0?super.requestAsyncId(V,Y,pe):V.flush(this)}});var Vh=se(4986),Cl=se(9751),uo=se(8505),Zo=se(9468),rc=se(5363);const Rv=new $.GfV("7.4.1"),zc="__angularfire_symbol__analyticsIsSupportedValue",yp="__angularfire_symbol__analyticsIsSupported",as="__angularfire_symbol__remoteConfigIsSupportedValue",Ia="__angularfire_symbol__remoteConfigIsSupported",Hc="__angularfire_symbol__messagingIsSupportedValue",bp="__angularfire_symbol__messagingIsSupported";function zu(j,V,Y){if(V){if(1===V.length)return V[0];const Ye=V.filter(Rt=>Rt.app===Y);if(1===Ye.length)return Ye[0]}return Y.container.getProvider(j).getImmediate({optional:!0})}globalThis[yp]||(globalThis[yp]=fr().then(j=>globalThis[zc]=j).catch(()=>globalThis[zc]=!1)),globalThis[bp]||(globalThis[bp]=fp().then(j=>globalThis[Hc]=j).catch(()=>globalThis[Hc]=!1)),globalThis[Ia]||(globalThis[Ia]=Su().then(j=>globalThis[as]=j).catch(()=>globalThis[as]=!1));const Wc=(j,V)=>{const Y=V?[V]:(0,c.C6)(),pe=[];return Y.forEach(Fe=>{Fe.container.getProvider(j).instances.forEach(Rt=>{pe.includes(Rt)||pe.push(Rt)})}),pe};function Ja(){}class Tp{constructor(V,Y=Ti){this.zone=V,this.delegate=Y}now(){return this.delegate.now()}schedule(V,Y,pe){const Fe=this.zone;return this.delegate.schedule(function(Rt){Fe.runGuarded(()=>{V.apply(this,[Rt])})},Y,pe)}}class Hu{constructor(V){this.zone=V,this.task=null}call(V,Y){const pe=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ja,{},Ja,Ja)),Y.pipe((0,uo.b)({next:pe,complete:pe,error:pe})).subscribe(V).add(pe)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let El=(()=>{class j{constructor(Y){this.ngZone=Y,this.outsideAngular=Y.runOutsideAngular(()=>new Tp(Zone.current)),this.insideAngular=Y.run(()=>new Tp(Zone.current,Vh.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return j.\u0275fac=function(Y){return new(Y||j)($.LFG($.R0b))},j.\u0275prov=$.Yz7({token:j,factory:j.\u0275fac,providedIn:"root"}),j})();function oi(){const j=globalThis.\u0275AngularFireScheduler;if(!j)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return j}function Al(j){return oi().ngZone.runOutsideAngular(()=>j())}function Yo(j){return oi().ngZone.run(()=>j())}function Xd(j){return oi(),function $d(j){return function(Y){return(Y=Y.lift(new Hu(j.ngZone))).pipe((0,Zo.R)(j.outsideAngular),(0,rc.Q)(j.insideAngular))}}(oi())(j)}const zh=(j,V)=>function(){const pe=arguments;return V&&setTimeout(()=>{"scheduled"===V.state&&V.invoke()},10),Yo(()=>j.apply(void 0,pe))},sc=(j,V)=>function(){let Y;const pe=arguments;for(let Ye=0;Ye<arguments.length;Ye++)"function"==typeof pe[Ye]&&(V&&(Y||(Y=Yo(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ja,{},Ja,Ja)))),pe[Ye]=zh(pe[Ye],Y));const Fe=Al(()=>j.apply(this,pe));if(!V){if(Fe instanceof Cl.y){const Ye=oi();return Fe.pipe((0,Zo.R)(Ye.outsideAngular),(0,rc.Q)(Ye.insideAngular))}return Yo(()=>Fe)}return Fe instanceof Cl.y?Fe.pipe(Xd):Fe instanceof Promise?Yo(()=>new Promise((Ye,Rt)=>Fe.then(ln=>Yo(()=>Ye(ln)),ln=>Yo(()=>Rt(ln))))):"function"==typeof Fe&&Y?function(){return setTimeout(()=>{Y&&"scheduled"===Y.state&&Y.invoke()},10),Fe.apply(this,arguments)}:Yo(()=>Fe)}},6457:(kn,At,se)=>{se.d(At,{$:()=>jd,A:()=>Me,B:()=>Ot,G:()=>vl,H:()=>wo,J:()=>xl,L:()=>Gi,M:()=>Ch,N:()=>mv,P:()=>Vh,Q:()=>op,R:()=>Qa,T:()=>kd,U:()=>Cu,V:()=>or,W:()=>da,X:()=>ar,Y:()=>ri,Z:()=>gv,_:()=>tg,a:()=>Ml,a0:()=>Vr,a1:()=>Pc,a2:()=>lp,a3:()=>ng,a4:()=>_v,a5:()=>vs,a6:()=>ig,a7:()=>Oc,a8:()=>vv,a9:()=>cp,aA:()=>Bs,aB:()=>ln,aC:()=>Yo,aD:()=>Al,aE:()=>jr,aI:()=>kh,aL:()=>Yl,aa:()=>Vd,ab:()=>hp,ac:()=>rg,af:()=>og,ag:()=>dp,ah:()=>ag,ak:()=>Ac,al:()=>Hd,an:()=>gp,ao:()=>_p,ap:()=>Er,aq:()=>_t,ar:()=>xi,as:()=>St,at:()=>_n,au:()=>Xc,av:()=>Zc,aw:()=>Nt,ax:()=>ze,ay:()=>He,az:()=>Bi,b:()=>ys,c:()=>Ia,d:()=>xp,e:()=>bp,f:()=>Xd,g:()=>Y,h:()=>sc,i:()=>ku,j:()=>Ye,k:()=>kb,l:()=>Eo,m:()=>sM,o:()=>Oe,r:()=>Uh,s:()=>ic,u:()=>Ti});var $=se(5861),c=se(2090),J=se(9681),je=se(655),Ke=se(1877),st=se(4859);const Oe={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Me={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const Ot=function Ne(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},yt=function Kt(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Pn=new c.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),et=new Ke.Yd("@firebase/auth");function vn(P,...M){et.logLevel<=Ke.in.ERROR&&et.error(`Auth (${J.SDK_VERSION}): ${P}`,...M)}function _n(P,...M){throw an(P,...M)}function Nt(P,...M){return an(P,...M)}function Dt(P,M,E){const O=Object.assign(Object.assign({},yt()),{[M]:E});return new c.LL("auth","Firebase",O).create(M,{appName:P.name})}function wt(P,M,E){if(!(M instanceof E))throw E.name!==M.constructor.name&&_n(P,"argument-error"),Dt(P,"argument-error",`Type of ${M.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function an(P,...M){if("string"!=typeof P){const E=M[0],O=[...M.slice(1)];return O[0]&&(O[0].appName=P.name),P._errorFactory.create(E,...O)}return Pn.create(P,...M)}function ze(P,M,...E){if(!P)throw an(M,...E)}function ot(P){const M="INTERNAL ASSERTION FAILED: "+P;throw vn(M),new Error(M)}function _t(P,M){P||ot(M)}const ke=new Map;function He(P){_t(P instanceof Function,"Expected a class definition");let M=ke.get(P);return M?(_t(M instanceof P,"Instance stored in cache mismatched with class"),M):(M=new P,ke.set(P,M),M)}function Xe(){var P;return typeof self<"u"&&(null===(P=self.location)||void 0===P?void 0:P.href)||""}function zt(){return"http:"===zn()||"https:"===zn()}function zn(){var P;return typeof self<"u"&&(null===(P=self.location)||void 0===P?void 0:P.protocol)||null}class nn{constructor(M,E){this.shortDelay=M,this.longDelay=E,_t(E>M,"Short delay should be less than long delay!"),this.isMobile=(0,c.uI)()||(0,c.b$)()}get(){return function Ni(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(zt()||(0,c.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function er(P,M){_t(P.emulator,"Emulator should always be set here");const{url:E}=P.emulator;return M?`${E}${M.startsWith("/")?M.slice(1):M}`:E}class Nr{static initialize(M,E,O){this.fetchImpl=M,E&&(this.headersImpl=E),O&&(this.responseImpl=O)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void ot("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void ot("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void ot("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const sr={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},Ui=new nn(3e4,6e4);function Mi(P,M){return P.tenantId&&!M.tenantId?Object.assign(Object.assign({},M),{tenantId:P.tenantId}):M}function Vi(P,M,E,O){return gr.apply(this,arguments)}function gr(){return(gr=(0,$.Z)(function*(P,M,E,O,q={}){return za(P,q,(0,$.Z)(function*(){let re={},Be={};O&&("GET"===M?Be=O:re={body:JSON.stringify(O)});const Et=(0,c.xO)(Object.assign({key:P.config.apiKey},Be)).slice(1),cn=yield P._getAdditionalHeaders();return cn["Content-Type"]="application/json",P.languageCode&&(cn["X-Firebase-Locale"]=P.languageCode),Nr.fetch()(ha(P,P.config.apiHost,E,Et),Object.assign({method:M,headers:cn,referrerPolicy:"no-referrer"},re))}))})).apply(this,arguments)}function za(P,M,E){return oo.apply(this,arguments)}function oo(){return(oo=(0,$.Z)(function*(P,M,E){P._canInitEmulator=!1;const O=Object.assign(Object.assign({},sr),M);try{const q=new Ca(P),re=yield Promise.race([E(),q.promise]);q.clearNetworkTimeout();const Be=yield re.json();if("needConfirmation"in Be)throw Br(P,"account-exists-with-different-credential",Be);if(re.ok&&!("errorMessage"in Be))return Be;{const Et=re.ok?Be.errorMessage:Be.error.message,[cn,jn]=Et.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===cn)throw Br(P,"credential-already-in-use",Be);if("EMAIL_EXISTS"===cn)throw Br(P,"email-already-in-use",Be);if("USER_DISABLED"===cn)throw Br(P,"user-disabled",Be);const di=O[cn]||cn.toLowerCase().replace(/[_\s]+/g,"-");if(jn)throw Dt(P,di,jn);_n(P,di)}}catch(q){if(q instanceof c.ZR)throw q;_n(P,"network-request-failed")}})).apply(this,arguments)}function Cr(P,M,E,O){return gl.apply(this,arguments)}function gl(){return(gl=(0,$.Z)(function*(P,M,E,O,q={}){const re=yield Vi(P,M,E,O,q);return"mfaPendingCredential"in re&&_n(P,"multi-factor-auth-required",{_serverResponse:re}),re})).apply(this,arguments)}function ha(P,M,E,O){const q=`${M}${E}?${O}`;return P.config.emulator?er(P.config,q):`${P.config.apiScheme}://${q}`}class Ca{constructor(M){this.auth=M,this.timer=null,this.promise=new Promise((E,O)=>{this.timer=setTimeout(()=>O(Nt(this.auth,"network-request-failed")),Ui.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Br(P,M,E){const O={appName:P.name};E.email&&(O.email=E.email),E.phoneNumber&&(O.phoneNumber=E.phoneNumber);const q=Nt(P,M,O);return q.customData._tokenResponse=E,q}function Un(){return(Un=(0,$.Z)(function*(P,M){return Vi(P,"POST","/v1/accounts:delete",M)})).apply(this,arguments)}function ao(P,M){return _r.apply(this,arguments)}function _r(){return(_r=(0,$.Z)(function*(P,M){return Vi(P,"POST","/v1/accounts:update",M)})).apply(this,arguments)}function Li(P,M){return ms.apply(this,arguments)}function ms(){return(ms=(0,$.Z)(function*(P,M){return Vi(P,"POST","/v1/accounts:lookup",M)})).apply(this,arguments)}function To(P){if(P)try{const M=new Date(Number(P));if(!isNaN(M.getTime()))return M.toUTCString()}catch{}}function Os(){return(Os=(0,$.Z)(function*(P,M=!1){const E=(0,c.m9)(P),O=yield E.getIdToken(M),q=Ai(O);ze(q&&q.exp&&q.auth_time&&q.iat,E.auth,"internal-error");const re="object"==typeof q.firebase?q.firebase:void 0,Be=re?.sign_in_provider;return{claims:q,token:O,authTime:To(zl(q.auth_time)),issuedAtTime:To(zl(q.iat)),expirationTime:To(zl(q.exp)),signInProvider:Be||null,signInSecondFactor:re?.sign_in_second_factor||null}})).apply(this,arguments)}function zl(P){return 1e3*Number(P)}function Ai(P){var M;const[E,O,q]=P.split(".");if(void 0===E||void 0===O||void 0===q)return vn("JWT malformed, contained fewer than 3 sections"),null;try{const re=(0,c.tV)(O);return re?JSON.parse(re):(vn("Failed to decode base64 JWT payload"),null)}catch(re){return vn("Caught error parsing JWT payload as JSON",null===(M=re)||void 0===M?void 0:M.toString()),null}}function Dn(P,M){return Ea.apply(this,arguments)}function Ea(){return(Ea=(0,$.Z)(function*(P,M,E=!1){if(E)return M;try{return yield M}catch(O){throw O instanceof c.ZR&&gs(O)&&P.auth.currentUser===P&&(yield P.auth.signOut()),O}})).apply(this,arguments)}function gs({code:P}){return"auth/user-disabled"===P||"auth/user-token-expired"===P}class li{constructor(M){this.user=M,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(M){var E;if(M){const O=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),O}{this.errorBackoff=3e4;const q=(null!==(E=this.user.stsTokenManager.expirationTime)&&void 0!==E?E:0)-Date.now()-3e5;return Math.max(0,q)}}schedule(M=!1){var E=this;if(!this.isRunning)return;const O=this.getInterval(M);this.timerId=setTimeout((0,$.Z)(function*(){yield E.iteration()}),O)}iteration(){var M=this;return(0,$.Z)(function*(){var E;try{yield M.user.getIdToken(!0)}catch(O){return void("auth/network-request-failed"===(null===(E=O)||void 0===E?void 0:E.code)&&M.schedule(!0))}M.schedule()})()}}class lo{constructor(M,E){this.createdAt=M,this.lastLoginAt=E,this._initializeTime()}_initializeTime(){this.lastSignInTime=To(this.lastLoginAt),this.creationTime=To(this.createdAt)}_copy(M){this.createdAt=M.createdAt,this.lastLoginAt=M.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function yr(P){return br.apply(this,arguments)}function br(){return(br=(0,$.Z)(function*(P){var M;const E=P.auth,O=yield P.getIdToken(),q=yield Dn(P,Li(E,{idToken:O}));ze(q?.users.length,E,"internal-error");const re=q.users[0];P._notifyReloadListener(re);const Be=null!==(M=re.providerUserInfo)&&void 0!==M&&M.length?we(re.providerUserInfo):[],Et=xe(P.providerData,Be),di=!!P.isAnonymous&&!(P.email&&re.passwordHash||Et?.length),wr={uid:re.localId,displayName:re.displayName||null,photoURL:re.photoUrl||null,email:re.email||null,emailVerified:re.emailVerified||!1,phoneNumber:re.phoneNumber||null,tenantId:re.tenantId||null,providerData:Et,metadata:new lo(re.createdAt,re.lastLoginAt),isAnonymous:di};Object.assign(P,wr)})).apply(this,arguments)}function rs(){return(rs=(0,$.Z)(function*(P){const M=(0,c.m9)(P);yield yr(M),yield M.auth._persistUserIfCurrent(M),M.auth._notifyListenersIfCurrent(M)})).apply(this,arguments)}function xe(P,M){return[...P.filter(O=>!M.some(q=>q.providerId===O.providerId)),...M]}function we(P){return P.map(M=>{var{providerId:E}=M,O=(0,je._T)(M,["providerId"]);return{providerId:E,uid:O.rawId||"",displayName:O.displayName||null,email:O.email||null,phoneNumber:O.phoneNumber||null,photoURL:O.photoUrl||null}})}function Ae(){return(Ae=(0,$.Z)(function*(P,M){const E=yield za(P,{},(0,$.Z)(function*(){const O=(0,c.xO)({grant_type:"refresh_token",refresh_token:M}).slice(1),{tokenApiHost:q,apiKey:re}=P.config,Be=ha(P,q,"/v1/token",`key=${re}`),Et=yield P._getAdditionalHeaders();return Et["Content-Type"]="application/x-www-form-urlencoded",Nr.fetch()(Be,{method:"POST",headers:Et,body:O})}));return{accessToken:E.access_token,expiresIn:E.expires_in,refreshToken:E.refresh_token}})).apply(this,arguments)}class Ce{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(M){ze(M.idToken,"internal-error"),ze(typeof M.idToken<"u","internal-error"),ze(typeof M.refreshToken<"u","internal-error");const E="expiresIn"in M&&typeof M.expiresIn<"u"?Number(M.expiresIn):function un(P){const M=Ai(P);return ze(M,"internal-error"),ze(typeof M.exp<"u","internal-error"),ze(typeof M.iat<"u","internal-error"),Number(M.exp)-Number(M.iat)}(M.idToken);this.updateTokensAndExpiration(M.idToken,M.refreshToken,E)}getToken(M,E=!1){var O=this;return(0,$.Z)(function*(){return ze(!O.accessToken||O.refreshToken,M,"user-token-expired"),E||!O.accessToken||O.isExpired?O.refreshToken?(yield O.refresh(M,O.refreshToken),O.accessToken):null:O.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(M,E){var O=this;return(0,$.Z)(function*(){const{accessToken:q,refreshToken:re,expiresIn:Be}=yield function ve(P,M){return Ae.apply(this,arguments)}(M,E);O.updateTokensAndExpiration(q,re,Number(Be))})()}updateTokensAndExpiration(M,E,O){this.refreshToken=E||null,this.accessToken=M||null,this.expirationTime=Date.now()+1e3*O}static fromJSON(M,E){const{refreshToken:O,accessToken:q,expirationTime:re}=E,Be=new Ce;return O&&(ze("string"==typeof O,"internal-error",{appName:M}),Be.refreshToken=O),q&&(ze("string"==typeof q,"internal-error",{appName:M}),Be.accessToken=q),re&&(ze("number"==typeof re,"internal-error",{appName:M}),Be.expirationTime=re),Be}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(M){this.accessToken=M.accessToken,this.refreshToken=M.refreshToken,this.expirationTime=M.expirationTime}_clone(){return Object.assign(new Ce,this.toJSON())}_performRefresh(){return ot("not implemented")}}function Ct(P,M){ze("string"==typeof P||typeof P>"u","internal-error",{appName:M})}class $t{constructor(M){var{uid:E,auth:O,stsTokenManager:q}=M,re=(0,je._T)(M,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new li(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=E,this.auth=O,this.stsTokenManager=q,this.accessToken=q.accessToken,this.displayName=re.displayName||null,this.email=re.email||null,this.emailVerified=re.emailVerified||!1,this.phoneNumber=re.phoneNumber||null,this.photoURL=re.photoURL||null,this.isAnonymous=re.isAnonymous||!1,this.tenantId=re.tenantId||null,this.providerData=re.providerData?[...re.providerData]:[],this.metadata=new lo(re.createdAt||void 0,re.lastLoginAt||void 0)}getIdToken(M){var E=this;return(0,$.Z)(function*(){const O=yield Dn(E,E.stsTokenManager.getToken(E.auth,M));return ze(O,E.auth,"internal-error"),E.accessToken!==O&&(E.accessToken=O,yield E.auth._persistUserIfCurrent(E),E.auth._notifyListenersIfCurrent(E)),O})()}getIdTokenResult(M){return function vr(P){return Os.apply(this,arguments)}(this,M)}reload(){return function Hi(P){return rs.apply(this,arguments)}(this)}_assign(M){this!==M&&(ze(this.uid===M.uid,this.auth,"internal-error"),this.displayName=M.displayName,this.photoURL=M.photoURL,this.email=M.email,this.emailVerified=M.emailVerified,this.phoneNumber=M.phoneNumber,this.isAnonymous=M.isAnonymous,this.tenantId=M.tenantId,this.providerData=M.providerData.map(E=>Object.assign({},E)),this.metadata._copy(M.metadata),this.stsTokenManager._assign(M.stsTokenManager))}_clone(M){return new $t(Object.assign(Object.assign({},this),{auth:M,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(M){ze(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=M,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(M){this.reloadListener?this.reloadListener(M):this.reloadUserInfo=M}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(M,E=!1){var O=this;return(0,$.Z)(function*(){let q=!1;M.idToken&&M.idToken!==O.stsTokenManager.accessToken&&(O.stsTokenManager.updateFromServerResponse(M),q=!0),E&&(yield yr(O)),yield O.auth._persistUserIfCurrent(O),q&&O.auth._notifyListenersIfCurrent(O)})()}delete(){var M=this;return(0,$.Z)(function*(){const E=yield M.getIdToken();return yield Dn(M,function _l(P,M){return Un.apply(this,arguments)}(M.auth,{idToken:E})),M.stsTokenManager.clearRefreshToken(),M.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(M=>Object.assign({},M)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(M,E){var O,q,re,Be,Et,cn,jn,di;const wr=null!==(O=E.displayName)&&void 0!==O?O:void 0,Rl=null!==(q=E.email)&&void 0!==q?q:void 0,ac=null!==(re=E.phoneNumber)&&void 0!==re?re:void 0,yg=null!==(Be=E.photoURL)&&void 0!==Be?Be:void 0,Nv=null!==(Et=E.tenantId)&&void 0!==Et?Et:void 0,sf=null!==(cn=E._redirectEventId)&&void 0!==cn?cn:void 0,af=null!==(jn=E.createdAt)&&void 0!==jn?jn:void 0,lf=null!==(di=E.lastLoginAt)&&void 0!==di?di:void 0,{uid:jb,emailVerified:Cp,isAnonymous:Bv,providerData:jv,stsTokenManager:bg}=E;ze(jb&&bg,M,"internal-error");const Ub=Ce.fromJSON(this.name,bg);ze("string"==typeof jb,M,"internal-error"),Ct(wr,M.name),Ct(Rl,M.name),ze("boolean"==typeof Cp,M,"internal-error"),ze("boolean"==typeof Bv,M,"internal-error"),Ct(ac,M.name),Ct(yg,M.name),Ct(Nv,M.name),Ct(sf,M.name),Ct(af,M.name),Ct(lf,M.name);const xg=new $t({uid:jb,auth:M,email:Rl,emailVerified:Cp,displayName:wr,isAnonymous:Bv,photoURL:yg,phoneNumber:ac,tenantId:Nv,stsTokenManager:Ub,createdAt:af,lastLoginAt:lf});return jv&&Array.isArray(jv)&&(xg.providerData=jv.map(Uv=>Object.assign({},Uv))),sf&&(xg._redirectEventId=sf),xg}static _fromIdTokenResponse(M,E,O=!1){return(0,$.Z)(function*(){const q=new Ce;q.updateFromServerResponse(E);const re=new $t({uid:E.localId,auth:M,stsTokenManager:q,isAnonymous:O});return yield yr(re),re})()}}const Gi=(()=>{class P{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,$.Z)(function*(){return!0})()}_set(E,O){var q=this;return(0,$.Z)(function*(){q.storage[E]=O})()}_get(E){var O=this;return(0,$.Z)(function*(){const q=O.storage[E];return void 0===q?null:q})()}_remove(E){var O=this;return(0,$.Z)(function*(){delete O.storage[E]})()}_addListener(E,O){}_removeListener(E,O){}}return P.type="NONE",P})();function Bi(P,M,E){return`firebase:${P}:${M}:${E}`}class _s{constructor(M,E,O){this.persistence=M,this.auth=E,this.userKey=O;const{config:q,name:re}=this.auth;this.fullUserKey=Bi(this.userKey,q.apiKey,re),this.fullPersistenceKey=Bi("persistence",q.apiKey,re),this.boundEventHandler=E._onStorageEvent.bind(E),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(M){return this.persistence._set(this.fullUserKey,M.toJSON())}getCurrentUser(){var M=this;return(0,$.Z)(function*(){const E=yield M.persistence._get(M.fullUserKey);return E?$t._fromJSON(M.auth,E):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(M){var E=this;return(0,$.Z)(function*(){if(E.persistence===M)return;const O=yield E.getCurrentUser();return yield E.removeCurrentUser(),E.persistence=M,O?E.setCurrentUser(O):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(M,E,O="authUser"){return(0,$.Z)(function*(){if(!E.length)return new _s(He(Gi),M,O);const q=(yield Promise.all(E.map(function(){var jn=(0,$.Z)(function*(di){if(yield di._isAvailable())return di});return function(di){return jn.apply(this,arguments)}}()))).filter(jn=>jn);let re=q[0]||He(Gi);const Be=Bi(O,M.config.apiKey,M.name);let Et=null;for(const jn of E)try{const di=yield jn._get(Be);if(di){const wr=$t._fromJSON(M,di);jn!==re&&(Et=wr),re=jn;break}}catch{}const cn=q.filter(jn=>jn._shouldAllowMigration);return re._shouldAllowMigration&&cn.length?(re=cn[0],Et&&(yield re._set(Be,Et.toJSON())),yield Promise.all(E.map(function(){var jn=(0,$.Z)(function*(di){if(di!==re)try{yield di._remove(Be)}catch{}});return function(di){return jn.apply(this,arguments)}}())),new _s(re,M,O)):new _s(re,M,O)})()}}function Re(P){const M=P.toLowerCase();if(M.includes("opera/")||M.includes("opr/")||M.includes("opios/"))return"Opera";if(Xt(M))return"IEMobile";if(M.includes("msie")||M.includes("trident/"))return"IE";if(M.includes("edge/"))return"Edge";if(Se(M))return"Firefox";if(M.includes("silk/"))return"Silk";if(rn(M))return"Blackberry";if(Zn(M))return"Webos";if(ye(M))return"Safari";if((M.includes("chrome/")||gt(M))&&!M.includes("edge/"))return"Chrome";if(St(M))return"Android";{const O=P.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===O?.length)return O[1]}return"Other"}function Se(P=(0,c.z$)()){return/firefox\//i.test(P)}function ye(P=(0,c.z$)()){const M=P.toLowerCase();return M.includes("safari/")&&!M.includes("chrome/")&&!M.includes("crios/")&&!M.includes("android")}function gt(P=(0,c.z$)()){return/crios\//i.test(P)}function Xt(P=(0,c.z$)()){return/iemobile/i.test(P)}function St(P=(0,c.z$)()){return/android/i.test(P)}function rn(P=(0,c.z$)()){return/blackberry/i.test(P)}function Zn(P=(0,c.z$)()){return/webos/i.test(P)}function xi(P=(0,c.z$)()){return/iphone|ipad|ipod/i.test(P)||/macintosh/i.test(P)&&/mobile/i.test(P)}function Er(P=(0,c.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(P)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(P)}function ji(P=(0,c.z$)()){return xi(P)||St(P)||Zn(P)||rn(P)||/windows phone/i.test(P)||Xt(P)}function wc(P,M=[]){let E;switch(P){case"Browser":E=Re((0,c.z$)());break;case"Worker":E=`${Re((0,c.z$)())}-${P}`;break;default:E=P}const O=M.length?M.join(","):"FirebaseCore-web";return`${E}/JsCore/${J.SDK_VERSION}/${O}`}class ui{constructor(M){this.auth=M,this.queue=[]}pushCallback(M,E){const O=re=>new Promise((Be,Et)=>{try{Be(M(re))}catch(cn){Et(cn)}});O.onAbort=E,this.queue.push(O);const q=this.queue.length-1;return()=>{this.queue[q]=()=>Promise.resolve()}}runMiddleware(M){var E=this;return(0,$.Z)(function*(){var O;if(E.auth.currentUser===M)return;const q=[];try{for(const re of E.queue)yield re(M),re.onAbort&&q.push(re.onAbort)}catch(re){q.reverse();for(const Be of q)try{Be()}catch{}throw E.auth._errorFactory.create("login-blocked",{originalMessage:null===(O=re)||void 0===O?void 0:O.message})}})()}}class Sh{constructor(M,E,O){this.app=M,this.heartbeatServiceProvider=E,this.config=O,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Id(this),this.idTokenSubscription=new Id(this),this.beforeStateQueue=new ui(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Pn,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=M.name,this.clientVersion=O.sdkClientVersion}_initializeWithPersistence(M,E){var O=this;return E&&(this._popupRedirectResolver=He(E)),this._initializationPromise=this.queue((0,$.Z)(function*(){var q,re;if(!O._deleted&&(O.persistenceManager=yield _s.create(O,M),!O._deleted)){if(null!==(q=O._popupRedirectResolver)&&void 0!==q&&q._shouldInitProactively)try{yield O._popupRedirectResolver._initialize(O)}catch{}yield O.initializeCurrentUser(E),O.lastNotifiedUid=(null===(re=O.currentUser)||void 0===re?void 0:re.uid)||null,!O._deleted&&(O._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var M=this;return(0,$.Z)(function*(){if(M._deleted)return;const E=yield M.assertedPersistence.getCurrentUser();if(M.currentUser||E){if(M.currentUser&&E&&M.currentUser.uid===E.uid)return M._currentUser._assign(E),void(yield M.currentUser.getIdToken());yield M._updateCurrentUser(E,!0)}})()}initializeCurrentUser(M){var E=this;return(0,$.Z)(function*(){var O;const q=yield E.assertedPersistence.getCurrentUser();let re=q,Be=!1;if(M&&E.config.authDomain){yield E.getOrInitRedirectPersistenceManager();const Et=null===(O=E.redirectUser)||void 0===O?void 0:O._redirectEventId,cn=re?._redirectEventId,jn=yield E.tryRedirectSignIn(M);(!Et||Et===cn)&&jn?.user&&(re=jn.user,Be=!0)}if(!re)return E.directlySetCurrentUser(null);if(!re._redirectEventId){if(Be)try{yield E.beforeStateQueue.runMiddleware(re)}catch(Et){re=q,E._popupRedirectResolver._overrideRedirectResult(E,()=>Promise.reject(Et))}return re?E.reloadAndSetCurrentUserOrClear(re):E.directlySetCurrentUser(null)}return ze(E._popupRedirectResolver,E,"argument-error"),yield E.getOrInitRedirectPersistenceManager(),E.redirectUser&&E.redirectUser._redirectEventId===re._redirectEventId?E.directlySetCurrentUser(re):E.reloadAndSetCurrentUserOrClear(re)})()}tryRedirectSignIn(M){var E=this;return(0,$.Z)(function*(){let O=null;try{O=yield E._popupRedirectResolver._completeRedirectFn(E,M,!0)}catch{yield E._setRedirectUser(null)}return O})()}reloadAndSetCurrentUserOrClear(M){var E=this;return(0,$.Z)(function*(){var O;try{yield yr(M)}catch(q){if("auth/network-request-failed"!==(null===(O=q)||void 0===O?void 0:O.code))return E.directlySetCurrentUser(null)}return E.directlySetCurrentUser(M)})()}useDeviceLanguage(){this.languageCode=function Ci(){if(typeof navigator>"u")return null;const P=navigator;return P.languages&&P.languages[0]||P.language||null}()}_delete(){var M=this;return(0,$.Z)(function*(){M._deleted=!0})()}updateCurrentUser(M){var E=this;return(0,$.Z)(function*(){const O=M?(0,c.m9)(M):null;return O&&ze(O.auth.config.apiKey===E.config.apiKey,E,"invalid-user-token"),E._updateCurrentUser(O&&O._clone(E))})()}_updateCurrentUser(M,E=!1){var O=this;return(0,$.Z)(function*(){if(!O._deleted)return M&&ze(O.tenantId===M.tenantId,O,"tenant-id-mismatch"),E||(yield O.beforeStateQueue.runMiddleware(M)),O.queue((0,$.Z)(function*(){yield O.directlySetCurrentUser(M),O.notifyAuthListeners()}))})()}signOut(){var M=this;return(0,$.Z)(function*(){return yield M.beforeStateQueue.runMiddleware(null),(M.redirectPersistenceManager||M._popupRedirectResolver)&&(yield M._setRedirectUser(null)),M._updateCurrentUser(null,!0)})()}setPersistence(M){var E=this;return this.queue((0,$.Z)(function*(){yield E.assertedPersistence.setPersistence(He(M))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(M){this._errorFactory=new c.LL("auth","Firebase",M())}onAuthStateChanged(M,E,O){return this.registerStateListener(this.authStateSubscription,M,E,O)}beforeAuthStateChanged(M,E){return this.beforeStateQueue.pushCallback(M,E)}onIdTokenChanged(M,E,O){return this.registerStateListener(this.idTokenSubscription,M,E,O)}toJSON(){var M;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(M=this._currentUser)||void 0===M?void 0:M.toJSON()}}_setRedirectUser(M,E){var O=this;return(0,$.Z)(function*(){const q=yield O.getOrInitRedirectPersistenceManager(E);return null===M?q.removeCurrentUser():q.setCurrentUser(M)})()}getOrInitRedirectPersistenceManager(M){var E=this;return(0,$.Z)(function*(){if(!E.redirectPersistenceManager){const O=M&&He(M)||E._popupRedirectResolver;ze(O,E,"argument-error"),E.redirectPersistenceManager=yield _s.create(E,[He(O._redirectPersistence)],"redirectUser"),E.redirectUser=yield E.redirectPersistenceManager.getCurrentUser()}return E.redirectPersistenceManager})()}_redirectUserForId(M){var E=this;return(0,$.Z)(function*(){var O,q;return E._isInitialized&&(yield E.queue((0,$.Z)(function*(){}))),(null===(O=E._currentUser)||void 0===O?void 0:O._redirectEventId)===M?E._currentUser:(null===(q=E.redirectUser)||void 0===q?void 0:q._redirectEventId)===M?E.redirectUser:null})()}_persistUserIfCurrent(M){var E=this;return(0,$.Z)(function*(){if(M===E.currentUser)return E.queue((0,$.Z)(function*(){return E.directlySetCurrentUser(M)}))})()}_notifyListenersIfCurrent(M){M===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var M,E;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const O=null!==(E=null===(M=this.currentUser)||void 0===M?void 0:M.uid)&&void 0!==E?E:null;this.lastNotifiedUid!==O&&(this.lastNotifiedUid=O,this.authStateSubscription.next(this.currentUser))}registerStateListener(M,E,O,q){if(this._deleted)return()=>{};const re="function"==typeof E?E:E.next.bind(E),Be=this._isInitialized?Promise.resolve():this._initializationPromise;return ze(Be,this,"internal-error"),Be.then(()=>re(this.currentUser)),"function"==typeof E?M.addObserver(E,O,q):M.addObserver(E)}directlySetCurrentUser(M){var E=this;return(0,$.Z)(function*(){E.currentUser&&E.currentUser!==M&&(E._currentUser._stopProactiveRefresh(),M&&E.isProactiveRefreshEnabled&&M._startProactiveRefresh()),E.currentUser=M,M?yield E.assertedPersistence.setCurrentUser(M):yield E.assertedPersistence.removeCurrentUser()})()}queue(M){return this.operations=this.operations.then(M,M),this.operations}get assertedPersistence(){return ze(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(M){!M||this.frameworks.includes(M)||(this.frameworks.push(M),this.frameworks.sort(),this.clientVersion=wc(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var M=this;return(0,$.Z)(function*(){var E;const O={"X-Client-Version":M.clientVersion};M.app.options.appId&&(O["X-Firebase-gmpid"]=M.app.options.appId);const q=yield null===(E=M.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===E?void 0:E.getHeartbeatsHeader();return q&&(O["X-Firebase-Client"]=q),O})()}}function jr(P){return(0,c.m9)(P)}class Id{constructor(M){this.auth=M,this.observer=null,this.addObserver=(0,c.ne)(E=>this.observer=E)}get next(){return ze(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function vl(P,M,E){const O=jr(P);ze(O._canInitEmulator,O,"emulator-config-failed"),ze(/^https?:\/\//.test(M),O,"invalid-emulator-scheme");const q=!!E?.disableWarnings,re=ks(M),{host:Be,port:Et}=function Mc(P){const M=ks(P),E=/(\/\/)?([^?#/]+)/.exec(P.substr(M.length));if(!E)return{host:"",port:null};const O=E[2].split("@").pop()||"",q=/^(\[[^\]]+\])(:|$)/.exec(O);if(q){const re=q[1];return{host:re,port:Wl(O.substr(re.length+1))}}{const[re,Be]=O.split(":");return{host:re,port:Wl(Be)}}}(M);O.config.emulator={url:`${re}//${Be}${null===Et?"":`:${Et}`}/`},O.settings.appVerificationDisabledForTesting=!0,O.emulatorConfig=Object.freeze({host:Be,port:Et,protocol:re.replace(":",""),options:Object.freeze({disableWarnings:q})}),q||function Ho(){function P(){const M=document.createElement("p"),E=M.style;M.innerText="Running in emulator mode. Do not use with production credentials.",E.position="fixed",E.width="100%",E.backgroundColor="#ffffff",E.border=".1em solid #000000",E.color="#b50000",E.bottom="0px",E.left="0px",E.margin="0px",E.zIndex="10000",E.textAlign="center",M.classList.add("firebase-emulator-warning"),document.body.appendChild(M)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",P):P())}()}function ks(P){const M=P.indexOf(":");return M<0?"":P.substr(0,M+1)}function Wl(P){if(!P)return null;const M=Number(P);return isNaN(M)?null:M}class wo{constructor(M,E){this.providerId=M,this.signInMethod=E}toJSON(){return ot("not implemented")}_getIdTokenResponse(M){return ot("not implemented")}_linkToIdToken(M,E){return ot("not implemented")}_getReauthenticationResolver(M){return ot("not implemented")}}function Pd(P,M){return vi.apply(this,arguments)}function vi(){return(vi=(0,$.Z)(function*(P,M){return Vi(P,"POST","/v1/accounts:resetPassword",Mi(P,M))})).apply(this,arguments)}function dv(P,M){return ip.apply(this,arguments)}function ip(){return(ip=(0,$.Z)(function*(P,M){return Vi(P,"POST","/v1/accounts:update",M)})).apply(this,arguments)}function Ha(P,M){return bu.apply(this,arguments)}function bu(){return(bu=(0,$.Z)(function*(P,M){return Vi(P,"POST","/v1/accounts:update",Mi(P,M))})).apply(this,arguments)}function yl(){return(yl=(0,$.Z)(function*(P,M){return Cr(P,"POST","/v1/accounts:signInWithPassword",Mi(P,M))})).apply(this,arguments)}function bl(P,M){return xr.apply(this,arguments)}function xr(){return(xr=(0,$.Z)(function*(P,M){return Vi(P,"POST","/v1/accounts:sendOobCode",Mi(P,M))})).apply(this,arguments)}function Fd(P,M){return Zs.apply(this,arguments)}function Zs(){return(Zs=(0,$.Z)(function*(P,M){return bl(P,M)})).apply(this,arguments)}function qr(P,M){return Sc.apply(this,arguments)}function Sc(){return(Sc=(0,$.Z)(function*(P,M){return bl(P,M)})).apply(this,arguments)}function Ld(P,M){return Cc.apply(this,arguments)}function Cc(){return(Cc=(0,$.Z)(function*(P,M){return bl(P,M)})).apply(this,arguments)}function Wo(P,M){return rp.apply(this,arguments)}function rp(){return(rp=(0,$.Z)(function*(P,M){return bl(P,M)})).apply(this,arguments)}function fv(){return(fv=(0,$.Z)(function*(P,M){return Cr(P,"POST","/v1/accounts:signInWithEmailLink",Mi(P,M))})).apply(this,arguments)}function Xm(){return(Xm=(0,$.Z)(function*(P,M){return Cr(P,"POST","/v1/accounts:signInWithEmailLink",Mi(P,M))})).apply(this,arguments)}class Wa extends wo{constructor(M,E,O,q=null){super("password",O),this._email=M,this._password=E,this._tenantId=q}static _fromEmailAndPassword(M,E){return new Wa(M,E,"password")}static _fromEmailAndCode(M,E,O=null){return new Wa(M,E,"emailLink",O)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(M){const E="string"==typeof M?JSON.parse(M):M;if(E?.email&&E?.password){if("password"===E.signInMethod)return this._fromEmailAndPassword(E.email,E.password);if("emailLink"===E.signInMethod)return this._fromEmailAndCode(E.email,E.password,E.tenantId)}return null}_getIdTokenResponse(M){var E=this;return(0,$.Z)(function*(){switch(E.signInMethod){case"password":return function xu(P,M){return yl.apply(this,arguments)}(M,{returnSecureToken:!0,email:E._email,password:E._password});case"emailLink":return function sp(P,M){return fv.apply(this,arguments)}(M,{email:E._email,oobCode:E._password});default:_n(M,"internal-error")}})()}_linkToIdToken(M,E){var O=this;return(0,$.Z)(function*(){switch(O.signInMethod){case"password":return dv(M,{idToken:E,returnSecureToken:!0,email:O._email,password:O._password});case"emailLink":return function Km(P,M){return Xm.apply(this,arguments)}(M,{idToken:E,email:O._email,oobCode:O._password});default:_n(M,"internal-error")}})()}_getReauthenticationResolver(M){return this._getIdTokenResponse(M)}}function ql(P,M){return pv.apply(this,arguments)}function pv(){return(pv=(0,$.Z)(function*(P,M){return Cr(P,"POST","/v1/accounts:signInWithIdp",Mi(P,M))})).apply(this,arguments)}class xl extends wo{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(M){const E=new xl(M.providerId,M.signInMethod);return M.idToken||M.accessToken?(M.idToken&&(E.idToken=M.idToken),M.accessToken&&(E.accessToken=M.accessToken),M.nonce&&!M.pendingToken&&(E.nonce=M.nonce),M.pendingToken&&(E.pendingToken=M.pendingToken)):M.oauthToken&&M.oauthTokenSecret?(E.accessToken=M.oauthToken,E.secret=M.oauthTokenSecret):_n("argument-error"),E}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(M){const E="string"==typeof M?JSON.parse(M):M,{providerId:O,signInMethod:q}=E,re=(0,je._T)(E,["providerId","signInMethod"]);if(!O||!q)return null;const Be=new xl(O,q);return Be.idToken=re.idToken||void 0,Be.accessToken=re.accessToken||void 0,Be.secret=re.secret,Be.nonce=re.nonce,Be.pendingToken=re.pendingToken||null,Be}_getIdTokenResponse(M){return ql(M,this.buildRequest())}_linkToIdToken(M,E){const O=this.buildRequest();return O.idToken=E,ql(M,O)}_getReauthenticationResolver(M){const E=this.buildRequest();return E.autoCreate=!1,ql(M,E)}buildRequest(){const M={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)M.pendingToken=this.pendingToken;else{const E={};this.idToken&&(E.id_token=this.idToken),this.accessToken&&(E.access_token=this.accessToken),this.secret&&(E.oauth_token_secret=this.secret),E.providerId=this.providerId,this.nonce&&!this.pendingToken&&(E.nonce=this.nonce),M.postBody=(0,c.xO)(E)}return M}}function Cb(P,M){return $m.apply(this,arguments)}function $m(){return($m=(0,$.Z)(function*(P,M){return Vi(P,"POST","/v1/accounts:sendVerificationCode",Mi(P,M))})).apply(this,arguments)}function Tu(){return(Tu=(0,$.Z)(function*(P,M){return Cr(P,"POST","/v1/accounts:signInWithPhoneNumber",Mi(P,M))})).apply(this,arguments)}function Qm(){return(Qm=(0,$.Z)(function*(P,M){const E=yield Cr(P,"POST","/v1/accounts:signInWithPhoneNumber",Mi(P,M));if(E.temporaryProof)throw Br(P,"account-exists-with-different-credential",E);return E})).apply(this,arguments)}const Ab={USER_NOT_FOUND:"user-not-found"};function Od(){return(Od=(0,$.Z)(function*(P,M){return Cr(P,"POST","/v1/accounts:signInWithPhoneNumber",Mi(P,Object.assign(Object.assign({},M),{operation:"REAUTH"})),Ab)})).apply(this,arguments)}class Tl extends wo{constructor(M){super("phone","phone"),this.params=M}static _fromVerification(M,E){return new Tl({verificationId:M,verificationCode:E})}static _fromTokenResponse(M,E){return new Tl({phoneNumber:M,temporaryProof:E})}_getIdTokenResponse(M){return function Eb(P,M){return Tu.apply(this,arguments)}(M,this._makeVerificationRequest())}_linkToIdToken(M,E){return function wu(P,M){return Qm.apply(this,arguments)}(M,Object.assign({idToken:E},this._makeVerificationRequest()))}_getReauthenticationResolver(M){return function Db(P,M){return Od.apply(this,arguments)}(M,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:M,phoneNumber:E,verificationId:O,verificationCode:q}=this.params;return M&&E?{temporaryProof:M,phoneNumber:E}:{sessionInfo:O,code:q}}toJSON(){const M={providerId:this.providerId};return this.params.phoneNumber&&(M.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(M.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(M.verificationCode=this.params.verificationCode),this.params.verificationId&&(M.verificationId=this.params.verificationId),M}static fromJSON(M){"string"==typeof M&&(M=JSON.parse(M));const{verificationId:E,verificationCode:O,phoneNumber:q,temporaryProof:re}=M;return O||E||q||re?new Tl({verificationId:E,verificationCode:O,phoneNumber:q,temporaryProof:re}):null}}class Mu{constructor(M){var E,O,q,re,Be,Et;const cn=(0,c.zd)((0,c.pd)(M)),jn=null!==(E=cn.apiKey)&&void 0!==E?E:null,di=null!==(O=cn.oobCode)&&void 0!==O?O:null,wr=function Rb(P){switch(P){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(q=cn.mode)&&void 0!==q?q:null);ze(jn&&di&&wr,"argument-error"),this.apiKey=jn,this.operation=wr,this.code=di,this.continueUrl=null!==(re=cn.continueUrl)&&void 0!==re?re:null,this.languageCode=null!==(Be=cn.languageCode)&&void 0!==Be?Be:null,this.tenantId=null!==(Et=cn.tenantId)&&void 0!==Et?Et:null}static parseLink(M){const E=function Qw(P){const M=(0,c.zd)((0,c.pd)(P)).link,E=M?(0,c.zd)((0,c.pd)(M)).deep_link_id:null,O=(0,c.zd)((0,c.pd)(P)).deep_link_id;return(O?(0,c.zd)((0,c.pd)(O)).link:null)||O||E||M||P}(M);try{return new Mu(E)}catch{return null}}}let Ch=(()=>{class P{constructor(){this.providerId=P.PROVIDER_ID}static credential(E,O){return Wa._fromEmailAndPassword(E,O)}static credentialWithLink(E,O){const q=Mu.parseLink(O);return ze(q,"argument-error"),Wa._fromEmailAndCode(E,q.code,q.tenantId)}}return P.PROVIDER_ID="password",P.EMAIL_PASSWORD_SIGN_IN_METHOD="password",P.EMAIL_LINK_SIGN_IN_METHOD="emailLink",P})();class Aa{constructor(M){this.providerId=M,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(M){this.defaultLanguageCode=M}setCustomParameters(M){return this.customParameters=M,this}getCustomParameters(){return this.customParameters}}class Zl extends Aa{constructor(){super(...arguments),this.scopes=[]}addScope(M){return this.scopes.includes(M)||this.scopes.push(M),this}getScopes(){return[...this.scopes]}}class Cu extends Zl{static credentialFromJSON(M){const E="string"==typeof M?JSON.parse(M):M;return ze("providerId"in E&&"signInMethod"in E,"argument-error"),xl._fromParams(E)}credential(M){return this._credential(Object.assign(Object.assign({},M),{nonce:M.rawNonce}))}_credential(M){return ze(M.idToken||M.accessToken,"argument-error"),xl._fromParams(Object.assign(Object.assign({},M),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(M){return Cu.oauthCredentialFromTaggedObject(M)}static credentialFromError(M){return Cu.oauthCredentialFromTaggedObject(M.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:M}){if(!M)return null;const{oauthIdToken:E,oauthAccessToken:O,oauthTokenSecret:q,pendingToken:re,nonce:Be,providerId:Et}=M;if(!O&&!q&&!E&&!re||!Et)return null;try{return new Cu(Et)._credential({idToken:E,accessToken:O,nonce:Be,pendingToken:re})}catch{return null}}}let mv=(()=>{class P extends Zl{constructor(){super("facebook.com")}static credential(E){return xl._fromParams({providerId:P.PROVIDER_ID,signInMethod:P.FACEBOOK_SIGN_IN_METHOD,accessToken:E})}static credentialFromResult(E){return P.credentialFromTaggedObject(E)}static credentialFromError(E){return P.credentialFromTaggedObject(E.customData||{})}static credentialFromTaggedObject({_tokenResponse:E}){if(!E||!("oauthAccessToken"in E)||!E.oauthAccessToken)return null;try{return P.credential(E.oauthAccessToken)}catch{return null}}}return P.FACEBOOK_SIGN_IN_METHOD="facebook.com",P.PROVIDER_ID="facebook.com",P})(),op=(()=>{class P extends Zl{constructor(){super("google.com"),this.addScope("profile")}static credential(E,O){return xl._fromParams({providerId:P.PROVIDER_ID,signInMethod:P.GOOGLE_SIGN_IN_METHOD,idToken:E,accessToken:O})}static credentialFromResult(E){return P.credentialFromTaggedObject(E)}static credentialFromError(E){return P.credentialFromTaggedObject(E.customData||{})}static credentialFromTaggedObject({_tokenResponse:E}){if(!E)return null;const{oauthIdToken:O,oauthAccessToken:q}=E;if(!O&&!q)return null;try{return P.credential(O,q)}catch{return null}}}return P.GOOGLE_SIGN_IN_METHOD="google.com",P.PROVIDER_ID="google.com",P})(),kd=(()=>{class P extends Zl{constructor(){super("github.com")}static credential(E){return xl._fromParams({providerId:P.PROVIDER_ID,signInMethod:P.GITHUB_SIGN_IN_METHOD,accessToken:E})}static credentialFromResult(E){return P.credentialFromTaggedObject(E)}static credentialFromError(E){return P.credentialFromTaggedObject(E.customData||{})}static credentialFromTaggedObject({_tokenResponse:E}){if(!E||!("oauthAccessToken"in E)||!E.oauthAccessToken)return null;try{return P.credential(E.oauthAccessToken)}catch{return null}}}return P.GITHUB_SIGN_IN_METHOD="github.com",P.PROVIDER_ID="github.com",P})();class Yl extends wo{constructor(M,E){super(M,M),this.pendingToken=E}_getIdTokenResponse(M){return ql(M,this.buildRequest())}_linkToIdToken(M,E){const O=this.buildRequest();return O.idToken=E,ql(M,O)}_getReauthenticationResolver(M){const E=this.buildRequest();return E.autoCreate=!1,ql(M,E)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(M){const E="string"==typeof M?JSON.parse(M):M,{providerId:O,signInMethod:q,pendingToken:re}=E;return O&&q&&re&&O===q?new Yl(O,re):null}static _create(M,E){return new Yl(M,E)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class or extends Aa{constructor(M){ze(M.startsWith("saml."),"argument-error"),super(M)}static credentialFromResult(M){return or.samlCredentialFromTaggedObject(M)}static credentialFromError(M){return or.samlCredentialFromTaggedObject(M.customData||{})}static credentialFromJSON(M){const E=Yl.fromJSON(M);return ze(E,"argument-error"),E}static samlCredentialFromTaggedObject({_tokenResponse:M}){if(!M)return null;const{pendingToken:E,providerId:O}=M;if(!E||!O)return null;try{return Yl._create(O,E)}catch{return null}}}let da=(()=>{class P extends Zl{constructor(){super("twitter.com")}static credential(E,O){return xl._fromParams({providerId:P.PROVIDER_ID,signInMethod:P.TWITTER_SIGN_IN_METHOD,oauthToken:E,oauthTokenSecret:O})}static credentialFromResult(E){return P.credentialFromTaggedObject(E)}static credentialFromError(E){return P.credentialFromTaggedObject(E.customData||{})}static credentialFromTaggedObject({_tokenResponse:E}){if(!E)return null;const{oauthAccessToken:O,oauthTokenSecret:q}=E;if(!O||!q)return null;try{return P.credential(O,q)}catch{return null}}}return P.TWITTER_SIGN_IN_METHOD="twitter.com",P.PROVIDER_ID="twitter.com",P})();function Jm(P,M){return Ec.apply(this,arguments)}function Ec(){return(Ec=(0,$.Z)(function*(P,M){return Cr(P,"POST","/v1/accounts:signUp",Mi(P,M))})).apply(this,arguments)}class fa{constructor(M){this.user=M.user,this.providerId=M.providerId,this._tokenResponse=M._tokenResponse,this.operationType=M.operationType}static _fromIdTokenResponse(M,E,O,q=!1){return(0,$.Z)(function*(){const re=yield $t._fromIdTokenResponse(M,O,q),Be=Kl(O);return new fa({user:re,providerId:Be,_tokenResponse:O,operationType:E})})()}static _forOperation(M,E,O){return(0,$.Z)(function*(){yield M._updateTokensIfNecessary(O,!0);const q=Kl(O);return new fa({user:M,providerId:q,_tokenResponse:O,operationType:E})})()}}function Kl(P){return P.providerId?P.providerId:"phoneNumber"in P?"phone":null}function ar(P){return Nd.apply(this,arguments)}function Nd(){return(Nd=(0,$.Z)(function*(P){var M;const E=jr(P);if(yield E._initializationPromise,null!==(M=E.currentUser)&&void 0!==M&&M.isAnonymous)return new fa({user:E.currentUser,providerId:null,operationType:"signIn"});const O=yield Jm(E,{returnSecureToken:!0}),q=yield fa._fromIdTokenResponse(E,"signIn",O,!0);return yield E._updateCurrentUser(q.user),q})).apply(this,arguments)}class eg extends c.ZR{constructor(M,E,O,q){var re;super(E.code,E.message),this.operationType=O,this.user=q,Object.setPrototypeOf(this,eg.prototype),this.customData={appName:M.name,tenantId:null!==(re=M.tenantId)&&void 0!==re?re:void 0,_serverResponse:E.customData._serverResponse,operationType:O}}static _fromErrorAndOperation(M,E,O,q){return new eg(M,E,O,q)}}function Bd(P,M,E,O){return("reauthenticate"===M?E._getReauthenticationResolver(P):E._getIdTokenResponse(P)).catch(re=>{throw"auth/multi-factor-auth-required"===re.code?eg._fromErrorAndOperation(P,re,M,O):re})}function qo(P){return new Set(P.map(({providerId:M})=>M).filter(M=>!!M))}function Ac(P,M){return Xl.apply(this,arguments)}function Xl(){return(Xl=(0,$.Z)(function*(P,M){const E=(0,c.m9)(P);yield Dc(!0,E,M);const{providerUserInfo:O}=yield ao(E.auth,{idToken:yield E.getIdToken(),deleteProvider:[M]}),q=qo(O||[]);return E.providerData=E.providerData.filter(re=>q.has(re.providerId)),q.has("phone")||(E.phoneNumber=null),yield E.auth._persistUserIfCurrent(E),E})).apply(this,arguments)}function Za(P,M){return co.apply(this,arguments)}function co(){return(co=(0,$.Z)(function*(P,M,E=!1){const O=yield Dn(P,M._linkToIdToken(P.auth,yield P.getIdToken()),E);return fa._forOperation(P,"link",O)})).apply(this,arguments)}function Dc(P,M,E){return $l.apply(this,arguments)}function $l(){return($l=(0,$.Z)(function*(P,M,E){yield yr(M);const q=!1===P?"provider-already-linked":"no-such-provider";ze(qo(M.providerData).has(E)===P,M.auth,q)})).apply(this,arguments)}function Eu(P,M){return Mo.apply(this,arguments)}function Mo(){return(Mo=(0,$.Z)(function*(P,M,E=!1){var O;const{auth:q}=P,re="reauthenticate";try{const Be=yield Dn(P,Bd(q,re,M,P),E);ze(Be.idToken,q,"internal-error");const Et=Ai(Be.idToken);ze(Et,q,"internal-error");const{sub:cn}=Et;return ze(P.uid===cn,q,"user-mismatch"),fa._forOperation(P,re,Be)}catch(Be){throw"auth/user-not-found"===(null===(O=Be)||void 0===O?void 0:O.code)&&_n(q,"user-mismatch"),Be}})).apply(this,arguments)}function Eh(P,M){return Ya.apply(this,arguments)}function Ya(){return(Ya=(0,$.Z)(function*(P,M,E=!1){const O="signIn",q=yield Bd(P,O,M),re=yield fa._fromIdTokenResponse(P,O,q);return E||(yield P._updateCurrentUser(re.user)),re})).apply(this,arguments)}function ri(P,M){return Ur.apply(this,arguments)}function Ur(){return(Ur=(0,$.Z)(function*(P,M){return Eh(jr(P),M)})).apply(this,arguments)}function gv(P,M){return Ah.apply(this,arguments)}function Ah(){return(Ah=(0,$.Z)(function*(P,M){const E=(0,c.m9)(P);return yield Dc(!1,E,M.providerId),Za(E,M)})).apply(this,arguments)}function tg(P,M){return Dh.apply(this,arguments)}function Dh(){return(Dh=(0,$.Z)(function*(P,M){return Eu((0,c.m9)(P),M)})).apply(this,arguments)}function Au(P,M){return Ql.apply(this,arguments)}function Ql(){return(Ql=(0,$.Z)(function*(P,M){return Cr(P,"POST","/v1/accounts:signInWithCustomToken",Mi(P,M))})).apply(this,arguments)}function jd(P,M){return Pt.apply(this,arguments)}function Pt(){return(Pt=(0,$.Z)(function*(P,M){const E=jr(P),O=yield Au(E,{token:M,returnSecureToken:!0}),q=yield fa._fromIdTokenResponse(E,"signIn",O);return yield E._updateCurrentUser(q.user),q})).apply(this,arguments)}class mi{constructor(M,E){this.factorId=M,this.uid=E.mfaEnrollmentId,this.enrollmentTime=new Date(E.enrolledAt).toUTCString(),this.displayName=E.displayName}static _fromServerResponse(M,E){return"phoneInfo"in E?Du._fromServerResponse(M,E):_n(M,"internal-error")}}class Du extends mi{constructor(M){super("phone",M),this.phoneNumber=M.phoneInfo}static _fromServerResponse(M,E){return new Du(E)}}function Rc(P,M,E){var O;ze((null===(O=E.url)||void 0===O?void 0:O.length)>0,P,"invalid-continue-uri"),ze(typeof E.dynamicLinkDomain>"u"||E.dynamicLinkDomain.length>0,P,"invalid-dynamic-link-domain"),M.continueUrl=E.url,M.dynamicLinkDomain=E.dynamicLinkDomain,M.canHandleCodeInApp=E.handleCodeInApp,E.iOS&&(ze(E.iOS.bundleId.length>0,P,"missing-ios-bundle-id"),M.iOSBundleId=E.iOS.bundleId),E.android&&(ze(E.android.packageName.length>0,P,"missing-android-pkg-name"),M.androidInstallApp=E.android.installApp,M.androidMinimumVersionCode=E.android.minimumVersion,M.androidPackageName=E.android.packageName)}function Vr(P,M,E){return Ic.apply(this,arguments)}function Ic(){return(Ic=(0,$.Z)(function*(P,M,E){const O=(0,c.m9)(P),q={requestType:"PASSWORD_RESET",email:M};E&&Rc(O,q,E),yield qr(O,q)})).apply(this,arguments)}function Pc(P,M,E){return So.apply(this,arguments)}function So(){return(So=(0,$.Z)(function*(P,M,E){yield Pd((0,c.m9)(P),{oobCode:M,newPassword:E})})).apply(this,arguments)}function lp(P,M){return Fc.apply(this,arguments)}function Fc(){return(Fc=(0,$.Z)(function*(P,M){yield Ha((0,c.m9)(P),{oobCode:M})})).apply(this,arguments)}function ng(P,M){return Jl.apply(this,arguments)}function Jl(){return(Jl=(0,$.Z)(function*(P,M){const E=(0,c.m9)(P),O=yield Pd(E,{oobCode:M}),q=O.requestType;switch(ze(q,E,"internal-error"),q){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ze(O.newEmail,E,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ze(O.mfaInfo,E,"internal-error");default:ze(O.email,E,"internal-error")}let re=null;return O.mfaInfo&&(re=mi._fromServerResponse(jr(E),O.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===O.requestType?O.newEmail:O.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===O.requestType?O.email:O.newEmail)||null,multiFactorInfo:re},operation:q}})).apply(this,arguments)}function _v(P,M){return Lc.apply(this,arguments)}function Lc(){return(Lc=(0,$.Z)(function*(P,M){const{data:E}=yield ng((0,c.m9)(P),M);return E.email})).apply(this,arguments)}function vs(P,M,E){return Co.apply(this,arguments)}function Co(){return(Co=(0,$.Z)(function*(P,M,E){const O=jr(P),q=yield Jm(O,{returnSecureToken:!0,email:M,password:E}),re=yield fa._fromIdTokenResponse(O,"signIn",q);return yield O._updateCurrentUser(re.user),re})).apply(this,arguments)}function ig(P,M,E){return ri((0,c.m9)(P),Ch.credential(M,E))}function Oc(P,M,E){return pa.apply(this,arguments)}function pa(){return(pa=(0,$.Z)(function*(P,M,E){const O=(0,c.m9)(P),q={requestType:"EMAIL_SIGNIN",email:M};ze(E.handleCodeInApp,O,"argument-error"),E&&Rc(O,q,E),yield Ld(O,q)})).apply(this,arguments)}function vv(P,M){return"EMAIL_SIGNIN"===Mu.parseLink(M)?.operation}function cp(P,M,E){return up.apply(this,arguments)}function up(){return(up=(0,$.Z)(function*(P,M,E){const O=(0,c.m9)(P),q=Ch.credentialWithLink(M,E||Xe());return ze(q._tenantId===(O.tenantId||null),O,"tenant-id-mismatch"),ri(O,q)})).apply(this,arguments)}function Ud(P,M){return Rh.apply(this,arguments)}function Rh(){return(Rh=(0,$.Z)(function*(P,M){return Vi(P,"POST","/v1/accounts:createAuthUri",Mi(P,M))})).apply(this,arguments)}function Vd(P,M){return kc.apply(this,arguments)}function kc(){return(kc=(0,$.Z)(function*(P,M){const O={identifier:M,continueUri:zt()?Xe():"http://localhost"},{signinMethods:q}=yield Ud((0,c.m9)(P),O);return q||[]})).apply(this,arguments)}function hp(P,M){return Ih.apply(this,arguments)}function Ih(){return(Ih=(0,$.Z)(function*(P,M){const E=(0,c.m9)(P),q={requestType:"VERIFY_EMAIL",idToken:yield P.getIdToken()};M&&Rc(E.auth,q,M);const{email:re}=yield Fd(E.auth,q);re!==P.email&&(yield P.reload())})).apply(this,arguments)}function rg(P,M,E){return wl.apply(this,arguments)}function wl(){return(wl=(0,$.Z)(function*(P,M,E){const O=(0,c.m9)(P),re={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield P.getIdToken(),newEmail:M};E&&Rc(O.auth,re,E);const{email:Be}=yield Wo(O.auth,re);Be!==P.email&&(yield P.reload())})).apply(this,arguments)}function sg(P,M){return Ph.apply(this,arguments)}function Ph(){return(Ph=(0,$.Z)(function*(P,M){return Vi(P,"POST","/v1/accounts:update",M)})).apply(this,arguments)}function og(P,M){return Ru.apply(this,arguments)}function Ru(){return(Ru=(0,$.Z)(function*(P,{displayName:M,photoURL:E}){if(void 0===M&&void 0===E)return;const O=(0,c.m9)(P),re={idToken:yield O.getIdToken(),displayName:M,photoUrl:E,returnSecureToken:!0},Be=yield Dn(O,sg(O.auth,re));O.displayName=Be.displayName||null,O.photoURL=Be.photoUrl||null;const Et=O.providerData.find(({providerId:cn})=>"password"===cn);Et&&(Et.displayName=O.displayName,Et.photoURL=O.photoURL),yield O._updateTokensIfNecessary(Be)})).apply(this,arguments)}function dp(P,M){return Gd((0,c.m9)(P),M,null)}function ag(P,M){return Gd((0,c.m9)(P),null,M)}function Gd(P,M,E){return ss.apply(this,arguments)}function ss(){return(ss=(0,$.Z)(function*(P,M,E){const{auth:O}=P,re={idToken:yield P.getIdToken(),returnSecureToken:!0};M&&(re.email=M),E&&(re.password=E);const Be=yield Dn(P,dv(O,re));yield P._updateTokensIfNecessary(Be,!0)})).apply(this,arguments)}class nr{constructor(M,E,O={}){this.isNewUser=M,this.providerId=E,this.profile=O}}class zd extends nr{constructor(M,E,O,q){super(M,E,O),this.username=q}}class Ib extends nr{constructor(M,E){super(M,"facebook.com",E)}}class fp extends zd{constructor(M,E){super(M,"github.com",E,"string"==typeof E?.login?E?.login:null)}}class lg extends nr{constructor(M,E){super(M,"google.com",E)}}class yv extends zd{constructor(M,E,O){super(M,"twitter.com",E,O)}}function Hd(P){const{user:M,_tokenResponse:E}=P;return M.isAnonymous&&!E?{providerId:null,isNewUser:!1,profile:null}:function Ka(P){var M,E;if(!P)return null;const{providerId:O}=P,q=P.rawUserInfo?JSON.parse(P.rawUserInfo):{},re=P.isNewUser||"identitytoolkit#SignupNewUserResponse"===P.kind;if(!O&&P?.idToken){const Be=null===(E=null===(M=Ai(P.idToken))||void 0===M?void 0:M.firebase)||void 0===E?void 0:E.sign_in_provider;if(Be)return new nr(re,"anonymous"!==Be&&"custom"!==Be?Be:null)}if(!O)return null;switch(O){case"facebook.com":return new Ib(re,q);case"github.com":return new fp(re,q);case"google.com":return new lg(re,q);case"twitter.com":return new yv(re,q,P.screenName||null);case"custom":case"anonymous":return new nr(re,null);default:return new nr(re,O,q)}}(E)}class ec{constructor(M,E){this.type=M,this.credential=E}static _fromIdtoken(M){return new ec("enroll",M)}static _fromMfaPendingCredential(M){return new ec("signin",M)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(M){var E,O;if(M?.multiFactorSession){if(null!==(E=M.multiFactorSession)&&void 0!==E&&E.pendingCredential)return ec._fromMfaPendingCredential(M.multiFactorSession.pendingCredential);if(null!==(O=M.multiFactorSession)&&void 0!==O&&O.idToken)return ec._fromIdtoken(M.multiFactorSession.idToken)}return null}}class Pu{constructor(M,E,O){this.session=M,this.hints=E,this.signInResolver=O}static _fromError(M,E){const O=jr(M),q=E.customData._serverResponse,re=(q.mfaInfo||[]).map(Et=>mi._fromServerResponse(O,Et));ze(q.mfaPendingCredential,O,"internal-error");const Be=ec._fromMfaPendingCredential(q.mfaPendingCredential);return new Pu(Be,re,function(){var Et=(0,$.Z)(function*(cn){const jn=yield cn._process(O,Be);delete q.mfaInfo,delete q.mfaPendingCredential;const di=Object.assign(Object.assign({},q),{idToken:jn.idToken,refreshToken:jn.refreshToken});switch(E.operationType){case"signIn":const wr=yield fa._fromIdTokenResponse(O,E.operationType,di);return yield O._updateCurrentUser(wr.user),wr;case"reauthenticate":return ze(E.user,O,"internal-error"),fa._forOperation(E.user,E.operationType,di);default:_n(O,"internal-error")}});return function(cn){return Et.apply(this,arguments)}}())}resolveSignIn(M){var E=this;return(0,$.Z)(function*(){return E.signInResolver(M)})()}}function gp(P,M){var E;const O=(0,c.m9)(P),q=M;return ze(M.customData.operationType,O,"argument-error"),ze(null===(E=q.customData._serverResponse)||void 0===E?void 0:E.mfaPendingCredential,O,"argument-error"),Pu._fromError(O,q)}function Ys(P,M){return Vi(P,"POST","/v2/accounts/mfaEnrollment:start",Mi(P,M))}class Tv{constructor(M){this.user=M,this.enrolledFactors=[],M._onReload(E=>{E.mfaInfo&&(this.enrolledFactors=E.mfaInfo.map(O=>mi._fromServerResponse(M.auth,O)))})}static _fromUser(M){return new Tv(M)}getSession(){var M=this;return(0,$.Z)(function*(){return ec._fromIdtoken(yield M.user.getIdToken())})()}enroll(M,E){var O=this;return(0,$.Z)(function*(){const q=M,re=yield O.getSession(),Be=yield Dn(O.user,q._process(O.user.auth,re,E));return yield O.user._updateTokensIfNecessary(Be),O.user.reload()})()}unenroll(M){var E=this;return(0,$.Z)(function*(){var O;const q="string"==typeof M?M:M.uid,re=yield E.user.getIdToken(),Be=yield Dn(E.user,function eM(P,M){return Vi(P,"POST","/v2/accounts/mfaEnrollment:withdraw",Mi(P,M))}(E.user.auth,{idToken:re,mfaEnrollmentId:q}));E.enrolledFactors=E.enrolledFactors.filter(({uid:Et})=>Et!==q),yield E.user._updateTokensIfNecessary(Be);try{yield E.user.reload()}catch(Et){if("auth/user-token-expired"!==(null===(O=Et)||void 0===O?void 0:O.code))throw Et}})()}}const Lh=new WeakMap;function _p(P){const M=(0,c.m9)(P);return Lh.has(M)||Lh.set(M,Tv._fromUser(M)),Lh.get(M)}const qd="__sak";class Nc{constructor(M,E){this.storageRetriever=M,this.type=E}_isAvailable(){try{return this.storage?(this.storage.setItem(qd,"1"),this.storage.removeItem(qd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(M,E){return this.storage.setItem(M,JSON.stringify(E)),Promise.resolve()}_get(M){const E=this.storage.getItem(M);return Promise.resolve(E?JSON.parse(E):null)}_remove(M){return this.storage.removeItem(M),Promise.resolve()}get storage(){return this.storageRetriever()}}const ys=(()=>{class P extends Nc{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(E,O)=>this.onStorageEvent(E,O),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function wv(){const P=(0,c.z$)();return ye(P)||xi(P)}()&&function Hl(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=ji(),this._shouldAllowMigration=!0}forAllChangedKeys(E){for(const O of Object.keys(this.listeners)){const q=this.storage.getItem(O),re=this.localCache[O];q!==re&&E(O,re,q)}}onStorageEvent(E,O=!1){if(!E.key)return void this.forAllChangedKeys((Et,cn,jn)=>{this.notifyListeners(Et,jn)});const q=E.key;if(O?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const Et=this.storage.getItem(q);if(E.newValue!==Et)null!==E.newValue?this.storage.setItem(q,E.newValue):this.storage.removeItem(q);else if(this.localCache[q]===E.newValue&&!O)return}const re=()=>{const Et=this.storage.getItem(q);!O&&this.localCache[q]===Et||this.notifyListeners(q,Et)},Be=this.storage.getItem(q);!function bi(){return(0,c.w1)()&&10===document.documentMode}()||Be===E.newValue||E.newValue===E.oldValue?re():setTimeout(re,10)}notifyListeners(E,O){this.localCache[E]=O;const q=this.listeners[E];if(q)for(const re of Array.from(q))re(O&&JSON.parse(O))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((E,O,q)=>{this.onStorageEvent(new StorageEvent("storage",{key:E,oldValue:O,newValue:q}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(E,O){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[E]||(this.listeners[E]=new Set,this.localCache[E]=this.storage.getItem(E)),this.listeners[E].add(O)}_removeListener(E,O){this.listeners[E]&&(this.listeners[E].delete(O),0===this.listeners[E].size&&delete this.listeners[E]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(E,O){var q=()=>super._set,re=this;return(0,$.Z)(function*(){yield q().call(re,E,O),re.localCache[E]=JSON.stringify(O)})()}_get(E){var O=()=>super._get,q=this;return(0,$.Z)(function*(){const re=yield O().call(q,E);return q.localCache[E]=JSON.stringify(re),re})()}_remove(E){var O=()=>super._remove,q=this;return(0,$.Z)(function*(){yield O().call(q,E),delete q.localCache[E]})()}}return P.type="LOCAL",P})(),Ml=(()=>{class P extends Nc{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(E,O){}_removeListener(E,O){}}return P.type="SESSION",P})();let Zd=(()=>{class P{constructor(E){this.eventTarget=E,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(E){const O=this.receivers.find(re=>re.isListeningto(E));if(O)return O;const q=new P(E);return this.receivers.push(q),q}isListeningto(E){return this.eventTarget===E}handleEvent(E){var O=this;return(0,$.Z)(function*(){const q=E,{eventId:re,eventType:Be,data:Et}=q.data,cn=O.handlersMap[Be];if(!cn?.size)return;q.ports[0].postMessage({status:"ack",eventId:re,eventType:Be});const jn=Array.from(cn).map(function(){var wr=(0,$.Z)(function*(Rl){return Rl(q.origin,Et)});return function(Rl){return wr.apply(this,arguments)}}()),di=yield function Pb(P){return Promise.all(P.map(function(){var M=(0,$.Z)(function*(E){try{return{fulfilled:!0,value:yield E}}catch(O){return{fulfilled:!1,reason:O}}});return function(E){return M.apply(this,arguments)}}()))}(jn);q.ports[0].postMessage({status:"done",eventId:re,eventType:Be,response:di})})()}_subscribe(E,O){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[E]||(this.handlersMap[E]=new Set),this.handlersMap[E].add(O)}_unsubscribe(E,O){this.handlersMap[E]&&O&&this.handlersMap[E].delete(O),(!O||0===this.handlersMap[E].size)&&delete this.handlersMap[E],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return P.receivers=[],P})();function kh(P="",M=10){let E="";for(let O=0;O<M;O++)E+=Math.floor(10*Math.random());return P+E}class dr{constructor(M){this.target=M,this.handlers=new Set}removeMessageHandler(M){M.messageChannel&&(M.messageChannel.port1.removeEventListener("message",M.onMessage),M.messageChannel.port1.close()),this.handlers.delete(M)}_send(M,E,O=50){var q=this;return(0,$.Z)(function*(){const re=typeof MessageChannel<"u"?new MessageChannel:null;if(!re)throw new Error("connection_unavailable");let Be,Et;return new Promise((cn,jn)=>{const di=kh("",20);re.port1.start();const wr=setTimeout(()=>{jn(new Error("unsupported_event"))},O);Et={messageChannel:re,onMessage(Rl){const ac=Rl;if(ac.data.eventId===di)switch(ac.data.status){case"ack":clearTimeout(wr),Be=setTimeout(()=>{jn(new Error("timeout"))},3e3);break;case"done":clearTimeout(Be),cn(ac.data.response);break;default:clearTimeout(wr),clearTimeout(Be),jn(new Error("invalid_response"))}}},q.handlers.add(Et),re.port1.addEventListener("message",Et.onMessage),q.target.postMessage({eventType:M,eventId:di,data:E},[re.port2])}).finally(()=>{Et&&q.removeMessageHandler(Et)})})()}}function Pi(){return window}function Bn(){return typeof Pi().WorkerGlobalScope<"u"&&"function"==typeof Pi().importScripts}function Bc(){return(Bc=(0,$.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const hg="firebaseLocalStorageDb",Nh="firebaseLocalStorage",Bh="fbase_key";class Uc{constructor(M){this.request=M}toPromise(){return new Promise((M,E)=>{this.request.addEventListener("success",()=>{M(this.request.result)}),this.request.addEventListener("error",()=>{E(this.request.error)})})}}function Fu(P,M){return P.transaction([Nh],M?"readwrite":"readonly").objectStore(Nh)}function Sn(){const P=indexedDB.open(hg,1);return new Promise((M,E)=>{P.addEventListener("error",()=>{E(P.error)}),P.addEventListener("upgradeneeded",()=>{const O=P.result;try{O.createObjectStore(Nh,{keyPath:Bh})}catch(q){E(q)}}),P.addEventListener("success",(0,$.Z)(function*(){const O=P.result;O.objectStoreNames.contains(Nh)?M(O):(O.close(),yield function tc(){const P=indexedDB.deleteDatabase(hg);return new Uc(P).toPromise()}(),M(yield Sn()))}))})}function dg(P,M,E){return Lu.apply(this,arguments)}function Lu(){return(Lu=(0,$.Z)(function*(P,M,E){const O=Fu(P,!0).put({[Bh]:M,value:E});return new Uc(O).toPromise()})).apply(this,arguments)}function Da(){return(Da=(0,$.Z)(function*(P,M){const E=Fu(P,!1).get(M),O=yield new Uc(E).toPromise();return void 0===O?null:O.value})).apply(this,arguments)}function Tr(P,M){const E=Fu(P,!0).delete(M);return new Uc(E).toPromise()}const ku=(()=>{class P{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var E=this;return(0,$.Z)(function*(){return E.db||(E.db=yield Sn()),E.db})()}_withRetries(E){var O=this;return(0,$.Z)(function*(){let q=0;for(;;)try{const re=yield O._openDb();return yield E(re)}catch(re){if(q++>3)throw re;O.db&&(O.db.close(),O.db=void 0)}})()}initializeServiceWorkerMessaging(){var E=this;return(0,$.Z)(function*(){return Bn()?E.initializeReceiver():E.initializeSender()})()}initializeReceiver(){var E=this;return(0,$.Z)(function*(){E.receiver=Zd._getInstance(function bs(){return Bn()?self:null}()),E.receiver._subscribe("keyChanged",function(){var O=(0,$.Z)(function*(q,re){return{keyProcessed:(yield E._poll()).includes(re.key)}});return function(q,re){return O.apply(this,arguments)}}()),E.receiver._subscribe("ping",function(){var O=(0,$.Z)(function*(q,re){return["keyChanged"]});return function(q,re){return O.apply(this,arguments)}}())})()}initializeSender(){var E=this;return(0,$.Z)(function*(){var O,q;if(E.activeServiceWorker=yield function Ks(){return Bc.apply(this,arguments)}(),!E.activeServiceWorker)return;E.sender=new dr(E.activeServiceWorker);const re=yield E.sender._send("ping",{},800);!re||(null===(O=re[0])||void 0===O?void 0:O.fulfilled)&&(null===(q=re[0])||void 0===q?void 0:q.value.includes("keyChanged"))&&(E.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(E){var O=this;return(0,$.Z)(function*(){if(O.sender&&O.activeServiceWorker&&function jc(){var P;return(null===(P=navigator?.serviceWorker)||void 0===P?void 0:P.controller)||null}()===O.activeServiceWorker)try{yield O.sender._send("keyChanged",{key:E},O.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,$.Z)(function*(){try{if(!indexedDB)return!1;const E=yield Sn();return yield dg(E,qd,"1"),yield Tr(E,qd),!0}catch{}return!1})()}_withPendingWrite(E){var O=this;return(0,$.Z)(function*(){O.pendingWrites++;try{yield E()}finally{O.pendingWrites--}})()}_set(E,O){var q=this;return(0,$.Z)(function*(){return q._withPendingWrite((0,$.Z)(function*(){return yield q._withRetries(re=>dg(re,E,O)),q.localCache[E]=O,q.notifyServiceWorker(E)}))})()}_get(E){var O=this;return(0,$.Z)(function*(){const q=yield O._withRetries(re=>function Kd(P,M){return Da.apply(this,arguments)}(re,E));return O.localCache[E]=q,q})()}_remove(E){var O=this;return(0,$.Z)(function*(){return O._withPendingWrite((0,$.Z)(function*(){return yield O._withRetries(q=>Tr(q,E)),delete O.localCache[E],O.notifyServiceWorker(E)}))})()}_poll(){var E=this;return(0,$.Z)(function*(){const O=yield E._withRetries(Be=>{const Et=Fu(Be,!1).getAll();return new Uc(Et).toPromise()});if(!O)return[];if(0!==E.pendingWrites)return[];const q=[],re=new Set;for(const{fbase_key:Be,value:Et}of O)re.add(Be),JSON.stringify(E.localCache[Be])!==JSON.stringify(Et)&&(E.notifyListeners(Be,Et),q.push(Be));for(const Be of Object.keys(E.localCache))E.localCache[Be]&&!re.has(Be)&&(E.notifyListeners(Be,null),q.push(Be));return q})()}notifyListeners(E,O){this.localCache[E]=O;const q=this.listeners[E];if(q)for(const re of Array.from(q))re(O)}startPolling(){var E=this;this.stopPolling(),this.pollTimer=setInterval((0,$.Z)(function*(){return E._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(E,O){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[E]||(this.listeners[E]=new Set,this._get(E)),this.listeners[E].add(O)}_removeListener(E,O){this.listeners[E]&&(this.listeners[E].delete(O),0===this.listeners[E].size&&delete this.listeners[E]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return P.type="LOCAL",P})();function Vc(P,M){return Vi(P,"POST","/v2/accounts/mfaSignIn:start",Mi(P,M))}function Fr(){return(Fr=(0,$.Z)(function*(P){return(yield Vi(P,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function jh(P){return new Promise((M,E)=>{const O=document.createElement("script");O.setAttribute("src",P),O.onload=M,O.onerror=q=>{const re=Nt("internal-error");re.customData=q,E(re)},O.type="text/javascript",O.charset="UTF-8",function Nu(){var P,M;return null!==(M=null===(P=document.getElementsByTagName("head"))||void 0===P?void 0:P[0])&&void 0!==M?M:document}().appendChild(O)})}function os(P){return`__${P}${Math.floor(1e6*Math.random())}`}const ei=1e12;class Zr{constructor(M){this.auth=M,this.counter=ei,this._widgets=new Map}render(M,E){const O=this.counter;return this._widgets.set(O,new Cv(M,this.auth.name,E||{})),this.counter++,O}reset(M){var E;const O=M||ei;null===(E=this._widgets.get(O))||void 0===E||E.delete(),this._widgets.delete(O)}getResponse(M){var E;return(null===(E=this._widgets.get(M||ei))||void 0===E?void 0:E.getResponse())||""}execute(M){var E=this;return(0,$.Z)(function*(){var O;return null===(O=E._widgets.get(M||ei))||void 0===O||O.execute(),""})()}}class Cv{constructor(M,E,O){this.params=O,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const q="string"==typeof M?document.getElementById(M):M;ze(q,"argument-error",{appName:E}),this.container=q,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Ev(P){const M=[],E="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let O=0;O<P;O++)M.push(E.charAt(Math.floor(Math.random()*E.length)));return M.join("")}(50);const{callback:M,"expired-callback":E}=this.params;if(M)try{M(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,E)try{E()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Gr=os("rcb"),Ns=new nn(3e4,6e4);class fr{constructor(){var M;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(M=Pi().grecaptcha)||void 0===M||!M.render)}load(M,E=""){return ze(function Ar(P){return P.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(P)}(E),M,"argument-error"),this.shouldResolveImmediately(E)?Promise.resolve(Pi().grecaptcha):new Promise((O,q)=>{const re=Pi().setTimeout(()=>{q(Nt(M,"network-request-failed"))},Ns.get());Pi()[Gr]=()=>{Pi().clearTimeout(re),delete Pi()[Gr];const Et=Pi().grecaptcha;if(!Et)return void q(Nt(M,"internal-error"));const cn=Et.render;Et.render=(jn,di)=>{const wr=cn(jn,di);return this.counter++,wr},this.hostLanguage=E,O(Et)},jh(`https://www.google.com/recaptcha/api.js??${(0,c.xO)({onload:Gr,render:"explicit",hl:E})}`).catch(()=>{clearTimeout(re),q(Nt(M,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(M){var E;return!(null===(E=Pi().grecaptcha)||void 0===E||!E.render)&&(M===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class fg{load(M){return(0,$.Z)(function*(){return new Zr(M)})()}clearedOneInstance(){}}const Av="recaptcha",xs={theme:"light",type:"image"};class Qa{constructor(M,E=Object.assign({},xs),O){this.parameters=E,this.type=Av,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=jr(O),this.isInvisible="invisible"===this.parameters.size,ze(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const q="string"==typeof M?document.getElementById(M):M;ze(q,this.auth,"argument-error"),this.container=q,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new fg:new fr,this.validateStartingState()}verify(){var M=this;return(0,$.Z)(function*(){M.assertNotDestroyed();const E=yield M.render(),O=M.getAssertedRecaptcha();return O.getResponse(E)||new Promise(re=>{const Be=Et=>{!Et||(M.tokenChangeListeners.delete(Be),re(Et))};M.tokenChangeListeners.add(Be),M.isInvisible&&O.execute(E)})})()}render(){try{this.assertNotDestroyed()}catch(M){return Promise.reject(M)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(M=>{throw this.renderPromise=null,M})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(M=>{this.container.removeChild(M)})}validateStartingState(){ze(!this.parameters.sitekey,this.auth,"argument-error"),ze(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ze(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(M){return E=>{if(this.tokenChangeListeners.forEach(O=>O(E)),"function"==typeof M)M(E);else if("string"==typeof M){const O=Pi()[M];"function"==typeof O&&O(E)}}}assertNotDestroyed(){ze(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var M=this;return(0,$.Z)(function*(){if(yield M.init(),!M.widgetId){let E=M.container;if(!M.isInvisible){const O=document.createElement("div");E.appendChild(O),E=O}M.widgetId=M.getAssertedRecaptcha().render(E,M.parameters)}return M.widgetId})()}init(){var M=this;return(0,$.Z)(function*(){ze(zt()&&!Bn(),M.auth,"internal-error"),yield function Ra(){let P=null;return new Promise(M=>{"complete"!==document.readyState?(P=()=>M(),window.addEventListener("load",P)):M()}).catch(M=>{throw P&&window.removeEventListener("load",P),M})}(),M.recaptcha=yield M._recaptchaLoader.load(M.auth,M.auth.languageCode||void 0);const E=yield function $a(P){return Fr.apply(this,arguments)}(M.auth);ze(E,M.auth,"internal-error"),M.parameters.sitekey=E})()}getAssertedRecaptcha(){return ze(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Lr{constructor(M,E){this.verificationId=M,this.onConfirmation=E}confirm(M){const E=Tl._fromVerification(this.verificationId,M);return this.onConfirmation(E)}}function ic(P,M,E){return Xs.apply(this,arguments)}function Xs(){return(Xs=(0,$.Z)(function*(P,M,E){const O=jr(P),q=yield Uu(O,M,(0,c.m9)(E));return new Lr(q,re=>ri(O,re))})).apply(this,arguments)}function Eo(P,M,E){return ju.apply(this,arguments)}function ju(){return(ju=(0,$.Z)(function*(P,M,E){const O=(0,c.m9)(P);yield Dc(!1,O,"phone");const q=yield Uu(O.auth,M,(0,c.m9)(E));return new Lr(q,re=>gv(O,re))})).apply(this,arguments)}function Uh(P,M,E){return Gc.apply(this,arguments)}function Gc(){return(Gc=(0,$.Z)(function*(P,M,E){const O=(0,c.m9)(P),q=yield Uu(O.auth,M,(0,c.m9)(E));return new Lr(q,re=>tg(O,re))})).apply(this,arguments)}function Uu(P,M,E){return Vu.apply(this,arguments)}function Vu(){return(Vu=(0,$.Z)(function*(P,M,E){var O;const q=yield E.verify();try{let re;if(ze("string"==typeof q,P,"argument-error"),ze(E.type===Av,P,"argument-error"),re="string"==typeof M?{phoneNumber:M}:M,"session"in re){const Be=re.session;if("phoneNumber"in re)return ze("enroll"===Be.type,P,"internal-error"),(yield Ys(P,{idToken:Be.credential,phoneEnrollmentInfo:{phoneNumber:re.phoneNumber,recaptchaToken:q}})).phoneSessionInfo.sessionInfo;{ze("signin"===Be.type,P,"internal-error");const Et=(null===(O=re.multiFactorHint)||void 0===O?void 0:O.uid)||re.multiFactorUid;return ze(Et,P,"missing-multi-factor-info"),(yield Vc(P,{mfaPendingCredential:Be.credential,mfaEnrollmentId:Et,phoneSignInInfo:{recaptchaToken:q}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:Be}=yield Cb(P,{phoneNumber:re.phoneNumber,recaptchaToken:q});return Be}}finally{E._reset()}})).apply(this,arguments)}function Ti(P,M){return Dv.apply(this,arguments)}function Dv(){return(Dv=(0,$.Z)(function*(P,M){yield Za((0,c.m9)(P),M)})).apply(this,arguments)}let Vh=(()=>{class P{constructor(E){this.providerId=P.PROVIDER_ID,this.auth=jr(E)}verifyPhoneNumber(E,O){return Uu(this.auth,E,(0,c.m9)(O))}static credential(E,O){return Tl._fromVerification(E,O)}static credentialFromResult(E){return P.credentialFromTaggedObject(E)}static credentialFromError(E){return P.credentialFromTaggedObject(E.customData||{})}static credentialFromTaggedObject({_tokenResponse:E}){if(!E)return null;const{phoneNumber:O,temporaryProof:q}=E;return O&&q?Tl._fromTokenResponse(O,q):null}}return P.PROVIDER_ID="phone",P.PHONE_SIGN_IN_METHOD="phone",P})();function Cl(P,M){return M?He(M):(ze(P._popupRedirectResolver,P,"argument-error"),P._popupRedirectResolver)}class uo extends wo{constructor(M){super("custom","custom"),this.params=M}_getIdTokenResponse(M){return ql(M,this._buildIdpRequest())}_linkToIdToken(M,E){return ql(M,this._buildIdpRequest(E))}_getReauthenticationResolver(M){return ql(M,this._buildIdpRequest())}_buildIdpRequest(M){const E={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return M&&(E.idToken=M),E}}function Zo(P){return Eh(P.auth,new uo(P),P.bypassAuthState)}function rc(P){const{auth:M,user:E}=P;return ze(E,M,"internal-error"),Eu(E,new uo(P),P.bypassAuthState)}function Rv(P){return zc.apply(this,arguments)}function zc(){return(zc=(0,$.Z)(function*(P){const{auth:M,user:E}=P;return ze(E,M,"internal-error"),Za(E,new uo(P),P.bypassAuthState)})).apply(this,arguments)}class yp{constructor(M,E,O,q,re=!1){this.auth=M,this.resolver=O,this.user=q,this.bypassAuthState=re,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(E)?E:[E]}execute(){var M=this;return new Promise(function(){var E=(0,$.Z)(function*(O,q){M.pendingPromise={resolve:O,reject:q};try{M.eventManager=yield M.resolver._initialize(M.auth),yield M.onExecution(),M.eventManager.registerConsumer(M)}catch(re){M.reject(re)}});return function(O,q){return E.apply(this,arguments)}}())}onAuthEvent(M){var E=this;return(0,$.Z)(function*(){const{urlResponse:O,sessionId:q,postBody:re,tenantId:Be,error:Et,type:cn}=M;if(Et)return void E.reject(Et);const jn={auth:E.auth,requestUri:O,sessionId:q,tenantId:Be||void 0,postBody:re||void 0,user:E.user,bypassAuthState:E.bypassAuthState};try{E.resolve(yield E.getIdpTask(cn)(jn))}catch(di){E.reject(di)}})()}onError(M){this.reject(M)}getIdpTask(M){switch(M){case"signInViaPopup":case"signInViaRedirect":return Zo;case"linkViaPopup":case"linkViaRedirect":return Rv;case"reauthViaPopup":case"reauthViaRedirect":return rc;default:_n(this.auth,"internal-error")}}resolve(M){_t(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(M),this.unregisterAndCleanUp()}reject(M){_t(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(M),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const as=new nn(2e3,1e4);function Ia(P,M,E){return Hc.apply(this,arguments)}function Hc(){return(Hc=(0,$.Z)(function*(P,M,E){const O=jr(P);wt(P,M,Aa);const q=Cl(O,E);return new Iv(O,"signInViaPopup",M,q).executeNotNull()})).apply(this,arguments)}function bp(P,M,E){return Gh.apply(this,arguments)}function Gh(){return(Gh=(0,$.Z)(function*(P,M,E){const O=(0,c.m9)(P);wt(O.auth,M,Aa);const q=Cl(O.auth,E);return new Iv(O.auth,"reauthViaPopup",M,q,O).executeNotNull()})).apply(this,arguments)}function xp(P,M,E){return Gu.apply(this,arguments)}function Gu(){return(Gu=(0,$.Z)(function*(P,M,E){const O=(0,c.m9)(P);wt(O.auth,M,Aa);const q=Cl(O.auth,E);return new Iv(O.auth,"linkViaPopup",M,q,O).executeNotNull()})).apply(this,arguments)}let Iv=(()=>{class P extends yp{constructor(E,O,q,re,Be){super(E,O,re,Be),this.provider=q,this.authWindow=null,this.pollId=null,P.currentPopupAction&&P.currentPopupAction.cancel(),P.currentPopupAction=this}executeNotNull(){var E=this;return(0,$.Z)(function*(){const O=yield E.execute();return ze(O,E.auth,"internal-error"),O})()}onExecution(){var E=this;return(0,$.Z)(function*(){_t(1===E.filter.length,"Popup operations only handle one event");const O=kh();E.authWindow=yield E.resolver._openPopup(E.auth,E.provider,E.filter[0],O),E.authWindow.associatedEvent=O,E.resolver._originValidation(E.auth).catch(q=>{E.reject(q)}),E.resolver._isIframeWebStorageSupported(E.auth,q=>{q||E.reject(Nt(E.auth,"web-storage-unsupported"))}),E.pollUserCancellation()})()}get eventId(){var E;return(null===(E=this.authWindow)||void 0===E?void 0:E.associatedEvent)||null}cancel(){this.reject(Nt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,P.currentPopupAction=null}pollUserCancellation(){const E=()=>{var O,q;this.pollId=null!==(q=null===(O=this.authWindow)||void 0===O?void 0:O.window)&&void 0!==q&&q.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Nt(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(E,as.get())};E()}}return P.currentPopupAction=null,P})();const Wc=new Map;class Ja extends yp{constructor(M,E,O=!1){super(M,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],E,void 0,O),this.eventId=null}execute(){var M=()=>super.execute,E=this;return(0,$.Z)(function*(){let O=Wc.get(E.auth._key());if(!O){try{const re=(yield function Tp(P,M){return Hu.apply(this,arguments)}(E.resolver,E.auth))?yield M().call(E):null;O=()=>Promise.resolve(re)}catch(q){O=()=>Promise.reject(q)}Wc.set(E.auth._key(),O)}return E.bypassAuthState||Wc.set(E.auth._key(),()=>Promise.resolve(null)),O()})()}onAuthEvent(M){var E=()=>super.onAuthEvent,O=this;return(0,$.Z)(function*(){if("signInViaRedirect"===M.type)return E().call(O,M);if("unknown"!==M.type){if(M.eventId){const q=yield O.auth._redirectUserForId(M.eventId);if(q)return O.user=q,E().call(O,M);O.resolve(null)}}else O.resolve(null)})()}onExecution(){return(0,$.Z)(function*(){})()}cleanUp(){}}function Hu(){return(Hu=(0,$.Z)(function*(P,M){const E=Yr(M),O=qc(P);if(!(yield O._isAvailable()))return!1;const q="true"===(yield O._get(E));return yield O._remove(E),q})).apply(this,arguments)}function El(P,M){return oi.apply(this,arguments)}function oi(){return(oi=(0,$.Z)(function*(P,M){return qc(P)._set(Yr(M),"true")})).apply(this,arguments)}function Al(){Wc.clear()}function Yo(P,M){Wc.set(P._key(),M)}function qc(P){return He(P._redirectPersistence)}function Yr(P){return Bi("pendingRedirect",P.config.apiKey,P.name)}function Xd(P,M,E){return function $d(P,M,E){return zh.apply(this,arguments)}(P,M,E)}function zh(){return(zh=(0,$.Z)(function*(P,M,E){const O=jr(P);wt(P,M,Aa);const q=Cl(O,E);return yield El(q,O),q._openRedirect(O,M,"signInViaRedirect")})).apply(this,arguments)}function sc(P,M,E){return function j(P,M,E){return V.apply(this,arguments)}(P,M,E)}function V(){return(V=(0,$.Z)(function*(P,M,E){const O=(0,c.m9)(P);wt(O.auth,M,Aa);const q=Cl(O.auth,E);yield El(q,O.auth);const re=yield ai(O);return q._openRedirect(O.auth,M,"reauthViaRedirect",re)})).apply(this,arguments)}function Y(P,M,E){return function pe(P,M,E){return Fe.apply(this,arguments)}(P,M,E)}function Fe(){return(Fe=(0,$.Z)(function*(P,M,E){const O=(0,c.m9)(P);wt(O.auth,M,Aa);const q=Cl(O.auth,E);yield Dc(!1,O,M.providerId),yield El(q,O.auth);const re=yield ai(O);return q._openRedirect(O.auth,M,"linkViaRedirect",re)})).apply(this,arguments)}function Ye(P,M){return Rt.apply(this,arguments)}function Rt(){return(Rt=(0,$.Z)(function*(P,M){return yield jr(P)._initializationPromise,ln(P,M,!1)})).apply(this,arguments)}function ln(P,M){return qn.apply(this,arguments)}function qn(){return(qn=(0,$.Z)(function*(P,M,E=!1){const O=jr(P),q=Cl(O,M),Be=yield new Ja(O,q,E).execute();return Be&&!E&&(delete Be.user._redirectEventId,yield O._persistUserIfCurrent(Be.user),yield O._setRedirectUser(null,M)),Be})).apply(this,arguments)}function ai(P){return hi.apply(this,arguments)}function hi(){return(hi=(0,$.Z)(function*(P){const M=kh(`${P.uid}:::`);return P._redirectEventId=M,yield P.auth._setRedirectUser(P),yield P.auth._persistUserIfCurrent(P),M})).apply(this,arguments)}class Bs{constructor(M){this.auth=M,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(M){this.consumers.add(M),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,M)&&(this.sendToConsumer(this.queuedRedirectEvent,M),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(M){this.consumers.delete(M)}onEvent(M){if(this.hasEventBeenHandled(M))return!1;let E=!1;return this.consumers.forEach(O=>{this.isEventForConsumer(M,O)&&(E=!0,this.sendToConsumer(M,O),this.saveEventToCache(M))}),this.hasHandledPotentialRedirect||!function Dl(P){switch(P.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return el(P);default:return!1}}(M)||(this.hasHandledPotentialRedirect=!0,E||(this.queuedRedirectEvent=M,E=!0)),E}sendToConsumer(M,E){var O;if(M.error&&!el(M)){const q=(null===(O=M.error.code)||void 0===O?void 0:O.split("auth/")[1])||"internal-error";E.onError(Nt(this.auth,q))}else E.onAuthEvent(M)}isEventForConsumer(M,E){const O=null===E.eventId||!!M.eventId&&M.eventId===E.eventId;return E.filter.includes(M.type)&&O}hasEventBeenHandled(M){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ao(M))}saveEventToCache(M){this.cachedEventUids.add(Ao(M)),this.lastProcessedEventTime=Date.now()}}function Ao(P){return[P.type,P.eventId,P.sessionId,P.tenantId].filter(M=>M).join("-")}function el({type:P,error:M}){return"unknown"===P&&"auth/no-auth-event"===M?.code}function Zc(P){return Qd.apply(this,arguments)}function Qd(){return(Qd=(0,$.Z)(function*(P,M={}){return Vi(P,"GET","/v1/projects",M)})).apply(this,arguments)}const Yc=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Hh=/^https?/;function tl(){return(tl=(0,$.Z)(function*(P){if(P.config.emulator)return;const{authorizedDomains:M}=yield Zc(P);for(const E of M)try{if(Pv(E))return}catch{}_n(P,"unauthorized-domain")})).apply(this,arguments)}function Pv(P){const M=Xe(),{protocol:E,hostname:O}=new URL(M);if(P.startsWith("chrome-extension://")){const Be=new URL(P);return""===Be.hostname&&""===O?"chrome-extension:"===E&&P.replace("chrome-extension://","")===M.replace("chrome-extension://",""):"chrome-extension:"===E&&Be.hostname===O}if(!Hh.test(E))return!1;if(Yc.test(P))return O===P;const q=P.replace(/\./g,"\\.");return new RegExp("^(.+\\."+q+"|"+q+")$","i").test(O)}const nM=new nn(3e4,6e4);function wp(){const P=Pi().___jsl;if(P?.H)for(const M of Object.keys(P.H))if(P.H[M].r=P.H[M].r||[],P.H[M].L=P.H[M].L||[],P.H[M].r=[...P.H[M].L],P.CP)for(let E=0;E<P.CP.length;E++)P.CP[E]=null}let Wu=null;function Jd(P){return Wu=Wu||function Lb(P){return new Promise((M,E)=>{var O,q,re;function Be(){wp(),gapi.load("gapi.iframes",{callback:()=>{M(gapi.iframes.getContext())},ontimeout:()=>{wp(),E(Nt(P,"network-request-failed"))},timeout:nM.get()})}if(null!==(q=null===(O=Pi().gapi)||void 0===O?void 0:O.iframes)&&void 0!==q&&q.Iframe)M(gapi.iframes.getContext());else{if(null===(re=Pi().gapi)||void 0===re||!re.load){const Et=os("iframefcb");return Pi()[Et]=()=>{gapi.load?Be():E(Nt(P,"network-request-failed"))},jh(`https://apis.google.com/js/api.js?onload=${Et}`).catch(cn=>E(cn))}Be()}}).catch(M=>{throw Wu=null,M})}(P),Wu}const Mp=new nn(5e3,15e3),pg={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ef=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ob(P){const M=P.config;ze(M.authDomain,P,"auth-domain-config-required");const E=M.emulator?er(M,"emulator/auth/iframe"):`https://${P.config.authDomain}/__/auth/iframe`,O={apiKey:M.apiKey,appName:P.name,v:J.SDK_VERSION},q=ef.get(P.config.apiHost);q&&(O.eid=q);const re=P._getFrameworks();return re.length&&(O.fw=re.join(",")),`${E}?${(0,c.xO)(O).slice(1)}`}function tf(){return tf=(0,$.Z)(function*(P){const M=yield Jd(P),E=Pi().gapi;return ze(E,P,"internal-error"),M.open({where:document.body,url:Ob(P),messageHandlersFilter:E.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pg,dontclear:!0},O=>new Promise(function(){var q=(0,$.Z)(function*(re,Be){yield O.restyle({setHideOnLeave:!1});const Et=Nt(P,"network-request-failed"),cn=Pi().setTimeout(()=>{Be(Et)},Mp.get());function jn(){Pi().clearTimeout(cn),re(O)}O.ping(jn).then(jn,()=>{Be(Et)})});return function(re,Be){return q.apply(this,arguments)}}()))}),tf.apply(this,arguments)}const nf={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class gg{constructor(M){this.window=M,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Xc(P,M,E,O,q,re){ze(P.config.authDomain,P,"auth-domain-config-required"),ze(P.config.apiKey,P,"invalid-api-key");const Be={apiKey:P.config.apiKey,appName:P.name,authType:E,redirectUrl:O,v:J.SDK_VERSION,eventId:q};if(M instanceof Aa){M.setDefaultLanguage(P.languageCode),Be.providerId=M.providerId||"",(0,c.xb)(M.getCustomParameters())||(Be.customParameters=JSON.stringify(M.getCustomParameters()));for(const[cn,jn]of Object.entries(re||{}))Be[cn]=jn}if(M instanceof Zl){const cn=M.getScopes().filter(jn=>""!==jn);cn.length>0&&(Be.scopes=cn.join(","))}P.tenantId&&(Be.tid=P.tenantId);const Et=Be;for(const cn of Object.keys(Et))void 0===Et[cn]&&delete Et[cn];return`${function _g({config:P}){return P.emulator?er(P,"emulator/auth/handler"):`https://${P.authDomain}/__/auth/handler`}(P)}?${(0,c.xO)(Et).slice(1)}`}const vg="webStorageSupport",kb=class rM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ml,this._completeRedirectFn=ln,this._overrideRedirectResult=Yo}_openPopup(M,E,O,q){var re=this;return(0,$.Z)(function*(){var Be;_t(null===(Be=re.eventManagers[M._key()])||void 0===Be?void 0:Be.manager,"_initialize() not called before _openPopup()");const Et=Xc(M,E,O,Xe(),q);return function Ov(P,M,E,O=500,q=600){const re=Math.max((window.screen.availHeight-q)/2,0).toString(),Be=Math.max((window.screen.availWidth-O)/2,0).toString();let Et="";const cn=Object.assign(Object.assign({},nf),{width:O.toString(),height:q.toString(),top:re,left:Be}),jn=(0,c.z$)().toLowerCase();E&&(Et=gt(jn)?"_blank":E),Se(jn)&&(M=M||"http://localhost",cn.scrollbars="yes");const di=Object.entries(cn).reduce((Rl,[ac,yg])=>`${Rl}${ac}=${yg},`,"");if(function tr(P=(0,c.z$)()){var M;return xi(P)&&!(null===(M=window.navigator)||void 0===M||!M.standalone)}(jn)&&"_self"!==Et)return function kv(P,M){const E=document.createElement("a");E.href=P,E.target=M;const O=document.createEvent("MouseEvent");O.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),E.dispatchEvent(O)}(M||"",Et),new gg(null);const wr=window.open(M||"",Et,di);ze(wr,P,"popup-blocked");try{wr.focus()}catch{}return new gg(wr)}(M,Et,kh())})()}_openRedirect(M,E,O,q){var re=this;return(0,$.Z)(function*(){return yield re._originValidation(M),function Tn(P){Pi().location.href=P}(Xc(M,E,O,Xe(),q)),new Promise(()=>{})})()}_initialize(M){const E=M._key();if(this.eventManagers[E]){const{manager:q,promise:re}=this.eventManagers[E];return q?Promise.resolve(q):(_t(re,"If manager is not set, promise should be"),re)}const O=this.initAndGetManager(M);return this.eventManagers[E]={promise:O},O.catch(()=>{delete this.eventManagers[E]}),O}initAndGetManager(M){var E=this;return(0,$.Z)(function*(){const O=yield function mg(P){return tf.apply(this,arguments)}(M),q=new Bs(M);return O.register("authEvent",re=>(ze(re?.authEvent,M,"invalid-auth-event"),{status:q.onEvent(re.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),E.eventManagers[M._key()]={manager:q},E.iframes[M._key()]=O,q})()}_isIframeWebStorageSupported(M,E){this.iframes[M._key()].send(vg,{type:vg},q=>{var re;const Be=null===(re=q?.[0])||void 0===re?void 0:re[vg];void 0!==Be&&E(!!Be),_n(M,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(M){const E=M._key();return this.originValidationPromises[E]||(this.originValidationPromises[E]=function ga(P){return tl.apply(this,arguments)}(M)),this.originValidationPromises[E]}get _shouldInitProactively(){return ji()||ye()||xi()}};class qu extends class $c{constructor(M){this.factorId=M}_process(M,E,O){switch(E.type){case"enroll":return this._finalizeEnroll(M,E.credential,O);case"signin":return this._finalizeSignIn(M,E.credential);default:return ot("unexpected MultiFactorSessionType")}}}{constructor(M){super("phone"),this.credential=M}static _fromCredential(M){return new qu(M)}_finalizeEnroll(M,E,O){return function ug(P,M){return Vi(P,"POST","/v2/accounts/mfaEnrollment:finalize",Mi(P,M))}(M,{idToken:E,displayName:O,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(M,E){return function nc(P,M){return Vi(P,"POST","/v2/accounts/mfaSignIn:finalize",Mi(P,M))}(M,{mfaPendingCredential:E,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let sM=(()=>{class P{constructor(){}static assertion(E){return qu._fromCredential(E)}}return P.FACTOR_ID="phone",P})();var Nb="@firebase/auth";class oM{constructor(M){this.auth=M,this.internalListeners=new Map}getUid(){var M;return this.assertAuthConfigured(),(null===(M=this.auth.currentUser)||void 0===M?void 0:M.uid)||null}getToken(M){var E=this;return(0,$.Z)(function*(){return E.assertAuthConfigured(),yield E.auth._initializationPromise,E.auth.currentUser?{accessToken:yield E.auth.currentUser.getIdToken(M)}:null})()}addAuthTokenListener(M){if(this.assertAuthConfigured(),this.internalListeners.has(M))return;const E=this.auth.onIdTokenChanged(O=>{var q;M((null===(q=O)||void 0===q?void 0:q.stsTokenManager.accessToken)||null)});this.internalListeners.set(M,E),this.updateProactiveRefresh()}removeAuthTokenListener(M){this.assertAuthConfigured();const E=this.internalListeners.get(M);!E||(this.internalListeners.delete(M),E(),this.updateProactiveRefresh())}assertAuthConfigured(){ze(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}!function lM(P){(0,J._registerComponent)(new st.wA("auth",(M,{options:E})=>{const O=M.getProvider("app").getImmediate(),q=M.getProvider("heartbeat"),{apiKey:re,authDomain:Be}=O.options;return((Et,cn)=>{ze(re&&!re.includes(":"),"invalid-api-key",{appName:Et.name}),ze(!Be?.includes(":"),"argument-error",{appName:Et.name});const jn={apiKey:re,authDomain:Be,clientPlatform:P,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wc(P)},di=new Sh(Et,cn,jn);return function ut(P,M){const E=M?.persistence||[],O=(Array.isArray(E)?E:[E]).map(He);M?.errorMap&&P._updateErrorMap(M.errorMap),P._initializeWithPersistence(O,M?.popupRedirectResolver)}(di,E),di})(O,q)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((M,E,O)=>{M.getProvider("auth-internal").initialize()})),(0,J._registerComponent)(new st.wA("auth-internal",M=>{const E=jr(M.getProvider("auth").getImmediate());return new oM(E)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,J.registerVersion)(Nb,"0.20.5",function aM(P){switch(P){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(P)),(0,J.registerVersion)(Nb,"0.20.5","esm2017")}("Browser")},2090:(kn,At,se)=>{se.d(At,{$s:()=>yr,BH:()=>Kt,G6:()=>ze,L:()=>Oe,LL:()=>Xe,Mn:()=>wt,Sg:()=>Ot,UG:()=>dt,US:()=>st,ZB:()=>Me,ZR:()=>ut,b$:()=>_n,d:()=>Nt,eu:()=>_t,hl:()=>ot,jU:()=>et,m9:()=>rs,ne:()=>Un,pd:()=>Br,r3:()=>Mi,ru:()=>vn,tV:()=>ct,uI:()=>Pn,vZ:()=>oo,w1:()=>Dt,xO:()=>ha,xb:()=>gr,z$:()=>yt,zI:()=>ke,zd:()=>Ca});const je=function(xe){const we=[];let ve=0;for(let Ae=0;Ae<xe.length;Ae++){let Ce=xe.charCodeAt(Ae);Ce<128?we[ve++]=Ce:Ce<2048?(we[ve++]=Ce>>6|192,we[ve++]=63&Ce|128):55296==(64512&Ce)&&Ae+1<xe.length&&56320==(64512&xe.charCodeAt(Ae+1))?(Ce=65536+((1023&Ce)<<10)+(1023&xe.charCodeAt(++Ae)),we[ve++]=Ce>>18|240,we[ve++]=Ce>>12&63|128,we[ve++]=Ce>>6&63|128,we[ve++]=63&Ce|128):(we[ve++]=Ce>>12|224,we[ve++]=Ce>>6&63|128,we[ve++]=63&Ce|128)}return we},st={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(xe,we){if(!Array.isArray(xe))throw Error("encodeByteArray takes an array as a parameter");this.init_();const ve=we?this.byteToCharMapWebSafe_:this.byteToCharMap_,Ae=[];for(let Ce=0;Ce<xe.length;Ce+=3){const Ct=xe[Ce],$t=Ce+1<xe.length,Qn=$t?xe[Ce+1]:0,Gi=Ce+2<xe.length,Bi=Gi?xe[Ce+2]:0;let Se=(15&Qn)<<2|Bi>>6,ye=63&Bi;Gi||(ye=64,$t||(Se=64)),Ae.push(ve[Ct>>2],ve[(3&Ct)<<4|Qn>>4],ve[Se],ve[ye])}return Ae.join("")},encodeString(xe,we){return this.HAS_NATIVE_SUPPORT&&!we?btoa(xe):this.encodeByteArray(je(xe),we)},decodeString(xe,we){return this.HAS_NATIVE_SUPPORT&&!we?atob(xe):function(xe){const we=[];let ve=0,Ae=0;for(;ve<xe.length;){const Ce=xe[ve++];if(Ce<128)we[Ae++]=String.fromCharCode(Ce);else if(Ce>191&&Ce<224){const Ct=xe[ve++];we[Ae++]=String.fromCharCode((31&Ce)<<6|63&Ct)}else if(Ce>239&&Ce<365){const Gi=((7&Ce)<<18|(63&xe[ve++])<<12|(63&xe[ve++])<<6|63&xe[ve++])-65536;we[Ae++]=String.fromCharCode(55296+(Gi>>10)),we[Ae++]=String.fromCharCode(56320+(1023&Gi))}else{const Ct=xe[ve++],$t=xe[ve++];we[Ae++]=String.fromCharCode((15&Ce)<<12|(63&Ct)<<6|63&$t)}}return we.join("")}(this.decodeStringToByteArray(xe,we))},decodeStringToByteArray(xe,we){this.init_();const ve=we?this.charToByteMapWebSafe_:this.charToByteMap_,Ae=[];for(let Ce=0;Ce<xe.length;){const Ct=ve[xe.charAt(Ce++)],Qn=Ce<xe.length?ve[xe.charAt(Ce)]:0;++Ce;const Bi=Ce<xe.length?ve[xe.charAt(Ce)]:64;++Ce;const Re=Ce<xe.length?ve[xe.charAt(Ce)]:64;if(++Ce,null==Ct||null==Qn||null==Bi||null==Re)throw Error();Ae.push(Ct<<2|Qn>>4),64!==Bi&&(Ae.push(Qn<<4&240|Bi>>2),64!==Re&&Ae.push(Bi<<6&192|Re))}return Ae},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let xe=0;xe<this.ENCODED_VALS.length;xe++)this.byteToCharMap_[xe]=this.ENCODED_VALS.charAt(xe),this.charToByteMap_[this.byteToCharMap_[xe]]=xe,this.byteToCharMapWebSafe_[xe]=this.ENCODED_VALS_WEBSAFE.charAt(xe),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[xe]]=xe,xe>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(xe)]=xe,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(xe)]=xe)}}},Oe=function(xe){return function(xe){const we=je(xe);return st.encodeByteArray(we,!0)}(xe).replace(/\./g,"")},ct=function(xe){try{return st.decodeString(xe,!0)}catch(we){console.error("base64Decode failed: ",we)}return null};function Me(xe,we){if(!(we instanceof Object))return we;switch(we.constructor){case Date:return new Date(we.getTime());case Object:void 0===xe&&(xe={});break;case Array:xe=[];break;default:return we}for(const ve in we)!we.hasOwnProperty(ve)||!Ne(ve)||(xe[ve]=Me(xe[ve],we[ve]));return xe}function Ne(xe){return"__proto__"!==xe}class Kt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((we,ve)=>{this.resolve=we,this.reject=ve})}wrapCallback(we){return(ve,Ae)=>{ve?this.reject(ve):this.resolve(Ae),"function"==typeof we&&(this.promise.catch(()=>{}),1===we.length?we(ve):we(ve,Ae))}}}function Ot(xe,we){if(xe.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const Ae=we||"demo-project",Ce=xe.iat||0,Ct=xe.sub||xe.user_id;if(!Ct)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const $t=Object.assign({iss:`https://securetoken.google.com/${Ae}`,aud:Ae,iat:Ce,exp:Ce+3600,auth_time:Ce,sub:Ct,user_id:Ct,firebase:{sign_in_provider:"custom",identities:{}}},xe);return[Oe(JSON.stringify({alg:"none",type:"JWT"})),Oe(JSON.stringify($t)),""].join(".")}function yt(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Pn(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(yt())}function dt(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function et(){return"object"==typeof self&&self.self===self}function vn(){const xe="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof xe&&void 0!==xe.id}function _n(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Nt(){return yt().indexOf("Electron/")>=0}function Dt(){const xe=yt();return xe.indexOf("MSIE ")>=0||xe.indexOf("Trident/")>=0}function wt(){return yt().indexOf("MSAppHost/")>=0}function ze(){return!dt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ot(){return"object"==typeof indexedDB}function _t(){return new Promise((xe,we)=>{try{let ve=!0;const Ae="validate-browser-context-for-indexeddb-analytics-module",Ce=self.indexedDB.open(Ae);Ce.onsuccess=()=>{Ce.result.close(),ve||self.indexedDB.deleteDatabase(Ae),xe(!0)},Ce.onupgradeneeded=()=>{ve=!1},Ce.onerror=()=>{var Ct;we((null===(Ct=Ce.error)||void 0===Ct?void 0:Ct.message)||"")}}catch(ve){we(ve)}})}function ke(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class ut extends Error{constructor(we,ve,Ae){super(ve),this.code=we,this.customData=Ae,this.name="FirebaseError",Object.setPrototypeOf(this,ut.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xe.prototype.create)}}class Xe{constructor(we,ve,Ae){this.service=we,this.serviceName=ve,this.errors=Ae}create(we,...ve){const Ae=ve[0]||{},Ce=`${this.service}/${we}`,Ct=this.errors[we],$t=Ct?function zt(xe,we){return xe.replace(zn,(ve,Ae)=>{const Ce=we[Ae];return null!=Ce?String(Ce):`<${Ae}?>`})}(Ct,Ae):"Error";return new ut(Ce,`${this.serviceName}: ${$t} (${Ce}).`,Ae)}}const zn=/\{\$([^}]+)}/g;function Mi(xe,we){return Object.prototype.hasOwnProperty.call(xe,we)}function gr(xe){for(const we in xe)if(Object.prototype.hasOwnProperty.call(xe,we))return!1;return!0}function oo(xe,we){if(xe===we)return!0;const ve=Object.keys(xe),Ae=Object.keys(we);for(const Ce of ve){if(!Ae.includes(Ce))return!1;const Ct=xe[Ce],$t=we[Ce];if(Cr(Ct)&&Cr($t)){if(!oo(Ct,$t))return!1}else if(Ct!==$t)return!1}for(const Ce of Ae)if(!ve.includes(Ce))return!1;return!0}function Cr(xe){return null!==xe&&"object"==typeof xe}function ha(xe){const we=[];for(const[ve,Ae]of Object.entries(xe))Array.isArray(Ae)?Ae.forEach(Ce=>{we.push(encodeURIComponent(ve)+"="+encodeURIComponent(Ce))}):we.push(encodeURIComponent(ve)+"="+encodeURIComponent(Ae));return we.length?"&"+we.join("&"):""}function Ca(xe){const we={};return xe.replace(/^\?/,"").split("&").forEach(Ae=>{if(Ae){const[Ce,Ct]=Ae.split("=");we[decodeURIComponent(Ce)]=decodeURIComponent(Ct)}}),we}function Br(xe){const we=xe.indexOf("?");if(!we)return"";const ve=xe.indexOf("#",we);return xe.substring(we,ve>0?ve:void 0)}function Un(xe,we){const ve=new ao(xe,we);return ve.subscribe.bind(ve)}class ao{constructor(we,ve){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=ve,this.task.then(()=>{we(this)}).catch(Ae=>{this.error(Ae)})}next(we){this.forEachObserver(ve=>{ve.next(we)})}error(we){this.forEachObserver(ve=>{ve.error(we)}),this.close(we)}complete(){this.forEachObserver(we=>{we.complete()}),this.close()}subscribe(we,ve,Ae){let Ce;if(void 0===we&&void 0===ve&&void 0===Ae)throw new Error("Missing Observer.");Ce=function Li(xe,we){if("object"!=typeof xe||null===xe)return!1;for(const ve of we)if(ve in xe&&"function"==typeof xe[ve])return!0;return!1}(we,["next","error","complete"])?we:{next:we,error:ve,complete:Ae},void 0===Ce.next&&(Ce.next=ms),void 0===Ce.error&&(Ce.error=ms),void 0===Ce.complete&&(Ce.complete=ms);const Ct=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?Ce.error(this.finalError):Ce.complete()}catch{}}),this.observers.push(Ce),Ct}unsubscribeOne(we){void 0===this.observers||void 0===this.observers[we]||(delete this.observers[we],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(we){if(!this.finalized)for(let ve=0;ve<this.observers.length;ve++)this.sendOne(ve,we)}sendOne(we,ve){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[we])try{ve(this.observers[we])}catch(Ae){typeof console<"u"&&console.error&&console.error(Ae)}})}close(we){this.finalized||(this.finalized=!0,void 0!==we&&(this.finalError=we),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ms(){}function yr(xe,we=1e3,ve=2){const Ae=we*Math.pow(ve,xe),Ce=Math.round(.5*Ae*(Math.random()-.5)*2);return Math.min(144e5,Ae+Ce)}function rs(xe){return xe&&xe._delegate?xe._delegate:xe}},4676:(kn,At,se)=>{var $={};se.r($),se.d($,{KHR_DF_CHANNEL_RGBSDA_ALPHA:()=>o_e,KHR_DF_CHANNEL_RGBSDA_BLUE:()=>i_e,KHR_DF_CHANNEL_RGBSDA_DEPTH:()=>s_e,KHR_DF_CHANNEL_RGBSDA_GREEN:()=>n_e,KHR_DF_CHANNEL_RGBSDA_RED:()=>t_e,KHR_DF_CHANNEL_RGBSDA_STENCIL:()=>r_e,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:()=>wge,KHR_DF_FLAG_ALPHA_STRAIGHT:()=>Tge,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT:()=>fge,KHR_DF_MODEL_ASTC:()=>bge,KHR_DF_MODEL_ETC1:()=>vge,KHR_DF_MODEL_ETC1S:()=>xge,KHR_DF_MODEL_ETC2:()=>yge,KHR_DF_MODEL_RGBSDA:()=>_ge,KHR_DF_MODEL_UNSPECIFIED:()=>gge,KHR_DF_PRIMARIES_ACES:()=>Kge,KHR_DF_PRIMARIES_ACESCC:()=>Xge,KHR_DF_PRIMARIES_ADOBERGB:()=>e_e,KHR_DF_PRIMARIES_BT2020:()=>Zge,KHR_DF_PRIMARIES_BT601_EBU:()=>Wge,KHR_DF_PRIMARIES_BT601_SMPTE:()=>qge,KHR_DF_PRIMARIES_BT709:()=>Hge,KHR_DF_PRIMARIES_CIEXYZ:()=>Yge,KHR_DF_PRIMARIES_DISPLAYP3:()=>Jge,KHR_DF_PRIMARIES_NTSC1953:()=>$ge,KHR_DF_PRIMARIES_PAL525:()=>Qge,KHR_DF_PRIMARIES_UNSPECIFIED:()=>zge,KHR_DF_SAMPLE_DATATYPE_EXPONENT:()=>c_e,KHR_DF_SAMPLE_DATATYPE_FLOAT:()=>a_e,KHR_DF_SAMPLE_DATATYPE_LINEAR:()=>u_e,KHR_DF_SAMPLE_DATATYPE_SIGNED:()=>l_e,KHR_DF_TRANSFER_ACESCC:()=>Uge,KHR_DF_TRANSFER_ACESCCT:()=>Vge,KHR_DF_TRANSFER_ADOBERGB:()=>Gge,KHR_DF_TRANSFER_BT1886:()=>Ige,KHR_DF_TRANSFER_DCIP3:()=>kge,KHR_DF_TRANSFER_HLG_EOTF:()=>Fge,KHR_DF_TRANSFER_HLG_OETF:()=>Pge,KHR_DF_TRANSFER_ITU:()=>Ege,KHR_DF_TRANSFER_LINEAR:()=>Sge,KHR_DF_TRANSFER_NTSC:()=>Age,KHR_DF_TRANSFER_PAL625_EOTF:()=>Bge,KHR_DF_TRANSFER_PAL_OETF:()=>Nge,KHR_DF_TRANSFER_PQ_EOTF:()=>Lge,KHR_DF_TRANSFER_PQ_OETF:()=>Oge,KHR_DF_TRANSFER_SLOG:()=>Dge,KHR_DF_TRANSFER_SLOG2:()=>Rge,KHR_DF_TRANSFER_SRGB:()=>Cge,KHR_DF_TRANSFER_ST240:()=>jge,KHR_DF_TRANSFER_UNSPECIFIED:()=>Mge,KHR_DF_VENDORID_KHRONOS:()=>pge,KHR_DF_VERSION:()=>mge,KHR_SUPERCOMPRESSION_BASISLZ:()=>uge,KHR_SUPERCOMPRESSION_NONE:()=>cge,KHR_SUPERCOMPRESSION_ZLIB:()=>dge,KHR_SUPERCOMPRESSION_ZSTD:()=>hge,KTX2Container:()=>eK,VK_FORMAT_A1R5G5B5_UNORM_PACK16:()=>y_e,VK_FORMAT_A2B10G10R10_SINT_PACK32:()=>ive,VK_FORMAT_A2B10G10R10_SNORM_PACK32:()=>tve,VK_FORMAT_A2B10G10R10_UINT_PACK32:()=>nve,VK_FORMAT_A2B10G10R10_UNORM_PACK32:()=>eve,VK_FORMAT_A2R10G10B10_SINT_PACK32:()=>J_e,VK_FORMAT_A2R10G10B10_SNORM_PACK32:()=>$_e,VK_FORMAT_A2R10G10B10_UINT_PACK32:()=>Q_e,VK_FORMAT_A2R10G10B10_UNORM_PACK32:()=>X_e,VK_FORMAT_A4B4G4R4_UNORM_PACK16_EXT:()=>k0e,VK_FORMAT_A4R4G4B4_UNORM_PACK16_EXT:()=>O0e,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:()=>P0e,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:()=>Qye,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:()=>$ye,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:()=>D0e,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:()=>qye,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:()=>Wye,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:()=>R0e,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:()=>Yye,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:()=>Zye,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:()=>I0e,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:()=>Xye,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:()=>Kye,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:()=>F0e,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:()=>e0e,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:()=>Jye,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:()=>L0e,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:()=>n0e,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:()=>t0e,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:()=>x0e,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:()=>Rye,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:()=>Dye,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:()=>T0e,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:()=>Pye,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:()=>Iye,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:()=>w0e,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:()=>Lye,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:()=>Fye,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:()=>M0e,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:()=>kye,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:()=>Oye,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:()=>S0e,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:()=>Bye,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:()=>Nye,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:()=>C0e,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:()=>Uye,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:()=>jye,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:()=>E0e,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:()=>Gye,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:()=>Vye,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:()=>A0e,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:()=>Hye,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:()=>zye,VK_FORMAT_B10G11R11_UFLOAT_PACK32:()=>Yve,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:()=>a0e,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:()=>d0e,VK_FORMAT_B4G4R4A4_UNORM_PACK16:()=>p_e,VK_FORMAT_B5G5R5A1_UNORM_PACK16:()=>v_e,VK_FORMAT_B5G6R5_UNORM_PACK16:()=>g_e,VK_FORMAT_B8G8R8A8_SINT:()=>Y_e,VK_FORMAT_B8G8R8A8_SNORM:()=>q_e,VK_FORMAT_B8G8R8A8_SRGB:()=>K_e,VK_FORMAT_B8G8R8A8_UINT:()=>Z_e,VK_FORMAT_B8G8R8A8_UNORM:()=>W_e,VK_FORMAT_B8G8R8_SINT:()=>B_e,VK_FORMAT_B8G8R8_SNORM:()=>k_e,VK_FORMAT_B8G8R8_SRGB:()=>j_e,VK_FORMAT_B8G8R8_UINT:()=>N_e,VK_FORMAT_B8G8R8_UNORM:()=>O_e,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:()=>oye,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:()=>sye,VK_FORMAT_BC1_RGB_SRGB_BLOCK:()=>rye,VK_FORMAT_BC1_RGB_UNORM_BLOCK:()=>iye,VK_FORMAT_BC2_SRGB_BLOCK:()=>lye,VK_FORMAT_BC2_UNORM_BLOCK:()=>aye,VK_FORMAT_BC3_SRGB_BLOCK:()=>uye,VK_FORMAT_BC3_UNORM_BLOCK:()=>cye,VK_FORMAT_BC4_SNORM_BLOCK:()=>dye,VK_FORMAT_BC4_UNORM_BLOCK:()=>hye,VK_FORMAT_BC5_SNORM_BLOCK:()=>pye,VK_FORMAT_BC5_UNORM_BLOCK:()=>fye,VK_FORMAT_BC6H_SFLOAT_BLOCK:()=>gye,VK_FORMAT_BC6H_UFLOAT_BLOCK:()=>mye,VK_FORMAT_BC7_SRGB_BLOCK:()=>vye,VK_FORMAT_BC7_UNORM_BLOCK:()=>_ye,VK_FORMAT_D16_UNORM:()=>Xve,VK_FORMAT_D16_UNORM_S8_UINT:()=>eye,VK_FORMAT_D24_UNORM_S8_UINT:()=>tye,VK_FORMAT_D32_SFLOAT:()=>Qve,VK_FORMAT_D32_SFLOAT_S8_UINT:()=>nye,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:()=>Kve,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:()=>Aye,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:()=>Eye,VK_FORMAT_EAC_R11_SNORM_BLOCK:()=>Cye,VK_FORMAT_EAC_R11_UNORM_BLOCK:()=>Sye,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:()=>Tye,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:()=>xye,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:()=>Mye,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:()=>wye,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:()=>bye,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:()=>yye,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:()=>o0e,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:()=>h0e,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:()=>_0e,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:()=>f0e,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:()=>v0e,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:()=>p0e,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:()=>y0e,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:()=>m0e,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:()=>b0e,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:()=>g0e,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:()=>s0e,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:()=>r0e,VK_FORMAT_R10X6_UNORM_PACK16:()=>i0e,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:()=>u0e,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:()=>c0e,VK_FORMAT_R12X4_UNORM_PACK16:()=>l0e,VK_FORMAT_R16G16B16A16_SFLOAT:()=>wve,VK_FORMAT_R16G16B16A16_SINT:()=>Tve,VK_FORMAT_R16G16B16A16_SNORM:()=>bve,VK_FORMAT_R16G16B16A16_UINT:()=>xve,VK_FORMAT_R16G16B16A16_UNORM:()=>yve,VK_FORMAT_R16G16B16_SFLOAT:()=>vve,VK_FORMAT_R16G16B16_SINT:()=>_ve,VK_FORMAT_R16G16B16_SNORM:()=>mve,VK_FORMAT_R16G16B16_UINT:()=>gve,VK_FORMAT_R16G16B16_UNORM:()=>pve,VK_FORMAT_R16G16_SFLOAT:()=>fve,VK_FORMAT_R16G16_SINT:()=>dve,VK_FORMAT_R16G16_SNORM:()=>uve,VK_FORMAT_R16G16_UINT:()=>hve,VK_FORMAT_R16G16_UNORM:()=>cve,VK_FORMAT_R16_SFLOAT:()=>lve,VK_FORMAT_R16_SINT:()=>ave,VK_FORMAT_R16_SNORM:()=>sve,VK_FORMAT_R16_UINT:()=>ove,VK_FORMAT_R16_UNORM:()=>rve,VK_FORMAT_R32G32B32A32_SFLOAT:()=>Ove,VK_FORMAT_R32G32B32A32_SINT:()=>Lve,VK_FORMAT_R32G32B32A32_UINT:()=>Fve,VK_FORMAT_R32G32B32_SFLOAT:()=>Pve,VK_FORMAT_R32G32B32_SINT:()=>Ive,VK_FORMAT_R32G32B32_UINT:()=>Rve,VK_FORMAT_R32G32_SFLOAT:()=>Dve,VK_FORMAT_R32G32_SINT:()=>Ave,VK_FORMAT_R32G32_UINT:()=>Eve,VK_FORMAT_R32_SFLOAT:()=>Cve,VK_FORMAT_R32_SINT:()=>Sve,VK_FORMAT_R32_UINT:()=>Mve,VK_FORMAT_R4G4B4A4_UNORM_PACK16:()=>f_e,VK_FORMAT_R4G4_UNORM_PACK8:()=>d_e,VK_FORMAT_R5G5B5A1_UNORM_PACK16:()=>__e,VK_FORMAT_R5G6B5_UNORM_PACK16:()=>m_e,VK_FORMAT_R64G64B64A64_SFLOAT:()=>Zve,VK_FORMAT_R64G64B64A64_SINT:()=>qve,VK_FORMAT_R64G64B64A64_UINT:()=>Wve,VK_FORMAT_R64G64B64_SFLOAT:()=>Hve,VK_FORMAT_R64G64B64_SINT:()=>zve,VK_FORMAT_R64G64B64_UINT:()=>Gve,VK_FORMAT_R64G64_SFLOAT:()=>Vve,VK_FORMAT_R64G64_SINT:()=>Uve,VK_FORMAT_R64G64_UINT:()=>jve,VK_FORMAT_R64_SFLOAT:()=>Bve,VK_FORMAT_R64_SINT:()=>Nve,VK_FORMAT_R64_UINT:()=>kve,VK_FORMAT_R8G8B8A8_SINT:()=>z_e,VK_FORMAT_R8G8B8A8_SNORM:()=>V_e,VK_FORMAT_R8G8B8A8_SRGB:()=>H_e,VK_FORMAT_R8G8B8A8_UINT:()=>G_e,VK_FORMAT_R8G8B8A8_UNORM:()=>U_e,VK_FORMAT_R8G8B8_SINT:()=>F_e,VK_FORMAT_R8G8B8_SNORM:()=>I_e,VK_FORMAT_R8G8B8_SRGB:()=>L_e,VK_FORMAT_R8G8B8_UINT:()=>P_e,VK_FORMAT_R8G8B8_UNORM:()=>R_e,VK_FORMAT_R8G8_SINT:()=>A_e,VK_FORMAT_R8G8_SNORM:()=>C_e,VK_FORMAT_R8G8_SRGB:()=>D_e,VK_FORMAT_R8G8_UINT:()=>E_e,VK_FORMAT_R8G8_UNORM:()=>S_e,VK_FORMAT_R8_SINT:()=>w_e,VK_FORMAT_R8_SNORM:()=>x_e,VK_FORMAT_R8_SRGB:()=>M_e,VK_FORMAT_R8_UINT:()=>T_e,VK_FORMAT_R8_UNORM:()=>b_e,VK_FORMAT_S8_UINT:()=>Jve,VK_FORMAT_UNDEFINED:()=>h_e,VK_FORMAT_X8_D24_UNORM_PACK32:()=>$ve,read:()=>N0e,write:()=>j0e});var c=se(4650);let J=null;function je(){return J}const Oe=new c.OlP("DocumentToken");let ct=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:function(){return function Te(){return(0,c.LFG)(Ne)}()},providedIn:"platform"}),i})();const Me=new c.OlP("Location Initialized");let Ne=(()=>{class i extends ct{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return je().getBaseHref(this._doc)}onPopState(t){const n=je().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){const n=je().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,n,r){Kt()?this._history.pushState(t,n,r):this.location.hash=r}replaceState(t,n,r){Kt()?this._history.replaceState(t,n,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Oe))},i.\u0275prov=c.Yz7({token:i,factory:function(){return function Ot(){return new Ne((0,c.LFG)(Oe))}()},providedIn:"platform"}),i})();function Kt(){return!!window.history.pushState}function yt(i,e){if(0==i.length)return e;if(0==e.length)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?i+e.substring(1):1==t?i+e:i+"/"+e}function Pn(i){const e=i.match(/#|\?|$/),t=e&&e.index||i.length;return i.slice(0,t-("/"===i[t-1]?1:0))+i.slice(t)}function dt(i){return i&&"?"!==i[0]?"?"+i:i}let et=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:function(){return(0,c.f3M)(_n)},providedIn:"root"}),i})();const vn=new c.OlP("appBaseHref");let _n=(()=>{class i extends et{constructor(t,n){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??(0,c.f3M)(Oe).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return yt(this._baseHref,t)}path(t=!1){const n=this._platformLocation.pathname+dt(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${n}${r}`:n}pushState(t,n,r,s){const o=this.prepareExternalUrl(r+dt(s));this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){const o=this.prepareExternalUrl(r+dt(s));this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(ct),c.LFG(vn,8))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Nt=(()=>{class i extends et{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(t){const n=yt(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,r,s){let o=this.prepareExternalUrl(r+dt(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){let o=this.prepareExternalUrl(r+dt(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(ct),c.LFG(vn,8))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})(),Dt=(()=>{class i{constructor(t){this._subject=new c.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const n=this._locationStrategy.getBaseHref();this._baseHref=Pn(ze(n)),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+dt(n))}normalize(t){return i.stripTrailingSlash(function an(i,e){return i&&e.startsWith(i)?e.substring(i.length):e}(this._baseHref,ze(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,n="",r=null){this._locationStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+dt(n)),r)}replaceState(t,n="",r=null){this._locationStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+dt(n)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)})),()=>{const n=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(n,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(r=>r(t,n))}subscribe(t,n,r){return this._subject.subscribe({next:t,error:n,complete:r})}}return i.normalizeQueryParams=dt,i.joinWithSlash=yt,i.stripTrailingSlash=Pn,i.\u0275fac=function(t){return new(t||i)(c.LFG(et))},i.\u0275prov=c.Yz7({token:i,factory:function(){return function wt(){return new Dt((0,c.LFG)(et))}()},providedIn:"root"}),i})();function ze(i){return i.replace(/\/index.html$/,"")}let Ha=(()=>{class i{constructor(t,n,r,s){this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&((0,c.sIi)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(n=>this._toggleClass(n.key,n.currentValue)),t.forEachChangedItem(n=>this._toggleClass(n.key,n.currentValue)),t.forEachRemovedItem(n=>{n.previousValue&&this._toggleClass(n.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(n=>{if("string"!=typeof n.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${(0,c.AaK)(n.item)}`);this._toggleClass(n.item,!0)}),t.forEachRemovedItem(n=>this._toggleClass(n.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(n=>this._toggleClass(n,!0)):Object.keys(t).forEach(n=>this._toggleClass(n,!!t[n])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(n=>this._toggleClass(n,!1)):Object.keys(t).forEach(n=>this._toggleClass(n,!1)))}_toggleClass(t,n){(t=t.trim())&&t.split(/\s+/g).forEach(r=>{n?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.ZZ4),c.Y36(c.aQg),c.Y36(c.SBq),c.Y36(c.Qsj))},i.\u0275dir=c.lG2({type:i,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),i})();class bl{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let xr=(()=>{class i{constructor(t,n,r){this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const n=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)n.createEmbeddedView(this._template,new bl(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)n.remove(null===s?void 0:s);else if(null!==s){const a=n.get(s);n.move(a,o),Fd(a,r)}});for(let r=0,s=n.length;r<s;r++){const a=n.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{Fd(n.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.s_b),c.Y36(c.Rgc),c.Y36(c.ZZ4))},i.\u0275dir=c.lG2({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),i})();function Fd(i,e){i.context.$implicit=e.item}let qr=(()=>{class i{constructor(t,n){this._viewContainer=t,this._context=new Sc,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Ld("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Ld("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.s_b),c.Y36(c.Rgc))},i.\u0275dir=c.lG2({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),i})();class Sc{constructor(){this.$implicit=null,this.ngIf=null}}function Ld(i,e){if(e&&!e.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${(0,c.AaK)(e)}'.`)}class Cc{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let Wo=(()=>{class i{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)}_matchCase(t){const n=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||n,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),n}_updateDefaultCases(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(let n=0;n<this._defaultViews.length;n++)this._defaultViews[n].enforceState(t)}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=c.lG2({type:i,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),i})(),rp=(()=>{class i{constructor(t,n,r){this.ngSwitch=r,r._addCase(),this._view=new Cc(t,n)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.s_b),c.Y36(c.Rgc),c.Y36(Wo,9))},i.\u0275dir=c.lG2({type:i,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),i})(),Wa=(()=>{class i{constructor(t,n,r){this._ngEl=t,this._differs=n,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,n){const[r,s]=t.split("."),o=-1===r.indexOf("-")?void 0:c.JOm.DashCase;null!=n?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${n}${s}`:n,o):this._renderer.removeStyle(this._ngEl.nativeElement,r,o)}_applyChanges(t){t.forEachRemovedItem(n=>this._setStyle(n.key,null)),t.forEachAddedItem(n=>this._setStyle(n.key,n.currentValue)),t.forEachChangedItem(n=>this._setStyle(n.key,n.currentValue))}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(c.aQg),c.Y36(c.Qsj))},i.\u0275dir=c.lG2({type:i,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),i})();class xl{createSubscription(e,t){return e.subscribe({next:t,error:n=>{throw n}})}dispose(e){e.unsubscribe()}}class Cb{createSubscription(e,t){return e.then(t,n=>{throw n})}dispose(e){}}const $m=new Cb,Eb=new xl;let Tu=(()=>{class i{constructor(t){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,n=>this._updateLatestValue(t,n))}_selectStrategy(t){if((0,c.QGY)(t))return $m;if((0,c.F4k)(t))return Eb;throw function qa(i,e){return new c.vHH(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,n){t===this._obj&&(this._latestValue=n,this._ref.markForCheck())}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.sBO,16))},i.\u0275pipe=c.Yjl({name:"async",type:i,pure:!1,standalone:!0}),i})(),or=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({}),i})();const da="browser";function Kl(i){return i===da}function ar(i){return"server"===i}let qo=(()=>{class i{}return i.\u0275prov=(0,c.Yz7)({token:i,providedIn:"root",factory:()=>new Ac((0,c.LFG)(Oe),window)}),i})();class Ac{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function Za(i,e){const t=i.getElementById(e)||i.getElementsByName(e)[0];if(t)return t;if("function"==typeof i.createTreeWalker&&i.body&&(i.body.createShadowRoot||i.body.attachShadow)){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=Xl(this.window.history)||Xl(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Xl(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class Eu extends class $l extends class Tt{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function st(i){J||(J=i)}(new Eu)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Eh(){return Mo=Mo||document.querySelector("base"),Mo?Mo.getAttribute("href"):null}();return null==t?null:function ri(i){Ya=Ya||document.createElement("a"),Ya.setAttribute("href",i);const e=Ya.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Mo=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function ip(i,e){e=encodeURIComponent(e);for(const t of i.split(";")){const n=t.indexOf("="),[r,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let Ya,Mo=null;const Ur=new c.OlP("TRANSITION_ID"),Ah=[{provide:c.ip1,useFactory:function gv(i,e,t){return()=>{t.get(c.CZH).donePromise.then(()=>{const n=je(),r=e.querySelectorAll(`style[ng-transition="${i}"]`);for(let s=0;s<r.length;s++)n.remove(r[s])})}},deps:[Ur,Oe,c.zs3],multi:!0}];let Dh=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})();const Au=new c.OlP("EventManagerPlugins");let Ql=(()=>{class i{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,n,r){return this._findPluginFor(n).addEventListener(t,n,r)}addGlobalEventListener(t,n,r){return this._findPluginFor(n).addGlobalEventListener(t,n,r)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Au),c.LFG(c.R0b))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})();class jd{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=je().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}let Pt=(()=>{class i{constructor(){this._stylesSet=new Set}addStyles(t){const n=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),n.add(r))}),this.onStylesAdded(n)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})(),mi=(()=>{class i extends Pt{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,n,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(n.appendChild(o))})}addHost(t){const n=[];this._addStylesToHost(this._stylesSet,t,n),this._hostNodes.set(t,n)}removeHost(t){const n=this._hostNodes.get(t);n&&n.forEach(Du),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((n,r)=>{this._addStylesToHost(t,r,n)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(Du))}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Oe))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})();function Du(i){je().remove(i)}const Rc={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Vr=/%COMP%/g;function Jl(i,e,t){for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?Jl(i,r,t):(r=r.replace(Vr,i),t.push(r))}return t}function _v(i){return e=>{if("__ngUnwrap__"===e)return i;!1===i(e)&&(e.preventDefault(),e.returnValue=!1)}}let vs=(()=>{class i{constructor(t,n,r){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new Co(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;switch(n.encapsulation){case c.ifc.Emulated:{let r=this.rendererByCompId.get(n.id);return r||(r=new vv(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,r)),r.applyToHost(t),r}case 1:case c.ifc.ShadowDom:return new cp(this.eventManager,this.sharedStylesHost,t,n);default:if(!this.rendererByCompId.has(n.id)){const r=Jl(n.id,n.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Ql),c.LFG(mi),c.LFG(c.AFp))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})();class Co{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Rc[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(pa(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(pa(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const s=Rc[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=Rc[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(c.JOm.DashCase|c.JOm.Important)?e.style.setProperty(t,n,r&c.JOm.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&c.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,_v(n)):this.eventManager.addEventListener(e,t,_v(n))}}function pa(i){return"TEMPLATE"===i.tagName&&void 0!==i.content}class vv extends Co{constructor(e,t,n,r){super(e),this.component=n;const s=Jl(r+"-"+n.id,n.styles,[]);t.addStyles(s),this.contentAttr=function Fc(i){return"_ngcontent-%COMP%".replace(Vr,i)}(r+"-"+n.id),this.hostAttr=function ng(i){return"_nghost-%COMP%".replace(Vr,i)}(r+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class cp extends Co{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Jl(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let up=(()=>{class i extends jd{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r){return t.addEventListener(n,r,!1),()=>this.removeEventListener(t,n,r)}removeEventListener(t,n,r){return t.removeEventListener(n,r)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Oe))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})();const Ud=["alt","control","meta","shift"],Vd={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},kc={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},hp={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let Ih=(()=>{class i extends jd{constructor(t){super(t)}supports(t){return null!=i.parseEventName(t)}addEventListener(t,n,r){const s=i.parseEventName(n),o=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>je().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const s=i._normalizeKey(n.pop());let o="";if(Ud.forEach(l=>{const h=n.indexOf(l);h>-1&&(n.splice(h,1),o+=l+".")}),o+=s,0!=n.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let n="",r=function rg(i){let e=i.key;if(null==e){if(e=i.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===i.location&&kc.hasOwnProperty(e)&&(e=kc[e]))}return Vd[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),Ud.forEach(s=>{s!=r&&(0,hp[s])(t)&&(n+=s+".")}),n+=r,n}static eventCallback(t,n,r){return s=>{i.getEventFullKey(s)===t&&r.runGuarded(()=>n(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Oe))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})();const Gd=(0,c.eFA)(c._c5,"browser",[{provide:c.Lbi,useValue:da},{provide:c.g9A,useValue:function og(){Eu.makeCurrent()},multi:!0},{provide:Oe,useFactory:function dp(){return(0,c.RDi)(document),document},deps:[]}]),ss=new c.OlP(""),Ka=[{provide:c.rWj,useClass:class tg{addToWindow(e){c.dqk.getAngularTestability=(n,r=!0)=>{const s=e.findTestabilityInTree(n,r);if(null==s)throw new Error("Could not find testability for element.");return s},c.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),c.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),c.dqk.frameworkStabilizers||(c.dqk.frameworkStabilizers=[]),c.dqk.frameworkStabilizers.push(n=>{const r=c.dqk.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&n(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?je().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:c.lri,useClass:c.dDg,deps:[c.R0b,c.eoX,c.rWj]},{provide:c.dDg,useClass:c.dDg,deps:[c.R0b,c.eoX,c.rWj]}],nr=[{provide:c.zSh,useValue:"root"},{provide:c.qLn,useFactory:function Ru(){return new c.qLn},deps:[]},{provide:Au,useClass:up,multi:!0,deps:[Oe,c.R0b,c.Lbi]},{provide:Au,useClass:Ih,multi:!0,deps:[Oe]},{provide:vs,useClass:vs,deps:[Ql,mi,c.AFp]},{provide:c.FYo,useExisting:vs},{provide:Pt,useExisting:mi},{provide:mi,useClass:mi,deps:[Oe]},{provide:Ql,useClass:Ql,deps:[Au,c.R0b]},{provide:class Dc{},useClass:Dh,deps:[]},[]];let zd=(()=>{class i{constructor(t){}static withServerTransition(t){return{ngModule:i,providers:[{provide:c.AFp,useValue:t.appId},{provide:Ur,useExisting:c.AFp},Ah]}}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(ss,12))},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({providers:[...nr,...Ka],imports:[or,c.hGG]}),i})(),Hd=(()=>{class i{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Oe))},i.\u0275prov=c.Yz7({token:i,factory:function(t){let n=null;return n=t?new t:function yv(){return new Hd((0,c.LFG)(Oe))}(),n},providedIn:"root"}),i})();typeof window<"u"&&window;let Ml=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:function(t){let n=null;return n=t?new(t||i):c.LFG(Zd),n},providedIn:"root"}),i})(),Zd=(()=>{class i extends Ml{constructor(t){super(),this._doc=t}sanitize(t,n){if(null==n)return null;switch(t){case c.q3G.NONE:return n;case c.q3G.HTML:return(0,c.qzn)(n,"HTML")?(0,c.z3N)(n):(0,c.EiD)(this._doc,String(n)).toString();case c.q3G.STYLE:return(0,c.qzn)(n,"Style")?(0,c.z3N)(n):n;case c.q3G.SCRIPT:if((0,c.qzn)(n,"Script"))return(0,c.z3N)(n);throw new Error("unsafe value used in a script context");case c.q3G.URL:return(0,c.qzn)(n,"URL")?(0,c.z3N)(n):(0,c.mCW)(String(n));case c.q3G.RESOURCE_URL:if((0,c.qzn)(n,"ResourceURL"))return(0,c.z3N)(n);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return(0,c.JVY)(t)}bypassSecurityTrustStyle(t){return(0,c.L6k)(t)}bypassSecurityTrustScript(t){return(0,c.eBb)(t)}bypassSecurityTrustUrl(t){return(0,c.LAX)(t)}bypassSecurityTrustResourceUrl(t){return(0,c.pB0)(t)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Oe))},i.\u0275prov=c.Yz7({token:i,factory:function(t){let n=null;return n=t?new t:function Pb(i){return new Zd(i.get(Oe))}(c.LFG(c.zs3)),n},providedIn:"root"}),i})();var dr=se(8996),Pi=se(3269);function Tn(...i){const e=(0,Pi.yG)(i);return(0,dr.D)(i,e)}var Bn=se(7579);class Ks extends Bn.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}const jc=(0,se(3888).d)(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});var bs=se(9751);const{isArray:hg}=Array,{getPrototypeOf:Yd,prototype:Nh,keys:Bh}=Object;function Uc(i){if(1===i.length){const e=i[0];if(hg(e))return{args:e,keys:null};if(function Fu(i){return i&&"object"==typeof i&&Yd(i)===Nh}(e)){const t=Bh(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}var tc=se(4671),Sn=se(4004);const{isArray:dg}=Array;function Kd(i){return(0,Sn.U)(e=>function Lu(i,e){return dg(e)?i(...e):i(e)}(i,e))}function Da(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}var Tr=se(5403),vp=se(9672);function Ou(...i){const e=(0,Pi.yG)(i),t=(0,Pi.jO)(i),{args:n,keys:r}=Uc(i);if(0===n.length)return(0,dr.D)([],e);const s=new bs.y(function Fb(i,e,t=tc.y){return n=>{ku(e,()=>{const{length:r}=i,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)ku(e,()=>{const h=(0,dr.D)(i[l],e);let f=!1;h.subscribe((0,Tr.x)(n,m=>{s[l]=m,f||(f=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}(n,e,r?o=>Da(r,o):tc.y));return t?s.pipe(Kd(t)):s}function ku(i,e,t){i?(0,vp.f)(t,i,e):e()}var Vc=se(8189);function $a(...i){return function nc(){return(0,Vc.J)(1)}()((0,dr.D)(i,(0,Pi.yG)(i)))}var Fr=se(8421);function Nu(i){return new bs.y(e=>{(0,Fr.Xf)(i()).subscribe(e)})}var jh=se(9635),os=se(576);function Bu(i,e){const t=(0,os.m)(i)?i:()=>i,n=r=>r.error(t());return new bs.y(e?r=>e.schedule(n,0,r):n)}var Sl=se(515),ei=se(727),Zr=se(4482);function Cv(){return(0,Zr.e)((i,e)=>{let t=null;i._refCount++;const n=(0,Tr.x)(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(t=null);const r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}class Ev extends bs.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,Zr.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new ei.w0;const t=this.getSubject();e.add(this.source.subscribe((0,Tr.x)(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=ei.w0.EMPTY)}return e}refCount(){return Cv()(this)}}function Gr(i,e){return(0,Zr.e)((t,n)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&n.complete();t.subscribe((0,Tr.x)(n,l=>{r?.unsubscribe();let h=0;const f=s++;(0,Fr.Xf)(i(l,f)).subscribe(r=(0,Tr.x)(n,m=>n.next(e?e(l,m,f,h++):m),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Ns(i){return i<=0?()=>Sl.E:(0,Zr.e)((e,t)=>{let n=0;e.subscribe((0,Tr.x)(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function ma(...i){const e=(0,Pi.yG)(i);return(0,Zr.e)((t,n)=>{(e?$a(i,t,e):$a(i,t)).subscribe(n)})}function fr(i,e){return(0,Zr.e)((t,n)=>{let r=0;t.subscribe((0,Tr.x)(n,s=>i.call(e,s,r++)&&n.next(s)))})}var Ar=se(5577);function fg(i){return(0,Zr.e)((e,t)=>{let n=!1;e.subscribe((0,Tr.x)(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function Av(i=xs){return(0,Zr.e)((e,t)=>{let n=!1;e.subscribe((0,Tr.x)(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function xs(){return new jc}function Qa(i,e){const t=arguments.length>=2;return n=>n.pipe(i?fr((r,s)=>i(r,s,n)):tc.y,Ns(1),t?fg(e):Av(()=>new jc))}function Ra(i,e){return(0,os.m)(e)?(0,Ar.z)(i,e,1):(0,Ar.z)(i,1)}var Lr=se(8505);function ic(i){return(0,Zr.e)((e,t)=>{let s,n=null,r=!1;n=e.subscribe((0,Tr.x)(t,void 0,void 0,o=>{s=(0,Fr.Xf)(i(o,ic(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function Xs(i,e,t,n,r){return(s,o)=>{let a=t,l=e,h=0;s.subscribe((0,Tr.x)(o,f=>{const m=h++;l=a?i(l,f,m):(a=!0,f),n&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function Eo(i,e){return(0,Zr.e)(Xs(i,e,arguments.length>=2,!0))}function ju(i){return i<=0?()=>Sl.E:(0,Zr.e)((e,t)=>{let n=[];e.subscribe((0,Tr.x)(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(const r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}function Uh(i,e){const t=arguments.length>=2;return n=>n.pipe(i?fr((r,s)=>i(r,s,n)):tc.y,ju(1),t?fg(e):Av(()=>new jc))}function Uu(i){return(0,Sn.U)(()=>i)}function Vu(i){return(0,Zr.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}const Ti="primary";class Dv{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Vh(i){return new Dv(i)}function Cl(i,e,t){const n=t.path.split("/");if(n.length>i.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<i.length))return null;const r={};for(let s=0;s<n.length;s++){const o=n[s],a=i[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function Zo(i,e){const t=i?Object.keys(i):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!rc(i[r],e[r]))return!1;return!0}function rc(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;const t=[...i].sort(),n=[...e].sort();return t.every((r,s)=>n[s]===r)}return i===e}function Rv(i){return Array.prototype.concat.apply([],i)}function zc(i){return i.length>0?i[i.length-1]:null}function as(i,e){for(const t in i)i.hasOwnProperty(t)&&e(i[t],t)}function Ia(i){return(0,c.CqO)(i)?i:(0,c.QGY)(i)?(0,dr.D)(Promise.resolve(i)):Tn(i)}const Gh={exact:function zu(i,e,t){if(!qc(i.segments,e.segments)||!Hu(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!i.children[n]||!zu(i.children[n],e.children[n],t))return!1;return!0},subset:Ja},xp={exact:function Iv(i,e){return Zo(i,e)},subset:function Wc(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>rc(i[t],e[t]))},ignored:()=>!0};function Gu(i,e,t){return Gh[t.paths](i.root,e.root,t.matrixParams)&&xp[t.queryParams](i.queryParams,e.queryParams)&&!("exact"===t.fragment&&i.fragment!==e.fragment)}function Ja(i,e,t){return Tp(i,e,e.segments,t)}function Tp(i,e,t,n){if(i.segments.length>t.length){const r=i.segments.slice(0,t.length);return!(!qc(r,t)||e.hasChildren()||!Hu(r,t,n))}if(i.segments.length===t.length){if(!qc(i.segments,t)||!Hu(i.segments,t,n))return!1;for(const r in e.children)if(!i.children[r]||!Ja(i.children[r],e.children[r],n))return!1;return!0}{const r=t.slice(0,i.segments.length),s=t.slice(i.segments.length);return!!(qc(i.segments,r)&&Hu(i.segments,r,n)&&i.children[Ti])&&Tp(i.children[Ti],e,s,n)}}function Hu(i,e,t){return e.every((n,r)=>xp[t](i[r].parameters,n.parameters))}class El{constructor(e,t,n){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Vh(this.queryParams)),this._queryParamMap}toString(){return zh.serialize(this)}}class oi{constructor(e,t){this.segments=e,this.children=t,this.parent=null,as(t,(n,r)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return sc(this)}}class Al{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Vh(this.parameters)),this._parameterMap}toString(){return ln(this)}}function qc(i,e){return i.length===e.length&&i.every((t,n)=>t.path===e[n].path)}let Xd=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:function(){return new $d},providedIn:"root"}),i})();class $d{parse(e){const t=new Zc(e);return new El(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${j(e.root,!0)}`,n=function ai(i){const e=Object.keys(i).map(t=>{const n=i[t];return Array.isArray(n)?n.map(r=>`${Y(t)}=${Y(r)}`).join("&"):`${Y(t)}=${Y(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function pe(i){return encodeURI(i)}(e.fragment)}`:""}`}}const zh=new $d;function sc(i){return i.segments.map(e=>ln(e)).join("/")}function j(i,e){if(!i.hasChildren())return sc(i);if(e){const t=i.children[Ti]?j(i.children[Ti],!1):"",n=[];return as(i.children,(r,s)=>{s!==Ti&&n.push(`${s}:${j(r,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function Yr(i,e){let t=[];return as(i.children,(n,r)=>{r===Ti&&(t=t.concat(e(n,r)))}),as(i.children,(n,r)=>{r!==Ti&&(t=t.concat(e(n,r)))}),t}(i,(n,r)=>r===Ti?[j(i.children[Ti],!1)]:[`${r}:${j(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[Ti]?`${sc(i)}/${t[0]}`:`${sc(i)}/(${t.join("//")})`}}function V(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Y(i){return V(i).replace(/%3B/gi,";")}function Fe(i){return V(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ye(i){return decodeURIComponent(i)}function Rt(i){return Ye(i.replace(/\+/g,"%20"))}function ln(i){return`${Fe(i.path)}${function qn(i){return Object.keys(i).map(e=>`;${Fe(e)}=${Fe(i[e])}`).join("")}(i.parameters)}`}const hi=/^[^\/()?;=#]+/;function Hn(i){const e=i.match(hi);return e?e[0]:""}const Bs=/^[^=?&#]+/,el=/^[^&#]+/;class Zc{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new oi([],{}):new oi([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[Ti]=new oi(e,t)),n}parseSegment(){const e=Hn(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new c.vHH(4009,!1);return this.capture(e),new Al(Ye(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=Hn(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const r=Hn(this.remaining);r&&(n=r,this.capture(n))}e[Ye(t)]=Ye(n)}parseQueryParam(e){const t=function Ao(i){const e=i.match(Bs);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const o=function Dl(i){const e=i.match(el);return e?e[0]:""}(this.remaining);o&&(n=o,this.capture(n))}const r=Rt(t),s=Rt(n);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=Hn(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new c.vHH(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Ti);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[Ti]:new oi([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new c.vHH(4011,!1)}}function Qd(i){return i.segments.length>0?new oi([],{[Ti]:i}):i}function Yc(i){const e={};for(const n of Object.keys(i.children)){const s=Yc(i.children[n]);(s.segments.length>0||s.hasChildren())&&(e[n]=s)}return function Hh(i){if(1===i.numberOfChildren&&i.children[Ti]){const e=i.children[Ti];return new oi(i.segments.concat(e.segments),e.children)}return i}(new oi(i.segments,e))}function ga(i){return i instanceof El}function Lb(i,e,t,n,r){if(0===t.length)return Mp(e.root,e.root,e.root,n,r);const s=function pg(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new iM(!0,0,i);let e=0,t=!1;const n=i.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return as(s.outlets,(l,h)=>{a[h]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new iM(t,e,n)}(t);return s.toRoot()?Mp(e.root,e.root,new oi([],{}),n,r):function o(l){const h=function mg(i,e,t,n){if(i.isAbsolute)return new ef(e.root,!0,0);if(-1===n)return new ef(t,t===e.root,0);return function tf(i,e,t){let n=i,r=e,s=t;for(;s>r;){if(s-=r,n=n.parent,!n)throw new c.vHH(4005,!1);r=n.segments.length}return new ef(n,!1,r-s)}(t,n+(Wu(i.commands[0])?0:1),i.numberOfDoubleDots)}(s,e,i.snapshot?._urlSegment,l),f=h.processChildren?Sp(h.segmentGroup,h.index,s.commands):Lv(h.segmentGroup,h.index,s.commands);return Mp(e.root,h.segmentGroup,f,n,r)}(i.snapshot?._lastPathIndex)}function Wu(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function Jd(i){return"object"==typeof i&&null!=i&&i.outlets}function Mp(i,e,t,n,r){let o,s={};n&&as(n,(l,h)=>{s[h]=Array.isArray(l)?l.map(f=>`${f}`):`${l}`}),o=i===e?t:Fv(i,e,t);const a=Qd(Yc(o));return new El(a,s,r)}function Fv(i,e,t){const n={};return as(i.children,(r,s)=>{n[s]=r===e?t:Fv(r,e,t)}),new oi(i.segments,n)}class iM{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&Wu(n[0]))throw new c.vHH(4003,!1);const r=n.find(Jd);if(r&&r!==zc(n))throw new c.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ef{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function Lv(i,e,t){if(i||(i=new oi([],{})),0===i.segments.length&&i.hasChildren())return Sp(i,e,t);const n=function p1(i,e,t){let n=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return s;const o=i.segments[r],a=t[n];if(Jd(a))break;const l=`${a}`,h=n<t.length-1?t[n+1]:null;if(r>0&&void 0===l)break;if(l&&h&&"object"==typeof h&&void 0===h.outlets){if(!kv(l,h,o))return s;n+=2}else{if(!kv(l,{},o))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const s=new oi(i.segments.slice(0,n.pathIndex),{});return s.children[Ti]=new oi(i.segments.slice(n.pathIndex),i.children),Sp(s,0,r)}return n.match&&0===r.length?new oi(i.segments,{}):n.match&&!i.hasChildren()?rf(i,e,t):n.match?Sp(i,0,r):rf(i,e,t)}function Sp(i,e,t){if(0===t.length)return new oi(i.segments,{});{const n=function nf(i){return Jd(i[0])?i[0].outlets:{[Ti]:i}}(t),r={};return as(n,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=Lv(i.children[o],e,s))}),as(i.children,(s,o)=>{void 0===n[o]&&(r[o]=s)}),new oi(i.segments,r)}}function rf(i,e,t){const n=i.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(Jd(s)){const l=gg(s.outlets);return new oi(n,l)}if(0===r&&Wu(t[0])){n.push(new Al(i.segments[e].path,Ov(t[0]))),r++;continue}const o=Jd(s)?s.outlets[Ti]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&Wu(a)?(n.push(new Al(o,Ov(a))),r+=2):(n.push(new Al(o,{})),r++)}return new oi(n,{})}function gg(i){const e={};return as(i,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=rf(new oi([],{}),0,t))}),e}function Ov(i){const e={};return as(i,(t,n)=>e[n]=`${t}`),e}function kv(i,e,t){return i==t.path&&Zo(e,t.parameters)}class oc{constructor(e,t){this.id=e,this.url=t}}class Kc extends oc{constructor(e,t,n="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Xc extends oc{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class _g extends oc{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class vg extends oc{constructor(e,t,n,r){super(e,t),this.error=n,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class rM extends oc{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class kb extends oc{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $c extends oc{constructor(e,t,n,r,s){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class qu extends oc{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class sM extends oc{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Nb{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Bb{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class oM{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class aM{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class lM{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class cM{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class P{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class E{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=O(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=O(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=q(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return q(e,this._root).map(t=>t.value)}}function O(i,e){if(i===e.value)return e;for(const t of e.children){const n=O(i,t);if(n)return n}return null}function q(i,e){if(i===e.value)return[e];for(const t of e.children){const n=q(i,t);if(n.length)return n.unshift(e),n}return[]}class re{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Be(i){const e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}class Et extends E{constructor(e,t){super(e),this.snapshot=t,Nv(this,e)}toString(){return this.snapshot.toString()}}function cn(i,e){const t=function jn(i,e){const o=new ac([],{},{},"",{},Ti,e,null,i.root,-1,{});return new yg("",new re(o,[]))}(i,e),n=new Ks([new Al("",{})]),r=new Ks({}),s=new Ks({}),o=new Ks({}),a=new Ks(""),l=new di(n,r,o,a,s,Ti,e,t.root);return l.snapshot=t.root,new Et(new re(l,[]),t)}class di{constructor(e,t,n,r,s,o,a,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Sn.U)(e=>Vh(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Sn.U)(e=>Vh(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function wr(i,e="emptyOnly"){const t=i.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const r=t[n],s=t[n-1];if(r.routeConfig&&""===r.routeConfig.path)n--;else{if(s.component)break;n--}}return function Rl(i){return i.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(n))}class ac{constructor(e,t,n,r,s,o,a,l,h,f,m,g){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=h,this._lastPathIndex=f,this._correctedLastPathIndex=g??f,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Vh(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Vh(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class yg extends E{constructor(e,t){super(t),this.url=e,Nv(this,t)}toString(){return sf(this._root)}}function Nv(i,e){e.value._routerState=i,e.children.forEach(t=>Nv(i,t))}function sf(i){const e=i.children.length>0?` { ${i.children.map(sf).join(", ")} } `:"";return`${i.value}${e}`}function af(i){if(i.snapshot){const e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,Zo(e.queryParams,t.queryParams)||i.queryParams.next(t.queryParams),e.fragment!==t.fragment&&i.fragment.next(t.fragment),Zo(e.params,t.params)||i.params.next(t.params),function uo(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!Zo(i[t],e[t]))return!1;return!0}(e.url,t.url)||i.url.next(t.url),Zo(e.data,t.data)||i.data.next(t.data)}else i.snapshot=i._futureSnapshot,i.data.next(i._futureSnapshot.data)}function lf(i,e){const t=Zo(i.params,e.params)&&function Yo(i,e){return qc(i,e)&&i.every((t,n)=>Zo(t.parameters,e[n].parameters))}(i.url,e.url);return t&&!(!i.parent!=!e.parent)&&(!i.parent||lf(i.parent,e.parent))}function Cp(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const r=function Bv(i,e,t){return e.children.map(n=>{for(const r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return Cp(i,n,r);return Cp(i,n)})}(i,e,t);return new re(n,r)}{if(i.shouldAttach(e.value)){const s=i.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Cp(i,a)),o}}const n=function jv(i){return new di(new Ks(i.url),new Ks(i.params),new Ks(i.queryParams),new Ks(i.fragment),new Ks(i.data),i.outlet,i.component,i)}(e.value),r=e.children.map(s=>Cp(i,s));return new re(n,r)}}const bg="ngNavigationCancelingError";function Ub(i,e){const{redirectTo:t,navigationBehaviorOptions:n}=ga(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=xg(!1,0,e);return r.url=t,r.navigationBehaviorOptions=n,r}function xg(i,e,t){const n=new Error("NavigationCancelingError: "+(i||""));return n[bg]=!0,n.cancellationCode=e,t&&(n.url=t),n}function Uv(i){return Vv(i)&&ga(i.url)}function Vv(i){return i&&i[bg]}class m1{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Ep,this.attachRef=null}}let Ep=(()=>{class i{constructor(){this.contexts=new Map}onChildOutletCreated(t,n){const r=this.getOrCreateContext(t);r.outlet=n,this.contexts.set(t,r)}onChildOutletDestroyed(t){const n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new m1,this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Vb=!1;let ls=(()=>{class i{constructor(t,n,r,s,o){this.parentContexts=t,this.location=n,this.changeDetector=s,this.environmentInjector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new c.vpe,this.deactivateEvents=new c.vpe,this.attachEvents=new c.vpe,this.detachEvents=new c.vpe,this.name=r||Ti,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new c.vHH(4012,Vb);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new c.vHH(4012,Vb);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new c.vHH(4012,Vb);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new c.vHH(4013,Vb);this._activatedRoute=t;const r=this.location,o=t._futureSnapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new g1(t,a,r.injector);if(n&&function TO(i){return!!i.resolveComponentFactory}(n)){const h=n.resolveComponentFactory(o);this.activated=r.createComponent(h,r.length,l)}else this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:n??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(Ep),c.Y36(c.s_b),c.$8M("name"),c.Y36(c.sBO),c.Y36(c.lqb))},i.\u0275dir=c.lG2({type:i,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),i})();class g1{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===di?this.route:e===Ep?this.childContexts:this.parent.get(e,t)}}let Gb=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=c.Xpm({type:i,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,n){1&t&&c._UZ(0,"router-outlet")},dependencies:[ls],encapsulation:2}),i})();function uM(i,e){return i.providers&&!i._injector&&(i._injector=(0,c.MMx)(i.providers,e,`Route: ${i.path}`)),i._injector??e}function zv(i){const e=i.children&&i.children.map(zv),t=e?{...i,children:e}:{...i};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ti&&(t.component=Gb),t}function Il(i){return i.outlet||Ti}function dM(i,e){const t=i.filter(n=>Il(n)===e);return t.push(...i.filter(n=>Il(n)!==e)),t}function fM(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let e=i.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class _1{constructor(e,t,n,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),af(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const r=Be(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],n),delete r[o]}),as(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=Be(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(n&&n.outlet){const o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=Be(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(e,t,n){const r=Be(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new cM(s.value.snapshot))}),e.children.length&&this.forwardEvent(new aM(e.value.snapshot))}activateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(af(r),r===s)if(r.component){const o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){const o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),af(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=fM(r.snapshot),l=a?.get(c._Vd)??null;o.attachRef=null,o.route=r,o.resolver=l,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}class pM{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Tg{constructor(e,t){this.component=e,this.route=t}}function lz(i,e,t){const n=i._root;return Mg(n,e?e._root:null,t,[n.value])}function wg(i,e,t){return(fM(e)??t).get(i)}function Mg(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Be(e);return i.children.forEach(o=>{(function v1(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=i.value,o=e?e.value:null,a=t?t.getContext(i.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function Ap(i,e,t){if("function"==typeof t)return t(i,e);switch(t){case"pathParamsChange":return!qc(i.url,e.url);case"pathParamsOrQueryParamsChange":return!qc(i.url,e.url)||!Zo(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!lf(i,e)||!Zo(i.queryParams,e.queryParams);default:return!lf(i,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new pM(n)):(s.data=o.data,s._resolvedData=o._resolvedData),Mg(i,e,s.component?a?a.children:null:t,n,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Tg(a.outlet.component,o))}else o&&Hv(e,a,r),r.canActivateChecks.push(new pM(n)),Mg(i,null,s.component?a?a.children:null:t,n,r)})(o,s[o.value.outlet],t,n.concat([o.value]),r),delete s[o.value.outlet]}),as(s,(o,a)=>Hv(o,t.getContext(a),r)),r}function Hv(i,e,t){const n=Be(i),r=i.value;as(n,(s,o)=>{Hv(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new Tg(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function Dp(i){return"function"==typeof i}function gM(i){return i instanceof jc||"EmptyError"===i?.name}const Wv=Symbol("INITIAL_VALUE");function Qc(){return Gr(i=>Ou(i.map(e=>e.pipe(Ns(1),ma(Wv)))).pipe((0,Sn.U)(e=>{for(const t of e)if(!0!==t){if(t===Wv)return Wv;if(!1===t||t instanceof El)return t}return!0}),fr(e=>e!==Wv),Ns(1)))}function FO(i){return(0,jh.z)((0,Lr.b)(e=>{if(ga(e))throw Ub(0,e)}),(0,Sn.U)(e=>!0===e))}const Ip={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function w1(i,e,t,n,r){const s=cf(i,e,t);return s.matched?function LO(i,e,t,n){const r=e.canMatch;return r&&0!==r.length?Tn(r.map(o=>{const a=i.get(o),l=function y1(i){return i&&Dp(i.canMatch)}(a)?a.canMatch(e,t):a(e,t);return Ia(l)})).pipe(Qc(),FO()):Tn(!0)}(n=uM(e,n),e,t).pipe((0,Sn.U)(o=>!0===o?s:{...Ip})):Tn(s)}function cf(i,e,t){if(""===e.path)return"full"===e.pathMatch&&(i.hasChildren()||t.length>0)?{...Ip}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||Cl)(t,i,e);if(!r)return{...Ip};const s={};as(r.posParams,(a,l)=>{s[l]=a.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function uf(i,e,t,n,r="corrected"){if(t.length>0&&function M1(i,e,t){return t.some(n=>Wb(i,e,n)&&Il(n)!==Ti)}(i,t,n)){const o=new oi(e,function cz(i,e,t,n){const r={};r[Ti]=n,n._sourceSegment=i,n._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&Il(s)!==Ti){const o=new oi([],{});o._sourceSegment=i,o._segmentIndexShift=e.length,r[Il(s)]=o}return r}(i,e,n,new oi(t,i.children)));return o._sourceSegment=i,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:[]}}if(0===t.length&&function kO(i,e,t){return t.some(n=>Wb(i,e,n))}(i,t,n)){const o=new oi(i.segments,function OO(i,e,t,n,r,s){const o={};for(const a of n)if(Wb(i,t,a)&&!r[Il(a)]){const l=new oi([],{});l._sourceSegment=i,l._segmentIndexShift="legacy"===s?i.segments.length:e.length,o[Il(a)]=l}return{...r,...o}}(i,e,t,n,i.children,r));return o._sourceSegment=i,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:t}}const s=new oi(i.segments,i.children);return s._sourceSegment=i,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}function Wb(i,e,t){return(!(i.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function S1(i,e,t,n){return!!(Il(i)===n||n!==Ti&&Wb(e,t,i))&&("**"===i.path||cf(e,i,t).matched)}function vM(i,e,t){return 0===e.length&&!i.children[t]}const qv=!1;class Sg{constructor(e){this.segmentGroup=e||null}}class C1{constructor(e){this.urlTree=e}}function Zv(i){return Bu(new Sg(i))}function qb(i){return Bu(new C1(i))}class dz{constructor(e,t,n,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=n,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=uf(this.urlTree.root,[],[],this.config).segmentGroup,t=new oi(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,Ti).pipe((0,Sn.U)(s=>this.createUrlTree(Yc(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(ic(s=>{if(s instanceof C1)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof Sg?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,Ti).pipe((0,Sn.U)(r=>this.createUrlTree(Yc(r),e.queryParams,e.fragment))).pipe(ic(r=>{throw r instanceof Sg?this.noMatchError(r):r}))}noMatchError(e){return new c.vHH(4002,qv)}createUrlTree(e,t,n){const r=Qd(e);return new El(r,t,n)}expandSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe((0,Sn.U)(s=>new oi([],s))):this.expandSegment(e,n,t,n.segments,r,!0)}expandChildren(e,t,n){const r=[];for(const s of Object.keys(n.children))"primary"===s?r.unshift(s):r.push(s);return(0,dr.D)(r).pipe(Ra(s=>{const o=n.children[s],a=dM(t,s);return this.expandSegmentGroup(e,a,o,s).pipe((0,Sn.U)(l=>({segment:l,outlet:s})))}),Eo((s,o)=>(s[o.outlet]=o.segment,s),{}),Uh())}expandSegment(e,t,n,r,s,o){return(0,dr.D)(n).pipe(Ra(a=>this.expandSegmentAgainstRoute(e,t,n,a,r,s,o).pipe(ic(h=>{if(h instanceof Sg)return Tn(null);throw h}))),Qa(a=>!!a),ic((a,l)=>{if(gM(a))return vM(t,r,s)?Tn(new oi([],{})):Zv(t);throw a}))}expandSegmentAgainstRoute(e,t,n,r,s,o,a){return S1(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o):Zv(t):Zv(t)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,r){const s=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?qb(s):this.lineralizeSegments(n,s).pipe((0,Ar.z)(o=>{const a=new oi(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:h,positionalParamSegments:f}=cf(t,r,s);if(!a)return Zv(t);const m=this.applyRedirectCommands(l,r.redirectTo,f);return r.redirectTo.startsWith("/")?qb(m):this.lineralizeSegments(r,m).pipe((0,Ar.z)(g=>this.expandSegment(e,t,n,g.concat(h),o,!1)))}matchSegmentAgainstRoute(e,t,n,r,s){return"**"===n.path?(e=uM(n,e),n.loadChildren?(n._loadedRoutes?Tn({routes:n._loadedRoutes,injector:n._loadedInjector}):this.configLoader.loadChildren(e,n)).pipe((0,Sn.U)(a=>(n._loadedRoutes=a.routes,n._loadedInjector=a.injector,new oi(r,{})))):Tn(new oi(r,{}))):w1(t,n,r,e).pipe(Gr(({matched:o,consumedSegments:a,remainingSegments:l})=>o?this.getChildConfig(e=n._injector??e,n,r).pipe((0,Ar.z)(f=>{const m=f.injector??e,g=f.routes,{segmentGroup:v,slicedSegments:y}=uf(t,a,l,g),b=new oi(v.segments,v.children);if(0===y.length&&b.hasChildren())return this.expandChildren(m,g,b).pipe((0,Sn.U)(R=>new oi(a,R)));if(0===g.length&&0===y.length)return Tn(new oi(a,{}));const T=Il(n)===s;return this.expandSegment(m,b,g,y,T?Ti:s,!0).pipe((0,Sn.U)(C=>new oi(a.concat(C.segments),C.children)))})):Zv(t)))}getChildConfig(e,t,n){return t.children?Tn({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Tn({routes:t._loadedRoutes,injector:t._loadedInjector}):function T1(i,e,t,n){const r=e.canLoad;return void 0===r||0===r.length?Tn(!0):Tn(r.map(o=>{const a=i.get(o),l=function SO(i){return i&&Dp(i.canLoad)}(a)?a.canLoad(e,t):a(e,t);return Ia(l)})).pipe(Qc(),FO())}(e,t,n).pipe((0,Ar.z)(r=>r?this.configLoader.loadChildren(e,t).pipe((0,Lr.b)(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function hz(i){return Bu(xg(qv,3))}())):Tn({routes:[],injector:e})}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Tn(n);if(r.numberOfChildren>1||!r.children[Ti])return Bu(new c.vHH(4e3,qv));r=r.children[Ti]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreateUrlTree(e,t,n,r){const s=this.createSegmentGroup(e,t.root,n,r);return new El(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return as(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);n[s]=t[a]}else n[s]=r}),n}createSegmentGroup(e,t,n,r){const s=this.createSegments(e,t.segments,n,r);let o={};return as(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,n,r)}),new oi(s,o)}createSegments(e,t,n,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,n))}findPosParam(e,t,n){const r=n[t.path.substring(1)];if(!r)throw new c.vHH(4001,qv);return r}findOrReturn(e,t){let n=0;for(const r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}}class pz{}class E1{constructor(e,t,n,r,s,o,a,l){this.injector=e,this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=a,this.urlSerializer=l}recognize(){const e=uf(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Ti).pipe((0,Sn.U)(t=>{if(null===t)return null;const n=new ac([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Ti,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new re(n,t),s=new yg(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(e){const t=e.value,n=wr(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,r)}processChildren(e,t,n){return(0,dr.D)(Object.keys(n.children)).pipe(Ra(r=>{const s=n.children[r],o=dM(t,r);return this.processSegmentGroup(e,o,s,r)}),Eo((r,s)=>r&&s?(r.push(...s),r):null),function Gc(i,e=!1){return(0,Zr.e)((t,n)=>{let r=0;t.subscribe((0,Tr.x)(n,s=>{const o=i(s,r++);(o||e)&&n.next(s),!o&&n.complete()}))})}(r=>null!==r),fg(null),Uh(),(0,Sn.U)(r=>{if(null===r)return null;const s=TM(r);return function xM(i){i.sort((e,t)=>e.value.outlet===Ti?-1:t.value.outlet===Ti?1:e.value.outlet.localeCompare(t.value.outlet))}(s),s}))}processSegment(e,t,n,r,s){return(0,dr.D)(t).pipe(Ra(o=>this.processSegmentAgainstRoute(o._injector??e,o,n,r,s)),Qa(o=>!!o),ic(o=>{if(gM(o))return vM(n,r,s)?Tn([]):Tn(null);throw o}))}processSegmentAgainstRoute(e,t,n,r,s){if(t.redirectTo||!S1(t,n,r,s))return Tn(null);let o;if("**"===t.path){const a=r.length>0?zc(r).parameters:{},l=Zb(n)+r.length;o=Tn({snapshot:new ac(r,a,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,I1(t),Il(t),t.component??t._loadedComponent??null,t,R1(n),l,P1(t),l),consumedSegments:[],remainingSegments:[]})}else o=w1(n,t,r,e).pipe((0,Sn.U)(({matched:a,consumedSegments:l,remainingSegments:h,parameters:f})=>{if(!a)return null;const m=Zb(n)+l.length;return{snapshot:new ac(l,f,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,I1(t),Il(t),t.component??t._loadedComponent??null,t,R1(n),m,P1(t),m),consumedSegments:l,remainingSegments:h}}));return o.pipe(Gr(a=>{if(null===a)return Tn(null);const{snapshot:l,consumedSegments:h,remainingSegments:f}=a;e=t._injector??e;const m=t._loadedInjector??e,g=function A1(i){return i.children?i.children:i.loadChildren?i._loadedRoutes:[]}(t),{segmentGroup:v,slicedSegments:y}=uf(n,h,f,g.filter(T=>void 0===T.redirectTo),this.relativeLinkResolution);if(0===y.length&&v.hasChildren())return this.processChildren(m,g,v).pipe((0,Sn.U)(T=>null===T?null:[new re(l,T)]));if(0===g.length&&0===y.length)return Tn([new re(l,[])]);const b=Il(t)===s;return this.processSegment(m,g,v,y,b?Ti:s).pipe((0,Sn.U)(T=>null===T?null:[new re(l,T)]))}))}}function D1(i){const e=i.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function TM(i){const e=[],t=new Set;for(const n of i){if(!D1(n)){e.push(n);continue}const r=e.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...n.children),t.add(r)):e.push(n)}for(const n of t){const r=TM(n.children);e.push(new re(n.value,r))}return e.filter(n=>!t.has(n))}function R1(i){let e=i;for(;e._sourceSegment;)e=e._sourceSegment;return e}function Zb(i){let e=i,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function I1(i){return i.data||{}}function P1(i){return i.resolve||{}}const Yb=Symbol("RouteTitle");function F1(i){return"string"==typeof i.title||null===i.title}function SM(i){return Gr(e=>{const t=i(e);return t?(0,dr.D)(t).pipe((0,Sn.U)(()=>e)):Tn(e)})}let L1=(()=>{class i{buildTitle(t){let n,r=t.root;for(;void 0!==r;)n=this.getResolvedTitleForRoute(r)??n,r=r.children.find(s=>s.outlet===Ti);return n}getResolvedTitleForRoute(t){return t.data[Yb]}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:function(){return(0,c.f3M)(CM)},providedIn:"root"}),i})(),CM=(()=>{class i extends L1{constructor(t){super(),this.title=t}updateTitle(t){const n=this.buildTitle(t);void 0!==n&&this.title.setTitle(n)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Hd))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class zO{}class EM extends class Pa{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const Yv=new c.OlP("",{providedIn:"root",factory:()=>({})}),Pp=new c.OlP("ROUTES");let Kv=(()=>{class i{constructor(t,n){this.injector=t,this.compiler=n,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Tn(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const n=Ia(t.loadComponent()).pipe((0,Lr.b)(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Vu(()=>{this.componentLoaders.delete(t)})),r=new Ev(n,()=>new Bn.x).pipe(Cv());return this.componentLoaders.set(t,r),r}loadChildren(t,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return Tn({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);const s=this.loadModuleFactoryOrRoutes(n.loadChildren).pipe((0,Sn.U)(a=>{this.onLoadEndListener&&this.onLoadEndListener(n);let l,h,f=!1;Array.isArray(a)?h=a:(l=a.create(t).injector,h=Rv(l.get(Pp,[],c.XFs.Self|c.XFs.Optional)));return{routes:h.map(zv),injector:l}}),Vu(()=>{this.childrenLoaders.delete(n)})),o=new Ev(s,()=>new Bn.x).pipe(Cv());return this.childrenLoaders.set(n,o),o}loadModuleFactoryOrRoutes(t){return Ia(t()).pipe((0,Ar.z)(n=>n instanceof c.YKP||Array.isArray(n)?Tn(n):(0,dr.D)(this.compiler.compileModuleAsync(n))))}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(c.zs3),c.LFG(c.Sil))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class HO{}class WO{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function qO(i){throw i}function k1(i,e,t){return e.parse("/")}const ZO={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},N1={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function B1(){const i=(0,c.f3M)(Xd),e=(0,c.f3M)(Ep),t=(0,c.f3M)(Dt),n=(0,c.f3M)(c.zs3),r=(0,c.f3M)(c.Sil),s=(0,c.f3M)(Pp,{optional:!0})??[],o=(0,c.f3M)(Yv,{optional:!0})??{},a=(0,c.f3M)(CM),l=(0,c.f3M)(L1,{optional:!0}),h=(0,c.f3M)(HO,{optional:!0}),f=(0,c.f3M)(zO,{optional:!0}),m=new Do(null,i,e,t,n,r,Rv(s));return h&&(m.urlHandlingStrategy=h),f&&(m.routeReuseStrategy=f),m.titleStrategy=l??a,function YO(i,e){i.errorHandler&&(e.errorHandler=i.errorHandler),i.malformedUriErrorHandler&&(e.malformedUriErrorHandler=i.malformedUriErrorHandler),i.onSameUrlNavigation&&(e.onSameUrlNavigation=i.onSameUrlNavigation),i.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=i.paramsInheritanceStrategy),i.relativeLinkResolution&&(e.relativeLinkResolution=i.relativeLinkResolution),i.urlUpdateStrategy&&(e.urlUpdateStrategy=i.urlUpdateStrategy),i.canceledNavigationResolution&&(e.canceledNavigationResolution=i.canceledNavigationResolution)}(o,m),m}let Do=(()=>{class i{constructor(t,n,r,s,o,a,l){this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=s,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Bn.x,this.errorHandler=qO,this.malformedUriErrorHandler=k1,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Tn(void 0),this.urlHandlingStrategy=new WO,this.routeReuseStrategy=new EM,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=o.get(Kv),this.configLoader.onLoadEndListener=g=>this.triggerEvent(new Bb(g)),this.configLoader.onLoadStartListener=g=>this.triggerEvent(new Nb(g)),this.ngModule=o.get(c.h0i),this.console=o.get(c.c2e);const m=o.get(c.R0b);this.isNgZoneEnabled=m instanceof c.R0b&&c.R0b.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function bp(){return new El(new oi([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=cn(this.currentUrlTree,this.rootComponentType),this.transitions=new Ks({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(t){const n=this.events;return t.pipe(fr(r=>0!==r.id),(0,Sn.U)(r=>({...r,extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Gr(r=>{let s=!1,o=!1;return Tn(r).pipe((0,Lr.b)(a=>{this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Gr(a=>{const l=this.browserUrlTree.toString(),h=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||h)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return j1(a.source)&&(this.browserUrlTree=a.extractedUrl),Tn(a).pipe(Gr(m=>{const g=this.transitions.getValue();return n.next(new Kc(m.id,this.serializeUrl(m.extractedUrl),m.source,m.restoredState)),g!==this.transitions.getValue()?Sl.E:Promise.resolve(m)}),function fz(i,e,t,n){return Gr(r=>function yM(i,e,t,n,r){return new dz(i,e,t,n,r).apply()}(i,e,t,r.extractedUrl,n).pipe((0,Sn.U)(s=>({...r,urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,Lr.b)(m=>{this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects},r.urlAfterRedirects=m.urlAfterRedirects}),function BO(i,e,t,n,r,s){return(0,Ar.z)(o=>function NO(i,e,t,n,r,s,o="emptyOnly",a="legacy"){return new E1(i,e,t,n,r,o,a,s).recognize().pipe(Gr(l=>null===l?function mz(i){return new bs.y(e=>e.error(i))}(new pz):Tn(l)))}(i,e,t,o.urlAfterRedirects,n.serialize(o.urlAfterRedirects),n,r,s).pipe((0,Sn.U)(a=>({...o,targetSnapshot:a}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,Lr.b)(m=>{if(r.targetSnapshot=m.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!m.extras.skipLocationChange){const v=this.urlHandlingStrategy.merge(m.urlAfterRedirects,m.rawUrl);this.setBrowserUrl(v,m)}this.browserUrlTree=m.urlAfterRedirects}const g=new rM(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);n.next(g)}));if(h&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:g,extractedUrl:v,source:y,restoredState:b,extras:T}=a,S=new Kc(g,this.serializeUrl(v),y,b);n.next(S);const C=cn(v,this.rootComponentType).snapshot;return Tn(r={...a,targetSnapshot:C,urlAfterRedirects:v,extras:{...T,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=a.rawUrl,a.resolve(null),Sl.E}),(0,Lr.b)(a=>{const l=new kb(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),(0,Sn.U)(a=>r={...a,guards:lz(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),function EO(i,e){return(0,Ar.z)(t=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Tn({...t,guardsResult:!0}):function AO(i,e,t,n){return(0,dr.D)(i).pipe((0,Ar.z)(r=>function PO(i,e,t,n,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Tn(s.map(a=>{const l=wg(a,e,r);return Ia(function Rp(i){return i&&Dp(i.canDeactivate)}(l)?l.canDeactivate(i,e,t,n):l(i,e,t,n)).pipe(Qa())})).pipe(Qc()):Tn(!0)}(r.component,r.route,t,e,n)),Qa(r=>!0!==r,!0))}(o,n,r,i).pipe((0,Ar.z)(a=>a&&function zb(i){return"boolean"==typeof i}(a)?function DO(i,e,t,n){return(0,dr.D)(e).pipe(Ra(r=>$a(function _M(i,e){return null!==i&&e&&e(new oM(i)),Tn(!0)}(r.route.parent,n),function RO(i,e){return null!==i&&e&&e(new lM(i)),Tn(!0)}(r.route,n),function x1(i,e,t){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function MO(i){const e=i.routeConfig?i.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:i,guards:e}:null}(o)).filter(o=>null!==o).map(o=>Nu(()=>Tn(o.guards.map(l=>{const h=wg(l,o.node,t);return Ia(function Hb(i){return i&&Dp(i.canActivateChild)}(h)?h.canActivateChild(n,i):h(n,i)).pipe(Qa())})).pipe(Qc())));return Tn(s).pipe(Qc())}(i,r.path,t),function IO(i,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return Tn(!0);const r=n.map(s=>Nu(()=>{const o=wg(s,e,t);return Ia(function mM(i){return i&&Dp(i.canActivate)}(o)?o.canActivate(e,i):o(e,i)).pipe(Qa())}));return Tn(r).pipe(Qc())}(i,r.route,t))),Qa(r=>!0!==r,!0))}(n,s,i,e):Tn(a)),(0,Sn.U)(a=>({...t,guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),(0,Lr.b)(a=>{if(r.guardsResult=a.guardsResult,ga(a.guardsResult))throw Ub(0,a.guardsResult);const l=new $c(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),fr(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,"",3),!1)),SM(a=>{if(a.guards.canActivateChecks.length)return Tn(a).pipe((0,Lr.b)(l=>{const h=new qu(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(h)}),Gr(l=>{let h=!1;return Tn(l).pipe(function jO(i,e){return(0,Ar.z)(t=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return Tn(t);let s=0;return(0,dr.D)(r).pipe(Ra(o=>function UO(i,e,t,n){const r=i.routeConfig,s=i._resolve;return void 0!==r?.title&&!F1(r)&&(s[Yb]=r.title),function VO(i,e,t,n){const r=function GO(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}(i);if(0===r.length)return Tn({});const s={};return(0,dr.D)(r).pipe((0,Ar.z)(o=>function MM(i,e,t,n){const r=wg(i,e,n);return Ia(r.resolve?r.resolve(e,t):r(e,t))}(i[o],e,t,n).pipe(Qa(),(0,Lr.b)(a=>{s[o]=a}))),ju(1),Uu(s),ic(o=>gM(o)?Sl.E:Bu(o)))}(s,i,e,n).pipe((0,Sn.U)(o=>(i._resolvedData=o,i.data=wr(i,t).resolve,r&&F1(r)&&(i.data[Yb]=r.title),null)))}(o.route,n,i,e)),(0,Lr.b)(()=>s++),ju(1),(0,Ar.z)(o=>s===r.length?Tn(t):Sl.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,Lr.b)({next:()=>h=!0,complete:()=>{h||(this.restoreHistory(l),this.cancelNavigationTransition(l,"",2))}}))}),(0,Lr.b)(l=>{const h=new sM(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(h)}))}),SM(a=>{const l=h=>{const f=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(h.routeConfig).pipe((0,Lr.b)(m=>{h.component=m}),(0,Sn.U)(()=>{})));for(const m of h.children)f.push(...l(m));return f};return Ou(l(a.targetSnapshot.root)).pipe(fg(),Ns(1))}),SM(()=>this.afterPreactivation()),(0,Sn.U)(a=>{const l=function jb(i,e,t){const n=Cp(i,e._root,t?t._root:void 0);return new Et(n,e)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return r={...a,targetRouterState:l}}),(0,Lr.b)(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((i,e,t)=>(0,Sn.U)(n=>(new _1(e,n.targetRouterState,n.currentRouterState,t).activate(i),n)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),(0,Lr.b)({next(){s=!0},complete(){s=!0}}),Vu(()=>{s||o||this.cancelNavigationTransition(r,"",1),this.currentNavigation?.id===r.id&&(this.currentNavigation=null)}),ic(a=>{if(o=!0,Vv(a)){Uv(a)||(this.navigated=!0,this.restoreHistory(r,!0));const l=new _g(r.id,this.serializeUrl(r.extractedUrl),a.message,a.cancellationCode);if(n.next(l),Uv(a)){const h=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),f={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||j1(r.source)};this.scheduleNavigation(h,"imperative",null,f,{resolve:r.resolve,reject:r.reject,promise:r.promise})}else r.resolve(!1)}else{this.restoreHistory(r,!0);const l=new vg(r.id,this.serializeUrl(r.extractedUrl),a,r.targetSnapshot??void 0);n.next(l);try{r.resolve(this.errorHandler(a))}catch(h){r.reject(h)}}return Sl.E}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next({...this.transitions.value,...t})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const n="popstate"===t.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{const r={replaceUrl:!0},s=t.state?.navigationId?t.state:null;if(s){const a={...s};delete a.navigationId,delete a.\u0275routerPageId,0!==Object.keys(a).length&&(r.state=a)}const o=this.parseUrl(t.url);this.scheduleNavigation(o,n,s,r)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){this.config=t.map(zv),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,n={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=n,h=r||this.routerState.root,f=l?this.currentUrlTree.fragment:o;let m=null;switch(a){case"merge":m={...this.currentUrlTree.queryParams,...s};break;case"preserve":m=this.currentUrlTree.queryParams;break;default:m=s||null}return null!==m&&(m=this.removeEmptyProps(m)),Lb(h,this.currentUrlTree,t,m,f??null)}navigateByUrl(t,n={skipLocationChange:!1}){const r=ga(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,n)}navigate(t,n={skipLocationChange:!1}){return function KO(i){for(let e=0;e<i.length;e++){if(null==i[e])throw new c.vHH(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let n;try{n=this.urlSerializer.parse(t)}catch(r){n=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return n}isActive(t,n){let r;if(r=!0===n?{...ZO}:!1===n?{...N1}:n,ga(t))return Gu(this.currentUrlTree,t,r);const s=this.parseUrl(t);return Gu(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((n,r)=>{const s=t[r];return null!=s&&(n[r]=s),n},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new Xc(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,n,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,h;o?(a=o.resolve,l=o.reject,h=o.promise):h=new Promise((g,v)=>{a=g,l=v});const f=++this.navigationId;let m;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),m=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):m=0,this.setTransition({id:f,targetPageId:m,source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(g=>Promise.reject(g))}setBrowserUrl(t,n){const r=this.urlSerializer.serialize(t),s={...n.extras.state,...this.generateNgRouterState(n.id,n.targetPageId)};this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,n=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===r?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===r&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,n,r){const s=new _g(t.id,this.serializeUrl(t.extractedUrl),n,r);this.triggerEvent(s),t.resolve(!1)}generateNgRouterState(t,n){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}}return i.\u0275fac=function(t){c.$Z()},i.\u0275prov=c.Yz7({token:i,factory:function(){return B1()},providedIn:"root"}),i})();function j1(i){return"imperative"!==i}class U1{}let DM=(()=>{class i{constructor(t,n,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(fr(t=>t instanceof Xc),Ra(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){const r=[];for(const s of n){s.providers&&!s._injector&&(s._injector=(0,c.MMx)(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent?r.push(this.preloadConfig(o,s)):(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return(0,dr.D)(r).pipe((0,Vc.J)())}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>{let r;r=n.loadChildren&&void 0===n.canLoad?this.loader.loadChildren(t,n):Tn(null);const s=r.pipe((0,Ar.z)(o=>null===o?Tn(void 0):(n._loadedRoutes=o.routes,n._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));if(n.loadComponent&&!n._loadedComponent){const o=this.loader.loadComponent(n);return(0,dr.D)([s,o]).pipe((0,Vc.J)())}return s})}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Do),c.LFG(c.Sil),c.LFG(c.lqb),c.LFG(U1),c.LFG(Kv))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})();const $O=new c.OlP("");let Zu=(()=>{class i{constructor(t,n,r={}){this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Kc?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Xc&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof P&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.router.triggerEvent(new P(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return i.\u0275fac=function(t){c.$Z()},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})();const G1=new c.OlP("ROUTER_FORROOT_GUARD"),RM=new c.OlP(""),QO=[Dt,{provide:Xd,useClass:$d},{provide:Do,useFactory:B1},Ep,{provide:di,useFactory:function $v(i){return i.routerState.root},deps:[Do]},Kv];function JO(){return new c.PXZ("Router",Do)}let IM=(()=>{class i{constructor(t){}static forRoot(t,n){return{ngModule:i,providers:[QO,[],Fp(t),{provide:G1,useFactory:_z,deps:[[Do,new c.FiY,new c.tp0]]},{provide:Yv,useValue:n||{}},n?.useHash?{provide:et,useClass:Nt}:{provide:et,useClass:_n},{provide:$O,useFactory:()=>{const i=(0,c.f3M)(Do),e=(0,c.f3M)(qo),t=(0,c.f3M)(Yv);return t.scrollOffset&&e.setOffset(t.scrollOffset),new Zu(i,e,t)}},n?.preloadingStrategy?rk(n.preloadingStrategy):[],{provide:c.PXZ,multi:!0,useFactory:JO},n?.initialNavigation?ek(n):[],[{provide:OM,useFactory:LM},{provide:c.tb,multi:!0,useExisting:OM}]]}}static forChild(t){return{ngModule:i,providers:[Fp(t)]}}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(G1,8))},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({}),i})();function _z(i){return"guarded"}function Fp(i){return[{provide:Pp,multi:!0,useValue:i}]}function LM(){const i=(0,c.f3M)(c.zs3);return e=>{const t=i.get(c.z2F);if(e!==t.components[0])return;const n=i.get(Do),r=i.get(H1);1===i.get(NM)&&n.initialNavigation(),i.get(RM,null,c.XFs.Optional)?.setUpPreloading(),i.get($O,null,c.XFs.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),r.next(),r.complete()}}const OM=new c.OlP("");function ek(i){return["disabled"===i.initialNavigation?[{provide:c.ip1,multi:!0,useFactory:()=>{const i=(0,c.f3M)(Do);return()=>{i.setUpLocationChangeListener()}}},{provide:NM,useValue:2}]:[],"enabledBlocking"===i.initialNavigation?[{provide:NM,useValue:0},{provide:c.ip1,multi:!0,deps:[c.zs3],useFactory:i=>{const e=i.get(Me,Promise.resolve(null));let t=!1;return()=>e.then(()=>new Promise(r=>{const s=i.get(Do),o=i.get(H1);(function n(r){i.get(Do).events.pipe(fr(o=>o instanceof Xc||o instanceof _g||o instanceof vg),(0,Sn.U)(o=>o instanceof Xc||o instanceof _g&&(0===o.code||1===o.code)&&null),fr(o=>null!==o),Ns(1)).subscribe(()=>{r()})})(()=>{r(!0),t=!0}),s.afterPreactivation=()=>(r(!0),t||o.closed?Tn(void 0):o),s.initialNavigation()}))}}]:[]]}const H1=new c.OlP("",{factory:()=>new Bn.x}),NM=new c.OlP("",{providedIn:"root",factory:()=>1});function rk(i){return[DM,{provide:RM,useExisting:DM},{provide:U1,useExisting:i}]}var nt=se(5861),pr=se(5813),Qv=se(5867);class W1{constructor(){return(0,Qv.C6)()}}se(6457);var Fi=se(2090),Jc=se(9681),Zh=se(1877),Ag=se(4859);class GM{constructor(){return(0,pr.vb)("auth")}}const qM=new Map,ZM={activated:!1,tokenObservers:[]},Kz={initialized:!1,enabled:!1};function $s(i){return qM.get(i)||ZM}function eu(i,e){qM.set(i,e)}function YM(){return Kz}class Rk{constructor(e,t,n,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,nt.Z)(function*(){t.stop();try{t.pending=new Fi.BH,yield function KM(i){return new Promise(e=>{setTimeout(e,i)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new Fi.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(n){t.retryPolicy(n)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const Xo=new Fi.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function Xb(i){if(!$s(i).activated)throw Xo.create("use-before-activation",{appName:i.name})}function nD(i,e){return Ig.apply(this,arguments)}function Ig(){return(Ig=(0,nt.Z)(function*({url:i,body:e},t){var n,r;const s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){const v=yield o.getHeartbeatsHeader();v&&(s["X-Firebase-Client"]=v)}const a={method:"POST",body:JSON.stringify(e),headers:s};let l,h;try{l=yield fetch(i,a)}catch(v){throw Xo.create("fetch-network-error",{originalErrorMessage:null===(n=v)||void 0===n?void 0:n.message})}if(200!==l.status)throw Xo.create("fetch-status-error",{httpStatus:l.status});try{h=yield l.json()}catch(v){throw Xo.create("fetch-parse-error",{originalErrorMessage:null===(r=v)||void 0===r?void 0:r.message})}const f=h.ttl.match(/^([\d.]+)(s)$/);if(!f||!f[2]||isNaN(Number(f[1])))throw Xo.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});const m=1e3*Number(f[1]),g=Date.now();return{token:h.token,expireTimeMillis:g+m,issuedAtTimeMillis:g}})).apply(this,arguments)}function $M(i,e){const{projectId:t,appId:n,apiKey:r}=i.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${t}/apps/${n}:exchangeDebugToken?key=${r}`,body:{debug_token:e}}}const ny="firebase-app-check-store";let Qb=null;function rD(){return Qb||(Qb=new Promise((i,e)=>{var t;try{const n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=r=>{i(r.target.result)},n.onerror=r=>{var s;e(Xo.create("storage-open",{originalErrorMessage:null===(s=r.target.error)||void 0===s?void 0:s.message}))},n.onupgradeneeded=r=>{0===r.oldVersion&&r.target.result.createObjectStore(ny,{keyPath:"compositeKey"})}}catch(n){e(Xo.create("storage-open",{originalErrorMessage:null===(t=n)||void 0===t?void 0:t.message}))}}),Qb)}function Jb(){return(Jb=(0,nt.Z)(function*(i,e){const n=(yield rD()).transaction(ny,"readwrite"),s=n.objectStore(ny).put({compositeKey:i,value:e});return new Promise((o,a)=>{s.onsuccess=l=>{o()},n.onerror=l=>{var h;a(Xo.create("storage-set",{originalErrorMessage:null===(h=l.target.error)||void 0===h?void 0:h.message}))}})})).apply(this,arguments)}const ex=new Zh.Yd("@firebase/app-check");function Fk(i,e){return(0,Fi.hl)()?function $z(i,e){return function JM(i,e){return Jb.apply(this,arguments)}(function Pk(i){return`${i.options.appId}-${i.name}`}(i),e)}(i,e).catch(t=>{ex.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Lk(){return YM().enabled}function Ok(){return cD.apply(this,arguments)}function cD(){return(cD=(0,nt.Z)(function*(){const i=YM();if(i.enabled&&i.token)return i.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const eS={error:"UNKNOWN_ERROR"};function kk(i){return Fi.US.encodeString(JSON.stringify(i),!1)}function ry(i){return sy.apply(this,arguments)}function sy(){return(sy=(0,nt.Z)(function*(i,e=!1){const t=i.app;Xb(t);const n=$s(t);let s,r=n.token;if(!r){const l=yield n.cachedTokenPromise;l&&nx(l)&&(r=l)}if(!e&&r&&nx(r))return{token:r.token};let a,o=!1;if(Lk()){n.exchangeTokenPromise||(n.exchangeTokenPromise=nD($M(t,yield Ok()),i.heartbeatServiceProvider).then(h=>(n.exchangeTokenPromise=void 0,h)),o=!0);const l=yield n.exchangeTokenPromise;return yield Fk(t,l),eu(t,Object.assign(Object.assign({},n),{token:l})),{token:l.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().then(l=>(n.exchangeTokenPromise=void 0,l)),o=!0),r=yield n.exchangeTokenPromise}catch(l){"appCheck/throttled"===l.code?ex.warn(l.message):ex.error(l),s=l}return r?(a={token:r.token},eu(t,Object.assign(Object.assign({},n),{token:r})),yield Fk(t,r)):a=nS(s),o&&tS(t,a),a})).apply(this,arguments)}function oy(i,e){const t=$s(i),n=t.tokenObservers.filter(r=>r.next!==e);0===n.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),eu(i,Object.assign(Object.assign({},t),{tokenObservers:n}))}function uD(i){const{app:e}=i,t=$s(e);let n=t.tokenRefresher;n||(n=function pf(i){const{app:e}=i;return new Rk((0,nt.Z)(function*(){let n;if(n=$s(e).token?yield ry(i,!0):yield ry(i),n.error)throw n.error}),()=>!0,()=>{const t=$s(e);if(t.token){let n=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,t.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},3e4,96e4)}(i),eu(e,Object.assign(Object.assign({},t),{tokenRefresher:n}))),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function tS(i,e){const t=$s(i).tokenObservers;for(const n of t)try{"EXTERNAL"===n.type&&null!=e.error?n.error(e.error):n.next(e)}catch{}}function nx(i){return i.expireTimeMillis-Date.now()>0}function nS(i){return{token:kk(eS),error:i}}class Nk{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=$s(this.app);for(const t of e)oy(this.app,t.next);return Promise.resolve()}}const Hk="app-check-internal";!function Wk(){(0,Jc._registerComponent)(new Ag.wA("app-check",i=>function hD(i,e){return new Nk(i,e)}(i.getProvider("app").getImmediate(),i.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((i,e,t)=>{i.getProvider(Hk).initialize()})),(0,Jc._registerComponent)(new Ag.wA(Hk,i=>function Bk(i){return{getToken:e=>ry(i,e),addTokenListener:e=>function tx(i,e,t,n){const{app:r}=i,s=$s(r),o={next:t,error:n,type:e};if(eu(r,Object.assign(Object.assign({},s),{tokenObservers:[...s.tokenObservers,o]})),s.token&&nx(s.token)){const a=s.token;Promise.resolve().then(()=>{t({token:a.token}),uD(i)}).catch(()=>{})}s.cachedTokenPromise.then(()=>uD(i))}(i,"INTERNAL",e),removeTokenListener:e=>oy(i.app,e)}}(i.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,Jc.registerVersion)("@firebase/app-check","0.5.12")}();class cx{constructor(){return(0,pr.vb)("app-check")}}typeof window<"u"&&window;var Rn,vD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xh={},cS=cS||{},gi=vD||self;function ux(){}function uS(i){var e=typeof i;return"array"==(e="object"!=e?e:i?Array.isArray(i)?"array":e:"null")||"object"==e&&"number"==typeof i.length}function gf(i){var e=typeof i;return"object"==e&&null!=i||"function"==e}var dS="closure_uid_"+(1e9*Math.random()>>>0),yD=0;function fS(i,e,t){return i.call.apply(i.bind,arguments)}function bD(i,e,t){if(!i)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),i.apply(e,r)}}return function(){return i.apply(e,arguments)}}function _a(i,e,t){return(_a=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?fS:bD).apply(null,arguments)}function pS(i,e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=t.slice();return n.push.apply(n,arguments),i.apply(this,n)}}function ho(i,e){function t(){}t.prototype=e.prototype,i.Z=e.prototype,i.prototype=new t,i.prototype.constructor=i,i.Vb=function(n,r,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(n,o)}}function Lp(){this.s=this.s,this.o=this.o}var xD={};Lp.prototype.s=!1,Lp.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var i=function hS(i){return Object.prototype.hasOwnProperty.call(i,dS)&&i[dS]||(i[dS]=++yD)}(this);delete xD[i]}},Lp.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const mS=Array.prototype.indexOf?function(i,e){return Array.prototype.indexOf.call(i,e,void 0)}:function(i,e){if("string"==typeof i)return"string"!=typeof e||1!=e.length?-1:i.indexOf(e,0);for(let t=0;t<i.length;t++)if(t in i&&i[t]===e)return t;return-1},gS=Array.prototype.forEach?function(i,e,t){Array.prototype.forEach.call(i,e,t)}:function(i,e,t){const n=i.length,r="string"==typeof i?i.split(""):i;for(let s=0;s<n;s++)s in r&&e.call(t,r[s],s,i)};function hx(i){return Array.prototype.concat.apply([],arguments)}function tu(i){const e=i.length;if(0<e){const t=Array(e);for(let n=0;n<e;n++)t[n]=i[n];return t}return[]}function Op(i){return/^[\s\xa0]*$/.test(i)}var $o,ay=String.prototype.trim?function(i){return i.trim()}:function(i){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(i)[1]};function fo(i,e){return-1!=i.indexOf(e)}function _S(i,e){return i<e?-1:i>e?1:0}e:{var vS=gi.navigator;if(vS){var wD=vS.userAgent;if(wD){$o=wD;break e}}$o=""}function yS(i,e,t){for(const n in i)e.call(t,i[n],n,i)}function Lg(i){const e={};for(const t in i)e[t]=i[t];return e}var MD="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function t2(i,e){let t,n;for(let r=1;r<arguments.length;r++){for(t in n=arguments[r],n)i[t]=n[t];for(let s=0;s<MD.length;s++)t=MD[s],Object.prototype.hasOwnProperty.call(n,t)&&(i[t]=n[t])}}function bS(i){return bS[" "](i),i}bS[" "]=ux;var fx,i,n2=fo($o,"Opera"),Og=fo($o,"Trident")||fo($o,"MSIE"),SD=fo($o,"Edge"),xS=SD||Og,r2=fo($o,"Gecko")&&!(fo($o.toLowerCase(),"webkit")&&!fo($o,"Edge"))&&!(fo($o,"Trident")||fo($o,"MSIE"))&&!fo($o,"Edge"),CD=fo($o.toLowerCase(),"webkit")&&!fo($o,"Edge");function dx(){var i=gi.document;return i?i.documentMode:void 0}e:{var ly="",TS=(i=$o,r2?/rv:([^\);]+)(\)|;)/.exec(i):SD?/Edge\/([\d\.]+)/.exec(i):Og?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(i):CD?/WebKit\/(\S+)/.exec(i):n2?/(?:Version)[ \/]?(\S+)/.exec(i):void 0);if(TS&&(ly=TS?TS[1]:""),Og){var wS=dx();if(null!=wS&&wS>parseFloat(ly)){fx=String(wS);break e}}fx=ly}var s2={};var px=gi.document&&Og&&(dx()||parseInt(fx,10))||void 0,kp=function(){if(!gi.addEventListener||!Object.defineProperty)return!1;var i=!1,e=Object.defineProperty({},"passive",{get:function(){i=!0}});try{gi.addEventListener("test",ux,e),gi.removeEventListener("test",ux,e)}catch{}return i}();function La(i,e){this.type=i,this.g=this.target=e,this.defaultPrevented=!1}function $h(i,e){if(La.call(this,i?i.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,i){var t=this.type=i.type,n=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:null;if(this.target=i.target||i.srcElement,this.g=e,e=i.relatedTarget){if(r2){e:{try{bS(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else"mouseover"==t?e=i.fromElement:"mouseout"==t&&(e=i.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=i.button,this.key=i.key||"",this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.pointerId=i.pointerId||0,this.pointerType="string"==typeof i.pointerType?i.pointerType:a2[i.pointerType]||"",this.state=i.state,this.i=i,i.defaultPrevented&&$h.Z.h.call(this)}}La.prototype.h=function(){this.defaultPrevented=!0},ho($h,La);var a2={2:"touch",3:"pen",4:"mouse"};$h.prototype.h=function(){$h.Z.h.call(this);var i=this.i;i.preventDefault?i.preventDefault():i.returnValue=!1};var cy="closure_listenable_"+(1e6*Math.random()|0),SS=0;function l2(i,e,t,n,r){this.listener=i,this.proxy=null,this.src=e,this.type=t,this.capture=!!n,this.ia=r,this.key=++SS,this.ca=this.fa=!1}function Pl(i){i.ca=!0,i.listener=null,i.proxy=null,i.src=null,i.ia=null}function _f(i){this.src=i,this.g={},this.h=0}function Ro(i,e){var t=e.type;if(t in i.g){var s,n=i.g[t],r=mS(n,e);(s=0<=r)&&Array.prototype.splice.call(n,r,1),s&&(Pl(e),0==i.g[t].length&&(delete i.g[t],i.h--))}}function Qh(i,e,t,n){for(var r=0;r<i.length;++r){var s=i[r];if(!s.ca&&s.listener==e&&s.capture==!!t&&s.ia==n)return r}return-1}_f.prototype.add=function(i,e,t,n,r){var s=i.toString();(i=this.g[s])||(i=this.g[s]=[],this.h++);var o=Qh(i,e,n,r);return-1<o?(e=i[o],t||(e.fa=!1)):((e=new l2(e,this.src,s,!!n,r)).fa=t,i.push(e)),e};var kg="closure_lm_"+(1e6*Math.random()|0),nl={};function mx(i,e,t,n,r){if(n&&n.once)return Bp(i,e,t,n,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)mx(i,e[s],t,n,r);return null}return t=gx(t),i&&i[cy]?i.N(e,t,gf(n)?!!n.capture:!!n,r):Np(i,e,t,!1,n,r)}function Np(i,e,t,n,r,s){if(!e)throw Error("Invalid event type");var o=gf(r)?!!r.capture:!!r,a=yf(i);if(a||(i[kg]=a=new _f(i)),(t=a.add(e,t,n,o,s)).proxy)return t;if(n=function Ng(){var e=Bg;return function i(t){return e.call(i.src,i.listener,t)}}(),t.proxy=n,n.src=i,n.listener=t,i.addEventListener)kp||(r=o),void 0===r&&(r=!1),i.addEventListener(e.toString(),n,r);else if(i.attachEvent)i.attachEvent(Up(e.toString()),n);else{if(!i.addListener||!i.removeListener)throw Error("addEventListener and attachEvent are unavailable.");i.addListener(n)}return t}function Bp(i,e,t,n,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Bp(i,e[s],t,n,r);return null}return t=gx(t),i&&i[cy]?i.O(e,t,gf(n)?!!n.capture:!!n,r):Np(i,e,t,!0,n,r)}function jp(i,e,t,n,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)jp(i,e[s],t,n,r);else n=gf(n)?!!n.capture:!!n,t=gx(t),i&&i[cy]?(i=i.i,(e=String(e).toString())in i.g&&-1<(t=Qh(s=i.g[e],t,n,r))&&(Pl(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete i.g[e],i.h--))):i&&(i=yf(i))&&(e=i.g[e.toString()],i=-1,e&&(i=Qh(e,t,n,r)),(t=-1<i?e[i]:null)&&vf(t))}function vf(i){if("number"!=typeof i&&i&&!i.ca){var e=i.src;if(e&&e[cy])Ro(e.i,i);else{var t=i.type,n=i.proxy;e.removeEventListener?e.removeEventListener(t,n,i.capture):e.detachEvent?e.detachEvent(Up(t),n):e.addListener&&e.removeListener&&e.removeListener(n),(t=yf(e))?(Ro(t,i),0==t.h&&(t.src=null,e[kg]=null)):Pl(i)}}}function Up(i){return i in nl?nl[i]:nl[i]="on"+i}function Bg(i,e){if(i.ca)i=!0;else{e=new $h(e,this);var t=i.listener,n=i.ia||i.src;i.fa&&vf(i),i=t.call(n,e)}return i}function yf(i){return(i=i[kg])instanceof _f?i:null}var bf="__closure_events_fn_"+(1e9*Math.random()>>>0);function gx(i){return"function"==typeof i?i:(i[bf]||(i[bf]=function(e){return i.handleEvent(e)}),i[bf])}function po(){Lp.call(this),this.i=new _f(this),this.P=this,this.I=null}function Io(i,e){var t,n=i.I;if(n)for(t=[];n;n=n.I)t.push(n);if(i=i.P,n=e.type||e,"string"==typeof e)e=new La(e,i);else if(e instanceof La)e.target=e.target||i;else{var r=e;t2(e=new La(n,i),r)}if(r=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];r=uy(o,n,!0,e)&&r}if(r=uy(o=e.g=i,n,!0,e)&&r,r=uy(o,n,!1,e)&&r,t)for(s=0;s<t.length;s++)r=uy(o=e.g=t[s],n,!1,e)&&r}function uy(i,e,t,n){if(!(e=i.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ca&&o.capture==t){var a=o.listener,l=o.ia||o.src;o.fa&&Ro(i.i,o),r=!1!==a.call(l,n)&&r}}return r&&!n.defaultPrevented}ho(po,Lp),po.prototype[cy]=!0,po.prototype.removeEventListener=function(i,e,t,n){jp(this,i,e,t,n)},po.prototype.M=function(){if(po.Z.M.call(this),this.i){var e,i=this.i;for(e in i.g){for(var t=i.g[e],n=0;n<t.length;n++)Pl(t[n]);delete i.g[e],i.h--}}this.I=null},po.prototype.N=function(i,e,t,n){return this.i.add(String(i),e,!1,t,n)},po.prototype.O=function(i,e,t,n){return this.i.add(String(i),e,!0,t,n)};var _x=gi.JSON.stringify;function AD(){var i=RS;let e=null;return i.g&&(e=i.g,i.g=i.g.next,i.g||(i.h=null),e.next=null),e}var AS,CS=new class{constructor(i,e){this.i=i,this.j=e,this.h=0,this.g=null}get(){let i;return 0<this.h?(this.h--,i=this.g,this.g=i.next,i.next=null):i=this.i(),i}}(()=>new RD,i=>i.reset());class RD{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function c2(i){gi.setTimeout(()=>{throw i},0)}function ES(i,e){AS||function ID(){var i=gi.Promise.resolve(void 0);AS=function(){i.then(IS)}}(),DS||(AS(),DS=!0),RS.add(i,e)}var DS=!1,RS=new class DD{constructor(){this.h=this.g=null}add(e,t){const n=CS.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function IS(){for(var i;i=AD();){try{i.h.call(i.g)}catch(t){c2(t)}var e=CS;e.j(i),100>e.h&&(e.h++,i.next=e.g,e.g=i)}DS=!1}function jg(i,e){po.call(this),this.h=i||1,this.g=e||gi,this.j=_a(this.kb,this),this.l=Date.now()}function PS(i){i.da=!1,i.S&&(i.g.clearTimeout(i.S),i.S=null)}function Ug(i,e,t){if("function"==typeof i)t&&(i=_a(i,t));else{if(!i||"function"!=typeof i.handleEvent)throw Error("Invalid listener argument");i=_a(i.handleEvent,i)}return 2147483647<Number(e)?-1:gi.setTimeout(i,e||0)}function hy(i){i.g=Ug(()=>{i.g=null,i.i&&(i.i=!1,hy(i))},i.j);const e=i.h;i.h=null,i.m.apply(null,e)}ho(jg,po),(Rn=jg.prototype).da=!1,Rn.S=null,Rn.kb=function(){if(this.da){var i=Date.now()-this.l;0<i&&i<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-i):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Io(this,"tick"),this.da&&(PS(this),this.start()))}},Rn.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Rn.M=function(){jg.Z.M.call(this),PS(this),delete this.g};class FS extends Lp{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:hy(this)}M(){super.M(),this.g&&(gi.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function dy(i){Lp.call(this),this.h=i,this.g={}}ho(dy,Lp);var fy=[];function py(i,e,t,n){Array.isArray(t)||(t&&(fy[0]=t.toString()),t=fy);for(var r=0;r<t.length;r++){var s=mx(e,t[r],n||i.handleEvent,!1,i.h||i);if(!s)break;i.g[s.key]=s}}function LS(i){yS(i.g,function(e,t){this.g.hasOwnProperty(t)&&vf(e)},i),i.g={}}function my(){this.g=!0}function Vp(i,e,t,n){i.info(function(){return"XMLHTTP TEXT ("+e+"): "+function NS(i,e){if(!i.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(i=0;i<t.length;i++)if(Array.isArray(t[i])){var n=t[i];if(!(2>n.length)){var r=n[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return _x(t)}catch{return e}}(i,t)+(n?" "+n:"")})}dy.prototype.M=function(){dy.Z.M.call(this),LS(this)},dy.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},my.prototype.Aa=function(){this.g=!1},my.prototype.info=function(){};var Gp={},BS=null;function gy(){return BS=BS||new po}function jS(i){La.call(this,Gp.Ma,i)}function Vg(i){const e=gy();Io(e,new jS(e,i))}function FD(i,e){La.call(this,Gp.STAT_EVENT,i),this.stat=e}function va(i){const e=gy();Io(e,new FD(e,i))}function US(i,e){La.call(this,Gp.Na,i),this.size=e}function zp(i,e){if("function"!=typeof i)throw Error("Fn must not be null and must be a function");return gi.setTimeout(function(){i()},e)}Gp.Ma="serverreachability",ho(jS,La),Gp.STAT_EVENT="statevent",ho(FD,La),Gp.Na="timingevent",ho(US,La);var Gg={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},VS={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function vx(){}function zS(){}vx.prototype.h=null;var xx,zg={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function yx(){La.call(this,"d")}function bx(){La.call(this,"c")}function HS(){}function _y(i,e,t,n){this.l=i,this.j=e,this.m=t,this.X=n||1,this.V=new dy(this),this.P=OD,this.W=new jg(i=xS?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new LD}function LD(){this.i=null,this.g="",this.h=!1}ho(yx,La),ho(bx,La),ho(HS,vx),HS.prototype.g=function(){return new XMLHttpRequest},HS.prototype.i=function(){return{}},xx=new HS;var OD=45e3,WS={},Ts={};function Tx(i,e,t){i.K=1,i.v=Sx(Po(e)),i.s=t,i.U=!0,kD(i,null)}function kD(i,e){i.F=Date.now(),Hg(i),i.A=Po(i.v);var t=i.A,n=i.X;Array.isArray(n)||(n=[String(n)]),wy(t.h,"t",n),i.C=0,t=i.l.H,i.h=new LD,i.g=nR(i.l,t?e:null,!i.s),0<i.O&&(i.L=new FS(_a(i.Ia,i,i.g),i.O)),py(i.V,i.g,"readystatechange",i.gb),e=i.H?Lg(i.H):{},i.s?(i.u||(i.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",i.g.ea(i.A,i.u,i.s,e)):(i.u="GET",i.g.ea(i.A,i.u,null,e)),Vg(1),function OS(i,e,t,n,r,s){i.info(function(){if(i.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var h=a[l].split("=");if(1<h.length){var f=h[0];h=h[1];var m=f.split("_");o=2<=m.length&&"type"==m[1]?o+(f+"=")+h+"&":o+(f+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+n+") [attempt "+r+"]: "+e+"\n"+t+"\n"+o})}(i.j,i.u,i.A,i.m,i.X,i.s)}function ND(i){return!!i.g&&"GET"==i.u&&2!=i.K&&i.l.Ba}function qS(i,e,t){let r,n=!0;for(;!i.I&&i.C<t.length;){if(r=u2(i,t),r==Ts){4==e&&(i.o=4,va(14),n=!1),Vp(i.j,i.m,null,"[Incomplete Response]");break}if(r==WS){i.o=4,va(15),Vp(i.j,i.m,t,"[Invalid Chunk]"),n=!1;break}Vp(i.j,i.m,r,null),wx(i,r)}ND(i)&&r!=Ts&&r!=WS&&(i.h.g="",i.C=0),4!=e||0!=t.length||i.h.h||(i.o=1,va(16),n=!1),i.i=i.i&&n,n?0<t.length&&!i.aa&&(i.aa=!0,(e=i.l).g==i&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+t.length),Tf(e),e.L=!0,va(11))):(Vp(i.j,i.m,t,"[Invalid Chunked Response]"),Hp(i),vy(i))}function u2(i,e){var t=i.C,n=e.indexOf("\n",t);return-1==n?Ts:(t=Number(e.substring(t,n)),isNaN(t)?WS:(n+=1)+t>e.length?Ts:(e=e.substr(n,t),i.C=n+t,e))}function Hg(i){i.Y=Date.now()+i.P,ZS(i,i.P)}function ZS(i,e){if(null!=i.B)throw Error("WatchDog timer not null");i.B=zp(_a(i.eb,i),e)}function Jh(i){i.B&&(gi.clearTimeout(i.B),i.B=null)}function vy(i){0==i.l.G||i.I||Ry(i.l,i)}function Hp(i){Jh(i);var e=i.L;e&&"function"==typeof e.na&&e.na(),i.L=null,PS(i.W),LS(i.V),i.g&&(e=i.g,i.g=null,e.abort(),e.na())}function wx(i,e){try{var t=i.l;if(0!=t.G&&(t.g==i||Ax(t.i,i)))if(t.I=i.N,!i.J&&Ax(t.i,i)&&3==t.G){try{var n=t.Ca.g.parse(e)}catch{n=null}if(Array.isArray(n)&&3==n.length){var r=n;if(0==r[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<i.F))break e;Yp(t),lC(t)}cC(t),va(18)}}else t.ta=r[1],0<t.ta-t.U&&37500>r[2]&&t.N&&0==t.A&&!t.v&&(t.v=zp(_a(t.ab,t),6e3));if(1>=JS(t.i)&&t.ka){try{t.ka()}catch{}t.ka=void 0}}else Wg(t,11)}else if((i.J||t.g==i)&&Yp(t),!Op(e))for(r=t.Ca.g.parse(e),e=0;e<r.length;e++){let h=r[e];if(t.U=h[0],h=h[1],2==t.G)if("c"==h[0]){t.J=h[1],t.la=h[2];const f=h[3];null!=f&&(t.ma=f,t.h.info("VER="+t.ma));const m=h[4];null!=m&&(t.za=m,t.h.info("SVER="+t.za));const g=h[5];null!=g&&"number"==typeof g&&0<g&&(t.K=n=1.5*g,t.h.info("backChannelRequestTimeoutMs_="+n)),n=t;const v=i.g;if(v){const y=v.g?v.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(y){var s=n.i;!s.g&&(fo(y,"spdy")||fo(y,"quic")||fo(y,"h2"))&&(s.j=s.l,s.g=new Set,s.h&&(eC(s,s.h),s.h=null))}if(n.D){const b=v.g?v.g.getResponseHeader("X-HTTP-Session-Id"):null;b&&(n.sa=b,Kr(n.F,n.D,b))}}t.G=3,t.j&&t.j.xa(),t.$&&(t.O=Date.now()-i.F,t.h.info("Handshake RTT: "+t.O+"ms"));var o=i;if((n=t).oa=hC(n,n.H?n.la:null,n.W),o.J){zD(n.i,o);var a=o,l=n.K;l&&a.setTimeout(l),a.B&&(Jh(a),Hg(a)),n.g=o}else eR(n);0<t.l.length&&Dy(t)}else"stop"!=h[0]&&"close"!=h[0]||Wg(t,7);else 3==t.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?Wg(t,7):xf(t):"noop"!=h[0]&&t.j&&t.j.wa(h),t.A=0)}Vg(4)}catch{}}function Mx(i,e){if(i.forEach&&"function"==typeof i.forEach)i.forEach(e,void 0);else if(uS(i)||"string"==typeof i)gS(i,e,void 0);else{if(i.T&&"function"==typeof i.T)var t=i.T();else if(i.R&&"function"==typeof i.R)t=void 0;else if(uS(i)||"string"==typeof i){t=[];for(var n=i.length,r=0;r<n;r++)t.push(r)}else for(r in t=[],n=0,i)t[n++]=r;n=function h2(i){if(i.R&&"function"==typeof i.R)return i.R();if("string"==typeof i)return i.split("");if(uS(i)){for(var e=[],t=i.length,n=0;n<t;n++)e.push(i[n]);return e}for(n in e=[],t=0,i)e[t++]=i[n];return e}(i),r=n.length;for(var s=0;s<r;s++)e.call(void 0,n[s],t&&t[s],i)}}function yy(i,e){this.h={},this.g=[],this.i=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var n=0;n<t;n+=2)this.set(arguments[n],arguments[n+1])}else if(i)if(i instanceof yy)for(t=i.T(),n=0;n<t.length;n++)this.set(t[n],i.get(t[n]));else for(n in i)this.set(n,i[n])}function by(i){if(i.i!=i.g.length){for(var e=0,t=0;e<i.g.length;){var n=i.g[e];ed(i.h,n)&&(i.g[t++]=n),e++}i.g.length=t}if(i.i!=i.g.length){var r={};for(t=e=0;e<i.g.length;)ed(r,n=i.g[e])||(i.g[t++]=n,r[n]=1),e++;i.g.length=t}}function ed(i,e){return Object.prototype.hasOwnProperty.call(i,e)}(Rn=_y.prototype).setTimeout=function(i){this.P=i},Rn.gb=function(i){i=i.target;const e=this.L;e&&3==Xu(i)?e.l():this.Ia(i)},Rn.Ia=function(i){try{if(i==this.g)e:{const f=Xu(this.g);var e=this.g.Da();const m=this.g.ba();if(!(3>f)&&(3!=f||xS||this.g&&(this.h.h||this.g.ga()||Ix(this.g)))){this.I||4!=f||7==e||Vg(8==e||0>=m?3:2),Jh(this);var t=this.g.ba();this.N=t;t:if(ND(this)){var n=Ix(this.g);i="";var r=n.length,s=4==Xu(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Hp(this),vy(this);var o="";break t}this.h.i=new gi.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,i+=this.h.i.decode(n[e],{stream:s&&e==r-1});n.splice(0,r),this.h.g+=i,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==t,function PD(i,e,t,n,r,s,o){i.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+r+"]: "+e+"\n"+t+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.X,f,t),this.i){if(this.$&&!this.J){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Op(a)){var h=a;break t}}h=null}if(!(t=h)){this.i=!1,this.o=3,va(12),Hp(this),vy(this);break e}Vp(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,wx(this,t)}this.U?(qS(this,f,o),xS&&this.i&&3==f&&(py(this.V,this.W,"tick",this.fb),this.W.start())):(Vp(this.j,this.m,o,null),wx(this,o)),4==f&&Hp(this),this.i&&!this.I&&(4==f?Ry(this.l,this):(this.i=!1,Hg(this)))}else 400==t&&0<o.indexOf("Unknown SID")?(this.o=3,va(12)):(this.o=0,va(13)),Hp(this),vy(this)}}}catch{}},Rn.fb=function(){if(this.g){var i=Xu(this.g),e=this.g.ga();this.C<e.length&&(Jh(this),qS(this,i,e),this.i&&4!=i&&Hg(this))}},Rn.cancel=function(){this.I=!0,Hp(this)},Rn.eb=function(){this.B=null;const i=Date.now();0<=i-this.Y?(function kS(i,e){i.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Vg(3),va(17)),Hp(this),this.o=2,vy(this)):ZS(this,this.Y-i)},(Rn=yy.prototype).R=function(){by(this);for(var i=[],e=0;e<this.g.length;e++)i.push(this.h[this.g[e]]);return i},Rn.T=function(){return by(this),this.g.concat()},Rn.get=function(i,e){return ed(this.h,i)?this.h[i]:e},Rn.set=function(i,e){ed(this.h,i)||(this.i++,this.g.push(i)),this.h[i]=e},Rn.forEach=function(i,e){for(var t=this.T(),n=0;n<t.length;n++){var r=t[n],s=this.get(r);i.call(e,s,r,this)}};var cc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Wp(i,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,i instanceof Wp){this.g=void 0!==e?e:i.g,il(this,i.j),this.s=i.s,rl(this,i.i),xy(this,i.m),this.l=i.l,e=i.h;var t=new Ty;t.i=e.i,e.g&&(t.g=new yy(e.g),t.h=e.h),YS(this,t),this.o=i.o}else i&&(t=String(i).match(cc))?(this.g=!!e,il(this,t[1]||"",!0),this.s=qp(t[2]||""),rl(this,t[3]||"",!0),xy(this,t[4]),this.l=qp(t[5]||"",!0),YS(this,t[6]||"",!0),this.o=qp(t[7]||"")):(this.g=!!e,this.h=new Ty(null,this.g))}function Po(i){return new Wp(i)}function il(i,e,t){i.j=t?qp(e,!0):e,i.j&&(i.j=i.j.replace(/:$/,""))}function rl(i,e,t){i.i=t?qp(e,!0):e}function xy(i,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);i.m=e}else i.m=null}function YS(i,e,t){e instanceof Ty?(i.h=e,function UD(i,e){e&&!i.j&&(nd(i),i.i=null,i.g.forEach(function(t,n){var r=n.toLowerCase();n!=r&&(XS(this,n),wy(this,r,t))},i)),i.j=e}(i.h,i.g)):(t||(e=td(e,jD)),i.h=new Ty(e,i.g))}function Kr(i,e,t){i.h.set(e,t)}function Sx(i){return Kr(i,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),i}function qp(i,e){return i?e?decodeURI(i.replace(/%25/g,"%2525")):decodeURIComponent(i):""}function td(i,e,t){return"string"==typeof i?(i=encodeURI(i).replace(e,m2),t&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function m2(i){return"%"+((i=i.charCodeAt(0))>>4&15).toString(16)+(15&i).toString(16)}Wp.prototype.toString=function(){var i=[],e=this.j;e&&i.push(td(e,KS,!0),":");var t=this.i;return(t||"file"==e)&&(i.push("//"),(e=this.s)&&i.push(td(e,KS,!0),"@"),i.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&i.push(":",String(t))),(t=this.l)&&(this.i&&"/"!=t.charAt(0)&&i.push("/"),i.push(td(t,"/"==t.charAt(0)?BD:g2,!0))),(t=this.h.toString())&&i.push("?",t),(t=this.o)&&i.push("#",td(t,Cx)),i.join("")};var KS=/[#\/\?@]/g,g2=/[#\?:]/g,BD=/[#\?]/g,jD=/[#\?@]/g,Cx=/#/g;function Ty(i,e){this.h=this.g=null,this.i=i||null,this.j=!!e}function nd(i){i.g||(i.g=new yy,i.h=0,i.i&&function d2(i,e){if(i){i=i.split("&");for(var t=0;t<i.length;t++){var n=i[t].indexOf("="),r=null;if(0<=n){var s=i[t].substring(0,n);r=i[t].substring(n+1)}else s=i[t];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(i.i,function(e,t){i.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function XS(i,e){nd(i),e=Zp(i,e),ed(i.g.h,e)&&(i.i=null,i.h-=i.g.get(e).length,ed((i=i.g).h,e)&&(delete i.h[e],i.i--,i.g.length>2*i.i&&by(i)))}function Ex(i,e){return nd(i),e=Zp(i,e),ed(i.g.h,e)}function wy(i,e,t){XS(i,e),0<t.length&&(i.i=null,i.g.set(Zp(i,e),tu(t)),i.h+=t.length)}function Zp(i,e){return e=String(e),i.j&&(e=e.toLowerCase()),e}function $S(i){this.l=i||GD,i=gi.PerformanceNavigationTiming?0<(i=gi.performance.getEntriesByType("navigation")).length&&("hq"==i[0].nextHopProtocol||"h2"==i[0].nextHopProtocol):!!(gi.g&&gi.g.Ea&&gi.g.Ea()&&gi.g.Ea().Zb),this.j=i?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Rn=Ty.prototype).add=function(i,e){nd(this),this.i=null,i=Zp(this,i);var t=this.g.get(i);return t||this.g.set(i,t=[]),t.push(e),this.h+=1,this},Rn.forEach=function(i,e){nd(this),this.g.forEach(function(t,n){gS(t,function(r){i.call(e,r,n,this)},this)},this)},Rn.T=function(){nd(this);for(var i=this.g.R(),e=this.g.T(),t=[],n=0;n<e.length;n++)for(var r=i[n],s=0;s<r.length;s++)t.push(e[n]);return t},Rn.R=function(i){nd(this);var e=[];if("string"==typeof i)Ex(this,i)&&(e=hx(e,this.g.get(Zp(this,i))));else{i=this.g.R();for(var t=0;t<i.length;t++)e=hx(e,i[t])}return e},Rn.set=function(i,e){return nd(this),this.i=null,Ex(this,i=Zp(this,i))&&(this.h-=this.g.get(i).length),this.g.set(i,[e]),this.h+=1,this},Rn.get=function(i,e){return i&&0<(i=this.R(i)).length?String(i[0]):e},Rn.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var i=[],e=this.g.T(),t=0;t<e.length;t++){var n=e[t],r=encodeURIComponent(String(n));n=this.R(n);for(var s=0;s<n.length;s++){var o=r;""!==n[s]&&(o+="="+encodeURIComponent(String(n[s]))),i.push(o)}}return this.i=i.join("&")};var GD=10;function QS(i){return!!i.h||!!i.g&&i.g.size>=i.j}function JS(i){return i.h?1:i.g?i.g.size:0}function Ax(i,e){return i.h?i.h==e:!!i.g&&i.g.has(e)}function eC(i,e){i.g?i.g.add(e):i.h=e}function zD(i,e){i.h&&i.h==e?i.h=null:i.g&&i.g.has(e)&&i.g.delete(e)}function HD(i){if(null!=i.h)return i.i.concat(i.h.D);if(null!=i.g&&0!==i.g.size){let e=i.i;for(const t of i.g.values())e=e.concat(t.D);return e}return tu(i.i)}function tC(){}function _2(){this.g=new tC}function v2(i,e,t){const n=t||"";try{Mx(i,function(r,s){let o=r;gf(r)&&(o=_x(r)),e.push(n+s+"="+encodeURIComponent(o))})}catch(r){throw e.push(n+"type="+encodeURIComponent("_badmap")),r}}function Dx(i,e,t,n,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(n)}catch{}}function My(i){this.l=i.$b||null,this.j=i.ib||!1}function Rx(i,e){po.call(this),this.D=i,this.u=e,this.m=void 0,this.readyState=nC,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}$S.prototype.cancel=function(){if(this.i=HD(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const i of this.g.values())i.cancel();this.g.clear()}},tC.prototype.stringify=function(i){return gi.JSON.stringify(i,void 0)},tC.prototype.parse=function(i){return gi.JSON.parse(i,void 0)},ho(My,vx),My.prototype.g=function(){return new Rx(this.l,this.j)},My.prototype.i=function(i){return function(){return i}}({}),ho(Rx,po);var nC=0;function WD(i){i.j.read().then(i.Sa.bind(i)).catch(i.ha.bind(i))}function Sy(i){i.readyState=4,i.l=null,i.j=null,i.A=null,Cy(i)}function Cy(i){i.onreadystatechange&&i.onreadystatechange.call(i)}(Rn=Rx.prototype).open=function(i,e){if(this.readyState!=nC)throw this.abort(),Error("Error reopening a connection");this.C=i,this.B=e,this.readyState=1,Cy(this)},Rn.send=function(i){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};i&&(e.body=i),(this.D||gi).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},Rn.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Sy(this)),this.readyState=nC},Rn.Va=function(i){if(this.g&&(this.l=i,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=i.headers,this.readyState=2,Cy(this)),this.g&&(this.readyState=3,Cy(this),this.g)))if("arraybuffer"===this.responseType)i.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof gi.ReadableStream<"u"&&"body"in i){if(this.j=i.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;WD(this)}else i.text().then(this.Ua.bind(this),this.ha.bind(this))},Rn.Sa=function(i){if(this.g){if(this.u&&i.value)this.response.push(i.value);else if(!this.u){var e=i.value?i.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!i.done}))&&(this.response=this.responseText+=e)}i.done?Sy(this):Cy(this),3==this.readyState&&WD(this)}},Rn.Ua=function(i){this.g&&(this.response=this.responseText=i,Sy(this))},Rn.Ta=function(i){this.g&&(this.response=i,Sy(this))},Rn.ha=function(){this.g&&Sy(this)},Rn.setRequestHeader=function(i,e){this.v.append(i,e)},Rn.getResponseHeader=function(i){return this.h&&this.h.get(i.toLowerCase())||""},Rn.getAllResponseHeaders=function(){if(!this.h)return"";const i=[],e=this.h.entries();for(var t=e.next();!t.done;)i.push((t=t.value)[0]+": "+t[1]),t=e.next();return i.join("\r\n")},Object.defineProperty(Rx.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(i){this.m=i?"include":"same-origin"}});var b2=gi.JSON.parse;function Qs(i){po.call(this),this.headers=new yy,this.u=i||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=qD,this.K=this.L=!1}ho(Qs,po);var qD="",x2=/^https?$/i,ZD=["POST","PUT"];function KD(i){return"content-type"==i.toLowerCase()}function iC(i,e){i.h=!1,i.g&&(i.l=!0,i.g.abort(),i.l=!1),i.j=e,i.m=5,rC(i),Ey(i)}function rC(i){i.D||(i.D=!0,Io(i,"complete"),Io(i,"error"))}function sC(i){if(i.h&&typeof cS<"u"&&(!i.C[1]||4!=Xu(i)||2!=i.ba()))if(i.v&&4==Xu(i))Ug(i.Fa,0,i);else if(Io(i,"readystatechange"),4==Xu(i)){i.h=!1;try{const a=i.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var n;if(n=0===a){var r=String(i.H).match(cc)[1]||null;if(!r&&gi.self&&gi.self.location){var s=gi.self.location.protocol;r=s.substr(0,s.length-1)}n=!x2.test(r?r.toLowerCase():"")}t=n}if(t)Io(i,"complete"),Io(i,"success");else{i.m=6;try{var o=2<Xu(i)?i.g.statusText:""}catch{o=""}i.j=o+" ["+i.ba()+"]",rC(i)}}finally{Ey(i)}}}function Ey(i,e){if(i.g){oC(i);const t=i.g,n=i.C[0]?ux:null;i.g=null,i.C=null,e||Io(i,"ready");try{t.onreadystatechange=n}catch{}}}function oC(i){i.g&&i.K&&(i.g.ontimeout=null),i.A&&(gi.clearTimeout(i.A),i.A=null)}function Xu(i){return i.g?i.g.readyState:0}function Ix(i){try{if(!i.g)return null;if("response"in i.g)return i.g.response;switch(i.J){case qD:case"text":return i.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in i.g)return i.g.mozResponseArrayBuffer}return null}catch{return null}}function id(i,e,t){e:{for(n in t){var n=!1;break e}n=!0}n||(t=function aC(i){let e="";return yS(i,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(t),"string"==typeof i?null!=t&&encodeURIComponent(String(t)):Kr(i,e,t))}function Ay(i,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[i]||e}function XD(i){this.za=0,this.l=[],this.h=new my,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Ay("failFast",!1,i),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Ay("baseRetryDelayMs",5e3,i),this.$a=Ay("retryDelaySeedMs",1e4,i),this.Ya=Ay("forwardChannelMaxRetries",2,i),this.ra=Ay("forwardChannelRequestTimeoutMs",2e4,i),this.qa=i&&i.xmlHttpFactory||void 0,this.Ba=i&&i.Yb||!1,this.K=void 0,this.H=i&&i.supportsCrossDomainXhr||!1,this.J="",this.i=new $S(i&&i.concurrentRequestLimit),this.Ca=new _2,this.ja=i&&i.fastHandshake||!1,this.Ra=i&&i.Wb||!1,i&&i.Aa&&this.h.Aa(),i&&i.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&i&&i.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!i||!1!==i.Xb}function xf(i){if(Px(i),3==i.G){var e=i.V++,t=Po(i.F);Kr(t,"SID",i.J),Kr(t,"RID",e),Kr(t,"TYPE","terminate"),Yn(i,t),(e=new _y(i,i.h,e,void 0)).K=2,e.v=Sx(Po(t)),t=!1,gi.navigator&&gi.navigator.sendBeacon&&(t=gi.navigator.sendBeacon(e.v.toString(),"")),!t&&gi.Image&&((new Image).src=e.v,t=!0),t||(e.g=nR(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Hg(e)}uC(i)}function lC(i){i.g&&(Tf(i),i.g.cancel(),i.g=null)}function Px(i){lC(i),i.u&&(gi.clearTimeout(i.u),i.u=null),Yp(i),i.i.cancel(),i.m&&("number"==typeof i.m&&gi.clearTimeout(i.m),i.m=null)}function $D(i,e){i.l.push(new class{constructor(i,e){this.h=i,this.g=e}}(i.Za++,e)),3==i.G&&Dy(i)}function Dy(i){QS(i.i)||i.m||(i.m=!0,ES(i.Ha,i),i.C=0)}function T2(i,e){var t;t=e?e.m:i.V++;const n=Po(i.F);Kr(n,"SID",i.J),Kr(n,"RID",t),Kr(n,"AID",i.U),Yn(i,n),i.o&&i.s&&id(n,i.o,i.s),t=new _y(i,i.h,t,i.C+1),null===i.o&&(t.H=i.s),e&&(i.l=e.D.concat(i.l)),e=JD(i,t,1e3),t.setTimeout(Math.round(.5*i.ra)+Math.round(.5*i.ra*Math.random())),eC(i.i,t),Tx(t,n,e)}function Yn(i,e){i.j&&Mx({},function(t,n){Kr(e,n,t)})}function JD(i,e,t){t=Math.min(i.l.length,t);var n=i.j?_a(i.j.Oa,i.j,i):null;e:{var r=i.l;let s=-1;for(;;){const o=["count="+t];-1==s?0<t?(s=r[0].h,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<t;l++){let h=r[l].h;const f=r[l].g;if(h-=s,0>h)s=Math.max(0,r[l].h-100),a=!1;else try{v2(f,o,"req"+h+"_")}catch{n&&n(f)}}if(a){n=o.join("&");break e}}}return i=i.l.splice(0,t),e.D=i,n}function eR(i){i.g||i.u||(i.Y=1,ES(i.Ga,i),i.A=0)}function cC(i){return!(i.g||i.u||3<=i.A||(i.Y++,i.u=zp(_a(i.Ga,i),cs(i,i.A)),i.A++,0))}function Tf(i){null!=i.B&&(gi.clearTimeout(i.B),i.B=null)}function tR(i){i.g=new _y(i,i.h,"rpc",i.Y),null===i.o&&(i.g.H=i.s),i.g.O=0;var e=Po(i.oa);Kr(e,"RID","rpc"),Kr(e,"SID",i.J),Kr(e,"CI",i.N?"0":"1"),Kr(e,"AID",i.U),Yn(i,e),Kr(e,"TYPE","xmlhttp"),i.o&&i.s&&id(e,i.o,i.s),i.K&&i.g.setTimeout(i.K);var t=i.g;i=i.la,t.K=1,t.v=Sx(Po(e)),t.s=null,t.U=!0,kD(t,i)}function Yp(i){null!=i.v&&(gi.clearTimeout(i.v),i.v=null)}function Ry(i,e){var t=null;if(i.g==e){Yp(i),Tf(i),i.g=null;var n=2}else{if(!Ax(i.i,e))return;t=e.D,zD(i.i,e),n=1}if(i.I=e.N,0!=i.G)if(e.i)if(1==n){t=e.s?e.s.length:0,e=Date.now()-e.F;var r=i.C;Io(n=gy(),new US(n,t,e,r)),Dy(i)}else eR(i);else if(3==(r=e.o)||0==r&&0<i.I||!(1==n&&function QD(i,e){return!(JS(i.i)>=i.i.j-(i.m?1:0)||(i.m?(i.l=e.D.concat(i.l),0):1==i.G||2==i.G||i.C>=(i.Xa?0:i.Ya)||(i.m=zp(_a(i.Ha,i,e),cs(i,i.C)),i.C++,0)))}(i,e)||2==n&&cC(i)))switch(t&&0<t.length&&(e=i.i,e.i=e.i.concat(t)),r){case 1:Wg(i,5);break;case 4:Wg(i,10);break;case 3:Wg(i,6);break;default:Wg(i,2)}}function cs(i,e){let t=i.Pa+Math.floor(Math.random()*i.$a);return i.j||(t*=2),t*e}function Wg(i,e){if(i.h.info("Error code "+e),2==e){var t=null;i.j&&(t=null);var n=_a(i.jb,i);t||(t=new Wp("//www.google.com/images/cleardot.gif"),gi.location&&"http"==gi.location.protocol||il(t,"https"),Sx(t)),function y2(i,e){const t=new my;if(gi.Image){const n=new Image;n.onload=pS(Dx,t,n,"TestLoadImage: loaded",!0,e),n.onerror=pS(Dx,t,n,"TestLoadImage: error",!1,e),n.onabort=pS(Dx,t,n,"TestLoadImage: abort",!1,e),n.ontimeout=pS(Dx,t,n,"TestLoadImage: timeout",!1,e),gi.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=i}else e(!1)}(t.toString(),n)}else va(2);i.G=0,i.j&&i.j.va(e),uC(i),Px(i)}function uC(i){i.G=0,i.I=-1,i.j&&((0!=HD(i.i).length||0!=i.l.length)&&(i.i.i.length=0,tu(i.l),i.l.length=0),i.j.ua())}function hC(i,e,t){let n=function f2(i){return i instanceof Wp?Po(i):new Wp(i,void 0)}(t);if(""!=n.i)e&&rl(n,e+"."+n.i),xy(n,n.m);else{const r=gi.location;n=function p2(i,e,t,n){var r=new Wp(null,void 0);return i&&il(r,i),e&&rl(r,e),t&&xy(r,t),n&&(r.l=n),r}(r.protocol,e?e+"."+r.hostname:r.hostname,+r.port,t)}return i.aa&&yS(i.aa,function(r,s){Kr(n,s,r)}),t=i.sa,(e=i.D)&&t&&Kr(n,e,t),Kr(n,"VER",i.ma),Yn(i,n),n}function nR(i,e,t){if(e&&!i.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Qs(t&&i.Ba&&!i.qa?new My({ib:!0}):i.qa)).L=i.H,e}function dC(){}function Iy(){if(Og&&!(10<=Number(px)))throw Error("Environmental error: no available transport.")}function sl(i,e){po.call(this),this.g=new XD(e),this.l=i,this.h=e&&e.messageUrlParams||null,i=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(i?i["X-Client-Protocol"]="webchannel":i={"X-Client-Protocol":"webchannel"}),this.g.s=i,i=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(i?i["X-WebChannel-Content-Type"]=e.messageContentType:i={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(i?i["X-WebChannel-Client-Profile"]=e.ya:i={"X-WebChannel-Client-Profile":e.ya}),this.g.P=i,(i=e&&e.httpHeadersOverwriteParam)&&!Op(i)&&(this.g.o=i),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Op(e)&&(this.g.D=e,null!==(i=this.h)&&e in i&&e in(i=this.h)&&delete i[e]),this.j=new qg(this)}function fC(i){yx.call(this);var e=i.__sm__;if(e){e:{for(const t in e){i=t;break e}i=void 0}(this.i=i)&&(i=this.i,e=null!==e&&i in e?e[i]:void 0),this.data=e}else this.data=i}function iR(){bx.call(this),this.status=1}function qg(i){this.g=i}(Rn=Qs.prototype).ea=function(i,e,t,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+i);e=e?e.toUpperCase():"GET",this.H=i,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():xx.g(),this.C=function GS(i){return i.h||(i.h=i.i())}(this.u?this.u:xx),this.g.onreadystatechange=_a(this.Fa,this);try{this.F=!0,this.g.open(e,String(i),!0),this.F=!1}catch(s){return void iC(this,s)}i=t||"";const r=new yy(this.headers);n&&Mx(n,function(s,o){r.set(o,s)}),n=function TD(i){e:{var e=KD;const t=i.length,n="string"==typeof i?i.split(""):i;for(let r=0;r<t;r++)if(r in n&&e.call(void 0,n[r],r,i)){e=r;break e}e=-1}return 0>e?null:"string"==typeof i?i.charAt(e):i[e]}(r.T()),t=gi.FormData&&i instanceof gi.FormData,!(0<=mS(ZD,e))||n||t||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach(function(s,o){this.g.setRequestHeader(o,s)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{oC(this),0<this.B&&((this.K=function YD(i){return Og&&function o2(){return function oH(i){var e=s2;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=i(9)}(function(){let i=0;const e=ay(String(fx)).split("."),t=ay("9").split("."),n=Math.max(e.length,t.length);for(let o=0;0==i&&o<n;o++){var r=e[o]||"",s=t[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==r[0].length&&0==s[0].length)break;i=_S(0==r[1].length?0:parseInt(r[1],10),0==s[1].length?0:parseInt(s[1],10))||_S(0==r[2].length,0==s[2].length)||_S(r[2],s[2]),r=r[3],s=s[3]}while(0==i)}return 0<=i})}()&&"number"==typeof i.timeout&&void 0!==i.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=_a(this.pa,this)):this.A=Ug(this.pa,this.B,this)),this.v=!0,this.g.send(i),this.v=!1}catch(s){iC(this,s)}},Rn.pa=function(){typeof cS<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Io(this,"timeout"),this.abort(8))},Rn.abort=function(i){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=i||7,Io(this,"complete"),Io(this,"abort"),Ey(this))},Rn.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ey(this,!0)),Qs.Z.M.call(this)},Rn.Fa=function(){this.s||(this.F||this.v||this.l?sC(this):this.cb())},Rn.cb=function(){sC(this)},Rn.ba=function(){try{return 2<Xu(this)?this.g.status:-1}catch{return-1}},Rn.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}},Rn.Qa=function(i){if(this.g){var e=this.g.responseText;return i&&0==e.indexOf(i)&&(e=e.substring(i.length)),b2(e)}},Rn.Da=function(){return this.m},Rn.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(Rn=XD.prototype).ma=8,Rn.G=1,Rn.hb=function(i){try{this.h.info("Origin Trials invoked: "+i)}catch{}},Rn.Ha=function(i){if(this.m)if(this.m=null,1==this.G){if(!i){this.V=Math.floor(1e5*Math.random()),i=this.V++;const r=new _y(this,this.h,i,void 0);let s=this.s;if(this.P&&(s?(s=Lg(s),t2(s,this.P)):s=this.P),null===this.o&&(r.H=s),this.ja)e:{for(var e=0,t=0;t<this.l.length;t++){var n=this.l[t];if(void 0===(n="__data__"in n.g&&"string"==typeof(n=n.g.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=t;break e}if(4096===e||t===this.l.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=JD(this,r,e),Kr(t=Po(this.F),"RID",i),Kr(t,"CVER",22),this.D&&Kr(t,"X-HTTP-Session-Id",this.D),Yn(this,t),this.o&&s&&id(t,this.o,s),eC(this.i,r),this.Ra&&Kr(t,"TYPE","init"),this.ja?(Kr(t,"$req",e),Kr(t,"SID","null"),r.$=!0,Tx(r,t,null)):Tx(r,t,e),this.G=2}}else 3==this.G&&(i?T2(this,i):0==this.l.length||QS(this.i)||T2(this))},Rn.Ga=function(){if(this.u=null,tR(this),this.$&&!(this.L||null==this.g||0>=this.O)){var i=2*this.O;this.h.info("BP detection timer enabled: "+i),this.B=zp(_a(this.bb,this),i)}},Rn.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,va(10),lC(this),tR(this))},Rn.ab=function(){null!=this.v&&(this.v=null,lC(this),cC(this),va(19))},Rn.jb=function(i){i?(this.h.info("Successfully pinged google.com"),va(2)):(this.h.info("Failed to ping google.com"),va(1))},(Rn=dC.prototype).xa=function(){},Rn.wa=function(){},Rn.va=function(){},Rn.ua=function(){},Rn.Oa=function(){},Iy.prototype.g=function(i,e){return new sl(i,e)},ho(sl,po),sl.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var i=this.g,e=this.l,t=this.h||void 0;i.Wa&&(i.h.info("Origin Trials enabled."),ES(_a(i.hb,i,e))),va(0),i.W=e,i.aa=t||{},i.N=i.X,i.F=hC(i,null,i.W),Dy(i)},sl.prototype.close=function(){xf(this.g)},sl.prototype.u=function(i){if("string"==typeof i){var e={};e.__data__=i,$D(this.g,e)}else this.v?((e={}).__data__=_x(i),$D(this.g,e)):$D(this.g,i)},sl.prototype.M=function(){this.g.j=null,delete this.j,xf(this.g),delete this.g,sl.Z.M.call(this)},ho(fC,yx),ho(iR,bx),ho(qg,dC),qg.prototype.xa=function(){Io(this.g,"a")},qg.prototype.wa=function(i){Io(this.g,new fC(i))},qg.prototype.va=function(i){Io(this.g,new iR(i))},qg.prototype.ua=function(){Io(this.g,"b")},Iy.prototype.createWebChannel=Iy.prototype.g,sl.prototype.send=sl.prototype.u,sl.prototype.open=sl.prototype.m,sl.prototype.close=sl.prototype.close,Gg.NO_ERROR=0,Gg.TIMEOUT=8,Gg.HTTP_ERROR=6,VS.COMPLETE="complete",zS.EventType=zg,zg.OPEN="a",zg.CLOSE="b",zg.ERROR="c",zg.MESSAGE="d",po.prototype.listen=po.prototype.N,Qs.prototype.listenOnce=Qs.prototype.O,Qs.prototype.getLastError=Qs.prototype.La,Qs.prototype.getLastErrorCode=Qs.prototype.Da,Qs.prototype.getStatus=Qs.prototype.ba,Qs.prototype.getResponseJson=Qs.prototype.Qa,Qs.prototype.getResponseText=Qs.prototype.ga,Qs.prototype.send=Qs.prototype.ea;var w2=Xh.createWebChannelTransport=function(){return new Iy},Py=Xh.getStatEventTarget=function(){return gy()},pC=Xh.ErrorCode=Gg,M2=Xh.EventType=VS,S2=Xh.Event=Gp,Fy=Xh.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},rR=Xh.FetchXmlHttpFactory=My,Ly=Xh.WebChannel=zS,sR=Xh.XhrIo=Qs;const oR="@firebase/firestore";class ws{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ws.UNAUTHENTICATED=new ws(null),ws.GOOGLE_CREDENTIALS=new ws("google-credentials-uid"),ws.FIRST_PARTY=new ws("first-party-uid"),ws.MOCK_USER=new ws("mock-user");let $u="9.9.2";const wf=new Zh.Yd("@firebase/firestore");function mC(){return wf.logLevel}function qt(i,...e){if(wf.logLevel<=Zh.in.DEBUG){const t=e.map(gC);wf.debug(`Firestore (${$u}): ${i}`,...t)}}function Ms(i,...e){if(wf.logLevel<=Zh.in.ERROR){const t=e.map(gC);wf.error(`Firestore (${$u}): ${i}`,...t)}}function Mf(i,...e){if(wf.logLevel<=Zh.in.WARN){const t=e.map(gC);wf.warn(`Firestore (${$u}): ${i}`,...t)}}function gC(i){if("string"==typeof i)return i;try{return JSON.stringify(i)}catch{return i}}function In(i="Unexpected state"){const e=`FIRESTORE (${$u}) INTERNAL ASSERTION FAILED: `+i;throw Ms(e),new Error(e)}function fi(i,e){i||In()}function yn(i,e){return i}const at={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class jt extends Fi.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Qo{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class _C{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Fx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ws.UNAUTHENTICATED))}shutdown(){}}class A2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class D2{constructor(e){this.t=e,this.currentUser=ws.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;let r=this.i;const s=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let o=new Qo;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Qo,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const h=o;e.enqueueRetryable((0,nt.Z)(function*(){yield h.promise,yield s(n.currentUser)}))},l=h=>{qt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?l(h):(qt("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Qo)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(qt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(fi("string"==typeof n.accessToken),new _C(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return fi(null===e||"string"==typeof e),new ws(e)}}class aR{constructor(e,t,n){this.type="FirstParty",this.user=ws.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);const r=e.auth.getAuthHeaderValueForFirstParty([]);r&&this.headers.set("Authorization",r),n&&this.headers.set("X-Goog-Iam-Authorization-Token",n)}}class Oy{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new aR(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(ws.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class lR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class R2{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,t){const n=s=>{null!=s.error&&qt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.p;return this.p=s.token,qt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const r=s=>{qt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.g.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.g.getImmediate({optional:!0});s?r(s):qt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(fi("string"==typeof t.token),this.p=t.token,new lR(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function I2(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}class cR{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=I2(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<t&&(n+=e.charAt(r[s]%e.length))}return n}}function _i(i,e){return i<e?-1:i>e?1:0}function Zg(i,e,t){return i.length===e.length&&i.every((n,r)=>t(n,e[r]))}function uR(i){return i+"\0"}class mr{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new jt(at.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new jt(at.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new jt(at.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new jt(at.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return mr.fromMillis(Date.now())}static fromDate(e){return mr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new mr(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?_i(this.nanoseconds,e.nanoseconds):_i(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ci{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ci(e)}static min(){return new ci(new mr(0,0))}static max(){return new ci(new mr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Yg{constructor(e,t,n){void 0===t?t=0:t>e.length&&In(),void 0===n?n=e.length-t:n>e.length-t&&In(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Yg.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Yg?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Xi extends Yg{construct(e,t,n){return new Xi(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new jt(at.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(r=>r.length>0))}return new Xi(t)}static emptyPath(){return new Xi([])}}const hR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ss extends Yg{construct(e,t,n){return new Ss(e,t,n)}static isValidIdentifier(e){return hR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ss.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ss(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(0===n.length)throw new jt(at.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;r<e.length;){const a=e[r];if("\\"===a){if(r+1===e.length)throw new jt(at.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if("\\"!==l&&"."!==l&&"`"!==l)throw new jt(at.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,r+=2}else"`"===a?(o=!o,r++):"."!==a||o?(n+=a,r++):(s(),r++)}if(s(),o)throw new jt(at.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ss(t)}static emptyPath(){return new Ss([])}}class fn{constructor(e){this.path=e}static fromPath(e){return new fn(Xi.fromString(e))}static fromName(e){return new fn(Xi.fromString(e).popFirst(5))}static empty(){return new fn(Xi.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Xi.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Xi.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new fn(new Xi(e.slice()))}}class Lx{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function ky(i){return i.fields.find(e=>2===e.kind)}function Kp(i){return i.fields.filter(e=>2!==e.kind)}Lx.UNKNOWN_ID=-1;class Ny{constructor(e,t){this.fieldPath=e,this.kind=t}}class By{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new By(0,Fl.min())}}function fR(i,e){const t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,r=ci.fromTimestamp(1e9===n?new mr(t+1,0):new mr(t,n));return new Fl(r,fn.empty(),e)}function Ox(i){return new Fl(i.readTime,i.key,-1)}class Fl{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Fl(ci.min(),fn.empty(),-1)}static max(){return new Fl(ci.max(),fn.empty(),-1)}}function kx(i,e){let t=i.readTime.compareTo(e.readTime);return 0!==t?t:(t=fn.comparator(i.documentKey,e.documentKey),0!==t?t:_i(i.largestBatchId,e.largestBatchId))}const pR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class mR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Sf(i){return vC.apply(this,arguments)}function vC(){return vC=(0,nt.Z)(function*(i){if(i.code!==at.FAILED_PRECONDITION||i.message!==pR)throw i;qt("LocalStore","Unexpectedly lost primary lease")}),vC.apply(this,arguments)}class $e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&In(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new $e((n,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof $e?t:$e.resolve(t)}catch(t){return $e.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):$e.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):$e.reject(t)}static resolve(e){return new $e((t,n)=>{t(e)})}static reject(e){return new $e((t,n)=>{n(e)})}static waitFor(e){return new $e((t,n)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&t()},l=>n(l))}),o=!0,s===r&&t()})}static or(e){let t=$e.resolve(!1);for(const n of e)t=t.next(r=>r?$e.resolve(r):n());return t}static forEach(e,t){const n=[];return e.forEach((r,s)=>{n.push(t.call(this,r,s))}),this.waitFor(n)}static mapArray(e,t){return new $e((n,r)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const h=l;t(e[h]).next(f=>{o[h]=f,++a,a===s&&n(o)},f=>r(f))}})}static doWhile(e,t){return new $e((n,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):n()};s()})}}class Nx{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.T=new Qo,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{t.error?this.T.reject(new Kg(e,t.error)):this.T.resolve()},this.transaction.onerror=n=>{const r=bC(n.target.error);this.T.reject(new Kg(e,r))}}static open(e,t,n,r){try{return new Nx(t,e.transaction(r,n))}catch(s){throw new Kg(t,s)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(qt("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new L2(t)}}class nu{constructor(e,t,n){this.name=e,this.version=t,this.P=n,12.2===nu.v((0,Fi.z$)())&&Ms("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return qt("SimpleDb","Removing database:",e),Xp(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!(0,Fi.hl)())return!1;if(nu.S())return!0;const e=(0,Fi.z$)(),t=nu.v(e),n=0<t&&t<10,r=nu.D(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static S(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.C)}static N(e,t){return e.store(t)}static v(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static D(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}k(e){var t=this;return(0,nt.Z)(function*(){return t.db||(qt("SimpleDb","Opening database:",t.name),t.db=yield new Promise((n,r)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=o=>{n(o.target.result)},s.onblocked=()=>{r(new Kg(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;r("VersionError"===a.name?new jt(at.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new jt(at.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new Kg(e,a))},s.onupgradeneeded=o=>{qt("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',o.oldVersion),t.P.M(o.target.result,s.transaction,o.oldVersion,t.version).next(()=>{qt("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.O&&(t.db.onversionchange=n=>t.O(n)),t.db})()}F(e){this.O=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,n,r){var s=this;return(0,nt.Z)(function*(){const o="readonly"===t;let a=0;for(;;){++a;try{s.db=yield s.k(e);const l=Nx.open(s.db,e,o?"readonly":"readwrite",n),h=r(l).next(f=>(l.R(),f)).catch(f=>(l.abort(f),$e.reject(f))).toPromise();return h.catch(()=>{}),yield l.A,h}catch(l){const h=l,f="FirebaseError"!==h.name&&a<3;if(qt("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),s.close(),!f)return Promise.reject(h)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class F2{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return Xp(this.$.delete())}}class Kg extends jt{constructor(e,t){super(at.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function rd(i){return"IndexedDbTransactionError"===i.name}class L2{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(qt("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(qt("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Xp(n)}add(e){return qt("SimpleDb","ADD",this.store.name,e,e),Xp(this.store.add(e))}get(e){return Xp(this.store.get(e)).next(t=>(void 0===t&&(t=null),qt("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return qt("SimpleDb","DELETE",this.store.name,e),Xp(this.store.delete(e))}count(){return qt("SimpleDb","COUNT",this.store.name),Xp(this.store.count())}K(e,t){const n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){const r=this.cursor(n),s=[];return this.G(r,(o,a)=>{s.push(a)}).next(()=>s)}{const r=this.store.getAll(n.range);return new $e((s,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{s(a.target.result)}})}}j(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new $e((r,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{r(o.target.result)}})}W(e,t){qt("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.H=!1;const r=this.cursor(n);return this.G(r,(s,o,a)=>a.delete())}J(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.G(r,t)}Y(e){const t=this.cursor({});return new $e((n,r)=>{t.onerror=s=>{const o=bC(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():n()}):n()}})}G(e,t){const n=[];return new $e((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const l=new F2(a),h=t(a.primaryKey,a.value,l);if(h instanceof $e){const f=h.catch(m=>(l.done(),$e.reject(m)));n.push(f)}l.isDone?r():null===l.U?a.continue():a.continue(l.U)}}).next(()=>$e.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Xp(i){return new $e((e,t)=>{i.onsuccess=n=>{e(n.target.result)},i.onerror=n=>{const r=bC(n.target.error);t(r)}})}let yC=!1;function bC(i){const e=nu.v((0,Fi.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(i.message.indexOf(t)>=0){const n=new jt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return yC||(yC=!0,setTimeout(()=>{throw n},0)),n}}return i}class O2{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.Z(15)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}Z(e){var t=this;qt("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,nt.Z)(function*(){t.task=null;try{qt("IndexBackiller",`Documents written: ${yield t.X.tt()}`)}catch(n){rd(n)?qt("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):yield Sf(n)}yield t.Z(1)}))}}class k2{constructor(e,t){this.localStore=e,this.persistence=t}tt(e=50){var t=this;return(0,nt.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>t.et(n,e))})()}et(e,t){const n=new Set;let r=t,s=!0;return $e.doWhile(()=>!0===s&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!n.has(o))return qt("IndexBackiller",`Processing collection: ${o}`),this.nt(e,o,r).next(a=>{r-=a,n.add(o)});s=!1})).next(()=>t-r)}nt(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.st(r,s)).next(a=>(qt("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}st(e,t){let n=e;return t.changes.forEach((r,s)=>{const o=Ox(s);kx(o,n)>0&&(n=o)}),new Fl(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class ya{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.it(n),this.rt=n=>t.writeSequenceNumber(n))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}function Bx(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function Cf(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function jx(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}ya.ot=-1;class Cs{constructor(e,t){this.comparator=e,this.root=t||mo.EMPTY}insert(e,t){return new Cs(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,mo.BLACK,null,null))}remove(e){return new Cs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mo.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ux(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ux(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ux(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ux(this.root,e,this.comparator,!0)}}class Ux{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mo{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=n??mo.RED,this.left=r??mo.EMPTY,this.right=s??mo.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new mo(e??this.key,t??this.value,n??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return mo.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return mo.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mo.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw In();const e=this.left.check();if(e!==this.right.check())throw In();return e+(this.isRed()?0:1)}}mo.EMPTY=null,mo.RED=!0,mo.BLACK=!1,mo.EMPTY=new class{constructor(){this.size=0}get key(){throw In()}get value(){throw In()}get color(){throw In()}get left(){throw In()}get right(){throw In()}copy(i,e,t,n,r){return this}insert(i,e,t){return new mo(i,e)}remove(i,e){return this}isEmpty(){return!0}inorderTraversal(i){return!1}reverseTraversal(i){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Mr{constructor(e){this.comparator=e,this.data=new Cs(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new xC(this.data.getIterator())}getIteratorFrom(e){return new xC(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof Mr)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(0!==this.comparator(r,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Mr(this.comparator);return t.data=e,t}}class xC{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function iu(i){return i.hasNext()?i.getNext():void 0}class ol{constructor(e){this.fields=e,e.sort(Ss.comparator)}static empty(){return new ol([])}unionWith(e){let t=new Mr(Ss.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new ol(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Zg(this.fields,e.fields,(t,n)=>t.isEqual(n))}}class Fo{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new Fo(t)}static fromUint8Array(e){const t=function(n){let r="";for(let s=0;s<n.length;++s)r+=String.fromCharCode(n[s]);return r}(e);return new Fo(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return _i(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Fo.EMPTY_BYTE_STRING=new Fo("");const gR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qu(i){if(fi(!!i),"string"==typeof i){let e=0;const t=gR.exec(i);if(fi(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Es(i.seconds),nanos:Es(i.nanos)}}function Es(i){return"number"==typeof i?i:"string"==typeof i?Number(i):0}function sd(i){return"string"==typeof i?Fo.fromBase64String(i):Fo.fromUint8Array(i)}function TC(i){var e,t;return"server_timestamp"===(null===(t=((null===(e=i?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function _R(i){const e=i.mapValue.fields.__previous_value__;return TC(e)?_R(e):e}function $p(i){const e=Qu(i.mapValue.fields.__local_write_time__.timestampValue);return new mr(e.seconds,e.nanos)}class vR{constructor(e,t,n,r,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=l}}class Ju{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Ju("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Ju&&e.projectId===this.projectId&&e.database===this.database}}function Xg(i){return null==i}function $g(i){return 0===i&&1/i==-1/0}function yR(i){return"number"==typeof i&&Number.isInteger(i)&&!$g(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}const Ef={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Vx={nullValue:"NULL_VALUE"};function Qp(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?TC(i)?4:TR(i)?9007199254740991:10:In()}function ru(i,e){if(i===e)return!0;const t=Qp(i);if(t!==Qp(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return $p(i).isEqual($p(e));case 3:return function(n,r){if("string"==typeof n.timestampValue&&"string"==typeof r.timestampValue&&n.timestampValue.length===r.timestampValue.length)return n.timestampValue===r.timestampValue;const s=Qu(n.timestampValue),o=Qu(r.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return r=e,sd(i.bytesValue).isEqual(sd(r.bytesValue));case 7:return i.referenceValue===e.referenceValue;case 8:return function(n,r){return Es(n.geoPointValue.latitude)===Es(r.geoPointValue.latitude)&&Es(n.geoPointValue.longitude)===Es(r.geoPointValue.longitude)}(i,e);case 2:return function(n,r){if("integerValue"in n&&"integerValue"in r)return Es(n.integerValue)===Es(r.integerValue);if("doubleValue"in n&&"doubleValue"in r){const s=Es(n.doubleValue),o=Es(r.doubleValue);return s===o?$g(s)===$g(o):isNaN(s)&&isNaN(o)}return!1}(i,e);case 9:return Zg(i.arrayValue.values||[],e.arrayValue.values||[],ru);case 10:return function(n,r){const s=n.mapValue.fields||{},o=r.mapValue.fields||{};if(Bx(s)!==Bx(o))return!1;for(const a in s)if(s.hasOwnProperty(a)&&(void 0===o[a]||!ru(s[a],o[a])))return!1;return!0}(i,e);default:return In()}var r}function Gx(i,e){return void 0!==(i.values||[]).find(t=>ru(t,e))}function od(i,e){if(i===e)return 0;const t=Qp(i),n=Qp(e);if(t!==n)return _i(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return _i(i.booleanValue,e.booleanValue);case 2:return function(r,s){const o=Es(r.integerValue||r.doubleValue),a=Es(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(i,e);case 3:return bR(i.timestampValue,e.timestampValue);case 4:return bR($p(i),$p(e));case 5:return _i(i.stringValue,e.stringValue);case 6:return function(r,s){const o=sd(r),a=sd(s);return o.compareTo(a)}(i.bytesValue,e.bytesValue);case 7:return function(r,s){const o=r.split("/"),a=s.split("/");for(let l=0;l<o.length&&l<a.length;l++){const h=_i(o[l],a[l]);if(0!==h)return h}return _i(o.length,a.length)}(i.referenceValue,e.referenceValue);case 8:return function(r,s){const o=_i(Es(r.latitude),Es(s.latitude));return 0!==o?o:_i(Es(r.longitude),Es(s.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return function(r,s){const o=r.values||[],a=s.values||[];for(let l=0;l<o.length&&l<a.length;++l){const h=od(o[l],a[l]);if(h)return h}return _i(o.length,a.length)}(i.arrayValue,e.arrayValue);case 10:return function(r,s){if(r===Ef.mapValue&&s===Ef.mapValue)return 0;if(r===Ef.mapValue)return 1;if(s===Ef.mapValue)return-1;const o=r.fields||{},a=Object.keys(o),l=s.fields||{},h=Object.keys(l);a.sort(),h.sort();for(let f=0;f<a.length&&f<h.length;++f){const m=_i(a[f],h[f]);if(0!==m)return m;const g=od(o[a[f]],l[h[f]]);if(0!==g)return g}return _i(a.length,h.length)}(i.mapValue,e.mapValue);default:throw In()}}function bR(i,e){if("string"==typeof i&&"string"==typeof e&&i.length===e.length)return _i(i,e);const t=Qu(i),n=Qu(e),r=_i(t.seconds,n.seconds);return 0!==r?r:_i(t.nanos,n.nanos)}function Qg(i){return xR(i)}function xR(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(n){const r=Qu(n);return`time(${r.seconds},${r.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?sd(i.bytesValue).toBase64():"referenceValue"in i?fn.fromName(i.referenceValue).toString():"geoPointValue"in i?`geo(${(e=i.geoPointValue).latitude},${e.longitude})`:"arrayValue"in i?function(n){let r="[",s=!0;for(const o of n.values||[])s?s=!1:r+=",",r+=xR(o);return r+"]"}(i.arrayValue):"mapValue"in i?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",o=!0;for(const a of r)o?o=!1:s+=",",s+=`${a}:${xR(n.fields[a])}`;return s+"}"}(i.mapValue):In();var e}function Jg(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function wC(i){return!!i&&"integerValue"in i}function jy(i){return!!i&&"arrayValue"in i}function MC(i){return!!i&&"nullValue"in i}function SC(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function zx(i){return!!i&&"mapValue"in i}function Uy(i){if(i.geoPointValue)return{geoPointValue:Object.assign({},i.geoPointValue)};if(i.timestampValue&&"object"==typeof i.timestampValue)return{timestampValue:Object.assign({},i.timestampValue)};if(i.mapValue){const e={mapValue:{fields:{}}};return Cf(i.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Uy(n)),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Uy(i.arrayValue.values[t]);return e}return Object.assign({},i)}function TR(i){return"__max__"===(((i.mapValue||{}).fields||{}).__type__||{}).stringValue}function B2(i){return"nullValue"in i?Vx:"booleanValue"in i?{booleanValue:!1}:"integerValue"in i||"doubleValue"in i?{doubleValue:NaN}:"timestampValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in i?{stringValue:""}:"bytesValue"in i?{bytesValue:""}:"referenceValue"in i?Jg(Ju.empty(),fn.empty()):"geoPointValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in i?{arrayValue:{}}:"mapValue"in i?{mapValue:{}}:In()}function j2(i){return"nullValue"in i?{booleanValue:!1}:"booleanValue"in i?{doubleValue:NaN}:"integerValue"in i||"doubleValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in i?{stringValue:""}:"stringValue"in i?{bytesValue:""}:"bytesValue"in i?Jg(Ju.empty(),fn.empty()):"referenceValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in i?{arrayValue:{}}:"arrayValue"in i?{mapValue:{}}:"mapValue"in i?Ef:In()}function wR(i,e){const t=od(i.value,e.value);return 0!==t?t:i.inclusive&&!e.inclusive?-1:!i.inclusive&&e.inclusive?1:0}function MR(i,e){const t=od(i.value,e.value);return 0!==t?t:i.inclusive&&!e.inclusive?1:!i.inclusive&&e.inclusive?-1:0}class Jo{constructor(e){this.value=e}static empty(){return new Jo({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!zx(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Uy(t)}setAll(e){let t=Ss.emptyPath(),n={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,n,r),n={},r=[],t=a.popLast()}o?n[a.lastSegment()]=Uy(o):r.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());zx(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ru(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];zx(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Cf(t,(r,s)=>e[r]=s);for(const r of n)delete e[r]}clone(){return new Jo(Uy(this.value))}}function e_(i){const e=[];return Cf(i.fields,(t,n)=>{const r=new Ss([t]);if(zx(n)){const s=e_(n.mapValue).fields;if(0===s.length)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)}),new ol(e)}class Dr{constructor(e,t,n,r,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Dr(e,0,ci.min(),ci.min(),Jo.empty(),0)}static newFoundDocument(e,t,n){return new Dr(e,1,t,ci.min(),n,0)}static newNoDocument(e,t){return new Dr(e,2,t,ci.min(),Jo.empty(),0)}static newUnknownDocument(e,t){return new Dr(e,3,t,ci.min(),Jo.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Jo.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Jo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ci.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Dr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Dr(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class SR{constructor(e,t=null,n=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.ut=null}}function CC(i,e=null,t=[],n=[],r=null,s=null,o=null){return new SR(i,e,t,n,r,s,o)}function Af(i){const e=yn(i);if(null===e.ut){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>{return(r=n).field.canonicalString()+r.op.toString()+Qg(r.value);var r}).join(","),t+="|ob:",t+=e.orderBy.map(n=>{return(r=n).field.canonicalString()+r.dir;var r}).join(","),Xg(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Qg(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Qg(n)).join(",")),e.ut=t}return e.ut}function t_(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<i.orderBy.length;r++)if(!z2(i.orderBy[r],e.orderBy[r]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let r=0;r<i.filters.length;r++)if((t=i.filters[r]).op!==(n=e.filters[r]).op||!t.field.isEqual(n.field)||!ru(t.value,n.value))return!1;var t,n;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!Gy(i.startAt,e.startAt)&&Gy(i.endAt,e.endAt)}function Hx(i){return fn.isDocumentKey(i.path)&&null===i.collectionGroup&&0===i.filters.length}function EC(i,e){return i.filters.filter(t=>t instanceof ea&&t.field.isEqual(e))}function AC(i,e,t){let n=Vx,r=!0;for(const s of EC(i,e)){let o=Vx,a=!0;switch(s.op){case"<":case"<=":o=B2(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Vx}wR({value:n,inclusive:r},{value:o,inclusive:a})<0&&(n=o,r=a)}if(null!==t)for(let s=0;s<i.orderBy.length;++s)if(i.orderBy[s].field.isEqual(e)){const o=t.position[s];wR({value:n,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(n=o,r=t.inclusive);break}return{value:n,inclusive:r}}function ER(i,e,t){let n=Ef,r=!0;for(const s of EC(i,e)){let o=Ef,a=!0;switch(s.op){case">=":case">":o=j2(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ef}MR({value:n,inclusive:r},{value:o,inclusive:a})>0&&(n=o,r=a)}if(null!==t)for(let s=0;s<i.orderBy.length;++s)if(i.orderBy[s].field.isEqual(e)){const o=t.position[s];MR({value:n,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(n=o,r=t.inclusive);break}return{value:n,inclusive:r}}class ea extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,n):new U2(e,t,n):"array-contains"===t?new DC(e,n):"in"===t?new eh(e,n):"not-in"===t?new G2(e,n):"array-contains-any"===t?new Wx(e,n):new ea(e,t,n)}static ct(e,t,n){return"in"===t?new V2(e,n):new Vy(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(od(t,this.value)):null!==t&&Qp(this.value)===Qp(t)&&this.at(od(t,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return In()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class U2 extends ea{constructor(e,t,n){super(e,t,n),this.key=fn.fromName(n.referenceValue)}matches(e){const t=fn.comparator(e.key,this.key);return this.at(t)}}class V2 extends ea{constructor(e,t){super(e,"in",t),this.keys=AR(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Vy extends ea{constructor(e,t){super(e,"not-in",t),this.keys=AR(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function AR(i,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(n=>fn.fromName(n.referenceValue))}class DC extends ea{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return jy(t)&&Gx(t.arrayValue,this.value)}}class eh extends ea{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Gx(this.value.arrayValue,t)}}class G2 extends ea{constructor(e,t){super(e,"not-in",t)}matches(e){if(Gx(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Gx(this.value.arrayValue,t)}}class Wx extends ea{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!jy(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Gx(this.value.arrayValue,n))}}class uc{constructor(e,t){this.position=e,this.inclusive=t}}class n_{constructor(e,t="asc"){this.field=e,this.dir=t}}function z2(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}function DR(i,e,t){let n=0;for(let r=0;r<i.position.length;r++){const s=e[r],o=i.position[r];if(n=s.field.isKeyField()?fn.comparator(fn.fromName(o.referenceValue),t.key):od(o,t.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function Gy(i,e){if(null===i)return null===e;if(null===e||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!ru(i.position[t],e.position[t]))return!1;return!0}class hc{constructor(e,t=null,n=[],r=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.lt=null,this.ft=null}}function RR(i,e,t,n,r,s,o,a){return new hc(i,e,t,n,r,s,o,a)}function i_(i){return new hc(i)}function RC(i){return 0===i.filters.length&&null===i.limit&&null==i.startAt&&null==i.endAt&&(0===i.explicitOrderBy.length||1===i.explicitOrderBy.length&&i.explicitOrderBy[0].field.isKeyField())}function qx(i){return i.explicitOrderBy.length>0?i.explicitOrderBy[0].field:null}function zy(i){for(const e of i.filters)if(e.ht())return e.field;return null}function Zx(i){return null!==i.collectionGroup}function r_(i){const e=yn(i);if(null===e.lt){e.lt=[];const t=zy(e),n=qx(e);if(null!==t&&null===n)t.isKeyField()||e.lt.push(new n_(t)),e.lt.push(new n_(Ss.keyField(),"asc"));else{let r=!1;for(const s of e.explicitOrderBy)e.lt.push(s),s.field.isKeyField()&&(r=!0);if(!r){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new n_(Ss.keyField(),s))}}}return e.lt}function al(i){const e=yn(i);if(!e.ft)if("F"===e.limitType)e.ft=CC(e.path,e.collectionGroup,r_(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of r_(e))t.push(new n_(s.field,"desc"===s.dir?"asc":"desc"));const n=e.endAt?new uc(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new uc(e.startAt.position,e.startAt.inclusive):null;e.ft=CC(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}return e.ft}function IC(i,e,t){return new hc(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function Jp(i,e){return t_(al(i),al(e))&&i.limitType===e.limitType}function Yx(i){return`${Af(al(i))}|lt:${i.limitType}`}function Kx(i){return`Query(target=${function CR(i){let e=i.path.canonicalString();return null!==i.collectionGroup&&(e+=" collectionGroup="+i.collectionGroup),i.filters.length>0&&(e+=`, filters: [${i.filters.map(t=>{return`${(n=t).field.canonicalString()} ${n.op} ${Qg(n.value)}`;var n}).join(", ")}]`),Xg(i.limit)||(e+=", limit: "+i.limit),i.orderBy.length>0&&(e+=`, orderBy: [${i.orderBy.map(t=>{return`${(n=t).field.canonicalString()} (${n.dir})`;var n}).join(", ")}]`),i.startAt&&(e+=", startAt: ",e+=i.startAt.inclusive?"b:":"a:",e+=i.startAt.position.map(t=>Qg(t)).join(",")),i.endAt&&(e+=", endAt: ",e+=i.endAt.inclusive?"a:":"b:",e+=i.endAt.position.map(t=>Qg(t)).join(",")),`Target(${e})`}(al(i))}; limitType=${i.limitType})`}function Hy(i,e){return e.isFoundDocument()&&function(t,n){const r=n.key.path;return null!==t.collectionGroup?n.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(r):fn.isDocumentKey(t.path)?t.path.isEqual(r):t.path.isImmediateParentOf(r)}(i,e)&&function(t,n){for(const r of t.explicitOrderBy)if(!r.field.isKeyField()&&null===n.data.field(r.field))return!1;return!0}(i,e)&&function(t,n){for(const r of t.filters)if(!r.matches(n))return!1;return!0}(i,e)&&(n=e,!((t=i).startAt&&!function(r,s,o){const a=DR(r,s,o);return r.inclusive?a<=0:a<0}(t.startAt,r_(t),n)||t.endAt&&!function(r,s,o){const a=DR(r,s,o);return r.inclusive?a>=0:a>0}(t.endAt,r_(t),n)));var t,n}function Xx(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function IR(i){return(e,t)=>{let n=!1;for(const r of r_(i)){const s=H2(r,e,t);if(0!==s)return s;n=n||r.field.isKeyField()}return 0}}function H2(i,e,t){const n=i.field.isKeyField()?fn.comparator(e.key,t.key):function(r,s,o){const a=s.data.field(r),l=o.data.field(r);return null!==a&&null!==l?od(a,l):In()}(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return In()}}function PR(i,e){if(i.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$g(e)?"-0":e}}function FR(i){return{integerValue:""+i}}function PC(i,e){return yR(e)?FR(e):PR(i,e)}class s_{constructor(){this._=void 0}}function LR(i,e,t){return i instanceof em?function(n,r){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return r&&(s.fields.__previous_value__=r),{mapValue:s}}(t,e):i instanceof tm?LC(i,e):i instanceof Df?kR(i,e):function(n,r){const s=FC(n,r),o=OC(s)+OC(n._t);return wC(s)&&wC(n._t)?FR(o):PR(n.wt,o)}(i,e)}function OR(i,e,t){return i instanceof tm?LC(i,e):i instanceof Df?kR(i,e):t}function FC(i,e){return i instanceof nm?wC(t=e)||(n=t)&&"doubleValue"in n?e:{integerValue:0}:null;var n,t}class em extends s_{}class tm extends s_{constructor(e){super(),this.elements=e}}function LC(i,e){const t=ba(e);for(const n of i.elements)t.some(r=>ru(r,n))||t.push(n);return{arrayValue:{values:t}}}class Df extends s_{constructor(e){super(),this.elements=e}}function kR(i,e){let t=ba(e);for(const n of i.elements)t=t.filter(r=>!ru(r,n));return{arrayValue:{values:t}}}class nm extends s_{constructor(e,t){super(),this.wt=e,this._t=t}}function OC(i){return Es(i.integerValue||i.doubleValue)}function ba(i){return jy(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}class th{constructor(e,t){this.field=e,this.transform=t}}class q2{constructor(e,t){this.version=e,this.transformResults=t}}class As{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new As}static exists(e){return new As(void 0,e)}static updateTime(e){return new As(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function kC(i,e){return void 0!==i.updateTime?e.isFoundDocument()&&e.version.isEqual(i.updateTime):void 0===i.exists||i.exists===e.isFoundDocument()}class Wy{}function NC(i,e){if(!i.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return i.isNoDocument()?new Rf(i.key,As.none()):new im(i.key,i.data,As.none());{const t=i.data,n=Jo.empty();let r=new Mr(Ss.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);null===o&&s.length>1&&(s=s.popLast(),o=t.field(s)),null===o?n.delete(s):n.set(s,o),r=r.add(s)}return new ad(i.key,n,new ol(r.toArray()),As.none())}}function qy(i,e,t){i instanceof im?function(n,r,s){const o=n.value.clone(),a=rm(n.fieldTransforms,r,s.transformResults);o.setAll(a),r.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(i,e,t):i instanceof ad?function(n,r,s){if(!kC(n.precondition,r))return void r.convertToUnknownDocument(s.version);const o=rm(n.fieldTransforms,r,s.transformResults),a=r.data;a.setAll(BR(n)),a.setAll(o),r.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(i,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Zy(i,e,t,n){return i instanceof im?function(r,s,o,a){if(!kC(r.precondition,s))return o;const l=r.value.clone(),h=jR(r.fieldTransforms,a,s);return l.setAll(h),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(i,e,t,n):i instanceof ad?function(r,s,o,a){if(!kC(r.precondition,s))return o;const l=jR(r.fieldTransforms,a,s),h=s.data;return h.setAll(BR(r)),h.setAll(l),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),null===o?null:o.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(f=>f.field))}(i,e,t,n):(o=t,kC(i.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o);var s,o}function BC(i,e){let t=null;for(const n of i.fieldTransforms){const r=e.data.field(n.field),s=FC(n.transform,r||null);null!=s&&(null===t&&(t=Jo.empty()),t.set(n.field,s))}return t||null}function NR(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&(n=e.fieldTransforms,!!(void 0===(t=i.fieldTransforms)&&void 0===n||t&&n&&Zg(t,n,(r,s)=>function W2(i,e){return i.field.isEqual(e.field)&&(n=e.transform,(t=i.transform)instanceof tm&&n instanceof tm||t instanceof Df&&n instanceof Df?Zg(t.elements,n.elements,ru):t instanceof nm&&n instanceof nm?ru(t._t,n._t):t instanceof em&&n instanceof em);var t,n}(r,s))))&&(0===i.type?i.value.isEqual(e.value):1!==i.type||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask));var t,n}class im extends Wy{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ad extends Wy{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function BR(i){const e=new Map;return i.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=i.data.field(t);e.set(t,n)}}),e}function rm(i,e,t){const n=new Map;fi(i.length===t.length);for(let r=0;r<t.length;r++){const s=i[r],o=s.transform,a=e.data.field(s.field);n.set(s.field,OR(o,a,t[r]))}return n}function jR(i,e,t){const n=new Map;for(const r of i){const s=r.transform,o=t.data.field(r.field);n.set(r.field,LR(s,o,e))}return n}class Rf extends Wy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $x extends Wy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class UR{constructor(e){this.count=e}}var us,zi;function Z2(i){switch(i){default:return In();case at.CANCELLED:case at.UNKNOWN:case at.DEADLINE_EXCEEDED:case at.RESOURCE_EXHAUSTED:case at.INTERNAL:case at.UNAVAILABLE:case at.UNAUTHENTICATED:return!1;case at.INVALID_ARGUMENT:case at.NOT_FOUND:case at.ALREADY_EXISTS:case at.PERMISSION_DENIED:case at.FAILED_PRECONDITION:case at.ABORTED:case at.OUT_OF_RANGE:case at.UNIMPLEMENTED:case at.DATA_LOSS:return!0}}function jC(i){if(void 0===i)return Ms("GRPC error has no .code"),at.UNKNOWN;switch(i){case us.OK:return at.OK;case us.CANCELLED:return at.CANCELLED;case us.UNKNOWN:return at.UNKNOWN;case us.DEADLINE_EXCEEDED:return at.DEADLINE_EXCEEDED;case us.RESOURCE_EXHAUSTED:return at.RESOURCE_EXHAUSTED;case us.INTERNAL:return at.INTERNAL;case us.UNAVAILABLE:return at.UNAVAILABLE;case us.UNAUTHENTICATED:return at.UNAUTHENTICATED;case us.INVALID_ARGUMENT:return at.INVALID_ARGUMENT;case us.NOT_FOUND:return at.NOT_FOUND;case us.ALREADY_EXISTS:return at.ALREADY_EXISTS;case us.PERMISSION_DENIED:return at.PERMISSION_DENIED;case us.FAILED_PRECONDITION:return at.FAILED_PRECONDITION;case us.ABORTED:return at.ABORTED;case us.OUT_OF_RANGE:return at.OUT_OF_RANGE;case us.UNIMPLEMENTED:return at.UNIMPLEMENTED;case us.DATA_LOSS:return at.DATA_LOSS;default:return In()}}(zi=us||(us={}))[zi.OK=0]="OK",zi[zi.CANCELLED=1]="CANCELLED",zi[zi.UNKNOWN=2]="UNKNOWN",zi[zi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",zi[zi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",zi[zi.NOT_FOUND=5]="NOT_FOUND",zi[zi.ALREADY_EXISTS=6]="ALREADY_EXISTS",zi[zi.PERMISSION_DENIED=7]="PERMISSION_DENIED",zi[zi.UNAUTHENTICATED=16]="UNAUTHENTICATED",zi[zi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",zi[zi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",zi[zi.ABORTED=10]="ABORTED",zi[zi.OUT_OF_RANGE=11]="OUT_OF_RANGE",zi[zi.UNIMPLEMENTED=12]="UNIMPLEMENTED",zi[zi.INTERNAL=13]="INTERNAL",zi[zi.UNAVAILABLE=14]="UNAVAILABLE",zi[zi.DATA_LOSS=15]="DATA_LOSS";class If{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,s]of n)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Cf(this.inner,(t,n)=>{for(const[r,s]of n)e(r,s)})}isEmpty(){return jx(this.inner)}size(){return this.innerSize}}const VR=new Cs(fn.comparator);function go(){return VR}const GR=new Cs(fn.comparator);function o_(...i){let e=GR;for(const t of i)e=e.insert(t.key,t);return e}function Qx(i){let e=GR;return i.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function ld(){return Jx()}function zR(){return Jx()}function Jx(){return new If(i=>i.toString(),(i,e)=>i.isEqual(e))}const Y2=new Cs(fn.comparator),K2=new Mr(fn.comparator);function Si(...i){let e=K2;for(const t of i)e=e.add(t);return e}const HR=new Mr(_i);function Yy(){return HR}class Ky{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,a_.createSynthesizedTargetChangeForCurrentChange(e,t)),new Ky(ci.min(),n,Yy(),go(),Si())}}class a_{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t){return new a_(Fo.EMPTY_BYTE_STRING,t,Si(),Si(),Si())}}class Xy{constructor(e,t,n,r){this.gt=e,this.removedTargetIds=t,this.key=n,this.yt=r}}class WR{constructor(e,t){this.targetId=e,this.It=t}}class qR{constructor(e,t,n=Fo.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class UC{constructor(){this.Tt=0,this.Et=GC(),this.At=Fo.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return 0!==this.Tt}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=Si(),t=Si(),n=Si();return this.Et.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:In()}}),new a_(this.At,this.Rt,e,t,n)}Dt(){this.bt=!1,this.Et=GC()}Ct(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Mt(){this.bt=!0,this.Rt=!0}}class X2{constructor(e){this.Ot=e,this.Ft=new Map,this.$t=go(),this.Bt=VC(),this.Lt=new Mr(_i)}Ut(e){for(const t of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(t,e.yt):this.Kt(t,e.key,e.yt);for(const t of e.removedTargetIds)this.Kt(t,e.key,e.yt)}Gt(e){this.forEachTarget(e,t=>{const n=this.Qt(t);switch(e.state){case 0:this.jt(t)&&n.Vt(e.resumeToken);break;case 1:n.kt(),n.Pt||n.Dt(),n.Vt(e.resumeToken);break;case 2:n.kt(),n.Pt||this.removeTarget(t);break;case 3:this.jt(t)&&(n.Mt(),n.Vt(e.resumeToken));break;case 4:this.jt(t)&&(this.Wt(t),n.Vt(e.resumeToken));break;default:In()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach((n,r)=>{this.jt(r)&&t(r)})}zt(e){const t=e.targetId,n=e.It.count,r=this.Ht(t);if(r){const s=r.target;if(Hx(s))if(0===n){const o=new fn(s.path);this.Kt(t,o,Dr.newNoDocument(o,ci.min()))}else fi(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}Yt(e){const t=new Map;this.Ft.forEach((s,o)=>{const a=this.Ht(o);if(a){if(s.current&&Hx(a.target)){const l=new fn(a.target.path);null!==this.$t.get(l)||this.Xt(o,l)||this.Kt(o,l,Dr.newNoDocument(l,e))}s.vt&&(t.set(o,s.St()),s.Dt())}});let n=Si();this.Bt.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const h=this.Ht(l);return!h||2===h.purpose||(a=!1,!1)}),a&&(n=n.add(s))}),this.$t.forEach((s,o)=>o.setReadTime(e));const r=new Ky(e,t,this.Lt,this.$t,n);return this.$t=go(),this.Bt=VC(),this.Lt=new Mr(_i),r}qt(e,t){if(!this.jt(e))return;const n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}Kt(e,t,n){if(!this.jt(e))return;const r=this.Qt(e);this.Xt(e,t)?r.Ct(t,1):r.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}removeTarget(e){this.Ft.delete(e)}Jt(e){const t=this.Qt(e).St();return this.Ot.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let t=this.Ft.get(e);return t||(t=new UC,this.Ft.set(e,t)),t}Zt(e){let t=this.Bt.get(e);return t||(t=new Mr(_i),this.Bt=this.Bt.insert(e,t)),t}jt(e){const t=null!==this.Ht(e);return t||qt("WatchChangeAggregator","Detected inactive target",e),t}Ht(e){const t=this.Ft.get(e);return t&&t.Pt?null:this.Ot.te(e)}Wt(e){this.Ft.set(e,new UC),this.Ot.getRemoteKeysForTarget(e).forEach(t=>{this.Kt(e,t,null)})}Xt(e,t){return this.Ot.getRemoteKeysForTarget(e).has(t)}}function VC(){return new Cs(fn.comparator)}function GC(){return new Cs(fn.comparator)}const ZR={asc:"ASCENDING",desc:"DESCENDING"},YR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class $2{constructor(e,t){this.databaseId=e,this.dt=t}}function $y(i,e){return i.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Q2(i,e){return i.dt?e.toBase64():e.toUint8Array()}function KR(i,e){return $y(i,e.toTimestamp())}function ta(i){return fi(!!i),ci.fromTimestamp(function(e){const t=Qu(e);return new mr(t.seconds,t.nanos)}(i))}function XR(i,e){return(t=i,new Xi(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function J2(i){const e=Xi.fromString(i);return fi(nI(e)),e}function eT(i,e){return XR(i.databaseId,e.path)}function cd(i,e){const t=J2(e);if(t.get(1)!==i.databaseId.projectId)throw new jt(at.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new jt(at.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new fn(Qy(t))}function $R(i,e){return XR(i.databaseId,e)}function eN(i){const e=J2(i);return 4===e.length?Xi.emptyPath():Qy(e)}function tT(i){return new Xi(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function Qy(i){return fi(i.length>4&&"documents"===i.get(4)),i.popFirst(5)}function tN(i,e,t){return{name:eT(i,e),fields:t.value.mapValue.fields}}function zC(i,e,t){const n=cd(i,e.name),r=ta(e.updateTime),s=new Jo({mapValue:{fields:e.fields}}),o=Dr.newFoundDocument(n,r,s);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function l_(i,e){let t;if(e instanceof im)t={update:tN(i,e.key,e.value)};else if(e instanceof Rf)t={delete:eT(i,e.key)};else if(e instanceof ad)t={update:tN(i,e.key,e.data),updateMask:hH(e.fieldMask)};else{if(!(e instanceof $x))return In();t={verify:eT(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(r,s){const o=s.transform;if(o instanceof em)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof tm)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Df)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof nm)return{fieldPath:s.field.canonicalString(),increment:o._t};throw In()}(0,n))),e.precondition.isNone||(t.currentDocument=void 0!==(r=e.precondition).updateTime?{updateTime:KR(i,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:In()),t;var r}function JR(i,e){const t=e.currentDocument?void 0!==(r=e.currentDocument).updateTime?As.updateTime(ta(r.updateTime)):void 0!==r.exists?As.exists(r.exists):As.none():As.none(),n=e.updateTransforms?e.updateTransforms.map(r=>function(s,o){let a=null;"setToServerValue"in o?(fi("REQUEST_TIME"===o.setToServerValue),a=new em):"appendMissingElements"in o?a=new tm(o.appendMissingElements.values||[]):"removeAllFromArray"in o?a=new Df(o.removeAllFromArray.values||[]):"increment"in o?a=new nm(s,o.increment):In();const l=Ss.fromServerFormat(o.fieldPath);return new th(l,a)}(i,r)):[];var r;if(e.update){const r=cd(i,e.update.name),s=new Jo({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new ol((e.updateMask.fieldPaths||[]).map(h=>Ss.fromServerFormat(h)));return new ad(r,s,o,t,n)}return new im(r,s,t,n)}if(e.delete){const r=cd(i,e.delete);return new Rf(r,t)}if(e.verify){const r=cd(i,e.verify);return new $x(r,t)}return In()}function WC(i,e){return{documents:[$R(i,e.path)]}}function eI(i,e){const t={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(t.parent=$R(i,n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=$R(i,n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);const r=function(l){if(0===l.length)return;const h=l.map(f=>function(m){if("=="===m.op){if(SC(m.value))return{unaryFilter:{field:ud(m.field),op:"IS_NAN"}};if(MC(m.value))return{unaryFilter:{field:ud(m.field),op:"IS_NULL"}}}else if("!="===m.op){if(SC(m.value))return{unaryFilter:{field:ud(m.field),op:"IS_NOT_NAN"}};if(MC(m.value))return{unaryFilter:{field:ud(m.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ud(m.field),op:iN(m.op),value:m.value}}}(f));return 1===h.length?h[0]:{compositeFilter:{op:"AND",filters:h}}}(e.filters);r&&(t.structuredQuery.where=r);const s=function(l){if(0!==l.length)return l.map(h=>{return{field:ud((f=h).field),direction:nN(f.dir)};var f})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const o=(h=e.limit,i.dt||Xg(h)?h:{value:h});var h,a,l;return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(t.structuredQuery.endAt={before:!(l=e.endAt).inclusive,values:l.position}),t}function qC(i){let e=eN(i.parent);const t=i.structuredQuery,n=t.from?t.from.length:0;let r=null;if(n>0){fi(1===n);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=tI(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(f=>{return new n_(c_((m=f).field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction));var m}));let a=null;t.limit&&(a=function(f){let m;return m="object"==typeof f?f.value:f,Xg(m)?null:m}(t.limit));let l=null;var f;t.startAt&&(l=new uc((f=t.startAt).values||[],!!f.before));let h=null;return t.endAt&&(h=function(f){return new uc(f.values||[],!f.before)}(t.endAt)),RR(e,r,o,s,a,"F",l,h)}function tI(i){return i?void 0!==i.unaryFilter?[uH(i)]:void 0!==i.fieldFilter?[cH(i)]:void 0!==i.compositeFilter?i.compositeFilter.filters.map(e=>tI(e)).reduce((e,t)=>e.concat(t)):In():[]}function nN(i){return ZR[i]}function iN(i){return YR[i]}function ud(i){return{fieldPath:i.canonicalString()}}function c_(i){return Ss.fromServerFormat(i.fieldPath)}function cH(i){return ea.create(c_(i.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return In()}}(i.fieldFilter.op),i.fieldFilter.value)}function uH(i){switch(i.unaryFilter.op){case"IS_NAN":const e=c_(i.unaryFilter.field);return ea.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=c_(i.unaryFilter.field);return ea.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const n=c_(i.unaryFilter.field);return ea.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=c_(i.unaryFilter.field);return ea.create(r,"!=",{nullValue:"NULL_VALUE"});default:return In()}}function hH(i){const e=[];return i.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function nI(i){return i.length>=4&&"projects"===i.get(0)&&"databases"===i.get(2)}function Oa(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=sN(e)),e=rN(i.get(t),e);return sN(e)}function rN(i,e){let t=e;const n=i.length;for(let r=0;r<n;r++){const s=i.charAt(r);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function sN(i){return i+"\x01\x01"}function nh(i){const e=i.length;if(fi(e>=2),2===e)return fi("\x01"===i.charAt(0)&&"\x01"===i.charAt(1)),Xi.emptyPath();const t=e-2,n=[];let r="";for(let s=0;s<e;){const o=i.indexOf("\x01",s);switch((o<0||o>t)&&In(),i.charAt(o+1)){case"\x01":const a=i.substring(s,o);let l;0===r.length?l=a:(r+=a,l=r,r=""),n.push(l);break;case"\x10":r+=i.substring(s,o),r+="\0";break;case"\x11":r+=i.substring(s,o+1);break;default:In()}s=o+2}return new Xi(n)}const ZC=["userId","batchId"];function Jy(i,e){return[i,Oa(e)]}function oN(i,e,t){return[i,Oa(e),t]}const su={},aN=["prefixPath","collectionGroup","readTime","documentId"],YC=["prefixPath","collectionGroup","documentId"],lN=["collectionGroup","readTime","prefixPath","documentId"],Ll=["canonicalId","targetId"],cN=["targetId","path"],KC=["path","targetId"],uN=["collectionId","parent"],hN=["indexId","uid"],XC=["uid","sequenceNumber"],iI=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],rI=["indexId","uid","orderedDocumentKey"],dN=["userId","collectionPath","documentId"],sI=["userId","collectionPath","largestBatchId"],oI=["userId","collectionGroup","largestBatchId"],aI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],lI=[...aI,"documentOverlays"],cI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],iT=cI,Pf=[...iT,"indexConfiguration","indexState","indexEntries"];class rT extends mR{constructor(e,t){super(),this.ee=e,this.currentSequenceNumber=t}}function Js(i,e){const t=yn(i);return nu.N(t.ee,e)}class ou{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&qy(s,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Zy(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Zy(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=zR();return this.mutations.forEach(r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const l=NC(o,a);null!==l&&n.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(ci.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Si())}isEqual(e){return this.batchId===e.batchId&&Zg(this.mutations,e.mutations,(t,n)=>NR(t,n))&&Zg(this.baseMutations,e.baseMutations,(t,n)=>NR(t,n))}}class $C{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){fi(e.mutations.length===n.length);let r=Y2;const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,n[o].version);return new $C(e,t,n,r)}}class uI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Ff{constructor(e,t,n,r,s=ci.min(),o=ci.min(),a=Fo.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new Ff(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new Ff(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Ff(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class hI{constructor(e){this.ne=e}}function dI(i,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:e0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document={name:eT(r=i.ne,(s=e).key),fields:s.data.value.mapValue.fields,updateTime:$y(r,s.version.toTimestamp())};else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:u_(e.version)};else{if(!e.isUnknownDocument())return In();n.unknownDocument={path:t.path.toArray(),version:u_(e.version)}}var r,s;return n}function e0(i){const e=i.toTimestamp();return[e.seconds,e.nanoseconds]}function u_(i){const e=i.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Lf(i){const e=new mr(i.seconds,i.nanoseconds);return ci.fromTimestamp(e)}function sm(i,e){const t=(e.baseMutations||[]).map(s=>JR(i.ne,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(o.updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s)}const n=e.mutations.map(s=>JR(i.ne,s)),r=mr.fromMillis(e.localWriteTimeMs);return new ou(e.batchId,r,t,n)}function h_(i){const e=Lf(i.readTime),t=void 0!==i.lastLimboFreeSnapshotVersion?Lf(i.lastLimboFreeSnapshotVersion):ci.min();let n;var r;return void 0!==i.query.documents?(fi(1===(r=i.query).documents.length),n=al(i_(eN(r.documents[0])))):n=al(qC(i.query)),new Ff(n,i.targetId,0,i.lastListenSequenceNumber,e,t,Fo.fromBase64String(i.resumeToken))}function pN(i,e){const t=u_(e.snapshotVersion),n=u_(e.lastLimboFreeSnapshotVersion);let r;r=Hx(e.target)?WC(i.ne,e.target):eI(i.ne,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Af(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:r}}function t0(i){const e=qC({parent:i.parent,structuredQuery:i.structuredQuery});return"LAST"===i.limitType?IC(e,e.limit,"L"):e}function sT(i,e){return new uI(e.largestBatchId,JR(i.ne,e.overlayMutation))}function QC(i,e){const t=e.path.lastSegment();return[i,Oa(e.path.popLast()),t]}function fI(i,e,t,n){return{indexId:i,uid:e.uid||"",sequenceNumber:t,readTime:u_(n.readTime),documentKey:Oa(n.documentKey.path),largestBatchId:n.largestBatchId}}class pI{getBundleMetadata(e,t){return JC(e).get(t).next(n=>{if(n)return{id:(r=n).bundleId,createTime:Lf(r.createTime),version:r.version};var r})}saveBundleMetadata(e,t){return JC(e).put({bundleId:(n=t).id,createTime:u_(ta(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return n0(e).get(t).next(n=>{if(n)return{name:(r=n).name,query:t0(r.bundledQuery),readTime:Lf(r.readTime)};var r})}saveNamedQuery(e,t){return n0(e).put({name:(n=t).name,readTime:u_(ta(n.readTime)),bundledQuery:n.bundledQuery});var n}}function JC(i){return Js(i,"bundles")}function n0(i){return Js(i,"namedQueries")}class om{constructor(e,t){this.wt=e,this.userId=t}static se(e,t){return new om(e,t.uid||"")}getOverlay(e,t){return d_(e).get(QC(this.userId,t)).next(n=>n?sT(this.wt,n):null)}getOverlays(e,t){const n=ld();return $e.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&n.set(r,s)})).next(()=>n)}saveOverlays(e,t,n){const r=[];return n.forEach((s,o)=>{const a=new uI(t,o);r.push(this.ie(e,a))}),$e.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach(o=>r.add(Oa(o.getCollectionPath())));const s=[];return r.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(d_(e).W("collectionPathOverlayIndex",a))}),$e.waitFor(s)}getOverlaysForCollection(e,t,n){const r=ld(),s=Oa(t),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return d_(e).K("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const h=sT(this.wt,l);r.set(h.getKey(),h)}return r})}getOverlaysForCollectionGroup(e,t,n,r){const s=ld();let o;const a=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return d_(e).J({index:"collectionGroupOverlayIndex",range:a},(l,h,f)=>{const m=sT(this.wt,h);s.size()<r||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):f.done()}).next(()=>s)}ie(e,t){return d_(e).put(function(n,r,s){const[o,a,l]=QC(r,s.mutation.key);return{userId:r,collectionPath:a,documentId:l,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:l_(n.ne,s.mutation)}}(this.wt,this.userId,t))}}function d_(i){return Js(i,"documentOverlays")}class am{constructor(){}re(e,t){this.oe(e,t),t.ue()}oe(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(Es(e.integerValue));else if("doubleValue"in e){const n=Es(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),$g(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ce(t,20),"string"==typeof n?t.he(n):(t.he(`${n.seconds||""}`),t.ae(n.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(sd(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ce(t,45),t.ae(n.latitude||0),t.ae(n.longitude||0)}else"mapValue"in e?TR(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):In()}le(e,t){this.ce(t,25),this.ge(e,t)}ge(e,t){t.he(e)}we(e,t){const n=e.fields||{};this.ce(t,55);for(const r of Object.keys(n))this.le(r,t),this.oe(n[r],t)}me(e,t){const n=e.values||[];this.ce(t,50);for(const r of n)this.oe(r,t)}_e(e,t){this.ce(t,37),fn.fromName(e).path.forEach(n=>{this.ce(t,60),this.ge(n,t)})}ce(e,t){e.ae(t)}fe(e){e.ae(2)}}function mI(i){if(0===i)return 8;let e=0;return i>>4==0&&(e+=4,i<<=4),i>>6==0&&(e+=2,i<<=2),i>>7==0&&(e+=1),e}function eE(i){const e=64-function(t){let n=0;for(let r=0;r<8;++r){const s=mI(255&t[r]);if(n+=s,8!==s)break}return n}(i);return Math.ceil(e/8)}am.ye=new am;class mN{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ie(n.value),n=t.next();this.Te()}Ee(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ae(n.value),n=t.next();this.Re()}be(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ie(n);else if(n<2048)this.Ie(960|n>>>6),this.Ie(128|63&n);else if(t<"\ud800"||"\udbff"<t)this.Ie(480|n>>>12),this.Ie(128|63&n>>>6),this.Ie(128|63&n);else{const r=t.codePointAt(0);this.Ie(240|r>>>18),this.Ie(128|63&r>>>12),this.Ie(128|63&r>>>6),this.Ie(128|63&r)}}this.Te()}Pe(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ae(n);else if(n<2048)this.Ae(960|n>>>6),this.Ae(128|63&n);else if(t<"\ud800"||"\udbff"<t)this.Ae(480|n>>>12),this.Ae(128|63&n>>>6),this.Ae(128|63&n);else{const r=t.codePointAt(0);this.Ae(240|r>>>18),this.Ae(128|63&r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r)}}this.Re()}ve(e){const t=this.Ve(e),n=eE(t);this.Se(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}De(e){const t=this.Ve(e),n=eE(t);this.Se(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Me(){return this.buffer.slice(0,this.position)}Ve(e){const t=function(r){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,r,!1),new Uint8Array(s.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Ie(e){const t=255&e;0===t?(this.xe(0),this.xe(255)):255===t?(this.xe(255),this.xe(0)):this.xe(t)}Ae(e){const t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class gN{constructor(e){this.Oe=e}de(e){this.Oe.pe(e)}he(e){this.Oe.be(e)}ae(e){this.Oe.ve(e)}ue(){this.Oe.Ce()}}class dH{constructor(e){this.Oe=e}de(e){this.Oe.Ee(e)}he(e){this.Oe.Pe(e)}ae(e){this.Oe.De(e)}ue(){this.Oe.Ne()}}class oT{constructor(){this.Oe=new mN,this.Fe=new gN(this.Oe),this.$e=new dH(this.Oe)}seed(e){this.Oe.seed(e)}Be(e){return 0===e?this.Fe:this.$e}Me(){return this.Oe.Me()}reset(){this.Oe.reset()}}class Of{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Le(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new Of(this.indexId,this.documentKey,this.arrayValue,n)}}function lm(i,e){let t=i.indexId-e.indexId;return 0!==t?t:(t=gI(i.arrayValue,e.arrayValue),0!==t?t:(t=gI(i.directionalValue,e.directionalValue),0!==t?t:fn.comparator(i.documentKey,e.documentKey)))}function gI(i,e){for(let t=0;t<i.length&&t<e.length;++t){const n=i[t]-e[t];if(0!==n)return n}return i.length-e.length}class _N{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const t of e.filters){const n=t;n.ht()?this.Ke=n:this.qe.push(n)}}Ge(e){const t=ky(e);if(void 0!==t&&!this.Qe(t))return!1;const n=Kp(e);let r=0,s=0;for(;r<n.length&&this.Qe(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.Ke){const o=n[r];if(!this.je(this.Ke,o)||!this.We(this.Ue[s++],o))return!1;++r}for(;r<n.length;++r){const o=n[r];if(s>=this.Ue.length||!this.We(this.Ue[s++],o))return!1}return!0}Qe(e){for(const t of this.qe)if(this.je(t,e))return!0;return!1}je(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}We(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class fH{constructor(){this.ze=new _I}addToCollectionParentIndex(e,t){return this.ze.add(t),$e.resolve()}getCollectionParents(e,t){return $e.resolve(this.ze.getEntries(t))}addFieldIndex(e,t){return $e.resolve()}deleteFieldIndex(e,t){return $e.resolve()}getDocumentsMatchingTarget(e,t){return $e.resolve(null)}getIndexType(e,t){return $e.resolve(0)}getFieldIndexes(e,t){return $e.resolve([])}getNextCollectionGroupToUpdate(e){return $e.resolve(null)}getMinOffset(e,t){return $e.resolve(Fl.min())}getMinOffsetFromCollectionGroup(e,t){return $e.resolve(Fl.min())}updateCollectionGroup(e,t,n){return $e.resolve()}updateIndexEntries(e,t){return $e.resolve()}}class _I{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Mr(Xi.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Mr(Xi.comparator)).toArray()}}const tE=new Uint8Array(0);class pH{constructor(e,t){this.user=e,this.databaseId=t,this.He=new _I,this.Je=new If(n=>Af(n),(n,r)=>t_(n,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.He.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.He.add(t)});const s={collectionId:n,parent:Oa(r)};return vN(e).put(s)}return $e.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[uR(t),""],!1,!0);return vN(e).K(r).next(s=>{for(const o of s){if(o.collectionId!==t)break;n.push(nh(o.parent))}return n})}addFieldIndex(e,t){const n=cm(e),r={indexId:(o=t).indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])};var o;delete r.indexId;const s=n.add(r);if(t.indexState){const o=s0(e);return s.next(a=>{o.put(fI(a,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const n=cm(e),r=s0(e),s=r0(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const n=r0(e);let r=!0;const s=new Map;return $e.forEach(this.Ye(t),o=>this.Xe(e,o).next(a=>{r&&(r=!!a),s.set(o,a)})).next(()=>{if(r){let o=Si();const a=[];return $e.forEach(s,(l,h)=>{var f;qt("IndexedDbIndexManager",`Using index ${f=l,`id=${f.indexId}|cg=${f.collectionGroup}|f=${f.fields.map(R=>`${R.fieldPath}:${R.kind}`).join(",")}`} to execute ${Af(t)}`);const m=function(R,I){const L=ky(I);if(void 0===L)return null;for(const N of EC(R,L.fieldPath))switch(N.op){case"array-contains-any":return N.value.arrayValue.values||[];case"array-contains":return[N.value]}return null}(h,l),g=function(R,I){const L=new Map;for(const N of Kp(I))for(const U of EC(R,N.fieldPath))switch(U.op){case"==":case"in":L.set(N.fieldPath.canonicalString(),U.value);break;case"not-in":case"!=":return L.set(N.fieldPath.canonicalString(),U.value),Array.from(L.values())}return null}(h,l),v=function(R,I){const L=[];let N=!0;for(const U of Kp(I)){const k=0===U.kind?AC(R,U.fieldPath,R.startAt):ER(R,U.fieldPath,R.startAt);L.push(k.value),N&&(N=k.inclusive)}return new uc(L,N)}(h,l),y=function(R,I){const L=[];let N=!0;for(const U of Kp(I)){const k=0===U.kind?ER(R,U.fieldPath,R.endAt):AC(R,U.fieldPath,R.endAt);L.push(k.value),N&&(N=k.inclusive)}return new uc(L,N)}(h,l),b=this.Ze(l,h,v),T=this.Ze(l,h,y),S=this.tn(l,h,g),C=this.en(l.indexId,m,b,v.inclusive,T,y.inclusive,S);return $e.forEach(C,R=>n.j(R,t.limit).next(I=>{I.forEach(L=>{const N=fn.fromSegments(L.documentKey);o.has(N)||(o=o.add(N),a.push(N))})}))}).next(()=>a)}return $e.resolve(null)})}Ye(e){let t=this.Je.get(e);return t||(t=[e],this.Je.set(e,t),t)}en(e,t,n,r,s,o,a){const l=(null!=t?t.length:1)*Math.max(n.length,s.length),h=l/(null!=t?t.length:1),f=[];for(let m=0;m<l;++m){const g=t?this.nn(t[m/h]):tE,v=this.sn(e,g,n[m%h],r),y=this.rn(e,g,s[m%h],o),b=a.map(T=>this.sn(e,g,T,!0));f.push(...this.createRange(v,y,b))}return f}sn(e,t,n,r){const s=new Of(e,fn.empty(),t,n);return r?s:s.Le()}rn(e,t,n,r){const s=new Of(e,fn.empty(),t,n);return r?s.Le():s}Xe(e,t){const n=new _N(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let o=null;for(const a of s)n.Ge(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let n=2;return $e.forEach(this.Ye(t),r=>this.Xe(e,r).next(s=>{s?0!==n&&s.fields.length<function(o){let a=new Mr(Ss.comparator),l=!1;for(const h of o.filters){const f=h;f.field.isKeyField()||("array-contains"===f.op||"array-contains-any"===f.op?l=!0:a=a.add(f.field))}for(const h of o.orderBy)h.field.isKeyField()||(a=a.add(h.field));return a.size+(l?1:0)}(r)&&(n=1):n=0})).next(()=>n)}on(e,t){const n=new oT;for(const r of Kp(e)){const s=t.data.field(r.fieldPath);if(null==s)return null;const o=n.Be(r.kind);am.ye.re(s,o)}return n.Me()}nn(e){const t=new oT;return am.ye.re(e,t.Be(0)),t.Me()}un(e,t){const n=new oT;return am.ye.re(Jg(this.databaseId,t),n.Be(function(r){const s=Kp(r);return 0===s.length?0:s[s.length-1].kind}(e))),n.Me()}tn(e,t,n){if(null===n)return[];let r=[];r.push(new oT);let s=0;for(const o of Kp(e)){const a=n[s++];for(const l of r)if(this.cn(t,o.fieldPath)&&jy(a))r=this.an(r,o,a);else{const h=l.Be(o.kind);am.ye.re(a,h)}}return this.hn(r)}Ze(e,t,n){return this.tn(e,t,n.position)}hn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Me();return t}an(e,t,n){const r=[...e],s=[];for(const o of n.arrayValue.values||[])for(const a of r){const l=new oT;l.seed(a.Me()),am.ye.re(o,l.Be(t.kind)),s.push(l)}return s}cn(e,t){return!!e.filters.find(n=>n instanceof ea&&n.field.isEqual(t)&&("in"===n.op||"not-in"===n.op))}getFieldIndexes(e,t){const n=cm(e),r=s0(e);return(t?n.K("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.K()).next(s=>{const o=[];return $e.forEach(s,a=>r.get([a.indexId,this.uid]).next(l=>{o.push(function(h,f){const m=f?new By(f.sequenceNumber,new Fl(Lf(f.readTime),new fn(nh(f.documentKey)),f.largestBatchId)):By.empty(),g=h.fields.map(([v,y])=>new Ny(Ss.fromServerFormat(v),y));return new Lx(h.indexId,h.collectionGroup,g,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((n,r)=>{const s=n.indexState.sequenceNumber-r.indexState.sequenceNumber;return 0!==s?s:_i(n.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){const r=cm(e),s=s0(e);return this.ln(e).next(o=>r.K("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>$e.forEach(a,l=>s.put(fI(l.indexId,this.user,o,n)))))}updateIndexEntries(e,t){const n=new Map;return $e.forEach(t,(r,s)=>{const o=n.get(r.collectionGroup);return(o?$e.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(a=>(n.set(r.collectionGroup,a),$e.forEach(a,l=>this.fn(e,r,l).next(h=>{const f=this.dn(s,l);return h.isEqual(f)?$e.resolve():this._n(e,s,l,h,f)}))))})}wn(e,t,n,r){return r0(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.un(n,t.key),documentKey:t.key.path.toArray()})}mn(e,t,n,r){return r0(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.un(n,t.key),t.key.path.toArray()])}fn(e,t,n){const r=r0(e);let s=new Mr(lm);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.un(n,t)])},(o,a)=>{s=s.add(new Of(n.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}dn(e,t){let n=new Mr(lm);const r=this.on(t,e);if(null==r)return n;const s=ky(t);if(null!=s){const o=e.data.field(s.fieldPath);if(jy(o))for(const a of o.arrayValue.values||[])n=n.add(new Of(t.indexId,e.key,this.nn(a),r))}else n=n.add(new Of(t.indexId,e.key,tE,r));return n}_n(e,t,n,r,s){qt("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(a,l,h,f,m){const g=a.getIterator(),v=l.getIterator();let y=iu(g),b=iu(v);for(;y||b;){let T=!1,S=!1;if(y&&b){const C=h(y,b);C<0?S=!0:C>0&&(T=!0)}else null!=y?S=!0:T=!0;T?(f(b),b=iu(v)):S?(m(y),y=iu(g)):(y=iu(g),b=iu(v))}}(r,s,lm,a=>{o.push(this.wn(e,t,n,a))},a=>{o.push(this.mn(e,t,n,a))}),$e.waitFor(o)}ln(e){let t=1;return s0(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,r,s)=>{s.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((o,a)=>lm(o,a)).filter((o,a,l)=>!a||0!==lm(o,l[a-1]));const r=[];r.push(e);for(const o of n){const a=lm(o,e),l=lm(o,t);if(0===a)r[0]=e.Le();else if(a>0&&l<0)r.push(o),r.push(o.Le());else if(l>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2)s.push(IDBKeyRange.bound([r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,tE,[]],[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,tE,[]]));return s}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(vI)}getMinOffset(e,t){return $e.mapArray(this.Ye(t),n=>this.Xe(e,n).next(r=>r||In())).next(vI)}}function vN(i){return Js(i,"collectionParents")}function r0(i){return Js(i,"indexEntries")}function cm(i){return Js(i,"indexConfiguration")}function s0(i){return Js(i,"indexState")}function vI(i){fi(0!==i.length);let e=i[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<i.length;n++){const r=i[n].indexState.offset;kx(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Fl(e.readTime,e.documentKey,t)}const nE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class eo{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new eo(e,eo.DEFAULT_COLLECTION_PERCENTILE,eo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function iE(i,e,t){const n=i.store("mutations"),r=i.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=n.J({range:o},(f,m,g)=>(a++,g.delete()));s.push(l.next(()=>{fi(1===a)}));const h=[];for(const f of t.mutations){const m=oN(e,f.key.path,t.batchId);s.push(r.delete(m)),h.push(f.key)}return $e.waitFor(s).next(()=>h)}function f_(i){if(!i)return 0;let e;if(i.document)e=i.document;else if(i.unknownDocument)e=i.unknownDocument;else{if(!i.noDocument)throw In();e=i.noDocument}return JSON.stringify(e).length}eo.DEFAULT_COLLECTION_PERCENTILE=10,eo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,eo.DEFAULT=new eo(41943040,eo.DEFAULT_COLLECTION_PERCENTILE,eo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),eo.DISABLED=new eo(-1,0,0);class p_{constructor(e,t,n,r){this.userId=e,this.wt=t,this.indexManager=n,this.referenceDelegate=r,this.gn={}}static se(e,t,n,r){fi(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new p_(s,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ih(e).J({index:"userMutationsIndex",range:n},(r,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,n,r){const s=kf(e),o=ih(e);return o.add({}).next(a=>{fi("number"==typeof a);const l=new ou(a,t,n,r),h=function(g,v,y){const b=y.baseMutations.map(S=>l_(g.ne,S)),T=y.mutations.map(S=>l_(g.ne,S));return{userId:v,batchId:y.batchId,localWriteTimeMs:y.localWriteTime.toMillis(),baseMutations:b,mutations:T}}(this.wt,this.userId,l),f=[];let m=new Mr((g,v)=>_i(g.canonicalString(),v.canonicalString()));for(const g of r){const v=oN(this.userId,g.key.path,a);m=m.add(g.key.path.popLast()),f.push(o.put(h)),f.push(s.put(v,su))}return m.forEach(g=>{f.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.gn[a]=l.keys()}),$e.waitFor(f).next(()=>l)})}lookupMutationBatch(e,t){return ih(e).get(t).next(n=>n?(fi(n.userId===this.userId),sm(this.wt,n)):null)}yn(e,t){return this.gn[t]?$e.resolve(this.gn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){const r=n.keys();return this.gn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return ih(e).J({index:"userMutationsIndex",range:r},(o,a,l)=>{a.userId===this.userId&&(fi(a.batchId>=n),s=sm(this.wt,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return ih(e).J({index:"userMutationsIndex",range:t,reverse:!0},(r,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ih(e).K("userMutationsIndex",t).next(n=>n.map(r=>sm(this.wt,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Jy(this.userId,t.path),r=IDBKeyRange.lowerBound(n),s=[];return kf(e).J({range:r},(o,a,l)=>{const[h,f,m]=o,g=nh(f);if(h===this.userId&&t.path.isEqual(g))return ih(e).get(m).next(v=>{if(!v)throw In();fi(v.userId===this.userId),s.push(sm(this.wt,v))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Mr(_i);const r=[];return t.forEach(s=>{const o=Jy(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=kf(e).J({range:a},(h,f,m)=>{const[g,v,y]=h,b=nh(v);g===this.userId&&s.path.isEqual(b)?n=n.add(y):m.done()});r.push(l)}),$e.waitFor(r).next(()=>this.pn(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,s=Jy(this.userId,n),o=IDBKeyRange.lowerBound(s);let a=new Mr(_i);return kf(e).J({range:o},(l,h,f)=>{const[m,g,v]=l,y=nh(g);m===this.userId&&n.isPrefixOf(y)?y.length===r&&(a=a.add(v)):f.done()}).next(()=>this.pn(e,a))}pn(e,t){const n=[],r=[];return t.forEach(s=>{r.push(ih(e).get(s).next(o=>{if(null===o)throw In();fi(o.userId===this.userId),n.push(sm(this.wt,o))}))}),$e.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return iE(e.ee,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.In(t.batchId)}),$e.forEach(n,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return $e.resolve();const n=IDBKeyRange.lowerBound([this.userId]),r=[];return kf(e).J({range:n},(s,o,a)=>{if(s[0]===this.userId){const l=nh(s[1]);r.push(l)}else a.done()}).next(()=>{fi(0===r.length)})})}containsKey(e,t){return yI(e,this.userId,t)}Tn(e){return o0(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function yI(i,e,t){const n=Jy(e,t.path),r=n[1],s=IDBKeyRange.lowerBound(n);let o=!1;return kf(i).J({range:s,H:!0},(a,l,h)=>{const[f,m,g]=a;f===e&&m===r&&(o=!0),h.done()}).next(()=>o)}function ih(i){return Js(i,"mutations")}function kf(i){return Js(i,"documentMutations")}function o0(i){return Js(i,"mutationQueues")}class m_{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new m_(0)}static Rn(){return new m_(-1)}}class mH{constructor(e,t){this.referenceDelegate=e,this.wt=t}allocateTargetId(e){return this.bn(e).next(t=>{const n=new m_(t.highestTargetId);return t.highestTargetId=n.next(),this.Pn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.bn(e).next(t=>ci.fromTimestamp(new mr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.bn(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Pn(e,r)))}addTargetData(e,t){return this.vn(e,t).next(()=>this.bn(e).next(n=>(n.targetCount+=1,this.Vn(t,n),this.Pn(e,n))))}updateTargetData(e,t){return this.vn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>a0(e).delete(t.targetId)).next(()=>this.bn(e)).next(n=>(fi(n.targetCount>0),n.targetCount-=1,this.Pn(e,n)))}removeTargets(e,t,n){let r=0;const s=[];return a0(e).J((o,a)=>{const l=h_(a);l.sequenceNumber<=t&&null===n.get(l.targetId)&&(r++,s.push(this.removeTargetData(e,l)))}).next(()=>$e.waitFor(s)).next(()=>r)}forEachTarget(e,t){return a0(e).J((n,r)=>{const s=h_(r);t(s)})}bn(e){return yN(e).get("targetGlobalKey").next(t=>(fi(null!==t),t))}Pn(e,t){return yN(e).put("targetGlobalKey",t)}vn(e,t){return a0(e).put(pN(this.wt,t))}Vn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.bn(e).next(t=>t.targetCount)}getTargetData(e,t){const n=Af(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return a0(e).J({range:r,index:"queryTargetsIndex"},(o,a,l)=>{const h=h_(a);t_(t,h.target)&&(s=h,l.done())}).next(()=>s)}addMatchingKeys(e,t,n){const r=[],s=hd(e);return t.forEach(o=>{const a=Oa(o.path);r.push(s.put({targetId:n,path:a})),r.push(this.referenceDelegate.addReference(e,n,o))}),$e.waitFor(r)}removeMatchingKeys(e,t,n){const r=hd(e);return $e.forEach(t,s=>{const o=Oa(s.path);return $e.waitFor([r.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){const n=hd(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=hd(e);let s=Si();return r.J({range:n,H:!0},(o,a,l)=>{const h=nh(o[1]),f=new fn(h);s=s.add(f)}).next(()=>s)}containsKey(e,t){const n=Oa(t.path),r=IDBKeyRange.bound([n],[uR(n)],!1,!0);let s=0;return hd(e).J({index:"documentTargetsIndex",H:!0,range:r},([o,a],l,h)=>{0!==o&&(s++,h.done())}).next(()=>s>0)}te(e,t){return a0(e).get(t).next(n=>n?h_(n):null)}}function a0(i){return Js(i,"targets")}function yN(i){return Js(i,"targetGlobal")}function hd(i){return Js(i,"targetDocuments")}function bI([i,e],[t,n]){const r=_i(i,t);return 0===r?_i(e,n):r}class bN{constructor(e){this.Sn=e,this.buffer=new Mr(bI),this.Dn=0}Cn(){return++this.Dn}xn(e){const t=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();bI(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class xN{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Nn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return null!==this.Nn}kn(e){var t=this;qt("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,nt.Z)(function*(){t.Nn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(n){rd(n)?qt("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Sf(n)}yield t.kn(3e5)}))}}class TN{constructor(e,t){this.Mn=e,this.params=t}calculateTargetCount(e,t){return this.Mn.On(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(0===t)return $e.resolve(ya.ot);const n=new bN(t);return this.Mn.forEachTarget(e,r=>n.xn(r.sequenceNumber)).next(()=>this.Mn.Fn(e,r=>n.xn(r))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Mn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Mn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(qt("LruGarbageCollector","Garbage collection skipped; disabled"),$e.resolve(nE)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(qt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),nE):this.$n(e,t))}getCacheSize(e){return this.Mn.getCacheSize(e)}$n(e,t){let n,r,s,o,a,l,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(qt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),r=this.params.maximumSequenceNumbersToCollect):r=m,o=Date.now(),this.nthSequenceNumber(e,r))).next(m=>(n=m,a=Date.now(),this.removeTargets(e,n,t))).next(m=>(s=m,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(m=>(h=Date.now(),mC()<=Zh.in.DEBUG&&qt("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-f}ms\n\tDetermined least recently used ${r} in `+(a-o)+`ms\n\tRemoved ${s} targets in `+(l-a)+`ms\n\tRemoved ${m} documents in `+(h-l)+`ms\nTotal Duration: ${h-f}ms`),$e.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:m})))}}class xI{constructor(e,t){this.db=e,this.garbageCollector=new TN(this,t)}On(e){const t=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(r=>n+r))}Bn(e){let t=0;return this.Fn(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Fn(e,t){return this.Ln(e,(n,r)=>t(r))}addReference(e,t,n){return l0(e,n)}removeReference(e,t,n){return l0(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return l0(e,t)}Un(e,t){return function(n,r){let s=!1;return o0(n).Y(o=>yI(n,o,r).next(a=>(a&&(s=!0),$e.resolve(!a)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Ln(e,(o,a)=>{if(a<=t){const l=this.Un(e,o).next(h=>{if(!h)return s++,n.getEntry(e,o).next(()=>(n.removeEntry(o,ci.min()),hd(e).delete([0,Oa(o.path)])))});r.push(l)}}).next(()=>$e.waitFor(r)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return l0(e,t)}Ln(e,t){const n=hd(e);let r,s=ya.ot;return n.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:h})=>{0===o?(s!==ya.ot&&t(new fn(nh(r)),s),s=h,r=l):s=ya.ot}).next(()=>{s!==ya.ot&&t(new fn(nh(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function l0(i,e){return hd(i).put((n=i.currentSequenceNumber,{targetId:0,path:Oa(e.path),sequenceNumber:n}));var n}class rE{constructor(){this.changes=new If(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Dr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?$e.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class wN{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return g_(e).put(n)}removeEntry(e,t,n){return g_(e).delete(function(r,s){const o=r.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],e0(s),o[o.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.qn(e,n)))}getEntry(e,t){let n=Dr.newInvalidDocument(t);return g_(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(__(t))},(r,s)=>{n=this.Kn(t,s)}).next(()=>n)}Gn(e,t){let n={size:0,document:Dr.newInvalidDocument(t)};return g_(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(__(t))},(r,s)=>{n={document:this.Kn(t,s),size:f_(s)}}).next(()=>n)}getEntries(e,t){let n=go();return this.Qn(e,t,(r,s)=>{const o=this.Kn(r,s);n=n.insert(r,o)}).next(()=>n)}jn(e,t){let n=go(),r=new Cs(fn.comparator);return this.Qn(e,t,(s,o)=>{const a=this.Kn(s,o);n=n.insert(s,a),r=r.insert(s,f_(o))}).next(()=>({documents:n,Wn:r}))}Qn(e,t,n){if(t.isEmpty())return $e.resolve();let r=new Mr(MI);t.forEach(l=>r=r.add(l));const s=IDBKeyRange.bound(__(r.first()),__(r.last())),o=r.getIterator();let a=o.getNext();return g_(e).J({index:"documentKeyIndex",range:s},(l,h,f)=>{const m=fn.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;a&&MI(a,m)<0;)n(a,null),a=o.getNext();a&&a.isEqual(m)&&(n(a,h),a=o.hasNext()?o.getNext():null),a?f.q(__(a)):f.done()}).next(()=>{for(;a;)n(a,null),a=o.hasNext()?o.getNext():null})}getAllFromCollection(e,t,n){const r=[t.popLast().toArray(),t.lastSegment(),e0(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],s=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return g_(e).K(IDBKeyRange.bound(r,s,!0)).next(o=>{let a=go();for(const l of o){const h=this.Kn(fn.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);a=a.insert(h.key,h)}return a})}getAllFromCollectionGroup(e,t,n,r){let s=go();const o=lT(t,n),a=lT(t,Fl.max());return g_(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,h,f)=>{const m=this.Kn(fn.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(m.key,m),s.size===r&&f.done()}).next(()=>s)}newChangeBuffer(e){return new wI(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return aT(e).get("remoteDocumentGlobalKey").next(t=>(fi(!!t),t))}qn(e,t){return aT(e).put("remoteDocumentGlobalKey",t)}Kn(e,t){if(t){const n=function fN(i,e){let t;if(e.document)t=zC(i.ne,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=fn.fromSegments(e.noDocument.path),r=Lf(e.noDocument.readTime);t=Dr.newNoDocument(n,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return In();{const n=fn.fromSegments(e.unknownDocument.path),r=Lf(e.unknownDocument.version);t=Dr.newUnknownDocument(n,r)}}return e.readTime&&t.setReadTime(function(n){const r=new mr(n[0],n[1]);return ci.fromTimestamp(r)}(e.readTime)),t}(this.wt,t);if(!n.isNoDocument()||!n.version.isEqual(ci.min()))return n}return Dr.newInvalidDocument(e)}}function TI(i){return new wN(i)}class wI extends rE{constructor(e,t){super(),this.zn=e,this.trackRemovals=t,this.Hn=new If(n=>n.toString(),(n,r)=>n.isEqual(r))}applyChanges(e){const t=[];let n=0,r=new Mr((s,o)=>_i(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Hn.get(s);if(t.push(this.zn.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=dI(this.zn.wt,o);r=r.add(s.path.popLast()),n+=f_(l)-a.size,t.push(this.zn.addEntry(e,s,l))}else if(n-=a.size,this.trackRemovals){const l=dI(this.zn.wt,o.convertToNoDocument(ci.min()));t.push(this.zn.addEntry(e,s,l))}}),r.forEach(s=>{t.push(this.zn.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.zn.updateMetadata(e,n)),$e.waitFor(t)}getFromCache(e,t){return this.zn.Gn(e,t).next(n=>(this.Hn.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.zn.jn(e,t).next(({documents:n,Wn:r})=>(r.forEach((s,o)=>{this.Hn.set(s,{size:o,readTime:n.get(s).readTime})}),n))}}function aT(i){return Js(i,"remoteDocumentGlobal")}function g_(i){return Js(i,"remoteDocumentsV14")}function __(i){const e=i.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function lT(i,e){const t=e.documentKey.path.toArray();return[i,e0(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function MI(i,e){const t=i.path.toArray(),n=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(r=_i(t[s],n[s]),r)return r;return r=_i(t.length,n.length),r||(r=_i(t[t.length-2],n[n.length-2]),r||_i(t[t.length-1],n[n.length-1]))}class MN{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class SN{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.getBaseDocument(e,t,n))).next(r=>(null!==n&&Zy(n.mutation,r,ol.empty(),mr.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Si()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Si()){const r=ld();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(s=>{let o=o_();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=ld();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Si()))}populateOverlays(e,t,n){const r=[];return n.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,n,r){let s=go();const o=Jx(),a=Jx();return t.forEach((l,h)=>{const f=n.get(h.key);r.has(h.key)&&(void 0===f||f.mutation instanceof ad)?s=s.insert(h.key,h):void 0!==f&&(o.set(h.key,f.mutation.getFieldMask()),Zy(f.mutation,h,f.mutation.getFieldMask(),mr.now()))}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((h,f)=>o.set(h,f)),t.forEach((h,f)=>{var m;return a.set(h,new MN(f,null!==(m=o.get(h))&&void 0!==m?m:null))}),a))}recalculateAndSaveOverlays(e,t){const n=Jx();let r=new Cs((o,a)=>o-a),s=Si();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const h=t.get(l);if(null===h)return;let f=n.get(l)||ol.empty();f=a.applyToLocalView(h,f),n.set(l,f);const m=(r.get(a.batchId)||Si()).add(l);r=r.insert(a.batchId,m)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),h=l.key,f=l.value,m=zR();f.forEach(g=>{if(!s.has(g)){const v=NC(t.get(g),n.get(g));null!==v&&m.set(g,v),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return $e.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n){return fn.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Zx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):$e.resolve(ld());let a=-1,l=s;return o.next(h=>$e.forEach(h,(f,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),s.get(f)?$e.resolve():this.getBaseDocument(e,f,m).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,l,h,Si())).next(f=>({batchId:a,changes:Qx(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new fn(t)).next(n=>{let r=o_();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let s=o_();return this.indexManager.getCollectionParents(e,r).next(o=>$e.forEach(o,a=>{const l=(h=t,f=a.child(r),new hc(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt));var h,f;return this.getDocumentsMatchingCollectionQuery(e,l,n).next(h=>{h.forEach((f,m)=>{s=s.insert(f,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next(s=>(r=s,this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId))).next(s=>{s.forEach((a,l)=>{const h=l.getKey();null===r.get(h)&&(r=r.insert(h,Dr.newInvalidDocument(h)))});let o=o_();return r.forEach((a,l)=>{const h=s.get(a);void 0!==h&&Zy(h.mutation,l,ol.empty(),mr.now()),Hy(t,l)&&(o=o.insert(a,l))}),o})}getBaseDocument(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):$e.resolve(Dr.newInvalidDocument(t))}}class gH{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,t){return $e.resolve(this.Jn.get(t))}saveBundleMetadata(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:ta(n.createTime)}),$e.resolve()}getNamedQuery(e,t){return $e.resolve(this.Yn.get(t))}saveNamedQuery(e,t){return this.Yn.set(t.name,{name:(n=t).name,query:t0(n.bundledQuery),readTime:ta(n.readTime)}),$e.resolve();var n}}class CN{constructor(){this.overlays=new Cs(fn.comparator),this.Xn=new Map}getOverlay(e,t){return $e.resolve(this.overlays.get(t))}getOverlays(e,t){const n=ld();return $e.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&n.set(r,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((r,s)=>{this.ie(e,t,s)}),$e.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Xn.get(n);return void 0!==r&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Xn.delete(n)),$e.resolve()}getOverlaysForCollection(e,t,n){const r=ld(),s=t.length+1,o=new fn(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&l.largestBatchId>n&&r.set(l.getKey(),l)}return $e.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new Cs((h,f)=>h-f);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>n){let f=s.get(h.largestBatchId);null===f&&(f=ld(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const a=ld(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((h,f)=>a.set(h,f)),!(a.size()>=r)););return $e.resolve(a)}ie(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const o=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new uI(t,n));let s=this.Xn.get(t);void 0===s&&(s=Si(),this.Xn.set(t,s)),this.Xn.set(t,s.add(n.key))}}class sE{constructor(){this.Zn=new Mr(Lo.ts),this.es=new Mr(Lo.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const n=new Lo(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}ss(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.rs(new Lo(e,t))}os(e,t){e.forEach(n=>this.removeReference(n,t))}us(e){const t=new fn(new Xi([])),n=new Lo(t,e),r=new Lo(t,e+1),s=[];return this.es.forEachInRange([n,r],o=>{this.rs(o),s.push(o.key)}),s}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new fn(new Xi([])),n=new Lo(t,e),r=new Lo(t,e+1);let s=Si();return this.es.forEachInRange([n,r],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new Lo(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Lo{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return fn.comparator(e.key,t.key)||_i(e.ls,t.ls)}static ns(e,t){return _i(e.ls,t.ls)||fn.comparator(e.key,t.key)}}class _H{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.fs=1,this.ds=new Mr(Lo.ts)}checkEmpty(e){return $e.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const s=this.fs;this.fs++;const o=new ou(s,t,n,r);this.mutationQueue.push(o);for(const a of r)this.ds=this.ds.add(new Lo(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return $e.resolve(o)}lookupMutationBatch(e,t){return $e.resolve(this._s(t))}getNextMutationBatchAfterBatchId(e,t){const r=this.ws(t+1),s=r<0?0:r;return $e.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return $e.resolve(0===this.mutationQueue.length?-1:this.fs-1)}getAllMutationBatches(e){return $e.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Lo(t,0),r=new Lo(t,Number.POSITIVE_INFINITY),s=[];return this.ds.forEachInRange([n,r],o=>{const a=this._s(o.ls);s.push(a)}),$e.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Mr(_i);return t.forEach(r=>{const s=new Lo(r,0),o=new Lo(r,Number.POSITIVE_INFINITY);this.ds.forEachInRange([s,o],a=>{n=n.add(a.ls)})}),$e.resolve(this.gs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;fn.isDocumentKey(s)||(s=s.child(""));const o=new Lo(new fn(s),0);let a=new Mr(_i);return this.ds.forEachWhile(l=>{const h=l.key.path;return!!n.isPrefixOf(h)&&(h.length===r&&(a=a.add(l.ls)),!0)},o),$e.resolve(this.gs(a))}gs(e){const t=[];return e.forEach(n=>{const r=this._s(n);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){fi(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();let n=this.ds;return $e.forEach(t.mutations,r=>{const s=new Lo(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.ds=n})}In(e){}containsKey(e,t){const n=new Lo(t,0),r=this.ds.firstAfterOrEqual(n);return $e.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return $e.resolve()}ys(e,t){return this.ws(e)}ws(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}_s(e){const t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class vH{constructor(e){this.ps=e,this.docs=new Cs(fn.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,o=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return $e.resolve(n?n.document.mutableCopy():Dr.newInvalidDocument(t))}getEntries(e,t){let n=go();return t.forEach(r=>{const s=this.docs.get(r);n=n.insert(r,s?s.document.mutableCopy():Dr.newInvalidDocument(r))}),$e.resolve(n)}getAllFromCollection(e,t,n){let r=go();const s=new fn(t.child("")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:a,value:{document:l}}=o.getNext();if(!t.isPrefixOf(a.path))break;a.path.length>t.length+1||kx(Ox(l),n)<=0||(r=r.insert(l.key,l.mutableCopy()))}return $e.resolve(r)}getAllFromCollectionGroup(e,t,n,r){In()}Is(e,t){return $e.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new yH(this)}getSize(e){return $e.resolve(this.size)}}class yH extends rE{constructor(e){super(),this.zn=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.zn.addEntry(e,r)):this.zn.removeEntry(n)}),$e.waitFor(t)}getFromCache(e,t){return this.zn.getEntry(e,t)}getAllFromCache(e,t){return this.zn.getEntries(e,t)}}class bH{constructor(e){this.persistence=e,this.Ts=new If(t=>Af(t),t_),this.lastRemoteSnapshotVersion=ci.min(),this.highestTargetId=0,this.Es=0,this.As=new sE,this.targetCount=0,this.Rs=m_.An()}forEachTarget(e,t){return this.Ts.forEach((n,r)=>t(r)),$e.resolve()}getLastRemoteSnapshotVersion(e){return $e.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $e.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),$e.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),$e.resolve()}vn(e){this.Ts.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new m_(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,t){return this.vn(t),this.targetCount+=1,$e.resolve()}updateTargetData(e,t){return this.vn(t),$e.resolve()}removeTargetData(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,$e.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.Ts.forEach((o,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.Ts.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),$e.waitFor(s).next(()=>r)}getTargetCount(e){return $e.resolve(this.targetCount)}getTargetData(e,t){const n=this.Ts.get(t)||null;return $e.resolve(n)}addMatchingKeys(e,t,n){return this.As.ss(t,n),$e.resolve()}removeMatchingKeys(e,t,n){this.As.os(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),$e.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.As.us(t),$e.resolve()}getMatchingKeysForTargetId(e,t){const n=this.As.hs(t);return $e.resolve(n)}containsKey(e,t){return $e.resolve(this.As.containsKey(t))}}class EN{constructor(e,t){this.bs={},this.overlays={},this.Ps=new ya(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new bH(this),this.indexManager=new fH,this.remoteDocumentCache=new vH(n=>this.referenceDelegate.Ss(n)),this.wt=new hI(t),this.Ds=new gH(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new CN,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.bs[e.toKey()];return n||(n=new _H(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,t,n){qt("MemoryPersistence","Starting transaction:",e);const r=new AN(this.Ps.next());return this.referenceDelegate.Cs(),n(r).next(s=>this.referenceDelegate.xs(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Ns(e,t){return $e.or(Object.values(this.bs).map(n=>()=>n.containsKey(e,t)))}}class AN extends mR{constructor(e){super(),this.currentSequenceNumber=e}}class oE{constructor(e){this.persistence=e,this.ks=new sE,this.Ms=null}static Os(e){return new oE(e)}get Fs(){if(this.Ms)return this.Ms;throw In()}addReference(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),$e.resolve()}removeReference(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),$e.resolve()}markPotentiallyOrphaned(e,t){return this.Fs.add(t.toString()),$e.resolve()}removeTarget(e,t){this.ks.us(t.targetId).forEach(r=>this.Fs.add(r.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Fs.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Cs(){this.Ms=new Set}xs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $e.forEach(this.Fs,n=>{const r=fn.fromPath(n);return this.$s(e,r).next(s=>{s||t.removeEntry(r,ci.min())})}).next(()=>(this.Ms=null,t.apply(e)))}updateLimboDocument(e,t){return this.$s(e,t).next(n=>{n?this.Fs.delete(t.toString()):this.Fs.add(t.toString())})}Ss(e){return 0}$s(e,t){return $e.or([()=>$e.resolve(this.ks.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ns(e,t)])}}class xH{constructor(e){this.wt=e}M(e,t,n,r){const s=new Nx("createOrUpgrade",t);var a;n<1&&r>=1&&(e.createObjectStore("owner"),(a=e).createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ZC,{unique:!0}),a.createObjectStore("documentMutations"),DN(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=$e.resolve();return n<3&&r>=3&&(0!==n&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),DN(e)),o=o.next(()=>function(a){const l=a.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ci.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",h)}(s))),n<4&&r>=4&&(0!==n&&(o=o.next(()=>function(a,l){return l.store("mutations").K().next(h=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ZC,{unique:!0});const f=l.store("mutations"),m=h.map(g=>f.put(g));return $e.waitFor(m)})}(e,s))),o=o.next(()=>{!function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),n<5&&r>=5&&(o=o.next(()=>this.Bs(s))),n<6&&r>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(s)))),n<7&&r>=7&&(o=o.next(()=>this.Us(s))),n<8&&r>=8&&(o=o.next(()=>this.qs(e,s))),n<9&&r>=9&&(o=o.next(()=>{!function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")}(e)})),n<10&&r>=10&&(o=o.next(()=>this.Ks(s))),n<11&&r>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&r>=12&&(o=o.next(()=>{!function(a){const l=a.createObjectStore("documentOverlays",{keyPath:dN});l.createIndex("collectionPathOverlayIndex",sI,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",oI,{unique:!1})}(e)})),n<13&&r>=13&&(o=o.next(()=>function(a){const l=a.createObjectStore("remoteDocumentsV14",{keyPath:aN});l.createIndex("documentKeyIndex",YC),l.createIndex("collectionGroupIndex",lN)}(e)).next(()=>this.Gs(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&r>=14&&(o=o.next(()=>this.Qs(e,s))),n<15&&r>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:hN}).createIndex("sequenceNumberIndex",XC,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:iI}).createIndex("documentKeyIndex",rI,{unique:!1})}(e))),o}Ls(e){let t=0;return e.store("remoteDocuments").J((n,r)=>{t+=f_(r)}).next(()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}Bs(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.K().next(r=>$e.forEach(r,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.K("userMutationsIndex",o).next(a=>$e.forEach(a,l=>{fi(l.userId===s.userId);const h=sm(this.wt,l);return iE(e,s.userId,h).next(()=>{})}))}))}Us(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const s=[];return n.J((o,a)=>{const l=new Xi(o),h=[0,Oa(l)];s.push(t.get(h).next(f=>f?$e.resolve():t.put({targetId:0,path:Oa(l),sequenceNumber:r.highestListenSequenceNumber})))}).next(()=>$e.waitFor(s))})}qs(e,t){e.createObjectStore("collectionParents",{keyPath:uN});const n=t.store("collectionParents"),r=new _I,s=o=>{if(r.add(o)){const a=o.lastSegment(),l=o.popLast();return n.put({collectionId:a,parent:Oa(l)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new Xi(o);return s(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,l],h)=>{const f=nh(a);return s(f.popLast())}))}Ks(e){const t=e.store("targets");return t.J((n,r)=>{const s=h_(r),o=pN(this.wt,s);return t.put(o)})}Gs(e,t){const n=t.store("remoteDocuments"),r=[];return n.J((s,o)=>{const a=t.store("remoteDocumentsV14"),l=(h=o,h.document?new fn(Xi.fromString(h.document.name).popFirst(5)):h.noDocument?fn.fromSegments(h.noDocument.path):h.unknownDocument?fn.fromSegments(h.unknownDocument.path):In()).path.toArray();var h;const f={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(f))}).next(()=>$e.waitFor(r))}Qs(e,t){const n=t.store("mutations"),r=TI(this.wt),s=new EN(oE.Os,this.wt.ne);return n.K().next(o=>{const a=new Map;return o.forEach(l=>{var h;let f=null!==(h=a.get(l.userId))&&void 0!==h?h:Si();sm(this.wt,l).keys().forEach(m=>f=f.add(m)),a.set(l.userId,f)}),$e.forEach(a,(l,h)=>{const f=new ws(h),m=om.se(this.wt,f),g=s.getIndexManager(f),v=p_.se(f,this.wt,g,s.referenceDelegate);return new SN(r,v,m,g).recalculateAndSaveOverlaysForDocumentKeys(new rT(t,ya.ot),l).next()})})}}function DN(i){i.createObjectStore("targetDocuments",{keyPath:cN}).createIndex("documentTargetsIndex",KC,{unique:!0}),i.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Ll,{unique:!0}),i.createObjectStore("targetGlobal")}const SI="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class CI{constructor(e,t,n,r,s,o,a,l,h,f,m=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.js=s,this.window=o,this.document=a,this.Ws=h,this.zs=f,this.Hs=m,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=g=>Promise.resolve(),!CI.V())throw new jt(at.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new xI(this,r),this.ei=t+"main",this.wt=new hI(l),this.ni=new nu(this.ei,this.Hs,new xH(this.wt)),this.Vs=new mH(this.referenceDelegate,this.wt),this.remoteDocumentCache=TI(this.wt),this.Ds=new pI,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,!1===f&&Ms("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new jt(at.FAILED_PRECONDITION,SI);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Vs.getHighestSequenceNumber(e))}).then(e=>{this.Ps=new ya(e,this.Ws)}).then(()=>{this.vs=!0}).catch(e=>(this.ni&&this.ni.close(),Promise.reject(e)))}ci(e){var t=this;return this.ti=function(){var n=(0,nt.Z)(function*(r){if(t.started)return e(r)});return function(r){return n.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F(function(){var t=(0,nt.Z)(function*(n){null===n.newVersion&&(yield e())});return function(n){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget((0,nt.Z)(function*(){t.started&&(yield t.ii())})))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>u(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ai(e).next(t=>{t||(this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)))})}).next(()=>this.hi(e)).next(t=>this.isPrimary&&!t?this.li(e).next(()=>!1):!!t&&this.fi(e).next(()=>!0))).catch(e=>{if(rd(e))return qt("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return qt("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.js.enqueueRetryable(()=>this.ti(e)),this.isPrimary=e})}ai(e){return cT(e).get("owner").next(t=>$e.resolve(this.di(t)))}_i(e){return u(e).delete(this.clientId)}wi(){var e=this;return(0,nt.Z)(function*(){if(e.isPrimary&&!e.mi(e.Zs,18e5)){e.Zs=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Js(n,"clientMetadata");return r.K().next(s=>{const o=e.gi(s,18e5),a=s.filter(l=>-1===o.indexOf(l));return $e.forEach(a,l=>r.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(e.si)for(const n of t)e.si.removeItem(e.yi(n.clientId))}})()}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ii().then(()=>this.wi()).then(()=>this.ui()))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?$e.resolve(!0):cT(e).get("owner").next(t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)){if(this.di(t)&&this.networkEnabled)return!0;if(!this.di(t)){if(!t.allowTabSynchronization)throw new jt(at.FAILED_PRECONDITION,SI);return!1}}return!(!this.networkEnabled||!this.inForeground)||u(e).K().next(n=>void 0===this.gi(n,5e3).find(r=>{if(this.clientId!==r.clientId){const o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(!this.networkEnabled&&r.networkEnabled||o&&a)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&qt("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,nt.Z)(function*(){e.vs=!1,e.Ii(),e.Xs&&(e.Xs.cancel(),e.Xs=null),e.Ti(),e.Ei(),yield e.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const n=new rT(t,ya.ot);return e.li(n).next(()=>e._i(n))}),e.ni.close(),e.Ai()})()}gi(e,t){return e.filter(n=>this.mi(n.updateTimeMs,t)&&!this.pi(n.clientId))}Ri(){return this.runTransaction("getActiveClients","readonly",e=>u(e).K().next(t=>this.gi(t,18e5).map(n=>n.clientId)))}get started(){return this.vs}getMutationQueue(e,t){return p_.se(e,this.wt,t,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new pH(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return om.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,t,n){qt("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",s=15===(o=this.Hs)?Pf:14===o?iT:13===o?cI:12===o?lI:11===o?aI:void In();var o;let a;return this.ni.runTransaction(e,r,s,l=>(a=new rT(l,this.Ps?this.Ps.next():ya.ot),"readwrite-primary"===t?this.ai(a).next(h=>!!h||this.hi(a)).next(h=>{if(!h)throw Ms(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)),new jt(at.FAILED_PRECONDITION,pR);return n(a)}).next(h=>this.fi(a).next(()=>h)):this.bi(a).next(()=>n(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}bi(e){return cT(e).get("owner").next(t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)&&!this.di(t)&&!(this.zs||this.allowTabSynchronization&&t.allowTabSynchronization))throw new jt(at.FAILED_PRECONDITION,SI)})}fi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return cT(e).put("owner",t)}static V(){return nu.V()}li(e){const t=cT(e);return t.get("owner").next(n=>this.di(n)?(qt("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):$e.resolve())}mi(e,t){const n=Date.now();return!(e<n-t||e>n&&(Ms(`Detected an update time that is in the future: ${e} > ${n}`),1))}ri(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ys=()=>{this.js.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ii()))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground="visible"===this.document.visibilityState)}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Js=()=>{this.Ii(),(0,Fi.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var t;try{const n=null!==(null===(t=this.si)||void 0===t?void 0:t.getItem(this.yi(e)));return qt("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Ms("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){Ms("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch{}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function cT(i){return Js(i,"owner")}function u(i){return Js(i,"clientMetadata")}function d(i,e){let t=i.projectId;return i.isDefaultDatabase||(t+="."+i.database),"firestore/"+e+"/"+t+"/"}class p{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Pi=n,this.vi=r}static Vi(e,t){let n=Si(),r=Si();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new p(e,t.fromCache,n,r)}}class _{constructor(){this.Si=!1}initialize(e,t){this.Di=e,this.indexManager=t,this.Si=!0}getDocumentsMatchingQuery(e,t,n,r){return this.Ci(e,t).next(s=>s||this.xi(e,t,r,n)).next(s=>s||this.Ni(e,t))}Ci(e,t){if(RC(t))return $e.resolve(null);let n=al(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=IC(t,null,"F"),n=al(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=Si(...s);return this.Di.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(l=>{const h=this.ki(t,a);return this.Mi(t,h,o,l.readTime)?this.Ci(e,IC(t,null,"F")):this.Oi(e,h,t,l)}))})))}xi(e,t,n,r){return RC(t)||r.isEqual(ci.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next(s=>{const o=this.ki(t,s);return this.Mi(t,o,n,r)?this.Ni(e,t):(mC()<=Zh.in.DEBUG&&qt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Kx(t)),this.Oi(e,o,t,fR(r,-1)))})}ki(e,t){let n=new Mr(IR(e));return t.forEach((r,s)=>{Hy(e,s)&&(n=n.add(s))}),n}Mi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ni(e,t){return mC()<=Zh.in.DEBUG&&qt("QueryEngine","Using full collection scan to execute query:",Kx(t)),this.Di.getDocumentsMatchingQuery(e,t,Fl.min())}Oi(e,t,n,r){return this.Di.getDocumentsMatchingQuery(e,n,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}class x{constructor(e,t,n,r){this.persistence=e,this.Fi=t,this.wt=r,this.$i=new Cs(_i),this.Bi=new If(s=>Af(s),t_),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(n)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new SN(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.$i))}}function w(i,e,t,n){return new x(i,e,t,n)}function D(i,e){return F.apply(this,arguments)}function F(){return F=(0,nt.Z)(function*(i,e){const t=yn(i);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let r;return t.mutationQueue.getAllMutationBatches(n).next(s=>(r=s,t.qi(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],a=[];let l=Si();for(const h of r){o.push(h.batchId);for(const f of h.mutations)l=l.add(f.key)}for(const h of s){a.push(h.batchId);for(const f of h.mutations)l=l.add(f.key)}return t.localDocuments.getDocuments(n,l).next(h=>({Ki:h,removedBatchIds:o,addedBatchIds:a}))})})}),F.apply(this,arguments)}function B(i,e){const t=yn(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const r=e.batch.keys(),s=t.Ui.newChangeBuffer({trackRemovals:!0});return function(o,a,l,h){const f=l.batch,m=f.keys();let g=$e.resolve();return m.forEach(v=>{g=g.next(()=>h.getEntry(a,v)).next(y=>{const b=l.docVersions.get(v);fi(null!==b),y.version.compareTo(b)<0&&(f.applyToRemoteDocument(y,l),y.isValidDocument()&&(y.setReadTime(l.commitVersion),h.addEntry(y)))})}),g.next(()=>o.mutationQueue.removeMutationBatch(a,f))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let a=Si();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(a=a.add(o.batch.mutations[l].key));return a}(e))).next(()=>t.localDocuments.getDocuments(n,r))})}function G(i){const e=yn(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Vs.getLastRemoteSnapshotVersion(t))}function X(i,e){const t=yn(i),n=e.snapshotVersion;let r=t.$i;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Ui.newChangeBuffer({trackRemovals:!0});r=t.$i;const a=[];e.targetChanges.forEach((f,m)=>{const g=r.get(m);if(!g)return;a.push(t.Vs.removeMatchingKeys(s,f.removedDocuments,m).next(()=>t.Vs.addMatchingKeys(s,f.addedDocuments,m)));let v=g.withSequenceNumber(s.currentSequenceNumber);var y,b,T;e.targetMismatches.has(m)?v=v.withResumeToken(Fo.EMPTY_BYTE_STRING,ci.min()).withLastLimboFreeSnapshotVersion(ci.min()):f.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(f.resumeToken,n)),r=r.insert(m,v),b=v,T=f,(0===(y=g).resumeToken.approximateByteSize()||b.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=3e8||T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0)&&a.push(t.Vs.updateTargetData(s,v))});let l=go(),h=Si();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(ae(s,o,e.documentUpdates).next(f=>{l=f.Gi,h=f.Qi})),!n.isEqual(ci.min())){const f=t.Vs.getLastRemoteSnapshotVersion(s).next(m=>t.Vs.setTargetsMetadata(s,s.currentSequenceNumber,n));a.push(f)}return $e.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,h)).next(()=>l)}).then(s=>(t.$i=r,s))}function ae(i,e,t){let n=Si(),r=Si();return t.forEach(s=>n=n.add(s)),e.getEntries(i,n).next(s=>{let o=go();return t.forEach((a,l)=>{const h=s.get(a);l.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(ci.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||0===l.version.compareTo(h.version)&&h.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):qt("LocalStore","Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",l.version)}),{Gi:o,Qi:r}})}function De(i,e){const t=yn(i);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Ue(i,e){const t=yn(i);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return t.Vs.getTargetData(n,e).next(s=>s?(r=s,$e.resolve(r)):t.Vs.allocateTargetId(n).next(o=>(r=new Ff(e,o,0,n.currentSequenceNumber),t.Vs.addTargetData(n,r).next(()=>r))))}).then(n=>{const r=t.$i.get(n.targetId);return(null===r||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.$i=t.$i.insert(n.targetId,n),t.Bi.set(e,n.targetId)),n})}function xt(i,e,t){return Ht.apply(this,arguments)}function Ht(){return Ht=(0,nt.Z)(function*(i,e,t){const n=yn(i),r=n.$i.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!rd(o))throw o;qt("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.$i=n.$i.remove(e),n.Bi.delete(r.target)}),Ht.apply(this,arguments)}function hn(i,e,t){const n=yn(i);let r=ci.min(),s=Si();return n.persistence.runTransaction("Execute query","readonly",o=>function(a,l,h){const f=yn(a),m=f.Bi.get(h);return void 0!==m?$e.resolve(f.$i.get(m)):f.Vs.getTargetData(l,h)}(n,o,al(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,n.Vs.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>n.Fi.getDocumentsMatchingQuery(o,e,t?r:ci.min(),t?s:Si())).next(a=>(kt(n,Xx(e),a),{documents:a,ji:s})))}function An(i,e){const t=yn(i),n=yn(t.Vs),r=t.$i.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>n.te(s,e).next(o=>o?o.target:null))}function si(i,e){const t=yn(i),n=t.Li.get(e)||ci.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.Ui.getAllFromCollectionGroup(r,e,fR(n,-1),Number.MAX_SAFE_INTEGER)).then(r=>(kt(t,e,r),r))}function kt(i,e,t){let n=ci.min();t.forEach((r,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),i.Li.set(e,n)}function Oi(){return Oi=(0,nt.Z)(function*(i,e,t,n){const r=yn(i);let s=Si(),o=go();for(const h of t){const f=e.Wi(h.metadata.name);h.document&&(s=s.add(f));const m=e.zi(h);m.setReadTime(e.Hi(h.metadata.readTime)),o=o.insert(f,m)}const a=r.Ui.newChangeBuffer({trackRemovals:!0}),l=yield Ue(r,(h=n,al(i_(Xi.fromString(`__bundle__/docs/${h}`)))));var h;return r.persistence.runTransaction("Apply bundle documents","readwrite",h=>ae(h,a,o).next(f=>(a.apply(h),f)).next(f=>r.Vs.removeMatchingKeysForTargetId(h,l.targetId).next(()=>r.Vs.addMatchingKeys(h,s,l.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(h,f.Gi,f.Qi)).next(()=>f.Gi)))}),Oi.apply(this,arguments)}function zr(i,e){return dd.apply(this,arguments)}function dd(){return dd=(0,nt.Z)(function*(i,e,t=Si()){const n=yield Ue(i,al(t0(e.bundledQuery))),r=yn(i);return r.persistence.runTransaction("Save named query","readwrite",s=>{const o=ta(e.readTime);if(n.snapshotVersion.compareTo(o)>=0)return r.Ds.saveNamedQuery(s,e);const a=n.withResumeToken(Fo.EMPTY_BYTE_STRING,o);return r.$i=r.$i.insert(a.targetId,a),r.Vs.updateTargetData(s,a).next(()=>r.Vs.removeMatchingKeysForTargetId(s,n.targetId)).next(()=>r.Vs.addMatchingKeys(s,t,n.targetId)).next(()=>r.Ds.saveNamedQuery(s,e))})}),dd.apply(this,arguments)}function uT(i,e){return`firestore_clients_${i}_${e}`}function hT(i,e,t){let n=`firestore_mutations_${i}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}function c0(i,e){return`firestore_targets_${i}_${e}`}class v_{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Ji(e,t,n){const r=JSON.parse(n);let s,o="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return o&&r.error&&(o="string"==typeof r.error.message&&"string"==typeof r.error.code,o&&(s=new jt(r.error.code,r.error.message))),o?new v_(e,t,r.state,s):(Ms("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class um{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Ji(e,t){const n=JSON.parse(t);let r,s="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return s&&n.error&&(s="string"==typeof n.error.message&&"string"==typeof n.error.code,s&&(r=new jt(n.error.code,n.error.message))),s?new um(e,n.state,r):(Ms("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class y_{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ji(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,s=Yy();for(let o=0;r&&o<n.activeTargetIds.length;++o)r=yR(n.activeTargetIds[o]),s=s.add(n.activeTargetIds[o]);return r?new y_(e,s):(Ms("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class u0{constructor(e,t){this.clientId=e,this.onlineState=t}static Ji(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new u0(t.clientId,t.onlineState):(Ms("SharedClientState",`Failed to parse online state: ${e}`),null)}}class h0{constructor(){this.activeTargetIds=Yy()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class d0{constructor(e,t,n,r,s){this.window=e,this.js=t,this.persistenceKey=n,this.tr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new Cs(_i),this.started=!1,this.ir=[];const o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.rr=uT(this.persistenceKey,this.tr),this.ur=`firestore_sequence_number_${this.persistenceKey}`,this.sr=this.sr.insert(this.tr,new h0),this.cr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.ar=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.lr=`firestore_online_state_${this.persistenceKey}`,this.dr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this.er)}static V(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,nt.Z)(function*(){const t=yield e.syncEngine.Ri();for(const r of t){if(r===e.tr)continue;const s=e.getItem(uT(e.persistenceKey,r));if(s){const o=y_.Ji(r,s);o&&(e.sr=e.sr.insert(o.clientId,o))}}e._r();const n=e.storage.getItem(e.lr);if(n){const r=e.wr(n);r&&e.mr(r)}for(const r of e.ir)e.nr(r);e.ir=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ur,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(e){let t=!1;return this.sr.forEach((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,t,n){this.yr(e,t,n),this.pr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(c0(this.persistenceKey,e));if(n){const r=um.Ji(e,n);r&&(t=r.state)}}return this.Ir.Xi(e),this._r(),t}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(c0(this.persistenceKey,e))}updateQueryState(e,t,n){this.Tr(e,t,n)}handleUserChange(e,t,n){t.forEach(r=>{this.pr(r)}),this.currentUser=e,n.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(e){this.Ar(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return qt("SharedClientState","READ",e,t),t}setItem(e,t){qt("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){qt("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){var t=this;const n=e;if(n.storageArea===this.storage){if(qt("SharedClientState","EVENT",n.key,n.newValue),n.key===this.rr)return void Ms("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable((0,nt.Z)(function*(){if(t.started){if(null!==n.key)if(t.cr.test(n.key)){if(null==n.newValue){const r=t.Rr(n.key);return t.br(r,null)}{const r=t.Pr(n.key,n.newValue);if(r)return t.br(r.clientId,r)}}else if(t.ar.test(n.key)){if(null!==n.newValue){const r=t.vr(n.key,n.newValue);if(r)return t.Vr(r)}}else if(t.hr.test(n.key)){if(null!==n.newValue){const r=t.Sr(n.key,n.newValue);if(r)return t.Dr(r)}}else if(n.key===t.lr){if(null!==n.newValue){const r=t.wr(n.newValue);if(r)return t.mr(r)}}else if(n.key===t.ur){const r=function(s){let o=ya.ot;if(null!=s)try{const a=JSON.parse(s);fi("number"==typeof a),o=a}catch(a){Ms("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==ya.ot&&t.sequenceNumberHandler(r)}else if(n.key===t.dr){const r=t.Cr(n.newValue);yield Promise.all(r.map(s=>t.syncEngine.Nr(s)))}}else t.ir.push(n)}))}}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,t,n){const r=new v_(this.currentUser,e,t,n),s=hT(this.persistenceKey,this.currentUser,e);this.setItem(s,r.Yi())}pr(e){const t=hT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Er(e){this.storage.setItem(this.lr,JSON.stringify({clientId:this.tr,onlineState:e}))}Tr(e,t,n){const r=c0(this.persistenceKey,e),s=new um(e,t,n);this.setItem(r,s.Yi())}Ar(e){const t=JSON.stringify(Array.from(e));this.setItem(this.dr,t)}Rr(e){const t=this.cr.exec(e);return t?t[1]:null}Pr(e,t){const n=this.Rr(e);return y_.Ji(n,t)}vr(e,t){const n=this.ar.exec(e),r=Number(n[1]);return v_.Ji(new ws(void 0!==n[2]?n[2]:null),r,t)}Sr(e,t){const n=this.hr.exec(e),r=Number(n[1]);return um.Ji(r,t)}wr(e){return u0.Ji(e)}Cr(e){return JSON.parse(e)}Vr(e){var t=this;return(0,nt.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.kr(e.batchId,e.state,e.error);qt("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Dr(e){return this.syncEngine.Mr(e.targetId,e.state,e.error)}br(e,t){const n=t?this.sr.insert(e,t):this.sr.remove(e),r=this.gr(this.sr),s=this.gr(n),o=[],a=[];return s.forEach(l=>{r.has(l)||o.push(l)}),r.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.Or(o,a).then(()=>{this.sr=n})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let t=Yy();return e.forEach((n,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class TH{constructor(){this.Fr=new h0,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,t,n){this.$r[e]=t}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new h0,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class b${Br(e){}shutdown(){}}class wH{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){qt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){qt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const x$={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class T${constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}class w$ extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.so=(e.ssl?"https":"http")+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,t,n,r,s){const o=this.oo(e,t);qt("RestConnection","Sending: ",o,n);const a={};return this.uo(a,r,s),this.co(e,o,a,n).then(l=>(qt("RestConnection","Received: ",l),l),l=>{throw Mf("RestConnection",`${e} failed with error: `,l,"url: ",o,"request:",n),l})}ao(e,t,n,r,s,o){return this.ro(e,t,n,r,s)}uo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+$u,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,s)=>e[s]=r),n&&n.headers.forEach((r,s)=>e[s]=r)}oo(e,t){return`${this.so}/v1/${t}:${x$[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,t,n,r){return new Promise((s,o)=>{const a=new sR;a.listenOnce(M2.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case pC.NO_ERROR:const h=a.getResponseJson();qt("Connection","XHR received:",JSON.stringify(h)),s(h);break;case pC.TIMEOUT:qt("Connection",'RPC "'+e+'" timed out'),o(new jt(at.DEADLINE_EXCEEDED,"Request time out"));break;case pC.HTTP_ERROR:const f=a.getStatus();if(qt("Connection",'RPC "'+e+'" failed with status:',f,"response text:",a.getResponseText()),f>0){const m=a.getResponseJson().error;if(m&&m.status&&m.message){const g=function(v){const y=v.toLowerCase().replace(/_/g,"-");return Object.values(at).indexOf(y)>=0?y:at.UNKNOWN}(m.status);o(new jt(g,m.message))}else o(new jt(at.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new jt(at.UNAVAILABLE,"Connection failed."));break;default:In()}}finally{qt("Connection",'RPC "'+e+'" completed.')}});const l=JSON.stringify(r);a.send(t,"POST",l,n,15)})}ho(e,t,n){const r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=w2(),o=Py(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new rR({})),this.uo(a.initMessageHeaders,t,n),(0,Fi.uI)()||(0,Fi.b$)()||(0,Fi.d)()||(0,Fi.w1)()||(0,Fi.Mn)()||(0,Fi.ru)()||(a.httpHeadersOverwriteParam="$httpHeaders");const l=r.join("");qt("Connection","Creating WebChannel: "+l,a);const h=s.createWebChannel(l,a);let f=!1,m=!1;const g=new T$({jr:y=>{m?qt("Connection","Not sending because WebChannel is closed:",y):(f||(qt("Connection","Opening WebChannel transport."),h.open(),f=!0),qt("Connection","WebChannel sending:",y),h.send(y))},Wr:()=>h.close()}),v=(y,b,T)=>{y.listen(b,S=>{try{T(S)}catch(C){setTimeout(()=>{throw C},0)}})};return v(h,Ly.EventType.OPEN,()=>{m||qt("Connection","WebChannel transport opened.")}),v(h,Ly.EventType.CLOSE,()=>{m||(m=!0,qt("Connection","WebChannel transport closed"),g.eo())}),v(h,Ly.EventType.ERROR,y=>{m||(m=!0,Mf("Connection","WebChannel transport errored:",y),g.eo(new jt(at.UNAVAILABLE,"The operation could not be completed")))}),v(h,Ly.EventType.MESSAGE,y=>{var b;if(!m){const T=y.data[0];fi(!!T);const S=T,C=S.error||(null===(b=S[0])||void 0===b?void 0:b.error);if(C){qt("Connection","WebChannel received error:",C);const R=C.status;let I=function(N){const U=us[N];if(void 0!==U)return jC(U)}(R),L=C.message;void 0===I&&(I=at.INTERNAL,L="Unknown error status: "+R+" with message "+C.message),m=!0,g.eo(new jt(I,L)),h.close()}else qt("Connection","WebChannel received:",T),g.no(T)}}),v(o,S2.STAT_EVENT,y=>{y.stat===Fy.PROXY?qt("Connection","Detected buffering proxy"):y.stat===Fy.NOPROXY&&qt("Connection","Detected no buffering proxy")}),setTimeout(()=>{g.Zr()},0),g}}function MH(){return typeof window<"u"?window:null}function EI(){return typeof document<"u"?document:null}function aE(i){return new $2(i,!0)}class RN{constructor(e,t,n=1e3,r=1.5,s=6e4){this.js=e,this.timerId=t,this.lo=n,this.fo=r,this._o=s,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const t=Math.floor(this.wo+this.To()),n=Math.max(0,Date.now()-this.yo),r=Math.max(0,t-n);r>0&&qt("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.wo} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,r,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}cancel(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}class SH{constructor(e,t,n,r,s,o,a,l){this.js=e,this.Ao=n,this.Ro=r,this.bo=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new RN(e,t)}Do(){return 1===this.state||5===this.state||this.Co()}Co(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.xo()}stop(){var e=this;return(0,nt.Z)(function*(){e.Do()&&(yield e.close(0))})()}No(){this.state=0,this.So.reset()}ko(){this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Mo()))}Oo(e){this.Fo(),this.stream.send(e)}Mo(){var e=this;return(0,nt.Z)(function*(){if(e.Co())return e.close(0)})()}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}close(e,t){var n=this;return(0,nt.Z)(function*(){n.Fo(),n.$o(),n.So.cancel(),n.Po++,4!==e?n.So.reset():t&&t.code===at.RESOURCE_EXHAUSTED?(Ms(t.toString()),Ms("Using maximum backoff delay to prevent overloading the backend."),n.So.po()):t&&t.code===at.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Bo(),n.stream.close(),n.stream=null),n.state=e,yield n.listener.Jr(t)})()}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),t=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.Po===t&&this.Uo(n,r)},n=>{e(()=>{const r=new jt(at.UNKNOWN,"Fetching auth token failed: "+n.message);return this.qo(r)})})}Uo(e,t){const n=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(()=>{n(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(r=>{n(()=>this.qo(r))}),this.stream.onMessage(r=>{n(()=>this.onMessage(r))})}xo(){var e=this;this.state=5,this.So.Io((0,nt.Z)(function*(){e.state=0,e.start()}))}qo(e){return qt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return t=>{this.js.enqueueAndForget(()=>this.Po===e?t():(qt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class M$ extends SH{constructor(e,t,n,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.wt=s}Ko(e,t){return this.bo.ho("Listen",e,t)}onMessage(e){this.So.reset();const t=function QR(i,e){let t;if("targetChange"in e){const n="NO_CHANGE"===(l=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===l?1:"REMOVE"===l?2:"CURRENT"===l?3:"RESET"===l?4:In(),r=e.targetChange.targetIds||[],s=function(l,h){return l.dt?(fi(void 0===h||"string"==typeof h),Fo.fromBase64String(h||"")):(fi(void 0===h||h instanceof Uint8Array),Fo.fromUint8Array(h||new Uint8Array))}(i,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const h=void 0===l.code?at.UNKNOWN:jC(l.code);return new jt(h,l.message||"")}(o);t=new qR(n,r,s,a||null)}else if("documentChange"in e){const n=e.documentChange,r=cd(i,n.document.name),s=ta(n.document.updateTime),o=new Jo({mapValue:{fields:n.document.fields}}),a=Dr.newFoundDocument(r,s,o);t=new Xy(n.targetIds||[],n.removedTargetIds||[],a.key,a)}else if("documentDelete"in e){const n=e.documentDelete,r=cd(i,n.document),s=n.readTime?ta(n.readTime):ci.min(),o=Dr.newNoDocument(r,s);t=new Xy([],n.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const n=e.documentRemove,r=cd(i,n.document);t=new Xy([],n.removedTargetIds||[],r,null)}else{if(!("filter"in e))return In();{const n=e.filter,s=new UR(n.count||0);t=new WR(n.targetId,s)}}var l;return t}(this.wt,e),n=function(r){if(!("targetChange"in r))return ci.min();const s=r.targetChange;return s.targetIds&&s.targetIds.length?ci.min():s.readTime?ta(s.readTime):ci.min()}(e);return this.listener.Go(t,n)}Qo(e){const t={};t.database=tT(this.wt),t.addTarget=function(r,s){let o;const a=s.target;return o=Hx(a)?{documents:WC(r,a)}:{query:eI(r,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0?o.resumeToken=Q2(r,s.resumeToken):s.snapshotVersion.compareTo(ci.min())>0&&(o.readTime=$y(r,s.snapshotVersion.toTimestamp())),o}(this.wt,e);const n=function lH(i,e){const t=function(n,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return In()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);n&&(t.labels=n),this.Oo(t)}jo(e){const t={};t.database=tT(this.wt),t.removeTarget=e,this.Oo(t)}}class S$ extends SH{constructor(e,t,n,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.wt=s,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,t){return this.bo.ho("Write",e,t)}onMessage(e){if(fi(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const t=function HC(i,e){return i&&i.length>0?(fi(void 0!==e),i.map(t=>function(n,r){let s=ta(n.updateTime?n.updateTime:r);return s.isEqual(ci.min())&&(s=ta(r)),new q2(s,n.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),n=ta(e.commitTime);return this.listener.Jo(n,t)}return fi(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=tT(this.wt),this.Oo(e)}Ho(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>l_(this.wt,n))};this.Oo(t)}}class C$ extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.bo=n,this.wt=r,this.Zo=!1}tu(){if(this.Zo)throw new jt(at.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,t,n){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.bo.ro(e,t,n,r,s)).catch(r=>{throw"FirebaseError"===r.name?(r.code===at.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new jt(at.UNKNOWN,r.toString())})}ao(e,t,n,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.bo.ao(e,t,n,s,o,r)).catch(s=>{throw"FirebaseError"===s.name?(s.code===at.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new jt(at.UNKNOWN,s.toString())})}terminate(){this.Zo=!0}}class E${constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(Ms(t),this.su=!1):qt("OnlineStateTracker",t)}cu(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}class A${constructor(e,t,n,r,s){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=s,this.du.Br(a=>{n.enqueueAndForget((0,nt.Z)(function*(){var l;b_(o)&&(qt("RemoteStore","Restarting streams for network reachability change."),yield(l=(0,nt.Z)(function*(h){const f=yn(h);f.lu.add(4),yield dT(f),f._u.set("Unknown"),f.lu.delete(4),yield lE(f)}),function(h){return l.apply(this,arguments)})(o))}))}),this._u=new E$(n,r)}}function lE(i){return IN.apply(this,arguments)}function IN(){return IN=(0,nt.Z)(function*(i){if(b_(i))for(const e of i.fu)yield e(!0)}),IN.apply(this,arguments)}function dT(i){return PN.apply(this,arguments)}function PN(){return PN=(0,nt.Z)(function*(i){for(const e of i.fu)yield e(!1)}),PN.apply(this,arguments)}function AI(i,e){const t=yn(i);t.hu.has(e.targetId)||(t.hu.set(e.targetId,e),ON(t)?LN(t):pT(t).Co()&&FN(t,e))}function cE(i,e){const t=yn(i),n=pT(t);t.hu.delete(e),n.Co()&&CH(t,e),0===t.hu.size&&(n.Co()?n.ko():b_(t)&&t._u.set("Unknown"))}function FN(i,e){i.wu.Nt(e.targetId),pT(i).Qo(e)}function CH(i,e){i.wu.Nt(e),pT(i).jo(e)}function LN(i){i.wu=new X2({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),te:e=>i.hu.get(e)||null}),pT(i).start(),i._u.iu()}function ON(i){return b_(i)&&!pT(i).Do()&&i.hu.size>0}function b_(i){return 0===yn(i).lu.size}function EH(i){i.wu=void 0}function D$(i){return kN.apply(this,arguments)}function kN(){return kN=(0,nt.Z)(function*(i){i.hu.forEach((e,t)=>{FN(i,e)})}),kN.apply(this,arguments)}function R$(i,e){return NN.apply(this,arguments)}function NN(){return NN=(0,nt.Z)(function*(i,e){EH(i),ON(i)?(i._u.uu(e),LN(i)):i._u.set("Unknown")}),NN.apply(this,arguments)}function I$(i,e,t){return BN.apply(this,arguments)}function BN(){return BN=(0,nt.Z)(function*(i,e,t){if(i._u.set("Online"),e instanceof qR&&2===e.state&&e.cause)try{yield(n=(0,nt.Z)(function*(r,s){const o=s.cause;for(const a of s.targetIds)r.hu.has(a)&&(yield r.remoteSyncer.rejectListen(a,o),r.hu.delete(a),r.wu.removeTarget(a))}),function(r,s){return n.apply(this,arguments)})(i,e)}catch(n){qt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield DI(i,n)}else if(e instanceof Xy?i.wu.Ut(e):e instanceof WR?i.wu.zt(e):i.wu.Gt(e),!t.isEqual(ci.min()))try{const n=yield G(i.localStore);t.compareTo(n)>=0&&(yield function(r,s){const o=r.wu.Yt(s);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const h=r.hu.get(l);h&&r.hu.set(l,h.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach(a=>{const l=r.hu.get(a);if(!l)return;r.hu.set(a,l.withResumeToken(Fo.EMPTY_BYTE_STRING,l.snapshotVersion)),CH(r,a);const h=new Ff(l.target,a,1,l.sequenceNumber);FN(r,h)}),r.remoteSyncer.applyRemoteEvent(o)}(i,t))}catch(n){qt("RemoteStore","Failed to raise snapshot:",n),yield DI(i,n)}var n}),BN.apply(this,arguments)}function DI(i,e,t){return jN.apply(this,arguments)}function jN(){return jN=(0,nt.Z)(function*(i,e,t){if(!rd(e))throw e;i.lu.add(1),yield dT(i),i._u.set("Offline"),t||(t=()=>G(i.localStore)),i.asyncQueue.enqueueRetryable((0,nt.Z)(function*(){qt("RemoteStore","Retrying IndexedDB access"),yield t(),i.lu.delete(1),yield lE(i)}))}),jN.apply(this,arguments)}function AH(i,e){return e().catch(t=>DI(i,t,e))}function fT(i){return UN.apply(this,arguments)}function UN(){return UN=(0,nt.Z)(function*(i){const e=yn(i),t=x_(e);let n=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;P$(e);)try{const r=yield De(e.localStore,n);if(null===r){0===e.au.length&&t.ko();break}n=r.batchId,F$(e,r)}catch(r){yield DI(e,r)}DH(e)&&RH(e)}),UN.apply(this,arguments)}function P$(i){return b_(i)&&i.au.length<10}function F$(i,e){i.au.push(e);const t=x_(i);t.Co()&&t.zo&&t.Ho(e.mutations)}function DH(i){return b_(i)&&!x_(i).Do()&&i.au.length>0}function RH(i){x_(i).start()}function L$(i){return VN.apply(this,arguments)}function VN(){return VN=(0,nt.Z)(function*(i){x_(i).Xo()}),VN.apply(this,arguments)}function O$(i){return GN.apply(this,arguments)}function GN(){return GN=(0,nt.Z)(function*(i){const e=x_(i);for(const t of i.au)e.Ho(t.mutations)}),GN.apply(this,arguments)}function k$(i,e,t){return zN.apply(this,arguments)}function zN(){return zN=(0,nt.Z)(function*(i,e,t){const n=i.au.shift(),r=$C.from(n,e,t);yield AH(i,()=>i.remoteSyncer.applySuccessfulWrite(r)),yield fT(i)}),zN.apply(this,arguments)}function N$(i,e){return HN.apply(this,arguments)}function HN(){return HN=(0,nt.Z)(function*(i,e){var t;e&&x_(i).zo&&(yield(t=(0,nt.Z)(function*(n,r){if(Z2(s=r.code)&&s!==at.ABORTED){const o=n.au.shift();x_(n).No(),yield AH(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,r)),yield fT(n)}var s}),function(n,r){return t.apply(this,arguments)})(i,e)),DH(i)&&RH(i)}),HN.apply(this,arguments)}function IH(i,e){return WN.apply(this,arguments)}function WN(){return WN=(0,nt.Z)(function*(i,e){const t=yn(i);t.asyncQueue.verifyOperationInProgress(),qt("RemoteStore","RemoteStore received new credentials");const n=b_(t);t.lu.add(3),yield dT(t),n&&t._u.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.lu.delete(3),yield lE(t)}),WN.apply(this,arguments)}function qN(i,e){return ZN.apply(this,arguments)}function ZN(){return ZN=(0,nt.Z)(function*(i,e){const t=yn(i);e?(t.lu.delete(2),yield lE(t)):e||(t.lu.add(2),yield dT(t),t._u.set("Unknown"))}),ZN.apply(this,arguments)}function pT(i){return i.mu||(i.mu=function(e,t,n){const r=yn(e);return r.tu(),new M$(t,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,n)}(i.datastore,i.asyncQueue,{zr:D$.bind(null,i),Jr:R$.bind(null,i),Go:I$.bind(null,i)}),i.fu.push(function(){var e=(0,nt.Z)(function*(t){t?(i.mu.No(),ON(i)?LN(i):i._u.set("Unknown")):(yield i.mu.stop(),EH(i))});return function(t){return e.apply(this,arguments)}}())),i.mu}function x_(i){return i.gu||(i.gu=function(e,t,n){const r=yn(e);return r.tu(),new S$(t,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,n)}(i.datastore,i.asyncQueue,{zr:L$.bind(null,i),Jr:N$.bind(null,i),Yo:O$.bind(null,i),Jo:k$.bind(null,i)}),i.fu.push(function(){var e=(0,nt.Z)(function*(t){t?(i.gu.No(),yield fT(i)):(yield i.gu.stop(),i.au.length>0&&(qt("RemoteStore",`Stopping write stream with ${i.au.length} pending writes`),i.au=[]))});return function(t){return e.apply(this,arguments)}}())),i.gu}class YN{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new Qo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,n,r,s){const o=Date.now()+n,a=new YN(e,t,o,r,s);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new jt(at.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function mT(i,e){if(Ms("AsyncQueue",`${e}: ${i}`),rd(i))return new jt(at.UNAVAILABLE,`${e}: ${i}`);throw i}class gT{constructor(e){this.comparator=e?(t,n)=>e(t,n)||fn.comparator(t.key,n.key):(t,n)=>fn.comparator(t.key,n.key),this.keyedMap=o_(),this.sortedSet=new Cs(this.comparator)}static emptySet(e){return new gT(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof gT)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new gT;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class PH{constructor(){this.yu=new Cs(fn.comparator)}track(e){const t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):In():this.yu=this.yu.insert(t,e)}pu(){const e=[];return this.yu.inorderTraversal((t,n)=>{e.push(n)}),e}}class _T{constructor(e,t,n,r,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l}static fromInitialDocuments(e,t,n,r){const s=[];return t.forEach(o=>{s.push({type:0,doc:o})}),new _T(e,t,gT.emptySet(t),s,n,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Jp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class B${constructor(){this.Iu=void 0,this.listeners=[]}}class j${constructor(){this.queries=new If(e=>Yx(e),Jp),this.onlineState="Unknown",this.Tu=new Set}}function KN(i,e){return XN.apply(this,arguments)}function XN(){return XN=(0,nt.Z)(function*(i,e){const t=yn(i),n=e.query;let r=!1,s=t.queries.get(n);if(s||(r=!0,s=new B$),r)try{s.Iu=yield t.onListen(n)}catch(o){const a=mT(o,`Initialization of query '${Kx(e.query)}' failed`);return void e.onError(a)}t.queries.set(n,s),s.listeners.push(e),e.Eu(t.onlineState),s.Iu&&e.Au(s.Iu)&&JN(t)}),XN.apply(this,arguments)}function $N(i,e){return QN.apply(this,arguments)}function QN(){return QN=(0,nt.Z)(function*(i,e){const t=yn(i),n=e.query;let r=!1;const s=t.queries.get(n);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),r=0===s.listeners.length)}if(r)return t.queries.delete(n),t.onUnlisten(n)}),QN.apply(this,arguments)}function U$(i,e){const t=yn(i);let n=!1;for(const r of e){const o=t.queries.get(r.query);if(o){for(const a of o.listeners)a.Au(r)&&(n=!0);o.Iu=r}}n&&JN(t)}function V$(i,e,t){const n=yn(i),r=n.queries.get(e);if(r)for(const s of r.listeners)s.onError(t);n.queries.delete(e)}function JN(i){i.Tu.forEach(e=>{e.next()})}class eB{constructor(e,t,n){this.query=e,this.Ru=t,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=n||{}}Au(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)3!==r.type&&n.push(r);e=new _T(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),t=!0):this.Vu(e,this.onlineState)&&(this.Su(e),t=!0),this.Pu=e,t}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}Vu(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}vu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Su(e){e=_T.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}class G${constructor(e,t){this.payload=e,this.byteLength=t}Cu(){return"metadata"in this.payload}}class FH{constructor(e){this.wt=e}Wi(e){return cd(this.wt,e)}zi(e){return e.metadata.exists?zC(this.wt,e.document,!1):Dr.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}Hi(e){return ta(e)}}class z${constructor(e,t,n){this.xu=e,this.localStore=t,this.wt=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=LH(e)}Nu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;const n=Xi.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ku(e){const t=new Map,n=new FH(this.wt);for(const r of e)if(r.metadata.queries){const s=n.Wi(r.metadata.name);for(const o of r.metadata.queries){const a=(t.get(o)||Si()).add(s);t.set(o,a)}}return t}complete(){var e=this;return(0,nt.Z)(function*(){const t=yield function Xn(i,e,t,n){return Oi.apply(this,arguments)}(e.localStore,new FH(e.wt),e.documents,e.xu.id),n=e.ku(e.documents);for(const r of e.queries)yield zr(e.localStore,r,n.get(r.name));return e.progress.taskState="Success",{progress:e.progress,Mu:e.collectionGroups,Ou:t}})()}}function LH(i){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:i.totalDocuments,totalBytes:i.totalBytes}}class OH{constructor(e){this.key=e}}class kH{constructor(e){this.key=e}}class NH{constructor(e,t){this.query=e,this.Fu=t,this.$u=null,this.current=!1,this.Bu=Si(),this.mutatedKeys=Si(),this.Lu=IR(e),this.Uu=new gT(this.Lu)}get qu(){return this.Fu}Ku(e,t){const n=t?t.Gu:new PH,r=t?t.Uu:this.Uu;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,h="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((f,m)=>{const g=r.get(f),v=Hy(this.query,m)?m:null,y=!!g&&this.mutatedKeys.has(g.key),b=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let T=!1;g&&v?g.data.isEqual(v.data)?y!==b&&(n.track({type:3,doc:v}),T=!0):this.Qu(g,v)||(n.track({type:2,doc:v}),T=!0,(l&&this.Lu(v,l)>0||h&&this.Lu(v,h)<0)&&(a=!0)):!g&&v?(n.track({type:0,doc:v}),T=!0):g&&!v&&(n.track({type:1,doc:g}),T=!0,(l||h)&&(a=!0)),T&&(v?(o=o.add(v),s=b?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const f="F"===this.query.limitType?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Uu:o,Gu:n,Mi:a,mutatedKeys:s}}Qu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const s=e.Gu.pu();s.sort((h,f)=>function(m,g){const v=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return In()}};return v(m)-v(g)}(h.type,f.type)||this.Lu(h.doc,f.doc)),this.ju(n);const o=t?this.Wu():[],a=0===this.Bu.size&&this.current?1:0,l=a!==this.$u;return this.$u=a,0!==s.length||l?{snapshot:new _T(this.query,e.Uu,r,s,e.mutatedKeys,0===a,l,!1),zu:o}:{zu:o}}Eu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new PH,mutatedKeys:this.mutatedKeys,Mi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(t=>this.Fu=this.Fu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Fu=this.Fu.delete(t)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=Si(),this.Uu.forEach(n=>{this.Hu(n.key)&&(this.Bu=this.Bu.add(n.key))});const t=[];return e.forEach(n=>{this.Bu.has(n)||t.push(new kH(n))}),this.Bu.forEach(n=>{e.has(n)||t.push(new OH(n))}),t}Ju(e){this.Fu=e.ji,this.Bu=Si();const t=this.Ku(e.documents);return this.applyChanges(t,!0)}Yu(){return _T.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}class H${constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class W${constructor(e){this.key=e,this.Xu=!1}}class q${constructor(e,t,n,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new If(a=>Yx(a),Jp),this.ec=new Map,this.nc=new Set,this.sc=new Cs(fn.comparator),this.ic=new Map,this.rc=new sE,this.oc={},this.uc=new Map,this.cc=m_.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return!0===this.ac}}function Z$(i,e){return tB.apply(this,arguments)}function tB(){return tB=(0,nt.Z)(function*(i,e){const t=MB(i);let n,r;const s=t.tc.get(e);if(s)n=s.targetId,t.sharedClientState.addLocalQueryTarget(n),r=s.view.Yu();else{const o=yield Ue(t.localStore,al(e));t.isPrimaryClient&&AI(t.remoteStore,o);const a=t.sharedClientState.addLocalQueryTarget(o.targetId);n=o.targetId,r=yield nB(t,e,n,"current"===a)}return r}),tB.apply(this,arguments)}function nB(i,e,t,n){return iB.apply(this,arguments)}function iB(){return iB=(0,nt.Z)(function*(i,e,t,n){i.hc=(f,m,g)=>{return(v=(0,nt.Z)(function*(y,b,T,S){let C=b.view.Ku(T);C.Mi&&(C=yield hn(y.localStore,b.query,!1).then(({documents:L})=>b.view.Ku(L,C)));const R=S&&S.targetChanges.get(b.targetId),I=b.view.applyChanges(C,y.isPrimaryClient,R);return fB(y,b.targetId,I.zu),I.snapshot}),function(y,b,T,S){return v.apply(this,arguments)})(i,f,m,g);var v};const r=yield hn(i.localStore,e,!0),s=new NH(e,r.ji),o=s.Ku(r.documents),a=a_.createSynthesizedTargetChangeForCurrentChange(t,n&&"Offline"!==i.onlineState),l=s.applyChanges(o,i.isPrimaryClient,a);fB(i,t,l.zu);const h=new H$(e,t,s);return i.tc.set(e,h),i.ec.has(t)?i.ec.get(t).push(e):i.ec.set(t,[e]),l.snapshot}),iB.apply(this,arguments)}function Y$(i,e){return rB.apply(this,arguments)}function rB(){return rB=(0,nt.Z)(function*(i,e){const t=yn(i),n=t.tc.get(e),r=t.ec.get(n.targetId);if(r.length>1)return t.ec.set(n.targetId,r.filter(s=>!Jp(s,e))),void t.tc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(n.targetId),t.sharedClientState.isActiveQueryTarget(n.targetId)||(yield xt(t.localStore,n.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(n.targetId),cE(t.remoteStore,n.targetId),vT(t,n.targetId)}).catch(Sf))):(vT(t,n.targetId),yield xt(t.localStore,n.targetId,!0))}),rB.apply(this,arguments)}function sB(){return sB=(0,nt.Z)(function*(i,e,t){const n=SB(i);try{const r=yield function(s,o){const a=yn(s),l=mr.now(),h=o.reduce((g,v)=>g.add(v.key),Si());let f,m;return a.persistence.runTransaction("Locally write mutations","readwrite",g=>{let v=go(),y=Si();return a.Ui.getEntries(g,h).next(b=>{v=b,v.forEach((T,S)=>{S.isValidDocument()||(y=y.add(T))})}).next(()=>a.localDocuments.getOverlayedDocuments(g,v)).next(b=>{f=b;const T=[];for(const S of o){const C=BC(S,f.get(S.key).overlayedDocument);null!=C&&T.push(new ad(S.key,C,e_(C.value.mapValue),As.exists(!0)))}return a.mutationQueue.addMutationBatch(g,l,T,o)}).next(b=>{m=b;const T=b.applyToLocalDocumentSet(f,y);return a.documentOverlayCache.saveOverlays(g,b.batchId,T)})}).then(()=>({batchId:m.batchId,changes:Qx(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),function(s,o,a){let l=s.oc[s.currentUser.toKey()];l||(l=new Cs(_i)),l=l.insert(o,a),s.oc[s.currentUser.toKey()]=l}(n,r.batchId,t),yield hm(n,r.changes),yield fT(n.remoteStore)}catch(r){const s=mT(r,"Failed to persist write");t.reject(s)}}),sB.apply(this,arguments)}function BH(i,e){return oB.apply(this,arguments)}function oB(){return oB=(0,nt.Z)(function*(i,e){const t=yn(i);try{const n=yield X(t.localStore,e);e.targetChanges.forEach((r,s)=>{const o=t.ic.get(s);o&&(fi(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.Xu=!0:r.modifiedDocuments.size>0?fi(o.Xu):r.removedDocuments.size>0&&(fi(o.Xu),o.Xu=!1))}),yield hm(t,n,e)}catch(n){yield Sf(n)}}),oB.apply(this,arguments)}function jH(i,e,t){const n=yn(i);if(n.isPrimaryClient&&0===t||!n.isPrimaryClient&&1===t){const r=[];n.tc.forEach((s,o)=>{const a=o.view.Eu(e);a.snapshot&&r.push(a.snapshot)}),function(s,o){const a=yn(s);a.onlineState=o;let l=!1;a.queries.forEach((h,f)=>{for(const m of f.listeners)m.Eu(o)&&(l=!0)}),l&&JN(a)}(n.eventManager,e),r.length&&n.Zu.Go(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function X$(i,e,t){return aB.apply(this,arguments)}function aB(){return aB=(0,nt.Z)(function*(i,e,t){const n=yn(i);n.sharedClientState.updateQueryState(e,"rejected",t);const r=n.ic.get(e),s=r&&r.key;if(s){let o=new Cs(fn.comparator);o=o.insert(s,Dr.newNoDocument(s,ci.min()));const a=Si().add(s),l=new Ky(ci.min(),new Map,new Mr(_i),o,a);yield BH(n,l),n.sc=n.sc.remove(s),n.ic.delete(e),pB(n)}else yield xt(n.localStore,e,!1).then(()=>vT(n,e,t)).catch(Sf)}),aB.apply(this,arguments)}function $$(i,e){return lB.apply(this,arguments)}function lB(){return lB=(0,nt.Z)(function*(i,e){const t=yn(i),n=e.batch.batchId;try{const r=yield B(t.localStore,e);dB(t,n,null),hB(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield hm(t,r)}catch(r){yield Sf(r)}}),lB.apply(this,arguments)}function Q$(i,e,t){return cB.apply(this,arguments)}function cB(){return cB=(0,nt.Z)(function*(i,e,t){const n=yn(i);try{const r=yield function(s,o){const a=yn(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return a.mutationQueue.lookupMutationBatch(l,o).next(f=>(fi(null!==f),h=f.keys(),a.mutationQueue.removeMutationBatch(l,f))).next(()=>a.mutationQueue.performConsistencyCheck(l)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(l,h,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>a.localDocuments.getDocuments(l,h))})}(n.localStore,e);dB(n,e,t),hB(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield hm(n,r)}catch(r){yield Sf(r)}}),cB.apply(this,arguments)}function uB(){return uB=(0,nt.Z)(function*(i,e){const t=yn(i);b_(t.remoteStore)||qt("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const n=yield function(s){const o=yn(s);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(t.localStore);if(-1===n)return void e.resolve();const r=t.uc.get(n)||[];r.push(e),t.uc.set(n,r)}catch(n){const r=mT(n,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}),uB.apply(this,arguments)}function hB(i,e){(i.uc.get(e)||[]).forEach(t=>{t.resolve()}),i.uc.delete(e)}function dB(i,e,t){const n=yn(i);let r=n.oc[n.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),n.oc[n.currentUser.toKey()]=r}}function vT(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const n of i.ec.get(e))i.tc.delete(n),t&&i.Zu.lc(n,t);i.ec.delete(e),i.isPrimaryClient&&i.rc.us(e).forEach(n=>{i.rc.containsKey(n)||UH(i,n)})}function UH(i,e){i.nc.delete(e.path.canonicalString());const t=i.sc.get(e);null!==t&&(cE(i.remoteStore,t),i.sc=i.sc.remove(e),i.ic.delete(t),pB(i))}function fB(i,e,t){for(const n of t)n instanceof OH?(i.rc.addReference(n.key,e),eQ(i,n)):n instanceof kH?(qt("SyncEngine","Document no longer in limbo: "+n.key),i.rc.removeReference(n.key,e),i.rc.containsKey(n.key)||UH(i,n.key)):In()}function eQ(i,e){const t=e.key,n=t.path.canonicalString();i.sc.get(t)||i.nc.has(n)||(qt("SyncEngine","New document in limbo: "+t),i.nc.add(n),pB(i))}function pB(i){for(;i.nc.size>0&&i.sc.size<i.maxConcurrentLimboResolutions;){const e=i.nc.values().next().value;i.nc.delete(e);const t=new fn(Xi.fromString(e)),n=i.cc.next();i.ic.set(n,new W$(t)),i.sc=i.sc.insert(t,n),AI(i.remoteStore,new Ff(al(i_(t.path)),n,2,ya.ot))}}function hm(i,e,t){return mB.apply(this,arguments)}function mB(){return mB=(0,nt.Z)(function*(i,e,t){const n=yn(i),r=[],s=[],o=[];var a;n.tc.isEmpty()||(n.tc.forEach((a,l)=>{o.push(n.hc(l,e,t).then(h=>{if(h){n.isPrimaryClient&&n.sharedClientState.updateQueryState(l.targetId,h.fromCache?"not-current":"current"),r.push(h);const f=p.Vi(l.targetId,h);s.push(f)}}))}),yield Promise.all(o),n.Zu.Go(r),yield(a=(0,nt.Z)(function*(l,h){const f=yn(l);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>$e.forEach(h,g=>$e.forEach(g.Pi,v=>f.persistence.referenceDelegate.addReference(m,g.targetId,v)).next(()=>$e.forEach(g.vi,v=>f.persistence.referenceDelegate.removeReference(m,g.targetId,v)))))}catch(m){if(!rd(m))throw m;qt("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const g=m.targetId;if(!m.fromCache){const v=f.$i.get(g),b=v.withLastLimboFreeSnapshotVersion(v.snapshotVersion);f.$i=f.$i.insert(g,b)}}}),function(l,h){return a.apply(this,arguments)})(n.localStore,s))}),mB.apply(this,arguments)}function tQ(i,e){return gB.apply(this,arguments)}function gB(){return gB=(0,nt.Z)(function*(i,e){const t=yn(i);if(!t.currentUser.isEqual(e)){qt("SyncEngine","User change. New user:",e.toKey());const n=yield D(t.localStore,e);t.currentUser=e,(r=t).uc.forEach(o=>{o.forEach(a=>{a.reject(new jt(at.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),r.uc.clear(),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield hm(t,n.Ki)}var r}),gB.apply(this,arguments)}function nQ(i,e){const t=yn(i),n=t.ic.get(e);if(n&&n.Xu)return Si().add(n.key);{let r=Si();const s=t.ec.get(e);if(!s)return r;for(const o of s){const a=t.tc.get(o);r=r.unionWith(a.view.qu)}return r}}function iQ(i,e){return _B.apply(this,arguments)}function _B(){return _B=(0,nt.Z)(function*(i,e){const t=yn(i),n=yield hn(t.localStore,e.query,!0),r=e.view.Ju(n);return t.isPrimaryClient&&fB(t,e.targetId,r.zu),r}),_B.apply(this,arguments)}function rQ(i,e){return vB.apply(this,arguments)}function vB(){return vB=(0,nt.Z)(function*(i,e){const t=yn(i);return si(t.localStore,e).then(n=>hm(t,n))}),vB.apply(this,arguments)}function sQ(i,e,t,n){return yB.apply(this,arguments)}function yB(){return yB=(0,nt.Z)(function*(i,e,t,n){const r=yn(i),s=yield function(o,a){const l=yn(o),h=yn(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",f=>h.yn(f,a).next(m=>m?l.localDocuments.getDocuments(f,m):$e.resolve(null)))}(r.localStore,e);var a;null!==s?("pending"===t?yield fT(r.remoteStore):"acknowledged"===t||"rejected"===t?(dB(r,e,n||null),hB(r,e),a=e,yn(yn(r.localStore).mutationQueue).In(a)):In(),yield hm(r,s)):qt("SyncEngine","Cannot apply mutation batch with id: "+e)}),yB.apply(this,arguments)}function bB(){return bB=(0,nt.Z)(function*(i,e){const t=yn(i);if(MB(t),SB(t),!0===e&&!0!==t.ac){const n=t.sharedClientState.getAllActiveQueryTargets(),r=yield VH(t,n.toArray());t.ac=!0,yield qN(t.remoteStore,!0);for(const s of r)AI(t.remoteStore,s)}else if(!1===e&&!1!==t.ac){const n=[];let r=Promise.resolve();t.ec.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?n.push(o):r=r.then(()=>(vT(t,o),xt(t.localStore,o,!0))),cE(t.remoteStore,o)}),yield r,yield VH(t,n),function(s){const o=yn(s);o.ic.forEach((a,l)=>{cE(o.remoteStore,l)}),o.rc.cs(),o.ic=new Map,o.sc=new Cs(fn.comparator)}(t),t.ac=!1,yield qN(t.remoteStore,!1)}}),bB.apply(this,arguments)}function VH(i,e,t){return xB.apply(this,arguments)}function xB(){return xB=(0,nt.Z)(function*(i,e,t){const n=yn(i),r=[],s=[];for(const o of e){let a;const l=n.ec.get(o);if(l&&0!==l.length){a=yield Ue(n.localStore,al(l[0]));for(const h of l){const f=n.tc.get(h),m=yield iQ(n,f);m.snapshot&&s.push(m.snapshot)}}else{const h=yield An(n.localStore,o);a=yield Ue(n.localStore,h),yield nB(n,GH(h),o,!1)}r.push(a)}return n.Zu.Go(s),r}),xB.apply(this,arguments)}function GH(i){return RR(i.path,i.collectionGroup,i.orderBy,i.filters,i.limit,"F",i.startAt,i.endAt)}function aQ(i){const e=yn(i);return yn(yn(e.localStore).persistence).Ri()}function lQ(i,e,t,n){return TB.apply(this,arguments)}function TB(){return TB=(0,nt.Z)(function*(i,e,t,n){const r=yn(i);if(r.ac)return void qt("SyncEngine","Ignoring unexpected query state notification.");const s=r.ec.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=yield si(r.localStore,Xx(s[0])),a=Ky.createSynthesizedRemoteEventForCurrentChange(e,"current"===t);yield hm(r,o,a);break}case"rejected":yield xt(r.localStore,e,!0),vT(r,e,n);break;default:In()}}),TB.apply(this,arguments)}function cQ(i,e,t){return wB.apply(this,arguments)}function wB(){return wB=(0,nt.Z)(function*(i,e,t){const n=MB(i);if(n.ac){for(const r of e){if(n.ec.has(r)){qt("SyncEngine","Adding an already active target "+r);continue}const s=yield An(n.localStore,r),o=yield Ue(n.localStore,s);yield nB(n,GH(s),o.targetId,!1),AI(n.remoteStore,o)}for(const r of t)n.ec.has(r)&&(yield xt(n.localStore,r,!1).then(()=>{cE(n.remoteStore,r),vT(n,r)}).catch(Sf))}}),wB.apply(this,arguments)}function MB(i){const e=yn(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=BH.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=nQ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=X$.bind(null,e),e.Zu.Go=U$.bind(null,e.eventManager),e.Zu.lc=V$.bind(null,e.eventManager),e}function SB(i){const e=yn(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$$.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Q$.bind(null,e),e}class zH{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,nt.Z)(function*(){t.wt=aE(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),yield t.persistence.start(),t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore)})()}mc(e,t){return null}gc(e,t){return null}wc(e){return w(this.persistence,new _,e.initialUser,this.wt)}_c(e){return new EN(oE.Os,this.wt)}dc(e){return new TH}terminate(){var e=this;return(0,nt.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class HH extends zH{constructor(e,t,n){super(),this.yc=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,n=this;return(0,nt.Z)(function*(){yield t().call(n,e),yield n.yc.initialize(n,e),yield SB(n.yc.syncEngine),yield fT(n.yc.remoteStore),yield n.persistence.ci(()=>(n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(),n.indexBackfillerScheduler&&!n.indexBackfillerScheduler.started&&n.indexBackfillerScheduler.start(),Promise.resolve()))})()}wc(e){return w(this.persistence,new _,e.initialUser,this.wt)}mc(e,t){return new xN(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}gc(e,t){const n=new k2(t,this.persistence);return new O2(e.asyncQueue,n)}_c(e){const t=d(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?eo.withCacheSize(this.cacheSizeBytes):eo.DEFAULT;return new CI(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,MH(),EI(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new TH}}class hQ extends HH{constructor(e,t){super(e,t,!1),this.yc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,n=this;return(0,nt.Z)(function*(){yield t().call(n,e);const r=n.yc.syncEngine;n.sharedClientState instanceof d0&&(n.sharedClientState.syncEngine={kr:sQ.bind(null,r),Mr:lQ.bind(null,r),Or:cQ.bind(null,r),Ri:aQ.bind(null,r),Nr:rQ.bind(null,r)},yield n.sharedClientState.start()),yield n.persistence.ci(function(){var s=(0,nt.Z)(function*(o){yield function oQ(i,e){return bB.apply(this,arguments)}(n.yc.syncEngine,o),n.gcScheduler&&(o&&!n.gcScheduler.started?n.gcScheduler.start():o||n.gcScheduler.stop()),n.indexBackfillerScheduler&&(o&&!n.indexBackfillerScheduler.started?n.indexBackfillerScheduler.start():o||n.indexBackfillerScheduler.stop())});return function(o){return s.apply(this,arguments)}}())})()}dc(e){const t=MH();if(!d0.V(t))throw new jt(at.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=d(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new d0(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class CB{initialize(e,t){var n=this;return(0,nt.Z)(function*(){n.localStore||(n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=r=>jH(n.syncEngine,r,1),n.remoteStore.remoteSyncer.handleCredentialChange=tQ.bind(null,n.syncEngine),yield qN(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(e){return new j$}createDatastore(e){const t=aE(e.databaseInfo.databaseId),n=new w$(e.databaseInfo);return new C$(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,s=a=>jH(this.syncEngine,a,0),o=wH.V()?new wH:new b$,new A$(t,n,r,s,o);var t,n,r,s,o}createSyncEngine(e,t){return function(n,r,s,o,a,l,h){const f=new q$(n,r,s,o,a,l);return h&&(f.ac=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,nt.Z)(function*(t){const n=yn(t);qt("RemoteStore","RemoteStore shutting down."),n.lu.add(5),yield dT(n),n.du.shutdown(),n._u.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function WH(i,e=10240){let t=0;return{read:()=>(0,nt.Z)(function*(){if(t<i.byteLength){const n={value:i.slice(t,t+e),done:!1};return t+=e,n}return{done:!0}})(),cancel:()=>(0,nt.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class RI{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):Ms("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class dQ{constructor(e,t){this.Ec=e,this.wt=t,this.metadata=new Qo,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then(n=>{n&&n.Cu()?this.metadata.resolve(n.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(n?.payload)}`))},n=>this.metadata.reject(n))}close(){return this.Ec.cancel()}getMetadata(){var e=this;return(0,nt.Z)(function*(){return e.metadata.promise})()}fc(){var e=this;return(0,nt.Z)(function*(){return yield e.getMetadata(),e.Rc()})()}Rc(){var e=this;return(0,nt.Z)(function*(){const t=yield e.bc();if(null===t)return null;const n=e.Ac.decode(t),r=Number(n);isNaN(r)&&e.Pc(`length string (${n}) is not valid number`);const s=yield e.vc(r);return new G$(JSON.parse(s),t.length+r)})()}Vc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}bc(){var e=this;return(0,nt.Z)(function*(){for(;e.Vc()<0&&!(yield e.Sc()););if(0===e.buffer.length)return null;const t=e.Vc();t<0&&e.Pc("Reached the end of bundle when a length string is expected.");const n=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),n})()}vc(e){var t=this;return(0,nt.Z)(function*(){for(;t.buffer.length<e;)(yield t.Sc())&&t.Pc("Reached the end of bundle when more is expected.");const n=t.Ac.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),n})()}Pc(e){throw this.Ec.cancel(),new Error(`Invalid bundle format: ${e}`)}Sc(){var e=this;return(0,nt.Z)(function*(){const t=yield e.Ec.read();if(!t.done){const n=new Uint8Array(e.buffer.length+t.value.length);n.set(e.buffer),n.set(t.value,e.buffer.length),e.buffer=n}return t.done})()}}class fQ{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,nt.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new jt(at.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=yield(r=(0,nt.Z)(function*(s,o){const a=yn(s),l=tT(a.wt)+"/documents",h={documents:o.map(v=>eT(a.wt,v))},f=yield a.ao("BatchGetDocuments",l,h,o.length),m=new Map;f.forEach(v=>{const y=function nT(i,e){return"found"in e?function(t,n){fi(!!n.found);const r=cd(t,n.found.name),s=ta(n.found.updateTime),o=new Jo({mapValue:{fields:n.found.fields}});return Dr.newFoundDocument(r,s,o)}(i,e):"missing"in e?function(t,n){fi(!!n.missing),fi(!!n.readTime);const r=cd(t,n.missing),s=ta(n.readTime);return Dr.newNoDocument(r,s)}(i,e):In()}(a.wt,v);m.set(y.key.toString(),y)});const g=[];return o.forEach(v=>{const y=m.get(v.toString());fi(!!y),g.push(y)}),g}),function(s,o){return r.apply(this,arguments)})(t.datastore,e);var r;return n.forEach(r=>t.recordVersion(r)),n})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new Rf(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,nt.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var n;e.mutations.forEach(n=>{t.delete(n.key.toString())}),t.forEach((n,r)=>{const s=fn.fromPath(r);e.mutations.push(new $x(s,e.precondition(s)))}),yield(n=(0,nt.Z)(function*(r,s){const o=yn(r),a=tT(o.wt)+"/documents",l={writes:s.map(h=>l_(o.wt,h))};yield o.ro("Commit",a,l)}),function(r,s){return n.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw In();t=ci.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new jt(at.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?As.updateTime(t):As.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ci.min()))throw new jt(at.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return As.updateTime(t)}return As.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class pQ{constructor(e,t,n,r,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=s,this.Dc=n.maxAttempts,this.So=new RN(this.asyncQueue,"transaction_retry")}run(){this.Dc-=1,this.Cc()}Cc(){var e=this;this.So.Io((0,nt.Z)(function*(){const t=new fQ(e.datastore),n=e.xc(t);n&&n.then(r=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(r)}).catch(s=>{e.Nc(s)}))}).catch(r=>{e.Nc(r)})}))}xc(e){try{const t=this.updateFunction(e);return!Xg(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Nc(e){this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Cc(),Promise.resolve()))):this.deferred.reject(e)}kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!Z2(t)}return!1}}class mQ{constructor(e,t,n,r){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=ws.UNAUTHENTICATED,this.clientId=cR.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(){var o=(0,nt.Z)(function*(a){qt("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(n,o=>(qt("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return(0,nt.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new jt(at.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Qo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,nt.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=mT(n,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}function qH(i,e){return EB.apply(this,arguments)}function EB(){return EB=(0,nt.Z)(function*(i,e){i.asyncQueue.verifyOperationInProgress(),qt("FirestoreClient","Initializing OfflineComponentProvider");const t=yield i.getConfiguration();yield e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener(function(){var r=(0,nt.Z)(function*(s){n.isEqual(s)||(yield D(e.localStore,s),n=s)});return function(s){return r.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>i.terminate()),i.offlineComponents=e}),EB.apply(this,arguments)}function ZH(i,e){return AB.apply(this,arguments)}function AB(){return AB=(0,nt.Z)(function*(i,e){i.asyncQueue.verifyOperationInProgress();const t=yield DB(i);qt("FirestoreClient","Initializing OnlineComponentProvider");const n=yield i.getConfiguration();yield e.initialize(t,n),i.setCredentialChangeListener(r=>IH(e.remoteStore,r)),i.setAppCheckTokenChangeListener((r,s)=>IH(e.remoteStore,s)),i.onlineComponents=e}),AB.apply(this,arguments)}function DB(i){return RB.apply(this,arguments)}function RB(){return RB=(0,nt.Z)(function*(i){return i.offlineComponents||(qt("FirestoreClient","Using default OfflineComponentProvider"),yield qH(i,new zH)),i.offlineComponents}),RB.apply(this,arguments)}function II(i){return IB.apply(this,arguments)}function IB(){return IB=(0,nt.Z)(function*(i){return i.onlineComponents||(qt("FirestoreClient","Using default OnlineComponentProvider"),yield ZH(i,new CB)),i.onlineComponents}),IB.apply(this,arguments)}function YH(i){return DB(i).then(e=>e.persistence)}function PI(i){return DB(i).then(e=>e.localStore)}function KH(i){return II(i).then(e=>e.remoteStore)}function PB(i){return II(i).then(e=>e.syncEngine)}function yT(i){return FB.apply(this,arguments)}function FB(){return FB=(0,nt.Z)(function*(i){const e=yield II(i),t=e.eventManager;return t.onListen=Z$.bind(null,e.syncEngine),t.onUnlisten=Y$.bind(null,e.syncEngine),t}),FB.apply(this,arguments)}function XH(i,e,t={}){const n=new Qo;return i.asyncQueue.enqueueAndForget((0,nt.Z)(function*(){return function(r,s,o,a,l){const h=new RI({next:m=>{s.enqueueAndForget(()=>$N(r,f));const g=m.docs.has(o);!g&&m.fromCache?l.reject(new jt(at.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&m.fromCache&&a&&"server"===a.source?l.reject(new jt(at.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),f=new eB(i_(o.path),h,{includeMetadataChanges:!0,Du:!0});return KN(r,f)}(yield yT(i),i.asyncQueue,e,t,n)})),n.promise}function $H(i,e,t={}){const n=new Qo;return i.asyncQueue.enqueueAndForget((0,nt.Z)(function*(){return function(r,s,o,a,l){const h=new RI({next:m=>{s.enqueueAndForget(()=>$N(r,f)),m.fromCache&&"server"===a.source?l.reject(new jt(at.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),f=new eB(o,h,{includeMetadataChanges:!0,Du:!0});return KN(r,f)}(yield yT(i),i.asyncQueue,e,t,n)})),n.promise}const QH=new Map;function LB(i,e,t){if(!t)throw new jt(at.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function JH(i,e,t,n){if(!0===e&&!0===n)throw new jt(at.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function e4(i){if(!fn.isDocumentKey(i))throw new jt(at.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function t4(i){if(fn.isDocumentKey(i))throw new jt(at.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function FI(i){if(void 0===i)return"undefined";if(null===i)return"null";if("string"==typeof i)return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if("number"==typeof i||"boolean"==typeof i)return""+i;if("object"==typeof i){if(i instanceof Array)return"an array";{const e=(t=i).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof i?"a function":In()}function $i(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new jt(at.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=FI(i);throw new jt(at.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}function n4(i,e){if(e<=0)throw new jt(at.INVALID_ARGUMENT,`Function ${i}() requires a positive number, but it was: ${e}.`)}class r4{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new jt(at.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new jt(at.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,JH("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class uE{constructor(e,t,n){this._authCredentials=t,this._appCheckCredentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new r4({}),this._settingsFrozen=!1,e instanceof Ju?this._databaseId=e:(this._app=e,this._databaseId=function(r){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new jt(at.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ju(r.options.projectId)}(e))}get app(){if(!this._app)throw new jt(at.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new jt(at.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new r4(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new Fx;switch(t.type){case"gapi":const n=t.client;return fi(!("object"!=typeof n||null===n||!n.auth||!n.auth.getAuthHeaderValueForFirstParty)),new Oy(n,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new jt(at.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=QH.get(e);t&&(qt("ComponentProvider","Removing Datastore"),QH.delete(e),t.terminate())}(this),Promise.resolve()}}class hs{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hs(this.firestore,e,this._key)}}class ll{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ll(this.firestore,e,this._query)}}class Nf extends ll{constructor(e,t,n){super(e,t,i_(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new hs(this.firestore,null,new fn(e))}withConverter(e){return new Nf(this.firestore,e,this._path)}}function OB(i,e,...t){if(i=(0,Fi.m9)(i),LB("collection","path",e),i instanceof uE){const n=Xi.fromString(e,...t);return t4(n),new Nf(i,null,n)}{if(!(i instanceof hs||i instanceof Nf))throw new jt(at.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(Xi.fromString(e,...t));return t4(n),new Nf(i.firestore,null,n)}}function hE(i,e,...t){if(i=(0,Fi.m9)(i),1===arguments.length&&(e=cR.I()),LB("doc","path",e),i instanceof uE){const n=Xi.fromString(e,...t);return e4(n),new hs(i,null,new fn(n))}{if(!(i instanceof hs||i instanceof Nf))throw new jt(at.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(Xi.fromString(e,...t));return e4(n),new hs(i.firestore,i instanceof Nf?i.converter:null,new fn(n))}}function s4(i,e){return i=(0,Fi.m9)(i),e=(0,Fi.m9)(e),(i instanceof hs||i instanceof Nf)&&(e instanceof hs||e instanceof Nf)&&i.firestore===e.firestore&&i.path===e.path&&i.converter===e.converter}function o4(i,e){return i=(0,Fi.m9)(i),e=(0,Fi.m9)(e),i instanceof ll&&e instanceof ll&&i.firestore===e.firestore&&Jp(i._query,e._query)&&i.converter===e.converter}class CQ{constructor(){this.Mc=Promise.resolve(),this.Oc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new RN(this,"async_queue_retry"),this.Kc=()=>{const t=EI();t&&qt("AsyncQueue","Visibility state changed to "+t.visibilityState),this.So.Eo()};const e=EI();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const t=EI();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const t=new Qo;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Oc.push(e),this.jc()))}jc(){var e=this;return(0,nt.Z)(function*(){if(0!==e.Oc.length){try{yield e.Oc[0](),e.Oc.shift(),e.So.reset()}catch(t){if(!rd(t))throw t;qt("AsyncQueue","Operation failed with retryable error: "+t)}e.Oc.length>0&&e.So.Io(()=>e.jc())}})()}Qc(e){const t=this.Mc.then(()=>(this.Lc=!0,e().catch(n=>{throw this.Bc=n,this.Lc=!1,Ms("INTERNAL UNHANDLED ERROR: ",function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),o}(n)),n}).then(n=>(this.Lc=!1,n))));return this.Mc=t,t}enqueueAfterDelay(e,t,n){this.Gc(),this.qc.indexOf(e)>-1&&(t=0);const r=YN.createAndSchedule(this,e,t,n,s=>this.Wc(s));return this.$c.push(r),r}Gc(){this.Bc&&In()}verifyOperationInProgress(){}zc(){var e=this;return(0,nt.Z)(function*(){let t;do{t=e.Mc,yield t}while(t!==e.Mc)})()}Hc(e){for(const t of this.$c)if(t.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.$c)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const t=this.$c.indexOf(e);this.$c.splice(t,1)}}function kB(i){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of["next","error","complete"])if(r in n&&"function"==typeof n[r])return!0;return!1}(i)}class EQ{constructor(){this._progressObserver={},this._taskCompletionResolver=new Qo,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Ds extends uE{constructor(e,t,n){super(e,t,n),this.type="firestore",this._queue=new CQ,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||a4(this),this._firestoreClient.terminate()}}function DQ(i=(0,Jc.getApp)()){return(0,Jc._getProvider)(i,"firestore").getImmediate()}function Oo(i){return i._firestoreClient||a4(i),i._firestoreClient.verifyNotTerminated(),i._firestoreClient}function a4(i){var e;const t=i._freezeSettings(),n=(s=(null===(e=i._app)||void 0===e?void 0:e.options.appId)||"",new vR(i._databaseId,s,i._persistenceKey,(a=t).host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams));var s,a;i._firestoreClient=new mQ(i._authCredentials,i._appCheckCredentials,i._queue,n)}function l4(i,e,t){const n=new Qo;return i.asyncQueue.enqueue((0,nt.Z)(function*(){try{yield qH(i,t),yield ZH(i,e),n.resolve()}catch(r){const s=r;if(!("FirebaseError"===(o=s).name?o.code===at.FAILED_PRECONDITION||o.code===at.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||22===o.code||20===o.code||11===o.code))throw s;Mf("Error enabling offline persistence. Falling back to persistence disabled: "+s),n.reject(s)}var o})).then(()=>n.promise)}function c4(i){if(i._initialized||i._terminated)throw new jt(at.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class dm{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new jt(at.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ss(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Bf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bf(Fo.fromBase64String(e))}catch(t){throw new jt(at.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Bf(Fo.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class f0{constructor(e){this._methodName=e}}class LI{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new jt(at.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new jt(at.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return _i(this._lat,e._lat)||_i(this._long,e._long)}}const BQ=/^__.*__$/;class jQ{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new ad(e,this.data,this.fieldMask,t,this.fieldTransforms):new im(e,this.data,t,this.fieldTransforms)}}class u4{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ad(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function h4(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw In()}}class OI{constructor(e,t,n,r,s,o){this.settings=e,this.databaseId=t,this.wt=n,this.ignoreUndefinedProperties=r,void 0===s&&this.Xc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new OI(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.sa(e),r}ia(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.Xc(),r}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return BI(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(h4(this.Zc)&&BQ.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class UQ{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.wt=n||aE(e)}aa(e,t,n,r=!1){return new OI({Zc:e,methodName:t,ca:n,path:Ss.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function p0(i){const e=i._freezeSettings(),t=aE(i._databaseId);return new UQ(i._databaseId,!!e.ignoreUndefinedProperties,t)}function kI(i,e,t,n,r,s={}){const o=i.aa(s.merge||s.mergeFields?2:0,e,t,r);UB("Data must be an object, but it was:",o,n);const a=p4(n,o);let l,h;if(s.merge)l=new ol(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const m of s.mergeFields){const g=VB(e,m,t);if(!o.contains(g))throw new jt(at.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);g4(f,g)||f.push(g)}l=new ol(f),h=o.fieldTransforms.filter(m=>l.covers(m.field))}else l=null,h=o.fieldTransforms;return new jQ(new Jo(a),l,h)}class dE extends f0{_toFieldTransform(e){if(2!==e.Zc)throw e.oa(1===e.Zc?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof dE}}function d4(i,e,t){return new OI({Zc:3,ca:e.settings.ca,methodName:i._methodName,na:t},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class NB extends f0{_toFieldTransform(e){return new th(e.path,new em)}isEqual(e){return e instanceof NB}}class VQ extends f0{constructor(e,t){super(e),this.ha=t}_toFieldTransform(e){const t=d4(this,e,!0),n=this.ha.map(s=>m0(s,t)),r=new tm(n);return new th(e.path,r)}isEqual(e){return this===e}}class GQ extends f0{constructor(e,t){super(e),this.ha=t}_toFieldTransform(e){const t=d4(this,e,!0),n=this.ha.map(s=>m0(s,t)),r=new Df(n);return new th(e.path,r)}isEqual(e){return this===e}}class zQ extends f0{constructor(e,t){super(e),this.la=t}_toFieldTransform(e){const t=new nm(e.wt,PC(e.wt,this.la));return new th(e.path,t)}isEqual(e){return this===e}}function BB(i,e,t,n){const r=i.aa(1,e,t);UB("Data must be an object, but it was:",r,n);const s=[],o=Jo.empty();Cf(n,(l,h)=>{const f=NI(e,l,t);h=(0,Fi.m9)(h);const m=r.ia(f);if(h instanceof dE)s.push(f);else{const g=m0(h,m);null!=g&&(s.push(f),o.set(f,g))}});const a=new ol(s);return new u4(o,a,r.fieldTransforms)}function jB(i,e,t,n,r,s){const o=i.aa(1,e,t),a=[VB(e,n,t)],l=[r];if(s.length%2!=0)throw new jt(at.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)a.push(VB(e,s[g])),l.push(s[g+1]);const h=[],f=Jo.empty();for(let g=a.length-1;g>=0;--g)if(!g4(h,a[g])){const v=a[g];let y=l[g];y=(0,Fi.m9)(y);const b=o.ia(v);if(y instanceof dE)h.push(v);else{const T=m0(y,b);null!=T&&(h.push(v),f.set(v,T))}}const m=new ol(h);return new u4(f,m,o.fieldTransforms)}function f4(i,e,t,n=!1){return m0(t,i.aa(n?4:3,e))}function m0(i,e){if(m4(i=(0,Fi.m9)(i)))return UB("Unsupported field value:",e,i),p4(i,e);if(i instanceof f0)return function(t,n){if(!h4(n.Zc))throw n.oa(`${t._methodName}() can only be used with update() and set()`);if(!n.path)throw n.oa(`${t._methodName}() is not currently supported inside arrays`);const r=t._toFieldTransform(n);r&&n.fieldTransforms.push(r)}(i,e),null;if(void 0===i&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.na&&4!==e.Zc)throw e.oa("Nested arrays are not supported");return function(t,n){const r=[];let s=0;for(const o of t){let a=m0(o,n.ra(s));null==a&&(a={nullValue:"NULL_VALUE"}),r.push(a),s++}return{arrayValue:{values:r}}}(i,e)}return function(t,n){if(null===(t=(0,Fi.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return PC(n.wt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const r=mr.fromDate(t);return{timestampValue:$y(n.wt,r)}}if(t instanceof mr){const r=new mr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:$y(n.wt,r)}}if(t instanceof LI)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Bf)return{bytesValue:Q2(n.wt,t._byteString)};if(t instanceof hs){const r=n.databaseId,s=t.firestore._databaseId;if(!s.isEqual(r))throw n.oa(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:XR(t.firestore._databaseId||n.databaseId,t._key.path)}}throw n.oa(`Unsupported field value: ${FI(t)}`)}(i,e)}function p4(i,e){const t={};return jx(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Cf(i,(n,r)=>{const s=m0(r,e.ea(n));null!=s&&(t[n]=s)}),{mapValue:{fields:t}}}function m4(i){return!("object"!=typeof i||null===i||i instanceof Array||i instanceof Date||i instanceof mr||i instanceof LI||i instanceof Bf||i instanceof hs||i instanceof f0)}function UB(i,e,t){if(!m4(t)||"object"!=typeof(n=t)||null===n||Object.getPrototypeOf(n)!==Object.prototype&&null!==Object.getPrototypeOf(n)){const n=FI(t);throw e.oa("an object"===n?i+" a custom object":i+" "+n)}var n}function VB(i,e,t){if((e=(0,Fi.m9)(e))instanceof dm)return e._internalPath;if("string"==typeof e)return NI(i,e);throw BI("Field path arguments must be of type string or ",i,!1,void 0,t)}const HQ=new RegExp("[~\\*/\\[\\]]");function NI(i,e,t){if(e.search(HQ)>=0)throw BI(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new dm(...e.split("."))._internalPath}catch{throw BI(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function BI(i,e,t,n,r){const s=n&&!n.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${n}`),o&&(l+=` in document ${r}`),l+=")"),new jt(at.INVALID_ARGUMENT,a+i+l)}function g4(i,e){return i.some(t=>t.isEqual(e))}class fE{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new hs(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new WQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(jI("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class WQ extends fE{data(){return super.data()}}function jI(i,e){return"string"==typeof e?NI(i,e):e instanceof dm?e._internalPath:e._delegate._internalPath}class g0{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fm extends fE{constructor(e,t,n,r,s,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new pE(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(jI("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class pE extends fm{data(e={}){return super.data(e)}}class T_{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new g0(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new pE(this._firestore,this._userDataWriter,n.key,n,new g0(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new jt(at.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(n,r){if(n._snapshot.oldDocs.isEmpty()){let s=0;return n._snapshot.docChanges.map(o=>({type:"added",doc:new pE(n._firestore,n._userDataWriter,o.doc.key,o.doc,new g0(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter),oldIndex:-1,newIndex:s++}))}{let s=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(o=>r||3!==o.type).map(o=>{const a=new pE(n._firestore,n._userDataWriter,o.doc.key,o.doc,new g0(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);let l=-1,h=-1;return 0!==o.type&&(l=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),1!==o.type&&(s=s.add(o.doc),h=s.indexOf(o.doc.key)),{type:qQ(o.type),doc:a,oldIndex:l,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function qQ(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return In()}}function _4(i,e){return i instanceof fm&&e instanceof fm?i._firestore===e._firestore&&i._key.isEqual(e._key)&&(null===i._document?null===e._document:i._document.isEqual(e._document))&&i._converter===e._converter:i instanceof T_&&e instanceof T_&&i._firestore===e._firestore&&o4(i.query,e.query)&&i.metadata.isEqual(e.metadata)&&i._snapshot.isEqual(e._snapshot)}function v4(i){if("L"===i.limitType&&0===i.explicitOrderBy.length)throw new jt(at.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mE{}function w_(i,...e){for(const t of e)i=t._apply(i);return i}class ZQ extends mE{constructor(e,t,n){super(),this.fa=e,this.da=t,this._a=n,this.type="where"}_apply(e){const t=p0(e.firestore),n=function(r,s,o,a,l,h,f){let m;if(l.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new jt(at.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){M4(f,h);const v=[];for(const y of f)v.push(w4(a,r,y));m={arrayValue:{values:v}}}else m=w4(a,r,f)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||M4(f,h),m=f4(o,"where",f,"in"===h||"not-in"===h);const g=ea.create(l,h,m);return function(v,y){if(y.ht()){const T=zy(v);if(null!==T&&!T.isEqual(y.field))throw new jt(at.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${T.toString()}' and '${y.field.toString()}'`);const S=qx(v);null!==S&&S4(0,y.field,S)}const b=function(T,S){for(const C of T.filters)if(S.indexOf(C.op)>=0)return C.op;return null}(v,function(T){switch(T){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(y.op));if(null!==b)throw new jt(at.INVALID_ARGUMENT,b===y.op?`Invalid query. You cannot use more than one '${y.op.toString()}' filter.`:`Invalid query. You cannot use '${y.op.toString()}' filters with '${b.toString()}' filters.`)}(r,g),g}(e._query,0,t,e.firestore._databaseId,this.fa,this.da,this._a);return new ll(e.firestore,e.converter,function(r,s){const o=r.filters.concat([s]);return new hc(r.path,r.collectionGroup,r.explicitOrderBy.slice(),o,r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}class KQ extends mE{constructor(e,t){super(),this.fa=e,this.wa=t,this.type="orderBy"}_apply(e){const t=function(n,r,s){if(null!==n.startAt)throw new jt(at.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==n.endAt)throw new jt(at.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new n_(r,s);return function(a,l){if(null===qx(a)){const h=zy(a);null!==h&&S4(0,h,l.field)}}(n,o),o}(e._query,this.fa,this.wa);return new ll(e.firestore,e.converter,function(n,r){const s=n.explicitOrderBy.concat([r]);return new hc(n.path,n.collectionGroup,s,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}(e._query,t))}}class y4 extends mE{constructor(e,t,n){super(),this.type=e,this.ma=t,this.ga=n}_apply(e){return new ll(e.firestore,e.converter,IC(e._query,this.ma,this.ga))}}class b4 extends mE{constructor(e,t,n){super(),this.type=e,this.ya=t,this.pa=n}_apply(e){const t=T4(e,this.type,this.ya,this.pa);return new ll(e.firestore,e.converter,(r=t,new hc((n=e._query).path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,r,n.endAt)));var n,r}}class x4 extends mE{constructor(e,t,n){super(),this.type=e,this.ya=t,this.pa=n}_apply(e){const t=T4(e,this.type,this.ya,this.pa);return new ll(e.firestore,e.converter,(r=t,new hc((n=e._query).path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,r)));var n,r}}function T4(i,e,t,n){if(t[0]=(0,Fi.m9)(t[0]),t[0]instanceof fE)return function(r,s,o,a,l){if(!a)throw new jt(at.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const h=[];for(const f of r_(r))if(f.field.isKeyField())h.push(Jg(s,a.key));else{const m=a.data.field(f.field);if(TC(m))throw new jt(at.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===m){const g=f.field.canonicalString();throw new jt(at.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}h.push(m)}return new uc(h,l)}(i._query,i.firestore._databaseId,e,t[0]._document,n);{const r=p0(i.firestore);return function(s,o,a,l,h,f){const m=s.explicitOrderBy;if(h.length>m.length)throw new jt(at.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const g=[];for(let v=0;v<h.length;v++){const y=h[v];if(m[v].field.isKeyField()){if("string"!=typeof y)throw new jt(at.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof y}`);if(!Zx(s)&&-1!==y.indexOf("/"))throw new jt(at.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${y}' contains a slash.`);const b=s.path.child(Xi.fromString(y));if(!fn.isDocumentKey(b))throw new jt(at.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${b}' is not because it contains an odd number of segments.`);const T=new fn(b);g.push(Jg(o,T))}else{const b=f4(a,l,y);g.push(b)}}return new uc(g,f)}(i._query,i.firestore._databaseId,r,e,t,n)}}function w4(i,e,t){if("string"==typeof(t=(0,Fi.m9)(t))){if(""===t)throw new jt(at.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Zx(e)&&-1!==t.indexOf("/"))throw new jt(at.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Xi.fromString(t));if(!fn.isDocumentKey(n))throw new jt(at.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Jg(i,new fn(n))}if(t instanceof hs)return Jg(i,t._key);throw new jt(at.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${FI(t)}.`)}function M4(i,e){if(!Array.isArray(i)||0===i.length)throw new jt(at.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(i.length>10)throw new jt(at.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function S4(i,e,t){if(!t.isEqual(e))throw new jt(at.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}const iJ={maxAttempts:5};class GB{convertValue(e,t="none"){switch(Qp(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Es(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(sd(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw In()}}convertObject(e,t){const n={};return Cf(e.fields,(r,s)=>{n[r]=this.convertValue(s,t)}),n}convertGeoPoint(e){return new LI(Es(e.latitude),Es(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=_R(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp($p(e));default:return null}}convertTimestamp(e){const t=Qu(e);return new mr(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Xi.fromString(e);fi(nI(n));const r=new Ju(n.get(1),n.get(3)),s=new fn(n.popFirst(5));return r.isEqual(t)||Ms(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function UI(i,e,t){let n;return n=i?t&&(t.merge||t.mergeFields)?i.toFirestore(e,t):i.toFirestore(e):e,n}class rJ extends GB{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new hs(this.firestore,null,t)}}class C4{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=p0(e)}set(e,t,n){this._verifyNotCommitted();const r=M_(e,this._firestore),s=UI(r.converter,t,n),o=kI(this._dataReader,"WriteBatch.set",r._key,s,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,As.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const s=M_(e,this._firestore);let o;return o="string"==typeof(t=(0,Fi.m9)(t))||t instanceof dm?jB(this._dataReader,"WriteBatch.update",s._key,t,n,r):BB(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,As.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=M_(e,this._firestore);return this._mutations=this._mutations.concat(new Rf(t._key,As.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new jt(at.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function M_(i,e){if((i=(0,Fi.m9)(i)).firestore!==e)throw new jt(at.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return i}function E4(i){i=$i(i,hs);const e=$i(i.firestore,Ds);return XH(Oo(e),i._key).then(t=>HB(e,i,t))}class _0 extends GB{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new hs(this.firestore,null,t)}}function A4(i){i=$i(i,ll);const e=$i(i.firestore,Ds),t=Oo(e),n=new _0(e);return v4(i._query),$H(t,i._query).then(r=>new T_(e,n,i,r))}function zB(i,e,t){i=$i(i,hs);const n=$i(i.firestore,Ds),r=UI(i.converter,e,t);return bT(n,[kI(p0(n),"setDoc",i._key,r,null!==i.converter,t).toMutation(i._key,As.none())])}function D4(i,e,t,...n){i=$i(i,hs);const r=$i(i.firestore,Ds),s=p0(r);let o;return o="string"==typeof(e=(0,Fi.m9)(e))||e instanceof dm?jB(s,"updateDoc",i._key,e,t,n):BB(s,"updateDoc",i._key,e),bT(r,[o.toMutation(i._key,As.exists(!0))])}function R4(i,...e){var t,n,r;i=(0,Fi.m9)(i);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||kB(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(kB(e[o])){const m=e[o];e[o]=null===(t=m.next)||void 0===t?void 0:t.bind(m),e[o+1]=null===(n=m.error)||void 0===n?void 0:n.bind(m),e[o+2]=null===(r=m.complete)||void 0===r?void 0:r.bind(m)}let l,h,f;if(i instanceof hs)h=$i(i.firestore,Ds),f=i_(i._key.path),l={next:m=>{e[o]&&e[o](HB(h,i,m))},error:e[o+1],complete:e[o+2]};else{const m=$i(i,ll);h=$i(m.firestore,Ds),f=m._query;const g=new _0(h);l={next:v=>{e[o]&&e[o](new T_(h,g,m,v))},error:e[o+1],complete:e[o+2]},v4(i._query)}return function(m,g,v,y){const b=new RI(y),T=new eB(g,b,v);return m.asyncQueue.enqueueAndForget((0,nt.Z)(function*(){return KN(yield yT(m),T)})),()=>{b.Tc(),m.asyncQueue.enqueueAndForget((0,nt.Z)(function*(){return $N(yield yT(m),T)}))}}(Oo(h),f,a,l)}function bT(i,e){return function(t,n){const r=new Qo;return t.asyncQueue.enqueueAndForget((0,nt.Z)(function*(){return function K$(i,e,t){return sB.apply(this,arguments)}(yield PB(t),n,r)})),r.promise}(Oo(i),e)}function HB(i,e,t){const n=t.docs.get(e._key),r=new _0(i);return new fm(i,r,e._key,n,new g0(t.hasPendingWrites,t.fromCache),e.converter)}class dJ extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=p0(e)}get(e){const t=M_(e,this._firestore),n=new rJ(this._firestore);return this._transaction.lookup([t._key]).then(r=>{if(!r||1!==r.length)return In();const s=r[0];if(s.isFoundDocument())return new fE(this._firestore,n,s.key,s,t.converter);if(s.isNoDocument())return new fE(this._firestore,n,t._key,null,t.converter);throw In()})}set(e,t,n){const r=M_(e,this._firestore),s=UI(r.converter,t,n),o=kI(this._dataReader,"Transaction.set",r._key,s,null!==r.converter,n);return this._transaction.set(r._key,o),this}update(e,t,n,...r){const s=M_(e,this._firestore);let o;return o="string"==typeof(t=(0,Fi.m9)(t))||t instanceof dm?jB(this._dataReader,"Transaction.update",s._key,t,n,r):BB(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){const t=M_(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=M_(e,this._firestore),n=new _0(this._firestore);return super.get(e).then(r=>new fm(this._firestore,n,t._key,r._document,new g0(!1,!1),t.converter))}}!function(i,e=!0){$u=Jc.SDK_VERSION,(0,Jc._registerComponent)(new Ag.wA("firestore",(t,{options:n})=>{const r=t.getProvider("app").getImmediate(),s=new Ds(r,new D2(t.getProvider("auth-internal")),new R2(t.getProvider("app-check-internal")));return n=Object.assign({useFetchStreams:e},n),s._setSettings(n),s},"PUBLIC")),(0,Jc.registerVersion)(oR,"3.4.14",i),(0,Jc.registerVersion)(oR,"3.4.14","esm2017")}();class WB{constructor(e){return e}}const P4="firestore",qB=new c.OlP("angularfire2.firestore-instances");function xJ(i){return(e,t)=>{const n=e.runOutsideAngular(()=>i(t));return new WB(n)}}const TJ={provide:class yJ{constructor(){return(0,pr.vb)(P4)}},deps:[[new c.FiY,qB]]},wJ={provide:WB,useFactory:function bJ(i,e){const t=(0,pr.JM)(P4,i,e);return t&&new WB(t)},deps:[[new c.FiY,qB],class Eg{constructor(e){return e}}]};let MJ=(()=>{class i{constructor(){(0,Qv.KN)("angularfire",pr.q4.full,"fst")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({providers:[wJ,TJ]}),i})();function SJ(i,...e){return{ngModule:MJ,providers:[{provide:qB,useFactory:xJ(i),multi:!0,deps:[c.R0b,c.zs3,pr.HU,W1,[new c.FiY,GM],[new c.FiY,cx],...e]}]}}const F4=(0,pr.u3)(OB,!0),VI=(0,pr.u3)(hE,!0),ZB=(0,pr.u3)(E4,!0),L4=(0,pr.u3)(A4,!0),O4=(0,pr.u3)(DQ,!0),CJ=(0,pr.u3)(zB,!0);let YB;try{YB=typeof Intl<"u"&&Intl.v8BreakIterator}catch{YB=!1}let xT,cl=(()=>{class i{constructor(t){this._platformId=t,this.isBrowser=this._platformId?Kl(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!YB)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(c.Lbi))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const k4=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function N4(){if(xT)return xT;if("object"!=typeof document||!document)return xT=new Set(k4),xT;let i=document.createElement("input");return xT=new Set(k4.filter(e=>(i.setAttribute("type",e),i.type===e))),xT}let gE,y0,KB;function v0(i){return function EJ(){if(null==gE&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>gE=!0}))}finally{gE=gE||!1}return gE}()?i:!!i.capture}function AJ(){if(null==y0){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return y0=!1,y0;if("scrollBehavior"in document.documentElement.style)y0=!0;else{const i=Element.prototype.scrollTo;y0=!!i&&!/\{\s*\[native code\]\s*\}/.test(i.toString())}}return y0}function XB(){let i=typeof document<"u"&&document?document.activeElement:null;for(;i&&i.shadowRoot;){const e=i.shadowRoot.activeElement;if(e===i)break;i=e}return i}function b0(i){return i.composedPath?i.composedPath()[0]:i.target}function $B(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function TT(i,...e){return e.length?e.some(t=>i[t]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}var _E=se(4986);function e3(i,e=_E.z){return(0,Zr.e)((t,n)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const h=s;s=null,n.next(h)}};function l(){const h=o+i,f=e.now();if(f<h)return r=this.schedule(void 0,h-f),void n.add(r);a()}t.subscribe((0,Tr.x)(n,h=>{s=h,o=e.now(),r||(r=e.schedule(l,i),n.add(r))},()=>{a(),n.complete()},void 0,()=>{s=r=null}))})}function U4(i){return fr((e,t)=>i<=t)}function V4(i,e=tc.y){return i=i??WJ,(0,Zr.e)((t,n)=>{let r,s=!0;t.subscribe((0,Tr.x)(n,o=>{const a=e(o);(s||!i(r,a))&&(s=!1,r=a,n.next(o))}))})}function WJ(i,e){return i===e}var G4=se(5032);function Xr(i){return(0,Zr.e)((e,t)=>{(0,Fr.Xf)(i).subscribe((0,Tr.x)(t,()=>t.complete(),G4.Z)),!t.closed&&e.subscribe(t)})}function $r(i){return null!=i&&"false"!=`${i}`}function pm(i,e=0){return function qJ(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}(i)?Number(i):e}function qI(i){return Array.isArray(i)?i:[i]}function ko(i){return null==i?"":"string"==typeof i?i:`${i}px`}function mm(i){return i instanceof c.SBq?i.nativeElement:i}let z4=(()=>{class i{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),ZJ=(()=>{class i{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,n)=>this._cleanupObserver(n))}observe(t){const n=mm(t);return new bs.y(r=>{const o=this._observeElement(n).subscribe(r);return()=>{o.unsubscribe(),this._unobserveElement(n)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const n=new Bn.x,r=this._mutationObserverFactory.create(s=>n.next(s));r&&r.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:r,stream:n,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:n,stream:r}=this._observedElements.get(t);n&&n.disconnect(),r.complete(),this._observedElements.delete(t)}}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(z4))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),H4=(()=>{class i{constructor(t,n,r){this._contentObserver=t,this._elementRef=n,this._ngZone=r,this.event=new c.vpe,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=$r(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=pm(t),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(e3(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(ZJ),c.Y36(c.SBq),c.Y36(c.R0b))},i.\u0275dir=c.lG2({type:i,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),i})(),t3=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({providers:[z4]}),i})();const W4=new Set;let wT,YJ=(()=>{class i{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):XJ}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function KJ(i){if(!W4.has(i))try{wT||(wT=document.createElement("style"),wT.setAttribute("type","text/css"),document.head.appendChild(wT)),wT.sheet&&(wT.sheet.insertRule(`@media ${i} {body{ }}`,0),W4.add(i))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(cl))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function XJ(i){return{matches:"all"===i||""===i,media:i,addListener:()=>{},removeListener:()=>{}}}let q4=(()=>{class i{constructor(t,n){this._mediaMatcher=t,this._zone=n,this._queries=new Map,this._destroySubject=new Bn.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return Z4(qI(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=Ou(Z4(qI(t)).map(o=>this._registerQuery(o).observable));return s=$a(s.pipe(Ns(1)),s.pipe(U4(1),e3(0))),s.pipe((0,Sn.U)(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:h})=>{a.matches=a.matches||l,a.breakpoints[h]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const n=this._mediaMatcher.matchMedia(t),s={observable:new bs.y(o=>{const a=l=>this._zone.run(()=>o.next(l));return n.addListener(a),()=>{n.removeListener(a)}}).pipe(ma(n),(0,Sn.U)(({matches:o})=>({query:t,matches:o})),Xr(this._destroySubject)),mql:n};return this._queries.set(t,s),s}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(YJ),c.LFG(c.R0b))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Z4(i){return i.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}function ZI(i,e){return(i.getAttribute(e)||"").match(/\S+/g)||[]}const K4="cdk-describedby-message",YI="cdk-describedby-host";let n3=0,eee=(()=>{class i{constructor(t,n){this._platform=n,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+n3++,this._document=t,this._id=(0,c.f3M)(c.AFp)+"-"+n3++}describe(t,n,r){if(!this._canBeDescribed(t,n))return;const s=r3(n,r);"string"!=typeof n?(X4(n,this._id),this._messageRegistry.set(s,{messageElement:n,referenceCount:0})):this._messageRegistry.has(s)||this._createMessageElement(n,r),this._isElementDescribedByMessage(t,s)||this._addMessageReference(t,s)}removeDescription(t,n,r){if(!n||!this._isElementNode(t))return;const s=r3(n,r);if(this._isElementDescribedByMessage(t,s)&&this._removeMessageReference(t,s),"string"==typeof n){const o=this._messageRegistry.get(s);o&&0===o.referenceCount&&this._deleteMessageElement(s)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const t=this._document.querySelectorAll(`[${YI}="${this._id}"]`);for(let n=0;n<t.length;n++)this._removeCdkDescribedByReferenceIds(t[n]),t[n].removeAttribute(YI);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(t,n){const r=this._document.createElement("div");X4(r,this._id),r.textContent=t,n&&r.setAttribute("role",n),this._createMessagesContainer(),this._messagesContainer.appendChild(r),this._messageRegistry.set(r3(t,n),{messageElement:r,referenceCount:0})}_deleteMessageElement(t){this._messageRegistry.get(t)?.messageElement?.remove(),this._messageRegistry.delete(t)}_createMessagesContainer(){if(this._messagesContainer)return;const t="cdk-describedby-message-container",n=this._document.querySelectorAll(`.${t}[platform="server"]`);for(let s=0;s<n.length;s++)n[s].remove();const r=this._document.createElement("div");r.style.visibility="hidden",r.classList.add(t),r.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&r.setAttribute("platform","server"),this._document.body.appendChild(r),this._messagesContainer=r}_removeCdkDescribedByReferenceIds(t){const n=ZI(t,"aria-describedby").filter(r=>0!=r.indexOf(K4));t.setAttribute("aria-describedby",n.join(" "))}_addMessageReference(t,n){const r=this._messageRegistry.get(n);(function QJ(i,e,t){const n=ZI(i,e);n.some(r=>r.trim()==t.trim())||(n.push(t.trim()),i.setAttribute(e,n.join(" ")))})(t,"aria-describedby",r.messageElement.id),t.setAttribute(YI,this._id),r.referenceCount++}_removeMessageReference(t,n){const r=this._messageRegistry.get(n);r.referenceCount--,function JJ(i,e,t){const r=ZI(i,e).filter(s=>s!=t.trim());r.length?i.setAttribute(e,r.join(" ")):i.removeAttribute(e)}(t,"aria-describedby",r.messageElement.id),t.removeAttribute(YI)}_isElementDescribedByMessage(t,n){const r=ZI(t,"aria-describedby"),s=this._messageRegistry.get(n),o=s&&s.messageElement.id;return!!o&&-1!=r.indexOf(o)}_canBeDescribed(t,n){if(!this._isElementNode(t))return!1;if(n&&"object"==typeof n)return!0;const r=null==n?"":`${n}`.trim(),s=t.getAttribute("aria-label");return!(!r||s&&s.trim()===r)}_isElementNode(t){return t.nodeType===this._document.ELEMENT_NODE}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Oe),c.LFG(cl))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function r3(i,e){return"string"==typeof i?`${e||""}/${i}`:i}function X4(i,e){i.id||(i.id=`${K4}-${e}-${n3++}`)}class nee extends class tee{constructor(e){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new Bn.x,this._typeaheadSubscription=ei.w0.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new Bn.x,this.change=new Bn.x,e instanceof c.n_E&&e.changes.subscribe(t=>{if(this._activeItem){const r=t.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}})}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe((0,Lr.b)(t=>this._pressedLetters.push(t)),e3(e),fr(()=>this._pressedLetters.length>0),(0,Sn.U)(()=>this._pressedLetters.join(""))).subscribe(t=>{const n=this._getItemsArray();for(let r=1;r<n.length+1;r++){const s=(this._activeItemIndex+r)%n.length,o=n[s];if(!this._skipPredicateFn(o)&&0===o.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}setActiveItem(e){const t=this._activeItem;this.updateActiveItem(e),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){const t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;default:return void((r||TT(e,"shiftKey"))&&(e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const t=this._getItemsArray(),n="number"==typeof e?e:t.indexOf(e);this._activeItem=t[n]??null,this._activeItemIndex=n}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const t=this._getItemsArray();for(let n=1;n<=t.length;n++){const r=(this._activeItemIndex+e*n+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){const n=this._getItemsArray();if(n[e]){for(;this._skipPredicateFn(n[e]);)if(!n[e+=t])return;this.setActiveItem(e)}}_getItemsArray(){return this._items instanceof c.n_E?this._items.toArray():this._items}}{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(e){return this._origin=e,this}setActiveItem(e){super.setActiveItem(e),this.activeItem&&this.activeItem.focus(this._origin)}}let KI=(()=>{class i{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function ree(i){return!!(i.offsetWidth||i.offsetHeight||"function"==typeof i.getClientRects&&i.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const n=function iee(i){try{return i.frameElement}catch{return null}}(function dee(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}(t));if(n&&(-1===Q4(n)||!this.isVisible(n)))return!1;let r=t.nodeName.toLowerCase(),s=Q4(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function uee(i){let e=i.nodeName.toLowerCase(),t="input"===e&&i.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,n){return function hee(i){return!function oee(i){return function lee(i){return"input"==i.nodeName.toLowerCase()}(i)&&"hidden"==i.type}(i)&&(function see(i){let e=i.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(i)||function aee(i){return function cee(i){return"a"==i.nodeName.toLowerCase()}(i)&&i.hasAttribute("href")}(i)||i.hasAttribute("contenteditable")||$4(i))}(t)&&!this.isDisabled(t)&&(n?.ignoreVisibility||this.isVisible(t))}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(cl))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function $4(i){if(!i.hasAttribute("tabindex")||void 0===i.tabIndex)return!1;let e=i.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function Q4(i){if(!$4(i))return null;const e=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class fee{constructor(e,t,n,r,s=!1){this._element=e,this._checker=t,this._ngZone=n,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const n=this._getFirstTabbableElement(t);return n?.focus(e),!!n}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=0;n<t.length;n++){const r=t[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[n]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=t.length-1;n>=0;n--){const r=t[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[n]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(Ns(1)).subscribe(e)}}let s3=(()=>{class i{constructor(t,n,r){this._checker=t,this._ngZone=n,this._document=r}create(t,n=!1){return new fee(t,this._checker,this._ngZone,this._document,n)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(KI),c.LFG(c.R0b),c.LFG(Oe))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function o3(i){return 0===i.buttons||0===i.offsetX&&0===i.offsetY}function a3(i){const e=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const pee=new c.OlP("cdk-input-modality-detector-options"),mee={ignoreKeys:[18,17,224,91,16]},MT=v0({passive:!0,capture:!0});let gee=(()=>{class i{constructor(t,n,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new Ks(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(a=>a===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=b0(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(o3(o)?"keyboard":"mouse"),this._mostRecentTarget=b0(o))},this._onTouchstart=o=>{a3(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=b0(o))},this._options={...mee,...s},this.modalityDetected=this._modality.pipe(U4(1)),this.modalityChanged=this.modalityDetected.pipe(V4()),t.isBrowser&&n.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,MT),r.addEventListener("mousedown",this._onMousedown,MT),r.addEventListener("touchstart",this._onTouchstart,MT)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,MT),document.removeEventListener("mousedown",this._onMousedown,MT),document.removeEventListener("touchstart",this._onTouchstart,MT))}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(cl),c.LFG(c.R0b),c.LFG(Oe),c.LFG(pee,8))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const vee=new c.OlP("cdk-focus-monitor-default-options"),XI=v0({passive:!0,capture:!0});let gm=(()=>{class i{constructor(t,n,r,s,o){this._ngZone=t,this._platform=n,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Bn.x,this._rootNodeFocusAndBlurListener=a=>{for(let h=b0(a);h;h=h.parentElement)"focus"===a.type?this._onFocus(a,h):this._onBlur(a,h)},this._document=s,this._detectionMode=o?.detectionMode||0}monitor(t,n=!1){const r=mm(t);if(!this._platform.isBrowser||1!==r.nodeType)return Tn(null);const s=function RJ(i){if(function DJ(){if(null==KB){const i=typeof document<"u"?document.head:null;KB=!(!i||!i.createShadowRoot&&!i.attachShadow)}return KB}()){const e=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return n&&(o.checkChildren=!0),o.subject;const a={checkChildren:n,subject:new Bn.x,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const n=mm(t),r=this._elementInfo.get(n);r&&(r.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(r))}focusVia(t,n,r){const s=mm(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,n,l)):(this._setOrigin(n),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,n){t.classList.toggle("cdk-focused",!!n),t.classList.toggle("cdk-touch-focused","touch"===n),t.classList.toggle("cdk-keyboard-focused","keyboard"===n),t.classList.toggle("cdk-mouse-focused","mouse"===n),t.classList.toggle("cdk-program-focused","program"===n)}_setOrigin(t,n=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&n,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,n){const r=this._elementInfo.get(n),s=b0(t);!r||!r.checkChildren&&n!==s||this._originChanged(n,this._getFocusOrigin(s),r)}_onBlur(t,n){const r=this._elementInfo.get(n);!r||r.checkChildren&&t.relatedTarget instanceof Node&&n.contains(t.relatedTarget)||(this._setClasses(n),this._emitOrigin(r,null))}_emitOrigin(t,n){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(n))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const n=t.rootNode,r=this._rootNodeFocusListenerCount.get(n)||0;r||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,XI),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,XI)}),this._rootNodeFocusListenerCount.set(n,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Xr(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const n=t.rootNode;if(this._rootNodeFocusListenerCount.has(n)){const r=this._rootNodeFocusListenerCount.get(n);r>1?this._rootNodeFocusListenerCount.set(n,r-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,XI),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,XI),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,n,r){this._setClasses(t,n),this._emitOrigin(r,n),this._lastFocusOrigin=n}_getClosestElementsInfo(t){const n=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&n.push([s,r])}),n}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:n,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!n||n===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let o=0;o<s.length;o++)if(s[o].contains(n))return!0;return!1}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(c.R0b),c.LFG(cl),c.LFG(gee),c.LFG(Oe,8),c.LFG(vee,8))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const e5="cdk-high-contrast-black-on-white",t5="cdk-high-contrast-white-on-black",l3="cdk-high-contrast-active";let n5=(()=>{class i{constructor(t,n){this._platform=t,this._document=n,this._breakpointSubscription=(0,c.f3M)(q4).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const n=this._document.defaultView||window,r=n&&n.getComputedStyle?n.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(l3,e5,t5),this._hasCheckedHighContrastMode=!0;const n=this.getHighContrastMode();1===n?t.add(l3,e5):2===n&&t.add(l3,t5)}}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(cl),c.LFG(Oe))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),r5=(()=>{class i{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(n5))},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[t3]}),i})();var yee=se(1144);const bee=["addListener","removeListener"],xee=["addEventListener","removeEventListener"],Tee=["on","off"];function $I(i,e,t,n){if((0,os.m)(t)&&(n=t,t=void 0),n)return $I(i,e,t).pipe(Kd(n));const[r,s]=function See(i){return(0,os.m)(i.addEventListener)&&(0,os.m)(i.removeEventListener)}(i)?xee.map(o=>a=>i[o](e,a,t)):function wee(i){return(0,os.m)(i.addListener)&&(0,os.m)(i.removeListener)}(i)?bee.map(s5(i,e)):function Mee(i){return(0,os.m)(i.on)&&(0,os.m)(i.off)}(i)?Tee.map(s5(i,e)):[];if(!r&&(0,yee.z)(i))return(0,Ar.z)(o=>$I(o,e,t))((0,Fr.Xf)(i));if(!r)throw new TypeError("Invalid event target");return new bs.y(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function s5(i,e){return t=>n=>i[t](e,n)}var o5=se(4408);const vE={schedule(i){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:n}=vE;n&&(e=n.requestAnimationFrame,t=n.cancelAnimationFrame);const r=e(s=>{t=void 0,i(s)});return new ei.w0(()=>t?.(r))},requestAnimationFrame(...i){const{delegate:e}=vE;return(e?.requestAnimationFrame||requestAnimationFrame)(...i)},cancelAnimationFrame(...i){const{delegate:e}=vE;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...i)},delegate:void 0};var a5=se(7565);new class Eee extends a5.v{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;e=e||n.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,r){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw r}}}(class Cee extends o5.o{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=vE.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(e,t,n);e.actions.some(r=>r.id===t)||(vE.cancelAnimationFrame(t),e._scheduled=void 0)}});let c3,Dee=1;const QI={};function l5(i){return i in QI&&(delete QI[i],!0)}const Ree={setImmediate(i){const e=Dee++;return QI[e]=!0,c3||(c3=Promise.resolve()),c3.then(()=>l5(e)&&i()),e},clearImmediate(i){l5(i)}},{setImmediate:Iee,clearImmediate:Pee}=Ree,JI={setImmediate(...i){const{delegate:e}=JI;return(e?.setImmediate||Iee)(...i)},clearImmediate(i){const{delegate:e}=JI;return(e?.clearImmediate||Pee)(i)},delegate:void 0},u3=new class Lee extends a5.v{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;e=e||n.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,r){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw r}}}(class Fee extends o5.o{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=JI.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(e,t,n);e.actions.some(r=>r.id===t)||(JI.clearImmediate(t),e._scheduled=void 0)}});var kee=se(3532);function c5(i=0,e,t=_E.P){let n=-1;return null!=e&&((0,kee.K)(e)?t=e:n=e),new bs.y(r=>{let s=function Nee(i){return i instanceof Date&&!isNaN(i)}(i)?+i-t.now():i;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=n?this.schedule(void 0,n):r.complete())},s)})}function u5(i,e=_E.z){return function Oee(i){return(0,Zr.e)((e,t)=>{let n=!1,r=null,s=null,o=!1;const a=()=>{if(s?.unsubscribe(),s=null,n){n=!1;const h=r;r=null,t.next(h)}o&&t.complete()},l=()=>{s=null,o&&t.complete()};e.subscribe((0,Tr.x)(t,h=>{n=!0,r=h,s||(0,Fr.Xf)(i(h)).subscribe(s=(0,Tr.x)(t,a,l))},()=>{o=!0,(!n||!s||s.closed)&&t.complete()}))})}(()=>c5(i,e))}const Bee=new c.OlP("cdk-dir-doc",{providedIn:"root",factory:function jee(){return(0,c.f3M)(Oe)}}),Uee=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let _m=(()=>{class i{constructor(t){if(this.value="ltr",this.change=new c.vpe,t){const r=t.documentElement?t.documentElement.dir:null;this.value=function Vee(i){const e=i?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?Uee.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||r||"ltr")}}ngOnDestroy(){this.change.complete()}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Bee,8))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),ST=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({}),i})(),h5=(()=>{class i{constructor(t,n,r){this._ngZone=t,this._platform=n,this._scrolled=new Bn.x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const n=this.scrollContainers.get(t);n&&(n.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new bs.y(n=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(u5(t)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Tn()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(t,n){const r=this.getAncestorScrollContainers(t);return this.scrolled(n).pipe(fr(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const n=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&n.push(s)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,n){let r=mm(n),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>$I(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(c.R0b),c.LFG(cl),c.LFG(Oe,8))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),d5=(()=>{class i{constructor(t,n,r){this._platform=t,this._change=new Bn.x,this._changeListener=s=>{this._change.next(s)},this._document=r,n.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:n,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+n,height:r,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,n=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||n.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||n.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(u5(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(cl),c.LFG(c.R0b),c.LFG(Oe,8))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),yE=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({}),i})(),f5=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[ST,yE,ST,yE]}),i})();class h3{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class eP extends h3{constructor(e,t,n,r){super(),this.component=e,this.viewContainerRef=t,this.injector=n,this.componentFactoryResolver=r}}class d3 extends h3{constructor(e,t,n,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=n,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class Hee extends h3{constructor(e){super(),this.element=e instanceof c.SBq?e.nativeElement:e}}class f3{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof eP?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof d3?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof Hee?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Wee extends f3{constructor(e,t,n,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=n,this._defaultInjector=r,this.attachDomPortal=o=>{const a=o.element,l=this._document.createComment("dom-portal");a.parentNode.insertBefore(l,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=s}attachComponentPortal(e){const n=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(n,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector),this.setDisposeFn(()=>r.destroy())):(r=n.create(e.injector||this._defaultInjector||c.zs3.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,n=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return n.rootNodes.forEach(r=>this.outletElement.appendChild(r)),n.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(n);-1!==r&&t.remove(r)}),this._attachedPortal=e,n}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let p3=(()=>{class i extends f3{constructor(t,n,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=n,this._isInitialized=!1,this.attached=new c.vpe,this.attachDomPortal=s=>{const o=s.element,a=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(a,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{a.parentNode&&a.parentNode.replaceChild(o,a)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(t){t.setAttachedHost(this);const n=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),o=n.createComponent(s,n.length,t.injector||n.injector);return n!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=t,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(t){t.setAttachedHost(this);const n=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=n,this.attached.emit(n),n}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c._Vd),c.Y36(c.s_b),c.Y36(Oe))},i.\u0275dir=c.lG2({type:i,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[c.qOj]}),i})(),tP=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({}),i})();var vm=se(6451);const p5=AJ();class qee{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=ko(-this._previousScrollPosition.left),e.style.top=ko(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,n=e.style,r=this._document.body.style,s=n.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),p5&&(n.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),p5&&(n.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,n=this._viewportRuler.getViewportSize();return t.scrollHeight>n.height||t.scrollWidth>n.width}}class Zee{constructor(e,t,n,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class m5{enable(){}disable(){}attach(){}}function m3(i,e){return e.some(t=>i.bottom<t.top||i.top>t.bottom||i.right<t.left||i.left>t.right)}function g5(i,e){return e.some(t=>i.top<t.top||i.bottom>t.bottom||i.left<t.left||i.right>t.right)}class Yee{constructor(e,t,n,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:r}=this._viewportRuler.getViewportSize();m3(t,[{width:n,height:r,bottom:r,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let Kee=(()=>{class i{constructor(t,n,r,s){this._scrollDispatcher=t,this._viewportRuler=n,this._ngZone=r,this.noop=()=>new m5,this.close=o=>new Zee(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new qee(this._viewportRuler,this._document),this.reposition=o=>new Yee(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(h5),c.LFG(d5),c.LFG(c.R0b),c.LFG(Oe))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class g3{constructor(e){if(this.scrollStrategy=new m5,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const n of t)void 0!==e[n]&&(this[n]=e[n])}}}class Xee{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let _5=(()=>{class i{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const n=this._attachedOverlays.indexOf(t);n>-1&&this._attachedOverlays.splice(n,1),0===this._attachedOverlays.length&&this.detach()}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Oe))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),$ee=(()=>{class i extends _5{constructor(t,n){super(t),this._ngZone=n,this._keydownListener=r=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const a=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(r)):a.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Oe),c.LFG(c.R0b,8))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Qee=(()=>{class i extends _5{constructor(t,n,r){super(t),this._platform=n,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=b0(s)},this._clickListener=s=>{const o=b0(s),a="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const l=this._attachedOverlays.slice();for(let h=l.length-1;h>-1;h--){const f=l[h];if(f._outsidePointerEvents.observers.length<1||!f.hasAttached())continue;if(f.overlayElement.contains(o)||f.overlayElement.contains(a))break;const m=f._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>m.next(s)):m.next(s)}}}add(t){if(super.add(t),!this._isAttached){const n=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(n)):this._addEventListeners(n),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Oe),c.LFG(cl),c.LFG(c.R0b,8))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),nP=(()=>{class i{constructor(t,n){this._platform=n,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||$B()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const n=this._document.createElement("div");n.classList.add(t),$B()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Oe),c.LFG(cl))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class bE{constructor(e,t,n,r,s,o,a,l,h,f=!1){this._portalOutlet=e,this._host=t,this._pane=n,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=l,this._outsideClickDispatcher=h,this._animationsDisabled=f,this._backdropElement=null,this._backdropClick=new Bn.x,this._attachments=new Bn.x,this._detachments=new Bn.x,this._locationChanges=ei.w0.EMPTY,this._backdropClickHandler=m=>this._backdropClick.next(m),this._backdropTransitionendHandler=m=>{this._disposeBackdrop(m.target)},this._keydownEvents=new Bn.x,this._outsidePointerEvents=new Bn.x,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Ns(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=ko(this._config.width),e.height=ko(this._config.height),e.minWidth=ko(this._config.minWidth),e.minHeight=ko(this._config.minHeight),e.maxWidth=ko(this._config.maxWidth),e.maxHeight=ko(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,n){const r=qI(t||[]).filter(s=>!!s);r.length&&(n?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(Xr((0,vm.T)(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const v5="cdk-overlay-connected-position-bounding-box",Jee=/([A-Za-z%]+)$/;class ete{constructor(e,t,n,r,s){this._viewportRuler=t,this._document=n,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Bn.x,this._resizeSubscription=ei.w0.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}get positions(){return this._preferredPositions}attach(e){this._validatePositions(),e.hostElement.classList.add(v5),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,n=this._viewportRect,r=this._containerRect,s=[];let o;for(let a of this._preferredPositions){let l=this._getOriginPoint(e,r,a),h=this._getOverlayPoint(l,t,a),f=this._getOverlayFit(h,t,n,a);if(f.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,l);this._canFitWithFlexibleDimensions(f,h,n)?s.push({position:a,origin:l,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(l,a)}):(!o||o.overlayFit.visibleArea<f.visibleArea)&&(o={overlayFit:f,overlayPoint:h,originPoint:l,position:a,overlayRect:t})}if(s.length){let a=null,l=-1;for(const h of s){const f=h.boundingBoxRect.width*h.boundingBoxRect.height*(h.position.weight||1);f>l&&(l=f,a=h)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&x0(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(v5),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,n){let r,s;if("center"==n.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;r="start"==n.originX?o:a}return t.left<0&&(r-=t.left),s="center"==n.originY?e.top+e.height/2:"top"==n.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,n){let r,s;return r="center"==n.overlayX?-t.width/2:"start"===n.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==n.overlayY?-t.height/2:"top"==n.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,n,r){const s=b5(t);let{x:o,y:a}=e,l=this._getOffset(r,"x"),h=this._getOffset(r,"y");l&&(o+=l),h&&(a+=h);let g=0-a,v=a+s.height-n.height,y=this._subtractOverflows(s.width,0-o,o+s.width-n.width),b=this._subtractOverflows(s.height,g,v),T=y*b;return{visibleArea:T,isCompletelyWithinViewport:s.width*s.height===T,fitsInViewportVertically:b===s.height,fitsInViewportHorizontally:y==s.width}}_canFitWithFlexibleDimensions(e,t,n){if(this._hasFlexibleDimensions){const r=n.bottom-t.y,s=n.right-t.x,o=y5(this._overlayRef.getConfig().minHeight),a=y5(this._overlayRef.getConfig().minWidth),h=e.fitsInViewportHorizontally||null!=a&&a<=s;return(e.fitsInViewportVertically||null!=o&&o<=r)&&h}return!1}_pushOverlayOnScreen(e,t,n){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=b5(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),l=Math.max(s.top-n.top-e.y,0),h=Math.max(s.left-n.left-e.x,0);let f=0,m=0;return f=r.width<=s.width?h||-o:e.x<this._viewportMargin?s.left-n.left-e.x:0,m=r.height<=s.height?l||-a:e.y<this._viewportMargin?s.top-n.top-e.y:0,this._previousPushAmount={x:f,y:m},{x:e.x+f,y:e.y+m}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const n=this._getScrollVisibility(),r=new Xee(e,n);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,r=e.overlayY;n="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(e,t){const n=this._viewportRect,r=this._isRtl();let s,o,a,f,m,g;if("top"===t.overlayY)o=e.y,s=n.height-o+this._viewportMargin;else if("bottom"===t.overlayY)a=n.height-e.y+2*this._viewportMargin,s=n.height-a+this._viewportMargin;else{const v=Math.min(n.bottom-e.y+n.top,e.y),y=this._lastBoundingBoxSize.height;s=2*v,o=e.y-v,s>y&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-y/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)g=n.width-e.x+this._viewportMargin,f=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)m=e.x,f=n.right-e.x;else{const v=Math.min(n.right-e.x+n.left,e.x),y=this._lastBoundingBoxSize.width;f=2*v,m=e.x-v,f>y&&!this._isInitialRender&&!this._growAfterOpen&&(m=e.x-y/2)}return{top:o,left:m,bottom:a,right:g,width:f,height:s}}_setBoundingBoxStyles(e,t){const n=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=ko(n.height),r.top=ko(n.top),r.bottom=ko(n.bottom),r.width=ko(n.width),r.left=ko(n.left),r.right=ko(n.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=ko(s)),o&&(r.maxWidth=ko(o))}this._lastBoundingBoxSize=n,x0(this._boundingBox.style,r)}_resetBoundingBoxStyles(){x0(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){x0(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const n={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const f=this._viewportRuler.getViewportScrollPosition();x0(n,this._getExactOverlayY(t,e,f)),x0(n,this._getExactOverlayX(t,e,f))}else n.position="static";let a="",l=this._getOffset(t,"x"),h=this._getOffset(t,"y");l&&(a+=`translateX(${l}px) `),h&&(a+=`translateY(${h}px)`),n.transform=a.trim(),o.maxHeight&&(r?n.maxHeight=ko(o.maxHeight):s&&(n.maxHeight="")),o.maxWidth&&(r?n.maxWidth=ko(o.maxWidth):s&&(n.maxWidth="")),x0(this._pane.style,n)}_getExactOverlayY(e,t,n){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=ko(s.y),r}_getExactOverlayX(e,t,n){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=ko(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),n=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:g5(e,n),isOriginOutsideView:m3(e,n),isOverlayClipped:g5(t,n),isOverlayOutsideView:m3(t,n)}}_subtractOverflows(e,...t){return t.reduce((n,r)=>n-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+e-this._viewportMargin,bottom:n.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?e.offsetX??this._offsetX:e.offsetY??this._offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&qI(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof c.SBq)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,n=e.height||0;return{top:e.y,bottom:e.y+n,left:e.x,right:e.x+t,height:n,width:t}}}function x0(i,e){for(let t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}function y5(i){if("number"!=typeof i&&null!=i){const[e,t]=i.split(Jee);return t&&"px"!==t?null:parseFloat(e)}return i||null}function b5(i){return{top:Math.floor(i.top),right:Math.floor(i.right),bottom:Math.floor(i.bottom),left:Math.floor(i.left),width:Math.floor(i.width),height:Math.floor(i.height)}}const x5="cdk-global-overlay-wrapper";class tte{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(x5),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=n,l=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),h=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a),f=this._xPosition,m=this._xOffset,g="rtl"===this._overlayRef.getConfig().direction;let v="",y="",b="";l?b="flex-start":"center"===f?(b="center",g?y=m:v=m):g?"left"===f||"end"===f?(b="flex-end",v=m):("right"===f||"start"===f)&&(b="flex-start",y=m):"left"===f||"start"===f?(b="flex-start",v=m):("right"===f||"end"===f)&&(b="flex-end",y=m),e.position=this._cssPosition,e.marginLeft=l?"0":v,e.marginTop=h?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=l?"0":y,t.justifyContent=b,t.alignItems=h?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,n=t.style;t.classList.remove(x5),n.justifyContent=n.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let nte=(()=>{class i{constructor(t,n,r,s){this._viewportRuler=t,this._document=n,this._platform=r,this._overlayContainer=s}global(){return new tte}flexibleConnectedTo(t){return new ete(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(d5),c.LFG(Oe),c.LFG(cl),c.LFG(nP))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),ite=0,fd=(()=>{class i{constructor(t,n,r,s,o,a,l,h,f,m,g,v){this.scrollStrategies=t,this._overlayContainer=n,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=l,this._document=h,this._directionality=f,this._location=m,this._outsideClickDispatcher=g,this._animationsModuleType=v}create(t){const n=this._createHostElement(),r=this._createPaneElement(n),s=this._createPortalOutlet(r),o=new g3(t);return o.direction=o.direction||this._directionality.value,new bE(s,n,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const n=this._document.createElement("div");return n.id="cdk-overlay-"+ite++,n.classList.add("cdk-overlay-pane"),t.appendChild(n),n}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(c.z2F)),new Wee(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Kee),c.LFG(nP),c.LFG(c._Vd),c.LFG(nte),c.LFG($ee),c.LFG(c.zs3),c.LFG(c.R0b),c.LFG(Oe),c.LFG(_m),c.LFG(Dt),c.LFG(Qee),c.LFG(c.QbO,8))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})();const ote={provide:new c.OlP("cdk-connected-overlay-scroll-strategy"),deps:[fd],useFactory:function ste(i){return()=>i.scrollStrategies.reposition()}};let xE=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({providers:[fd,ote],imports:[ST,tP,f5,f5]}),i})();function ate(i,e){}class iP{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0}}let T5=(()=>{class i extends f3{constructor(t,n,r,s,o,a,l,h){super(),this._elementRef=t,this._focusTrapFactory=n,this._config=s,this._interactivityChecker=o,this._ngZone=a,this._overlayRef=l,this._focusMonitor=h,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=f=>{this._portalOutlet.hasAttached();const m=this._portalOutlet.attachDomPortal(f);return this._contentAttached(),m},this._ariaLabelledBy=this._config.ariaLabelledBy||null,this._document=r}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(t){this._portalOutlet.hasAttached();const n=this._portalOutlet.attachComponentPortal(t);return this._contentAttached(),n}attachTemplatePortal(t){this._portalOutlet.hasAttached();const n=this._portalOutlet.attachTemplatePortal(t);return this._contentAttached(),n}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(t,n){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(n)}_focusByCssSelector(t,n){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,n)}_trapFocus(){const t=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||t.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{n||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const t=this._config.restoreFocus;let n=null;if("string"==typeof t?n=this._document.querySelector(t):"boolean"==typeof t?n=t?this._elementFocusedBeforeDialogWasOpened:null:t&&(n=t),this._config.restoreFocus&&n&&"function"==typeof n.focus){const r=XB(),s=this._elementRef.nativeElement;(!r||r===this._document.body||r===s||s.contains(r))&&(this._focusMonitor?(this._focusMonitor.focusVia(n,this._closeInteractionType),this._closeInteractionType=null):n.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,n=XB();return t===n||t.contains(n)}_initializeFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=XB())}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(s3),c.Y36(Oe,8),c.Y36(iP),c.Y36(KI),c.Y36(c.R0b),c.Y36(bE),c.Y36(gm))},i.\u0275cmp=c.Xpm({type:i,selectors:[["cdk-dialog-container"]],viewQuery:function(t,n){if(1&t&&c.Gf(p3,7),2&t){let r;c.iGM(r=c.CRH())&&(n._portalOutlet=r.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(t,n){2&t&&c.uIk("id",n._config.id||null)("role",n._config.role)("aria-modal",n._config.ariaModal)("aria-labelledby",n._config.ariaLabel?null:n._ariaLabelledBy)("aria-label",n._config.ariaLabel)("aria-describedby",n._config.ariaDescribedBy||null)},features:[c.qOj],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,n){1&t&&c.YNc(0,ate,0,0,"ng-template",0)},dependencies:[p3],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2}),i})();class _3{constructor(e,t){this.overlayRef=e,this.config=t,this.closed=new Bn.x,this.disableClose=t.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=t.id,this.keydownEvents.subscribe(n=>{27===n.keyCode&&!this.disableClose&&!TT(n)&&(n.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})})}close(e,t){if(this.containerInstance){const n=this.closed;this.containerInstance._closeInteractionType=t?.focusOrigin||"program",this.overlayRef.dispose(),n.next(e),n.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",t=""){return this.overlayRef.updateSize({width:e,height:t}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}}const w5=new c.OlP("DialogScrollStrategy"),lte=new c.OlP("DialogData"),cte=new c.OlP("DefaultDialogConfig"),hte={provide:w5,deps:[fd],useFactory:function ute(i){return()=>i.scrollStrategies.block()}};let dte=0,M5=(()=>{class i{constructor(t,n,r,s,o,a){this._overlay=t,this._injector=n,this._defaultOptions=r,this._parentDialog=s,this._overlayContainer=o,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Bn.x,this._afterOpenedAtThisLevel=new Bn.x,this._ariaHiddenElements=new Map,this.afterAllClosed=Nu(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(ma(void 0))),this._scrollStrategy=a}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}open(t,n){(n={...this._defaultOptions||new iP,...n}).id=n.id||"cdk-dialog-"+dte++,n.id&&this.getDialogById(n.id);const s=this._getOverlayConfig(n),o=this._overlay.create(s),a=new _3(o,n),l=this._attachContainer(o,a,n);return a.containerInstance=l,this._attachDialogContent(t,a,l,n),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(a),a.closed.subscribe(()=>this._removeOpenDialog(a,!0)),this.afterOpened.next(a),a}closeAll(){v3(this.openDialogs,t=>t.close())}getDialogById(t){return this.openDialogs.find(n=>n.id===t)}ngOnDestroy(){v3(this._openDialogsAtThisLevel,t=>{!1===t.config.closeOnDestroy&&this._removeOpenDialog(t,!1)}),v3(this._openDialogsAtThisLevel,t=>t.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(t){const n=new g3({positionStrategy:t.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,width:t.width,height:t.height,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(n.backdropClass=t.backdropClass),n}_attachContainer(t,n,r){const s=r.injector||r.viewContainerRef?.injector,o=[{provide:iP,useValue:r},{provide:_3,useValue:n},{provide:bE,useValue:t}];let a;r.container?"function"==typeof r.container?a=r.container:(a=r.container.type,o.push(...r.container.providers(r))):a=T5;const l=new eP(a,r.viewContainerRef,c.zs3.create({parent:s||this._injector,providers:o}),r.componentFactoryResolver);return t.attach(l).instance}_attachDialogContent(t,n,r,s){if(t instanceof c.Rgc){const o=this._createInjector(s,n,r,void 0);let a={$implicit:s.data,dialogRef:n};s.templateContext&&(a={...a,..."function"==typeof s.templateContext?s.templateContext():s.templateContext}),r.attachTemplatePortal(new d3(t,null,a,o))}else{const o=this._createInjector(s,n,r,this._injector),a=r.attachComponentPortal(new eP(t,s.viewContainerRef,o,s.componentFactoryResolver));n.componentInstance=a.instance}}_createInjector(t,n,r,s){const o=t.injector||t.viewContainerRef?.injector,a=[{provide:lte,useValue:t.data},{provide:_3,useValue:n}];return t.providers&&("function"==typeof t.providers?a.push(...t.providers(n,t,r)):a.push(...t.providers)),t.direction&&(!o||!o.get(_m,null,c.XFs.Optional))&&a.push({provide:_m,useValue:{value:t.direction,change:Tn()}}),c.zs3.create({parent:o||s,providers:a})}_removeOpenDialog(t,n){const r=this.openDialogs.indexOf(t);r>-1&&(this.openDialogs.splice(r,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((s,o)=>{s?o.setAttribute("aria-hidden",s):o.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),n&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const n=t.parentElement.children;for(let r=n.length-1;r>-1;r--){const s=n[r];s!==t&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(fd),c.LFG(c.zs3),c.LFG(cte,8),c.LFG(i,12),c.LFG(nP),c.LFG(w5))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})();function v3(i,e){let t=i.length;for(;t--;)e(i[t])}let fte=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({providers:[M5,hte],imports:[xE,tP,r5,tP]}),i})();const mte=new c.OlP("mat-sanity-checks",{providedIn:"root",factory:function pte(){return!0}});let Qr=(()=>{class i{constructor(t,n,r){this._sanityChecks=n,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!$B()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(n5),c.LFG(mte,8),c.LFG(Oe))},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[ST,ST]}),i})();function rP(i){return class extends i{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=$r(e)}}}function TE(i,e){return class extends i{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const n=t||this.defaultColor;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}}}function y3(i){return class extends i{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=$r(e)}}}function gte(i){return class extends i{constructor(...e){super(...e),this.errorState=!1}updateErrorState(){const e=this.errorState,s=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);s!==e&&(this.errorState=s,this.stateChanges.next())}}}let A5=(()=>{class i{isErrorState(t,n){return!!(t&&t.invalid&&(t.touched||n&&n.submitted))}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class vte{constructor(e,t,n,r=!1){this._renderer=e,this.element=t,this.config=n,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const D5={enterDuration:225,exitDuration:150},b3=v0({passive:!0}),R5=["mousedown","touchstart"],I5=["mouseup","mouseleave","touchend","touchcancel"];class bte{constructor(e,t,n,r){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=mm(n))}fadeInRipple(e,t,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...D5,...n.animation};n.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=n.radius||function xte(i,e,t){const n=Math.max(Math.abs(i-t.left),Math.abs(i-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(n*n+r*r)}(e,t,r),a=e-r.left,l=t-r.top,h=s.enterDuration,f=document.createElement("div");f.classList.add("mat-ripple-element"),f.style.left=a-o+"px",f.style.top=l-o+"px",f.style.height=2*o+"px",f.style.width=2*o+"px",null!=n.color&&(f.style.backgroundColor=n.color),f.style.transitionDuration=`${h}ms`,this._containerElement.appendChild(f);const m=window.getComputedStyle(f),v=m.transitionDuration,y="none"===m.transitionProperty||"0s"===v||"0s, 0s"===v,b=new vte(this,f,n,y);f.style.transform="scale3d(1, 1, 1)",b.state=0,n.persistent||(this._mostRecentTransientRipple=b);let T=null;return!y&&(h||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const S=()=>this._finishRippleTransition(b),C=()=>this._destroyRipple(b);f.addEventListener("transitionend",S),f.addEventListener("transitioncancel",C),T={onTransitionEnd:S,onTransitionCancel:C}}),this._activeRipples.set(b,T),(y||!h)&&this._finishRippleTransition(b),b}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,n={...D5,...e.config.animation};t.style.transitionDuration=`${n.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=mm(e);!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(R5))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(I5),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:n}=e.config;e.state=1,!n&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=o3(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!a3(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let n=0;n<t.length;n++)this.fadeInRipple(t[n].clientX,t[n].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(t=>{this._triggerElement.addEventListener(t,this,b3)})})}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){this._triggerElement&&(R5.forEach(e=>{this._triggerElement.removeEventListener(e,this,b3)}),this._pointerUpEventsRegistered&&I5.forEach(e=>{this._triggerElement.removeEventListener(e,this,b3)}))}}const Tte=new c.OlP("mat-ripple-global-options");let ME=(()=>{class i{constructor(t,n,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new bte(this,n,t,r)}get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,n=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,n,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(c.R0b),c.Y36(cl),c.Y36(Tte,8),c.Y36(c.QbO,8))},i.\u0275dir=c.lG2({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,n){2&t&&c.ekj("mat-ripple-unbounded",n.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),i})(),sP=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[Qr,Qr]}),i})(),wte=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[Qr]}),i})(),P5=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[sP,or,Qr,wte]}),i})();class F5{}const ym="*";function jf(i,e){return{type:7,name:i,definitions:e,options:{}}}function ul(i,e=null){return{type:4,styles:e,timings:i}}function L5(i,e=null){return{type:3,steps:i,options:e}}function O5(i,e=null){return{type:2,steps:i,options:e}}function Qi(i){return{type:6,styles:i,offset:null}}function Uf(i,e,t){return{type:0,name:i,styles:e,options:t}}function ka(i,e,t=null){return{type:1,expr:i,animation:e,options:t}}function x3(i=null){return{type:9,options:i}}function T3(i,e,t=null){return{type:11,selector:i,animation:e,options:t}}function k5(i){Promise.resolve(null).then(i)}class SE{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){k5(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class N5{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,r=0;const s=this.players.length;0==s?k5(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++n==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const r=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(r)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}function Cte(i,e){}const CT={params:{enterAnimationDuration:"150ms",exitAnimationDuration:"75ms"}},Ete={dialogContainer:jf("dialogContainer",[Uf("void, exit",Qi({opacity:0,transform:"scale(0.7)"})),Uf("enter",Qi({transform:"none"})),ka("* => enter",L5([ul("{{enterAnimationDuration}} cubic-bezier(0, 0, 0.2, 1)",Qi({transform:"none",opacity:1})),T3("@*",x3(),{optional:!0})]),CT),ka("* => void, * => exit",L5([ul("{{exitAnimationDuration}} cubic-bezier(0.4, 0.0, 0.2, 1)",Qi({opacity:0})),T3("@*",x3(),{optional:!0})]),CT)])};class oP{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0,this.enterAnimationDuration=CT.params.enterAnimationDuration,this.exitAnimationDuration=CT.params.exitAnimationDuration}}let Ate=(()=>{class i extends T5{constructor(t,n,r,s,o,a,l,h){super(t,n,r,s,o,a,l,h),this._animationStateChanged=new c.vpe}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(t){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:t})}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(s3),c.Y36(Oe,8),c.Y36(oP),c.Y36(KI),c.Y36(c.R0b),c.Y36(bE),c.Y36(gm))},i.\u0275cmp=c.Xpm({type:i,selectors:[["ng-component"]],features:[c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})(),Dte=(()=>{class i extends Ate{constructor(t,n,r,s,o,a,l,h,f){super(t,n,r,s,o,a,l,f),this._changeDetectorRef=h,this._state="enter"}_onAnimationDone({toState:t,totalTime:n}){"enter"===t?this._openAnimationDone(n):"exit"===t&&this._animationStateChanged.next({state:"closed",totalTime:n})}_onAnimationStart({toState:t,totalTime:n}){"enter"===t?this._animationStateChanged.next({state:"opening",totalTime:n}):("exit"===t||"void"===t)&&this._animationStateChanged.next({state:"closing",totalTime:n})}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}_getAnimationState(){return{value:this._state,params:{enterAnimationDuration:this._config.enterAnimationDuration||CT.params.enterAnimationDuration,exitAnimationDuration:this._config.exitAnimationDuration||CT.params.exitAnimationDuration}}}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(s3),c.Y36(Oe,8),c.Y36(oP),c.Y36(KI),c.Y36(c.R0b),c.Y36(bE),c.Y36(c.sBO),c.Y36(gm))},i.\u0275cmp=c.Xpm({type:i,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-dialog-container"],hostVars:7,hostBindings:function(t,n){1&t&&c.WFA("@dialogContainer.start",function(s){return n._onAnimationStart(s)})("@dialogContainer.done",function(s){return n._onAnimationDone(s)}),2&t&&(c.Ikx("id",n._config.id),c.uIk("aria-modal",n._config.ariaModal)("role",n._config.role)("aria-labelledby",n._config.ariaLabel?null:n._ariaLabelledBy)("aria-label",n._config.ariaLabel)("aria-describedby",n._config.ariaDescribedBy||null),c.d8E("@dialogContainer",n._getAnimationState()))},features:[c.qOj],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,n){1&t&&c.YNc(0,Cte,0,0,"ng-template",0)},dependencies:[p3],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions.mat-dialog-actions-align-center,.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions.mat-dialog-actions-align-end,.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}"],encapsulation:2,data:{animation:[Ete.dialogContainer]}}),i})();class aP{constructor(e,t,n){this._ref=e,this._containerInstance=n,this._afterOpened=new Bn.x,this._beforeClosed=new Bn.x,this._state=0,this.disableClose=t.disableClose,this.id=e.id,n._animationStateChanged.pipe(fr(r=>"opened"===r.state),Ns(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),n._animationStateChanged.pipe(fr(r=>"closed"===r.state),Ns(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),(0,vm.T)(this.backdropClick(),this.keydownEvents().pipe(fr(r=>27===r.keyCode&&!this.disableClose&&!TT(r)))).subscribe(r=>{this.disableClose||(r.preventDefault(),function Rte(i,e,t){i._closeInteractionType=e,i.close(t)}(this,"keydown"===r.type?"keyboard":"mouse"))})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(fr(t=>"closing"===t.state),Ns(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(e){let t=this._ref.config.positionStrategy;return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._ref.updatePosition(),this}updateSize(e="",t=""){return this._ref.updateSize(e,t),this}addPanelClass(e){return this._ref.addPanelClass(e),this}removePanelClass(e){return this._ref.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const lP=new c.OlP("MatDialogData"),Ite=new c.OlP("mat-dialog-default-options"),B5=new c.OlP("mat-dialog-scroll-strategy"),Fte={provide:B5,deps:[fd],useFactory:function Pte(i){return()=>i.scrollStrategies.block()}};let Lte=0,Ote=(()=>{class i{constructor(t,n,r,s,o,a,l,h,f,m){this._overlay=t,this._defaultOptions=r,this._parentDialog=s,this._dialogRefConstructor=l,this._dialogContainerType=h,this._dialogDataToken=f,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Bn.x,this._afterOpenedAtThisLevel=new Bn.x,this._idPrefix="mat-dialog-",this.afterAllClosed=Nu(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(ma(void 0))),this._scrollStrategy=a,this._dialog=n.get(M5)}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(t,n){let r;(n={...this._defaultOptions||new oP,...n}).id=n.id||`${this._idPrefix}${Lte++}`,n.scrollStrategy=n.scrollStrategy||this._scrollStrategy();const s=this._dialog.open(t,{...n,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:oP,useValue:n},{provide:iP,useValue:n}]},templateContext:()=>({dialogRef:r}),providers:(o,a,l)=>(r=new this._dialogRefConstructor(o,n,l),r.updatePosition(n?.position),[{provide:this._dialogContainerType,useValue:l},{provide:this._dialogDataToken,useValue:a.data},{provide:this._dialogRefConstructor,useValue:r}])});return r.componentInstance=s.componentInstance,this.openDialogs.push(r),this.afterOpened.next(r),r.afterClosed().subscribe(()=>{const o=this.openDialogs.indexOf(r);o>-1&&(this.openDialogs.splice(o,1),this.openDialogs.length||this._getAfterAllClosed().next())}),r}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(n=>n.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(t){let n=t.length;for(;n--;)t[n].close()}}return i.\u0275fac=function(t){c.$Z()},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})(),cP=(()=>{class i extends Ote{constructor(t,n,r,s,o,a,l,h){super(t,n,s,a,l,o,aP,Dte,lP,h)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(fd),c.LFG(c.zs3),c.LFG(Dt,8),c.LFG(Ite,8),c.LFG(B5),c.LFG(i,12),c.LFG(nP),c.LFG(c.QbO,8))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})(),kte=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({providers:[cP,Fte],imports:[fte,xE,tP,Qr,Qr]}),i})();const Nte=["mat-button",""],Bte=["*"],Ute=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],Vte=TE(rP(y3(class{constructor(i){this._elementRef=i}})));let CE=(()=>{class i extends Vte{constructor(t,n,r){super(t),this._focusMonitor=n,this._animationMode=r,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const s of Ute)this._hasHostAttributes(s)&&this._getHostElement().classList.add(s);t.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t,n){t?this._focusMonitor.focusVia(this._getHostElement(),t,n):this._getHostElement().focus(n)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...t){return t.some(n=>this._getHostElement().hasAttribute(n))}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(gm),c.Y36(c.QbO,8))},i.\u0275cmp=c.Xpm({type:i,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(t,n){if(1&t&&c.Gf(ME,5),2&t){let r;c.iGM(r=c.CRH())&&(n.ripple=r.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(t,n){2&t&&(c.uIk("disabled",n.disabled||null),c.ekj("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-button-disabled",n.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[c.qOj],attrs:Nte,ngContentSelectors:Bte,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(t,n){1&t&&(c.F$t(),c.TgZ(0,"span",0),c.Hsn(1),c.qZA(),c._UZ(2,"span",1)(3,"span",2)),2&t&&(c.xp6(2),c.ekj("mat-button-ripple-round",n.isRoundButton||n.isIconButton),c.Q6J("matRippleDisabled",n._isRippleDisabled())("matRippleCentered",n.isIconButton)("matRippleTrigger",n._getHostElement()))},dependencies:[ME],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}.mat-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.mat-flat-button::before,.mat-raised-button::before,.mat-fab::before,.mat-mini-fab::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-stroked-button::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}"],encapsulation:2,changeDetection:0}),i})(),j5=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[sP,Qr,Qr]}),i})();const Gte=["*",[["mat-card-footer"]]],zte=["*","mat-card-footer"];let uP=(()=>{class i{constructor(t){this._animationMode=t}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.QbO,8))},i.\u0275cmp=c.Xpm({type:i,selectors:[["mat-card"]],hostAttrs:[1,"mat-card","mat-focus-indicator"],hostVars:2,hostBindings:function(t,n){2&t&&c.ekj("_mat-animation-noopable","NoopAnimations"===n._animationMode)},exportAs:["matCard"],ngContentSelectors:zte,decls:2,vars:0,template:function(t,n){1&t&&(c.F$t(Gte),c.Hsn(0),c.Hsn(1,1))},styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:block;position:relative;padding:16px;border-radius:4px}.mat-card._mat-animation-noopable{transition:none !important;animation:none !important}.mat-card>.mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card>.mat-divider-horizontal{left:auto;right:0}.mat-card>.mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card>.mat-divider-horizontal.mat-divider-inset{margin-right:0}.cdk-high-contrast-active .mat-card{outline:solid 1px}.mat-card-actions,.mat-card-subtitle,.mat-card-content{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px;display:block;overflow:hidden}.mat-card-image img{width:100%}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media(max-width: 599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card>:first-child,.mat-card-content>:first-child{margin-top:0}.mat-card>:last-child:not(.mat-card-footer),.mat-card-content>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions:not(.mat-card-actions-align-end) .mat-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-raised-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-actions-align-end .mat-button:last-child,.mat-card-actions-align-end .mat-raised-button:last-child,.mat-card-actions-align-end .mat-stroked-button:last-child{margin-left:0;margin-right:0}.mat-card-title:not(:first-child),.mat-card-subtitle:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}"],encapsulation:2,changeDetection:0}),i})(),Hte=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[Qr,Qr]}),i})();const Wte=["tooltip"],U5="tooltip-panel",V5=v0({passive:!0}),G5=new c.OlP("mat-tooltip-scroll-strategy"),Kte={provide:G5,deps:[fd],useFactory:function Yte(i){return()=>i.scrollStrategies.reposition({scrollThrottle:20})}},Xte=new c.OlP("mat-tooltip-default-options",{providedIn:"root",factory:function $te(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}});let Qte=(()=>{class i{constructor(t,n,r,s,o,a,l,h,f,m,g,v){this._overlay=t,this._elementRef=n,this._scrollDispatcher=r,this._viewContainerRef=s,this._ngZone=o,this._platform=a,this._ariaDescriber=l,this._focusMonitor=h,this._dir=m,this._defaultOptions=g,this._position="below",this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._viewportMargin=8,this._cssClassPrefix="mat",this._showDelay=this._defaultOptions.showDelay,this._hideDelay=this._defaultOptions.hideDelay,this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new Bn.x,this._scrollStrategy=f,this._document=v,g&&(g.position&&(this.position=g.position),g.touchGestures&&(this.touchGestures=g.touchGestures)),m.change.pipe(Xr(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})}get position(){return this._position}set position(t){t!==this._position&&(this._position=t,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get disabled(){return this._disabled}set disabled(t){this._disabled=$r(t),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(t){this._showDelay=pm(t)}get hideDelay(){return this._hideDelay}set hideDelay(t){this._hideDelay=pm(t),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(t){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=t?String(t).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(t){this._tooltipClass=t,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(Xr(this._destroyed)).subscribe(t=>{t?"keyboard"===t&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const t=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([n,r])=>{t.removeEventListener(n,r,V5)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(t,this.message,"tooltip"),this._focusMonitor.stopMonitoring(t)}show(t=this.showDelay){if(this.disabled||!this.message||this._isTooltipVisible()&&!this._tooltipInstance._showTimeoutId&&!this._tooltipInstance._hideTimeoutId)return;const n=this._createOverlay();this._detach(),this._portal=this._portal||new eP(this._tooltipComponent,this._viewContainerRef);const r=this._tooltipInstance=n.attach(this._portal).instance;r._triggerElement=this._elementRef.nativeElement,r._mouseLeaveHideDelay=this._hideDelay,r.afterHidden().pipe(Xr(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),r.show(t)}hide(t=this.hideDelay){this._tooltipInstance&&this._tooltipInstance.hide(t)}toggle(){this._isTooltipVisible()?this.hide():this.show()}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(){if(this._overlayRef)return this._overlayRef;const t=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),n=this._overlay.position().flexibleConnectedTo(this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(t);return n.positionChanges.pipe(Xr(this._destroyed)).subscribe(r=>{this._updateCurrentPositionClass(r.connectionPair),this._tooltipInstance&&r.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:n,panelClass:`${this._cssClassPrefix}-${U5}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(Xr(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(Xr(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(Xr(this._destroyed)).subscribe(r=>{this._isTooltipVisible()&&27===r.keyCode&&!TT(r)&&(r.preventDefault(),r.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(t){const n=t.getConfig().positionStrategy,r=this._getOrigin(),s=this._getOverlayPosition();n.withPositions([this._addOffset({...r.main,...s.main}),this._addOffset({...r.fallback,...s.fallback})])}_addOffset(t){return t}_getOrigin(){const t=!this._dir||"ltr"==this._dir.value,n=this.position;let r;"above"==n||"below"==n?r={originX:"center",originY:"above"==n?"top":"bottom"}:"before"==n||"left"==n&&t||"right"==n&&!t?r={originX:"start",originY:"center"}:("after"==n||"right"==n&&t||"left"==n&&!t)&&(r={originX:"end",originY:"center"});const{x:s,y:o}=this._invertPosition(r.originX,r.originY);return{main:r,fallback:{originX:s,originY:o}}}_getOverlayPosition(){const t=!this._dir||"ltr"==this._dir.value,n=this.position;let r;"above"==n?r={overlayX:"center",overlayY:"bottom"}:"below"==n?r={overlayX:"center",overlayY:"top"}:"before"==n||"left"==n&&t||"right"==n&&!t?r={overlayX:"end",overlayY:"center"}:("after"==n||"right"==n&&t||"left"==n&&!t)&&(r={overlayX:"start",overlayY:"center"});const{x:s,y:o}=this._invertPosition(r.overlayX,r.overlayY);return{main:r,fallback:{overlayX:s,overlayY:o}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(Ns(1),Xr(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(t){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=t,this._tooltipInstance._markForCheck())}_invertPosition(t,n){return"above"===this.position||"below"===this.position?"top"===n?n="bottom":"bottom"===n&&(n="top"):"end"===t?t="start":"start"===t&&(t="end"),{x:t,y:n}}_updateCurrentPositionClass(t){const{overlayY:n,originX:r,originY:s}=t;let o;if(o="center"===n?this._dir&&"rtl"===this._dir.value?"end"===r?"left":"right":"start"===r?"left":"right":"bottom"===n&&"top"===s?"above":"below",o!==this._currentPosition){const a=this._overlayRef;if(a){const l=`${this._cssClassPrefix}-${U5}-`;a.removePanelClass(l+this._currentPosition),a.addPanelClass(l+o)}this._currentPosition=o}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",()=>{this._setupPointerExitEventsIfNeeded(),this.show()}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",()=>{this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(),500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const t=[];if(this._platformSupportsMouseEvents())t.push(["mouseleave",n=>{const r=n.relatedTarget;(!r||!this._overlayRef?.overlayElement.contains(r))&&this.hide()}],["wheel",n=>this._wheelListener(n)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const n=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};t.push(["touchend",n],["touchcancel",n])}this._addListeners(t),this._passiveListeners.push(...t)}_addListeners(t){t.forEach(([n,r])=>{this._elementRef.nativeElement.addEventListener(n,r,V5)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(t){if(this._isTooltipVisible()){const n=this._document.elementFromPoint(t.clientX,t.clientY),r=this._elementRef.nativeElement;n!==r&&!r.contains(n)&&this.hide()}}_disableNativeGesturesIfNecessary(){const t=this.touchGestures;if("off"!==t){const n=this._elementRef.nativeElement,r=n.style;("on"===t||"INPUT"!==n.nodeName&&"TEXTAREA"!==n.nodeName)&&(r.userSelect=r.msUserSelect=r.webkitUserSelect=r.MozUserSelect="none"),("on"===t||!n.draggable)&&(r.webkitUserDrag="none"),r.touchAction="none",r.webkitTapHighlightColor="transparent"}}}return i.\u0275fac=function(t){c.$Z()},i.\u0275dir=c.lG2({type:i,inputs:{position:["matTooltipPosition","position"],disabled:["matTooltipDisabled","disabled"],showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]}}),i})(),hP=(()=>{class i extends Qte{constructor(t,n,r,s,o,a,l,h,f,m,g,v){super(t,n,r,s,o,a,l,h,f,m,g,v),this._tooltipComponent=ene}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(fd),c.Y36(c.SBq),c.Y36(h5),c.Y36(c.s_b),c.Y36(c.R0b),c.Y36(cl),c.Y36(eee),c.Y36(gm),c.Y36(G5),c.Y36(_m,8),c.Y36(Xte,8),c.Y36(Oe))},i.\u0275dir=c.lG2({type:i,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-tooltip-trigger"],exportAs:["matTooltip"],features:[c.qOj]}),i})(),Jte=(()=>{class i{constructor(t,n){this._changeDetectorRef=t,this._visibility="initial",this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new Bn.x,this._animationsDisabled="NoopAnimations"===n}show(t){clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},t)}hide(t){clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},t)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){clearTimeout(this._showTimeoutId),clearTimeout(this._hideTimeoutId),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:t}){(!t||!this._triggerElement.contains(t))&&this.hide(this._mouseLeaveHideDelay)}_onShow(){}_handleAnimationEnd({animationName:t}){(t===this._showAnimation||t===this._hideAnimation)&&this._finalizeAnimation(t===this._showAnimation)}_finalizeAnimation(t){t?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(t){const n=this._tooltip.nativeElement,r=this._showAnimation,s=this._hideAnimation;if(n.classList.remove(t?s:r),n.classList.add(t?r:s),this._isVisible=t,t&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const o=getComputedStyle(n);("0s"===o.getPropertyValue("animation-duration")||"none"===o.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}t&&this._onShow(),this._animationsDisabled&&(n.classList.add("_mat-animation-noopable"),this._finalizeAnimation(t))}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.sBO),c.Y36(c.QbO,8))},i.\u0275dir=c.lG2({type:i}),i})(),ene=(()=>{class i extends Jte{constructor(t,n,r){super(t,r),this._breakpointObserver=n,this._isHandset=this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)"),this._showAnimation="mat-tooltip-show",this._hideAnimation="mat-tooltip-hide"}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.sBO),c.Y36(q4),c.Y36(c.QbO,8))},i.\u0275cmp=c.Xpm({type:i,selectors:[["mat-tooltip-component"]],viewQuery:function(t,n){if(1&t&&c.Gf(Wte,7),2&t){let r;c.iGM(r=c.CRH())&&(n._tooltip=r.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(t,n){1&t&&c.NdJ("mouseleave",function(s){return n._handleMouseLeave(s)}),2&t&&c.Udp("zoom",n.isVisible()?1:null)},features:[c.qOj],decls:4,vars:6,consts:[[1,"mat-tooltip",3,"ngClass","animationend"],["tooltip",""]],template:function(t,n){if(1&t&&(c.TgZ(0,"div",0,1),c.NdJ("animationend",function(s){return n._handleAnimationEnd(s)}),c.ALo(2,"async"),c._uU(3),c.qZA()),2&t){let r;c.ekj("mat-tooltip-handset",null==(r=c.lcZ(2,4,n._isHandset))?null:r.matches),c.Q6J("ngClass",n.tooltipClass),c.xp6(3),c.Oqu(n.message)}},dependencies:[Ha,Tu],styles:[".mat-tooltip{color:#fff;border-radius:4px;margin:14px;max-width:250px;padding-left:8px;padding-right:8px;overflow:hidden;text-overflow:ellipsis;transform:scale(0)}.mat-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.cdk-high-contrast-active .mat-tooltip{outline:solid 1px}.mat-tooltip-handset{margin:24px;padding-left:16px;padding-right:16px}.mat-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-tooltip-show{0%{opacity:0;transform:scale(0)}50%{opacity:.5;transform:scale(0.99)}100%{opacity:1;transform:scale(1)}}@keyframes mat-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(1)}}.mat-tooltip-show{animation:mat-tooltip-show 200ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-tooltip-hide{animation:mat-tooltip-hide 100ms cubic-bezier(0, 0, 0.2, 1) forwards}"],encapsulation:2,changeDetection:0}),i})(),z5=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({providers:[Kte],imports:[r5,or,xE,Qr,Qr,yE]}),i})();function H5(i){for(let e in i){let t=i[e]??"";switch(e){case"display":i.display="flex"===t?["-webkit-flex","flex"]:"inline-flex"===t?["-webkit-inline-flex","inline-flex"]:t;break;case"align-items":case"align-self":case"align-content":case"flex":case"flex-basis":case"flex-flow":case"flex-grow":case"flex-shrink":case"flex-wrap":case"justify-content":i["-webkit-"+e]=t;break;case"flex-direction":i["-webkit-flex-direction"]=t,i["flex-direction"]=t;break;case"order":i.order=i["-webkit-"+e]=isNaN(+t)?"0":t}}return i}const M3="inline",dP=["row","column","row-reverse","column-reverse"];function W5(i){let[e,t,n]=q5(i);return function nne(i,e=null,t=!1){return{display:t?"inline-flex":"flex","box-sizing":"border-box","flex-direction":i,"flex-wrap":e||null}}(e,t,n)}function q5(i){i=i?.toLowerCase()??"";let[e,t,n]=i.split(" ");return dP.find(r=>r===e)||(e=dP[0]),t===M3&&(t=n!==M3?n:"",n=M3),[e,tne(t),!!n]}function EE(i){let[e]=q5(i);return e.indexOf("row")>-1}function tne(i){if(i)switch(i.toLowerCase()){case"reverse":case"wrap-reverse":case"reverse-wrap":i="wrap-reverse";break;case"no":case"none":case"nowrap":i="nowrap";break;default:i="wrap"}return i}function bm(i,...e){if(null==i)throw TypeError("Cannot convert undefined or null to object");for(let t of e)if(null!=t)for(let n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);return i}const rne={provide:c.tb,useFactory:function ine(i,e){return()=>{if(Kl(e)){const t=Array.from(i.querySelectorAll(`[class*=${Z5}]`)),n=/\bflex-layout-.+?\b/g;t.forEach(r=>{r.classList.contains(`${Z5}ssr`)&&r.parentNode?r.parentNode.removeChild(r):r.className.replace(n,"")})}}},deps:[Oe,c.Lbi],multi:!0},Z5="flex-layout-";let S3=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({providers:[rne]}),i})();class T0{constructor(e=!1,t="all",n="",r="",s=0){this.matches=e,this.mediaQuery=t,this.mqAlias=n,this.suffix=r,this.priority=s,this.property=""}clone(){return new T0(this.matches,this.mediaQuery,this.mqAlias,this.suffix)}}let sne=(()=>{class i{constructor(){this.stylesheet=new Map}addStyleToElement(t,n,r){const s=this.stylesheet.get(t);s?s.set(n,r):this.stylesheet.set(t,new Map([[n,r]]))}clearStyles(){this.stylesheet.clear()}getStyleForElement(t,n){const r=this.stylesheet.get(t);let s="";if(r){const o=r.get(n);("number"==typeof o||"string"==typeof o)&&(s=o+"")}return s}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const C3={addFlexToParent:!0,addOrientationBps:!1,disableDefaultBps:!1,disableVendorPrefixes:!1,serverLoaded:!1,useColumnBasisZero:!0,printWithBreakpoints:[],mediaTriggerAutoRestore:!0,ssrObserveBreakpoints:[],multiplier:void 0,defaultUnit:"px",detectLayoutDisplay:!1},pd=new c.OlP("Flex Layout token, config options for the library",{providedIn:"root",factory:()=>C3}),ET=new c.OlP("FlexLayoutServerLoaded",{providedIn:"root",factory:()=>!1}),E3=new c.OlP("Flex Layout token, collect all breakpoints into one provider",{providedIn:"root",factory:()=>null});function Y5(i,e){return i=i?.clone()??new T0,e&&(i.mqAlias=e.alias,i.mediaQuery=e.mediaQuery,i.suffix=e.suffix,i.priority=e.priority),i}class to{constructor(){this.shouldCache=!0}sideEffect(e,t,n){}}let ds=(()=>{class i{constructor(t,n,r,s){this._serverStylesheet=t,this._serverModuleLoaded=n,this._platformId=r,this.layoutConfig=s}applyStyleToElement(t,n,r=null){let s={};"string"==typeof n&&(s[n]=r,n=s),s=this.layoutConfig.disableVendorPrefixes?n:H5(n),this._applyMultiValueStyleToElement(s,t)}applyStyleToElements(t,n=[]){const r=this.layoutConfig.disableVendorPrefixes?t:H5(t);n.forEach(s=>{this._applyMultiValueStyleToElement(r,s)})}getFlowDirection(t){const n="flex-direction";let r=this.lookupStyle(t,n);return[r||"row",this.lookupInlineStyle(t,n)||ar(this._platformId)&&this._serverModuleLoaded?r:""]}hasWrap(t){return"wrap"===this.lookupStyle(t,"flex-wrap")}lookupAttributeValue(t,n){return t.getAttribute(n)??""}lookupInlineStyle(t,n){return Kl(this._platformId)?t.style.getPropertyValue(n):function one(i,e){return K5(i)[e]??""}(t,n)}lookupStyle(t,n,r=!1){let s="";return t&&((s=this.lookupInlineStyle(t,n))||(Kl(this._platformId)?r||(s=getComputedStyle(t).getPropertyValue(n)):this._serverModuleLoaded&&(s=this._serverStylesheet.getStyleForElement(t,n)))),s?s.trim():""}_applyMultiValueStyleToElement(t,n){Object.keys(t).sort().forEach(r=>{const s=t[r],o=Array.isArray(s)?s:[s];o.sort();for(let a of o)a=a?a+"":"",Kl(this._platformId)||!this._serverModuleLoaded?Kl(this._platformId)?n.style.setProperty(r,a):ane(n,r,a):this._serverStylesheet.addStyleToElement(n,r,a)})}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(sne),c.LFG(ET),c.LFG(c.Lbi),c.LFG(pd))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function ane(i,e,t){e=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();const n=K5(i);n[e]=t??"",function lne(i,e){let t="";for(const n in e)e[n]&&(t+=`${n}:${e[n]};`);i.setAttribute("style",t)}(i,n)}function K5(i){const e={},t=i.getAttribute("style");if(t){const n=t.split(/;+/g);for(let r=0;r<n.length;r++){const s=n[r].trim();if(s.length>0){const o=s.indexOf(":");if(-1===o)throw new Error(`Invalid CSS style: ${s}`);e[s.substr(0,o).trim()]=s.substr(o+1).trim()}}}return e}function AE(i,e){return(e&&e.priority||0)-(i&&i.priority||0)}function cne(i,e){return(i.priority||0)-(e.priority||0)}let A3=(()=>{class i{constructor(t,n,r){this._zone=t,this._platformId=n,this._document=r,this.source=new Ks(new T0(!0)),this.registry=new Map,this.pendingRemoveListenerFns=[],this._observable$=this.source.asObservable()}get activations(){const t=[];return this.registry.forEach((n,r)=>{n.matches&&t.push(r)}),t}isActive(t){return this.registry.get(t)?.matches??this.registerQuery(t).some(r=>r.matches)}observe(t,n=!1){if(t&&t.length){const r=this._observable$.pipe(fr(o=>!n||t.indexOf(o.mediaQuery)>-1)),s=new bs.y(o=>{const a=this.registerQuery(t);if(a.length){const l=a.pop();a.forEach(h=>{o.next(h)}),this.source.next(l)}o.complete()});return(0,vm.T)(s,r)}return this._observable$}registerQuery(t){const n=Array.isArray(t)?t:[t],r=[];return function une(i,e){const t=i.filter(n=>!X5[n]);if(t.length>0){const n=t.join(", ");try{const r=e.createElement("style");r.setAttribute("type","text/css"),r.styleSheet||r.appendChild(e.createTextNode(`\n/*\n  @angular/flex-layout - workaround for possible browser quirk with mediaQuery listeners\n  see http://bit.ly/2sd4HMP\n*/\n@media ${n} {.fx-query-test{ }}\n`)),e.head.appendChild(r),t.forEach(s=>X5[s]=r)}catch(r){console.error(r)}}}(n,this._document),n.forEach(s=>{const o=l=>{this._zone.run(()=>this.source.next(new T0(l.matches,s)))};let a=this.registry.get(s);a||(a=this.buildMQL(s),a.addListener(o),this.pendingRemoveListenerFns.push(()=>a.removeListener(o)),this.registry.set(s,a)),a.matches&&r.push(new T0(!0,s))}),r}ngOnDestroy(){let t;for(;t=this.pendingRemoveListenerFns.pop();)t()}buildMQL(t){return function hne(i,e){return e&&window.matchMedia("all").addListener?window.matchMedia(i):{matches:"all"===i||""===i,media:i,addListener:()=>{},removeListener:()=>{},onchange:null,addEventListener(){},removeEventListener(){},dispatchEvent:()=>!1}}(t,Kl(this._platformId))}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(c.R0b),c.LFG(c.Lbi),c.LFG(Oe))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const X5={},dne=[{alias:"xs",mediaQuery:"screen and (min-width: 0px) and (max-width: 599.98px)",priority:1e3},{alias:"sm",mediaQuery:"screen and (min-width: 600px) and (max-width: 959.98px)",priority:900},{alias:"md",mediaQuery:"screen and (min-width: 960px) and (max-width: 1279.98px)",priority:800},{alias:"lg",mediaQuery:"screen and (min-width: 1280px) and (max-width: 1919.98px)",priority:700},{alias:"xl",mediaQuery:"screen and (min-width: 1920px) and (max-width: 4999.98px)",priority:600},{alias:"lt-sm",overlapping:!0,mediaQuery:"screen and (max-width: 599.98px)",priority:950},{alias:"lt-md",overlapping:!0,mediaQuery:"screen and (max-width: 959.98px)",priority:850},{alias:"lt-lg",overlapping:!0,mediaQuery:"screen and (max-width: 1279.98px)",priority:750},{alias:"lt-xl",overlapping:!0,priority:650,mediaQuery:"screen and (max-width: 1919.98px)"},{alias:"gt-xs",overlapping:!0,mediaQuery:"screen and (min-width: 600px)",priority:-950},{alias:"gt-sm",overlapping:!0,mediaQuery:"screen and (min-width: 960px)",priority:-850},{alias:"gt-md",overlapping:!0,mediaQuery:"screen and (min-width: 1280px)",priority:-750},{alias:"gt-lg",overlapping:!0,mediaQuery:"screen and (min-width: 1920px)",priority:-650}],$5="(orientation: portrait) and (max-width: 599.98px)",Q5="(orientation: landscape) and (max-width: 959.98px)",J5="(orientation: portrait) and (min-width: 600px) and (max-width: 839.98px)",e6="(orientation: landscape) and (min-width: 960px) and (max-width: 1279.98px)",t6="(orientation: portrait) and (min-width: 840px)",n6="(orientation: landscape) and (min-width: 1280px)",xm={HANDSET:`${$5}, ${Q5}`,TABLET:`${J5} , ${e6}`,WEB:`${t6}, ${n6} `,HANDSET_PORTRAIT:`${$5}`,TABLET_PORTRAIT:`${J5} `,WEB_PORTRAIT:`${t6}`,HANDSET_LANDSCAPE:`${Q5}`,TABLET_LANDSCAPE:`${e6}`,WEB_LANDSCAPE:`${n6}`},fne=[{alias:"handset",priority:2e3,mediaQuery:xm.HANDSET},{alias:"handset.landscape",priority:2e3,mediaQuery:xm.HANDSET_LANDSCAPE},{alias:"handset.portrait",priority:2e3,mediaQuery:xm.HANDSET_PORTRAIT},{alias:"tablet",priority:2100,mediaQuery:xm.TABLET},{alias:"tablet.landscape",priority:2100,mediaQuery:xm.TABLET_LANDSCAPE},{alias:"tablet.portrait",priority:2100,mediaQuery:xm.TABLET_PORTRAIT},{alias:"web",priority:2200,mediaQuery:xm.WEB,overlapping:!0},{alias:"web.landscape",priority:2200,mediaQuery:xm.WEB_LANDSCAPE,overlapping:!0},{alias:"web.portrait",priority:2200,mediaQuery:xm.WEB_PORTRAIT,overlapping:!0}],pne=/(\.|-|_)/g;function mne(i){let e=i.length>0?i.charAt(0):"",t=i.length>1?i.slice(1):"";return e.toUpperCase()+t}const yne=new c.OlP("Token (@angular/flex-layout) Breakpoints",{providedIn:"root",factory:()=>{const i=(0,c.f3M)(E3),e=(0,c.f3M)(pd),t=[].concat.apply([],(i||[]).map(r=>Array.isArray(r)?r:[r]));return function vne(i,e=[]){const t={};return i.forEach(n=>{t[n.alias]=n}),e.forEach(n=>{t[n.alias]?bm(t[n.alias],n):t[n.alias]=n}),function _ne(i){return i.forEach(e=>{e.suffix||(e.suffix=function gne(i){return i.replace(pne,"|").split("|").map(mne).join("")}(e.alias),e.overlapping=!!e.overlapping)}),i}(Object.keys(t).map(n=>t[n]))}((e.disableDefaultBps?[]:dne).concat(e.addOrientationBps?fne:[]),t)}});let D3=(()=>{class i{constructor(t){this.findByMap=new Map,this.items=[...t].sort(cne)}findByAlias(t){return t?this.findWithPredicate(t,n=>n.alias===t):null}findByQuery(t){return this.findWithPredicate(t,n=>n.mediaQuery===t)}get overlappings(){return this.items.filter(t=>t.overlapping)}get aliases(){return this.items.map(t=>t.alias)}get suffixes(){return this.items.map(t=>t?.suffix??"")}findWithPredicate(t,n){let r=this.findByMap.get(t);return r||(r=this.items.find(n)??null,this.findByMap.set(t,r)),r??null}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(yne))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const AT="print",bne={alias:AT,mediaQuery:AT,priority:1e3};let xne=(()=>{class i{constructor(t,n,r){this.breakpoints=t,this.layoutConfig=n,this._document=r,this.registeredBeforeAfterPrintHooks=!1,this.isPrintingBeforeAfterEvent=!1,this.beforePrintEventListeners=[],this.afterPrintEventListeners=[],this.formerActivations=null,this.isPrinting=!1,this.queue=new Tne,this.deactivations=[]}withPrintQuery(t){return[...t,AT]}isPrintEvent(t){return t.mediaQuery.startsWith(AT)}get printAlias(){return[...this.layoutConfig.printWithBreakpoints??[]]}get printBreakPoints(){return this.printAlias.map(t=>this.breakpoints.findByAlias(t)).filter(t=>null!==t)}getEventBreakpoints({mediaQuery:t}){const n=this.breakpoints.findByQuery(t);return(n?[...this.printBreakPoints,n]:this.printBreakPoints).sort(AE)}updateEvent(t){let n=this.breakpoints.findByQuery(t.mediaQuery);return this.isPrintEvent(t)&&(n=this.getEventBreakpoints(t)[0],t.mediaQuery=n?.mediaQuery??""),Y5(t,n)}registerBeforeAfterPrintHooks(t){if(!this._document.defaultView||this.registeredBeforeAfterPrintHooks)return;this.registeredBeforeAfterPrintHooks=!0;const n=()=>{this.isPrinting||(this.isPrintingBeforeAfterEvent=!0,this.startPrinting(t,this.getEventBreakpoints(new T0(!0,AT))),t.updateStyles())},r=()=>{this.isPrintingBeforeAfterEvent=!1,this.isPrinting&&(this.stopPrinting(t),t.updateStyles())};this._document.defaultView.addEventListener("beforeprint",n),this._document.defaultView.addEventListener("afterprint",r),this.beforePrintEventListeners.push(n),this.afterPrintEventListeners.push(r)}interceptEvents(t){return n=>{this.isPrintEvent(n)?n.matches&&!this.isPrinting?(this.startPrinting(t,this.getEventBreakpoints(n)),t.updateStyles()):!n.matches&&this.isPrinting&&!this.isPrintingBeforeAfterEvent&&(this.stopPrinting(t),t.updateStyles()):this.collectActivations(t,n)}}blockPropagation(){return t=>!(this.isPrinting||this.isPrintEvent(t))}startPrinting(t,n){this.isPrinting=!0,this.formerActivations=t.activatedBreakpoints,t.activatedBreakpoints=this.queue.addPrintBreakpoints(n)}stopPrinting(t){t.activatedBreakpoints=this.deactivations,this.deactivations=[],this.formerActivations=null,this.queue.clear(),this.isPrinting=!1}collectActivations(t,n){if(!this.isPrinting||this.isPrintingBeforeAfterEvent){if(!this.isPrintingBeforeAfterEvent)return void(this.deactivations=[]);if(!n.matches){const r=this.breakpoints.findByQuery(n.mediaQuery);if(r){const s=this.formerActivations&&this.formerActivations.includes(r),o=!this.formerActivations&&t.activatedBreakpoints.includes(r);(s||o)&&(this.deactivations.push(r),this.deactivations.sort(AE))}}}}ngOnDestroy(){this._document.defaultView&&(this.beforePrintEventListeners.forEach(t=>this._document.defaultView.removeEventListener("beforeprint",t)),this.afterPrintEventListeners.forEach(t=>this._document.defaultView.removeEventListener("afterprint",t)))}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(D3),c.LFG(pd),c.LFG(Oe))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class Tne{constructor(){this.printBreakpoints=[]}addPrintBreakpoints(e){return e.push(bne),e.sort(AE),e.forEach(t=>this.addBreakpoint(t)),this.printBreakpoints}addBreakpoint(e){e&&void 0===this.printBreakpoints.find(n=>n.mediaQuery===e.mediaQuery)&&(this.printBreakpoints=function wne(i){return i?.mediaQuery.startsWith(AT)??!1}(e)?[e,...this.printBreakpoints]:[...this.printBreakpoints,e])}clear(){this.printBreakpoints=[]}}let Rs=(()=>{class i{constructor(t,n,r){this.matchMedia=t,this.breakpoints=n,this.hook=r,this._useFallbacks=!0,this._activatedBreakpoints=[],this.elementMap=new Map,this.elementKeyMap=new WeakMap,this.watcherMap=new WeakMap,this.updateMap=new WeakMap,this.clearMap=new WeakMap,this.subject=new Bn.x,this.observeActivations()}get activatedAlias(){return this.activatedBreakpoints[0]?.alias??""}set activatedBreakpoints(t){this._activatedBreakpoints=[...t]}get activatedBreakpoints(){return[...this._activatedBreakpoints]}set useFallbacks(t){this._useFallbacks=t}onMediaChange(t){const n=this.findByQuery(t.mediaQuery);if(n){t=Y5(t,n);const r=this.activatedBreakpoints.indexOf(n);t.matches&&-1===r?(this._activatedBreakpoints.push(n),this._activatedBreakpoints.sort(AE),this.updateStyles()):!t.matches&&-1!==r&&(this._activatedBreakpoints.splice(r,1),this._activatedBreakpoints.sort(AE),this.updateStyles())}}init(t,n,r,s,o=[]){r6(this.updateMap,t,n,r),r6(this.clearMap,t,n,s),this.buildElementKeyMap(t,n),this.watchExtraTriggers(t,n,o)}getValue(t,n,r){const s=this.elementMap.get(t);if(s){const o=void 0!==r?s.get(r):this.getActivatedValues(s,n);if(o)return o.get(n)}}hasValue(t,n){const r=this.elementMap.get(t);if(r){const s=this.getActivatedValues(r,n);if(s)return void 0!==s.get(n)||!1}return!1}setValue(t,n,r,s){let o=this.elementMap.get(t);if(o){const l=(o.get(s)??new Map).set(n,r);o.set(s,l),this.elementMap.set(t,o)}else o=(new Map).set(s,(new Map).set(n,r)),this.elementMap.set(t,o);const a=this.getValue(t,n);void 0!==a&&this.updateElement(t,n,a)}trackValue(t,n){return this.subject.asObservable().pipe(fr(r=>r.element===t&&r.key===n))}updateStyles(){this.elementMap.forEach((t,n)=>{const r=new Set(this.elementKeyMap.get(n));let s=this.getActivatedValues(t);s&&s.forEach((o,a)=>{this.updateElement(n,a,o),r.delete(a)}),r.forEach(o=>{if(s=this.getActivatedValues(t,o),s){const a=s.get(o);this.updateElement(n,o,a)}else this.clearElement(n,o)})})}clearElement(t,n){const r=this.clearMap.get(t);if(r){const s=r.get(n);s&&(s(),this.subject.next({element:t,key:n,value:""}))}}updateElement(t,n,r){const s=this.updateMap.get(t);if(s){const o=s.get(n);o&&(o(r),this.subject.next({element:t,key:n,value:r}))}}releaseElement(t){const n=this.watcherMap.get(t);n&&(n.forEach(s=>s.unsubscribe()),this.watcherMap.delete(t));const r=this.elementMap.get(t);r&&(r.forEach((s,o)=>r.delete(o)),this.elementMap.delete(t))}triggerUpdate(t,n){const r=this.elementMap.get(t);if(r){const s=this.getActivatedValues(r,n);s&&(n?this.updateElement(t,n,s.get(n)):s.forEach((o,a)=>this.updateElement(t,a,o)))}}buildElementKeyMap(t,n){let r=this.elementKeyMap.get(t);r||(r=new Set,this.elementKeyMap.set(t,r)),r.add(n)}watchExtraTriggers(t,n,r){if(r&&r.length){let s=this.watcherMap.get(t);if(s||(s=new Map,this.watcherMap.set(t,s)),!s.get(n)){const a=(0,vm.T)(...r).subscribe(()=>{const l=this.getValue(t,n);this.updateElement(t,n,l)});s.set(n,a)}}}findByQuery(t){return this.breakpoints.findByQuery(t)}getActivatedValues(t,n){for(let s=0;s<this.activatedBreakpoints.length;s++){const a=t.get(this.activatedBreakpoints[s].alias);if(a&&(void 0===n||a.has(n)&&null!=a.get(n)))return a}if(!this._useFallbacks)return;const r=t.get("");return void 0===n||r&&r.has(n)?r:void 0}observeActivations(){const t=this.breakpoints.items.map(n=>n.mediaQuery);this.hook.registerBeforeAfterPrintHooks(this),this.matchMedia.observe(this.hook.withPrintQuery(t)).pipe((0,Lr.b)(this.hook.interceptEvents(this)),fr(this.hook.blockPropagation())).subscribe(this.onMediaChange.bind(this))}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(A3),c.LFG(D3),c.LFG(xne))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function r6(i,e,t,n){if(void 0!==n){const r=i.get(e)??new Map;r.set(t,n),i.set(e,r)}}let js=(()=>{class i{constructor(t,n,r,s){this.elementRef=t,this.styleBuilder=n,this.styler=r,this.marshal=s,this.DIRECTIVE_KEY="",this.inputs=[],this.mru={},this.destroySubject=new Bn.x,this.styleCache=new Map}get parentElement(){return this.elementRef.nativeElement.parentElement}get nativeElement(){return this.elementRef.nativeElement}get activatedValue(){return this.marshal.getValue(this.nativeElement,this.DIRECTIVE_KEY)}set activatedValue(t){this.marshal.setValue(this.nativeElement,this.DIRECTIVE_KEY,t,this.marshal.activatedAlias)}ngOnChanges(t){Object.keys(t).forEach(n=>{if(-1!==this.inputs.indexOf(n)){const r=n.split(".").slice(1).join(".");this.setValue(t[n].currentValue,r)}})}ngOnDestroy(){this.destroySubject.next(),this.destroySubject.complete(),this.marshal.releaseElement(this.nativeElement)}init(t=[]){this.marshal.init(this.elementRef.nativeElement,this.DIRECTIVE_KEY,this.updateWithValue.bind(this),this.clearStyles.bind(this),t)}addStyles(t,n){const r=this.styleBuilder,s=r.shouldCache;let o=this.styleCache.get(t);(!o||!s)&&(o=r.buildStyles(t,n),s&&this.styleCache.set(t,o)),this.mru={...o},this.applyStyleToElement(o),r.sideEffect(t,o,n)}clearStyles(){Object.keys(this.mru).forEach(t=>{this.mru[t]=""}),this.applyStyleToElement(this.mru),this.mru={},this.currentValue=void 0}triggerUpdate(){this.marshal.triggerUpdate(this.nativeElement,this.DIRECTIVE_KEY)}getFlexFlowDirection(t,n=!1){if(t){const[r,s]=this.styler.getFlowDirection(t);if(!s&&n){const o=W5(r);this.styler.applyStyleToElements(o,[t])}return r.trim()}return"row"}hasWrap(t){return this.styler.hasWrap(t)}applyStyleToElement(t,n,r=this.nativeElement){this.styler.applyStyleToElement(r,t,n)}setValue(t,n){this.marshal.setValue(this.nativeElement,this.DIRECTIVE_KEY,t,n)}updateWithValue(t){this.currentValue!==t&&(this.addStyles(t),this.currentValue=t)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(to),c.Y36(ds),c.Y36(Rs))},i.\u0275dir=c.lG2({type:i,features:[c.TTD]}),i})();function s6(i,e="1",t="1"){let n=[e,t,i],r=i.indexOf("calc");if(r>0){n[2]=o6(i.substring(r).trim());let s=i.substr(0,r).trim().split(" ");2==s.length&&(n[0]=s[0],n[1]=s[1])}else if(0==r)n[2]=o6(i.trim());else{let s=i.split(" ");n=3===s.length?s:[e,t,i]}return n}function o6(i){return i.replace(/[\s]/g,"").replace(/[\/\*\+\-]/g," $& ")}let Cne=(()=>{class i extends to{buildStyles(t,{display:n}){const r=W5(t);return{...r,display:"none"===n?n:r.display}}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Ene=["fxLayout","fxLayout.xs","fxLayout.sm","fxLayout.md","fxLayout.lg","fxLayout.xl","fxLayout.lt-sm","fxLayout.lt-md","fxLayout.lt-lg","fxLayout.lt-xl","fxLayout.gt-xs","fxLayout.gt-sm","fxLayout.gt-md","fxLayout.gt-lg"];let Ane=(()=>{class i extends js{constructor(t,n,r,s,o){super(t,r,n,s),this._config=o,this.DIRECTIVE_KEY="layout",this.init()}updateWithValue(t){const r=this._config.detectLayoutDisplay?this.styler.lookupStyle(this.nativeElement,"display"):"";this.styleCache=l6.get(r)??new Map,l6.set(r,this.styleCache),this.currentValue!==t&&(this.addStyles(t,{display:r}),this.currentValue=t)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(ds),c.Y36(Cne),c.Y36(Rs),c.Y36(pd))},i.\u0275dir=c.lG2({type:i,features:[c.qOj]}),i})(),w0=(()=>{class i extends Ane{constructor(){super(...arguments),this.inputs=Ene}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275dir=c.lG2({type:i,selectors:[["","fxLayout",""],["","fxLayout.xs",""],["","fxLayout.sm",""],["","fxLayout.md",""],["","fxLayout.lg",""],["","fxLayout.xl",""],["","fxLayout.lt-sm",""],["","fxLayout.lt-md",""],["","fxLayout.lt-lg",""],["","fxLayout.lt-xl",""],["","fxLayout.gt-xs",""],["","fxLayout.gt-sm",""],["","fxLayout.gt-md",""],["","fxLayout.gt-lg",""]],inputs:{fxLayout:"fxLayout","fxLayout.xs":"fxLayout.xs","fxLayout.sm":"fxLayout.sm","fxLayout.md":"fxLayout.md","fxLayout.lg":"fxLayout.lg","fxLayout.xl":"fxLayout.xl","fxLayout.lt-sm":"fxLayout.lt-sm","fxLayout.lt-md":"fxLayout.lt-md","fxLayout.lt-lg":"fxLayout.lt-lg","fxLayout.lt-xl":"fxLayout.lt-xl","fxLayout.gt-xs":"fxLayout.gt-xs","fxLayout.gt-sm":"fxLayout.gt-sm","fxLayout.gt-md":"fxLayout.gt-md","fxLayout.gt-lg":"fxLayout.gt-lg"},features:[c.qOj]}),i})();const l6=new Map;let Une=(()=>{class i extends to{constructor(t){super(),this.layoutConfig=t}buildStyles(t,n){let[r,s,...o]=t.split(" "),a=o.join(" ");const l=n.direction.indexOf("column")>-1?"column":"row",h=EE(l)?"max-width":"max-height",f=EE(l)?"min-width":"min-height",m=String(a).indexOf("calc")>-1,g=m||"auto"===a,v=String(a).indexOf("%")>-1&&!m,y=String(a).indexOf("px")>-1||String(a).indexOf("rem")>-1||String(a).indexOf("em")>-1||String(a).indexOf("vw")>-1||String(a).indexOf("vh")>-1;let b=m||y;r="0"==r?0:r,s="0"==s?0:s;const T=!r&&!s;let S={};const C={"max-width":null,"max-height":null,"min-width":null,"min-height":null};switch(a||""){case"":const R=!1!==this.layoutConfig.useColumnBasisZero;a="row"===l?"0%":R?"0.000000001px":"auto";break;case"initial":case"nogrow":r=0,a="auto";break;case"grow":a="100%";break;case"noshrink":s=0,a="auto";break;case"auto":break;case"none":r=0,s=0,a="auto";break;default:!b&&!v&&!isNaN(a)&&(a+="%"),"0%"===a&&(b=!0),"0px"===a&&(a="0%"),S=bm(C,m?{"flex-grow":r,"flex-shrink":s,"flex-basis":b?a:"100%"}:{flex:`${r} ${s} ${b?a:"100%"}`})}return S.flex||S["flex-grow"]||(S=bm(C,m?{"flex-grow":r,"flex-shrink":s,"flex-basis":a}:{flex:`${r} ${s} ${a}`})),"0%"!==a&&"0px"!==a&&"0.000000001px"!==a&&"auto"!==a&&(S[f]=T||b&&r?a:null,S[h]=T||!g&&s?a:null),S[f]||S[h]?n.hasWrap&&(S[m?"flex-basis":"flex"]=S[h]?m?S[h]:`${r} ${s} ${S[h]}`:m?S[f]:`${r} ${s} ${S[f]}`):S=bm(C,m?{"flex-grow":r,"flex-shrink":s,"flex-basis":a}:{flex:`${r} ${s} ${a}`}),bm(S,{"box-sizing":"border-box"})}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(pd))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Vne=["fxFlex","fxFlex.xs","fxFlex.sm","fxFlex.md","fxFlex.lg","fxFlex.xl","fxFlex.lt-sm","fxFlex.lt-md","fxFlex.lt-lg","fxFlex.lt-xl","fxFlex.gt-xs","fxFlex.gt-sm","fxFlex.gt-md","fxFlex.gt-lg"];let Gne=(()=>{class i extends js{constructor(t,n,r,s,o){super(t,s,n,o),this.layoutConfig=r,this.marshal=o,this.DIRECTIVE_KEY="flex",this.direction=void 0,this.wrap=void 0,this.flexGrow="1",this.flexShrink="1",this.init()}get shrink(){return this.flexShrink}set shrink(t){this.flexShrink=t||"1",this.triggerReflow()}get grow(){return this.flexGrow}set grow(t){this.flexGrow=t||"1",this.triggerReflow()}ngOnInit(){this.parentElement&&(this.marshal.trackValue(this.parentElement,"layout").pipe(Xr(this.destroySubject)).subscribe(this.onLayoutChange.bind(this)),this.marshal.trackValue(this.nativeElement,"layout-align").pipe(Xr(this.destroySubject)).subscribe(this.triggerReflow.bind(this)))}onLayoutChange(t){const r=t.value.split(" ");this.direction=r[0],this.wrap=void 0!==r[1]&&"wrap"===r[1],this.triggerUpdate()}updateWithValue(t){void 0===this.direction&&(this.direction=this.getFlexFlowDirection(this.parentElement,!1!==this.layoutConfig.addFlexToParent)),void 0===this.wrap&&(this.wrap=this.hasWrap(this.parentElement));const r=this.direction,s=r.startsWith("row"),o=this.wrap;s&&o?this.styleCache=Wne:s&&!o?this.styleCache=zne:!s&&o?this.styleCache=qne:!s&&!o&&(this.styleCache=Hne);const l=s6(String(t).replace(";",""),this.flexGrow,this.flexShrink);this.addStyles(l.join(" "),{direction:r,hasWrap:o})}triggerReflow(){const t=this.activatedValue;if(void 0!==t){const n=s6(t+"",this.flexGrow,this.flexShrink);this.marshal.updateElement(this.nativeElement,this.DIRECTIVE_KEY,n.join(" "))}}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(ds),c.Y36(pd),c.Y36(Une),c.Y36(Rs))},i.\u0275dir=c.lG2({type:i,inputs:{shrink:["fxShrink","shrink"],grow:["fxGrow","grow"]},features:[c.qOj]}),i})(),h6=(()=>{class i extends Gne{constructor(){super(...arguments),this.inputs=Vne}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275dir=c.lG2({type:i,selectors:[["","fxFlex",""],["","fxFlex.xs",""],["","fxFlex.sm",""],["","fxFlex.md",""],["","fxFlex.lg",""],["","fxFlex.xl",""],["","fxFlex.lt-sm",""],["","fxFlex.lt-md",""],["","fxFlex.lt-lg",""],["","fxFlex.lt-xl",""],["","fxFlex.gt-xs",""],["","fxFlex.gt-sm",""],["","fxFlex.gt-md",""],["","fxFlex.gt-lg",""]],inputs:{fxFlex:"fxFlex","fxFlex.xs":"fxFlex.xs","fxFlex.sm":"fxFlex.sm","fxFlex.md":"fxFlex.md","fxFlex.lg":"fxFlex.lg","fxFlex.xl":"fxFlex.xl","fxFlex.lt-sm":"fxFlex.lt-sm","fxFlex.lt-md":"fxFlex.lt-md","fxFlex.lt-lg":"fxFlex.lt-lg","fxFlex.lt-xl":"fxFlex.lt-xl","fxFlex.gt-xs":"fxFlex.gt-xs","fxFlex.gt-sm":"fxFlex.gt-sm","fxFlex.gt-md":"fxFlex.gt-md","fxFlex.gt-lg":"fxFlex.gt-lg"},features:[c.qOj]}),i})();const zne=new Map,Hne=new Map,Wne=new Map,qne=new Map;let mie=(()=>{class i extends to{buildStyles(t,n){const r={},[s,o]=t.split(" ");switch(s){case"center":r["justify-content"]="center";break;case"space-around":r["justify-content"]="space-around";break;case"space-between":r["justify-content"]="space-between";break;case"space-evenly":r["justify-content"]="space-evenly";break;case"end":case"flex-end":r["justify-content"]="flex-end";break;default:r["justify-content"]="flex-start"}switch(o){case"start":case"flex-start":r["align-items"]=r["align-content"]="flex-start";break;case"center":r["align-items"]=r["align-content"]="center";break;case"end":case"flex-end":r["align-items"]=r["align-content"]="flex-end";break;case"space-between":r["align-content"]="space-between",r["align-items"]="stretch";break;case"space-around":r["align-content"]="space-around",r["align-items"]="stretch";break;case"baseline":r["align-content"]="stretch",r["align-items"]="baseline";break;default:r["align-items"]=r["align-content"]="stretch"}return bm(r,{display:n.inline?"inline-flex":"flex","flex-direction":n.layout,"box-sizing":"border-box","max-width":"stretch"===o?EE(n.layout)?null:"100%":null,"max-height":"stretch"===o&&EE(n.layout)?"100%":null})}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const gie=["fxLayoutAlign","fxLayoutAlign.xs","fxLayoutAlign.sm","fxLayoutAlign.md","fxLayoutAlign.lg","fxLayoutAlign.xl","fxLayoutAlign.lt-sm","fxLayoutAlign.lt-md","fxLayoutAlign.lt-lg","fxLayoutAlign.lt-xl","fxLayoutAlign.gt-xs","fxLayoutAlign.gt-sm","fxLayoutAlign.gt-md","fxLayoutAlign.gt-lg"];let _ie=(()=>{class i extends js{constructor(t,n,r,s){super(t,r,n,s),this.DIRECTIVE_KEY="layout-align",this.layout="row",this.inline=!1,this.init(),this.marshal.trackValue(this.nativeElement,"layout").pipe(Xr(this.destroySubject)).subscribe(this.onLayoutChange.bind(this))}updateWithValue(t){const n=this.layout||"row",r=this.inline;"row"===n&&r?this.styleCache=Tie:"row"!==n||r?"row-reverse"===n&&r?this.styleCache=Mie:"row-reverse"!==n||r?"column"===n&&r?this.styleCache=wie:"column"!==n||r?"column-reverse"===n&&r?this.styleCache=Sie:"column-reverse"===n&&!r&&(this.styleCache=xie):this.styleCache=yie:this.styleCache=bie:this.styleCache=vie,this.addStyles(t,{layout:n,inline:r})}onLayoutChange(t){const n=t.value.split(" ");this.layout=n[0],this.inline=t.value.includes("inline"),dP.find(r=>r===this.layout)||(this.layout="row"),this.triggerUpdate()}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(ds),c.Y36(mie),c.Y36(Rs))},i.\u0275dir=c.lG2({type:i,features:[c.qOj]}),i})(),S_=(()=>{class i extends _ie{constructor(){super(...arguments),this.inputs=gie}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275dir=c.lG2({type:i,selectors:[["","fxLayoutAlign",""],["","fxLayoutAlign.xs",""],["","fxLayoutAlign.sm",""],["","fxLayoutAlign.md",""],["","fxLayoutAlign.lg",""],["","fxLayoutAlign.xl",""],["","fxLayoutAlign.lt-sm",""],["","fxLayoutAlign.lt-md",""],["","fxLayoutAlign.lt-lg",""],["","fxLayoutAlign.lt-xl",""],["","fxLayoutAlign.gt-xs",""],["","fxLayoutAlign.gt-sm",""],["","fxLayoutAlign.gt-md",""],["","fxLayoutAlign.gt-lg",""]],inputs:{fxLayoutAlign:"fxLayoutAlign","fxLayoutAlign.xs":"fxLayoutAlign.xs","fxLayoutAlign.sm":"fxLayoutAlign.sm","fxLayoutAlign.md":"fxLayoutAlign.md","fxLayoutAlign.lg":"fxLayoutAlign.lg","fxLayoutAlign.xl":"fxLayoutAlign.xl","fxLayoutAlign.lt-sm":"fxLayoutAlign.lt-sm","fxLayoutAlign.lt-md":"fxLayoutAlign.lt-md","fxLayoutAlign.lt-lg":"fxLayoutAlign.lt-lg","fxLayoutAlign.lt-xl":"fxLayoutAlign.lt-xl","fxLayoutAlign.gt-xs":"fxLayoutAlign.gt-xs","fxLayoutAlign.gt-sm":"fxLayoutAlign.gt-sm","fxLayoutAlign.gt-md":"fxLayoutAlign.gt-md","fxLayoutAlign.gt-lg":"fxLayoutAlign.gt-lg"},features:[c.qOj]}),i})();const vie=new Map,yie=new Map,bie=new Map,xie=new Map,Tie=new Map,wie=new Map,Mie=new Map,Sie=new Map;let d6=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[S3,ST]}),i})(),Iie=(()=>{class i extends js{constructor(t,n,r,s,o,a,l){super(t,null,n,r),this.ngClassInstance=l,this.DIRECTIVE_KEY="ngClass",this.ngClassInstance||(this.ngClassInstance=new Ha(s,o,t,a)),this.init(),this.setValue("","")}set klass(t){this.ngClassInstance.klass=t,this.setValue(t,"")}updateWithValue(t){this.ngClassInstance.ngClass=t,this.ngClassInstance.ngDoCheck()}ngDoCheck(){this.ngClassInstance.ngDoCheck()}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(ds),c.Y36(Rs),c.Y36(c.ZZ4),c.Y36(c.aQg),c.Y36(c.Qsj),c.Y36(Ha,10))},i.\u0275dir=c.lG2({type:i,inputs:{klass:["class","klass"]},features:[c.qOj]}),i})();const Pie=["ngClass","ngClass.xs","ngClass.sm","ngClass.md","ngClass.lg","ngClass.xl","ngClass.lt-sm","ngClass.lt-md","ngClass.lt-lg","ngClass.lt-xl","ngClass.gt-xs","ngClass.gt-sm","ngClass.gt-md","ngClass.gt-lg"];let R3=(()=>{class i extends Iie{constructor(){super(...arguments),this.inputs=Pie}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275dir=c.lG2({type:i,selectors:[["","ngClass",""],["","ngClass.xs",""],["","ngClass.sm",""],["","ngClass.md",""],["","ngClass.lg",""],["","ngClass.xl",""],["","ngClass.lt-sm",""],["","ngClass.lt-md",""],["","ngClass.lt-lg",""],["","ngClass.lt-xl",""],["","ngClass.gt-xs",""],["","ngClass.gt-sm",""],["","ngClass.gt-md",""],["","ngClass.gt-lg",""]],inputs:{ngClass:"ngClass","ngClass.xs":"ngClass.xs","ngClass.sm":"ngClass.sm","ngClass.md":"ngClass.md","ngClass.lg":"ngClass.lg","ngClass.xl":"ngClass.xl","ngClass.lt-sm":"ngClass.lt-sm","ngClass.lt-md":"ngClass.lt-md","ngClass.lt-lg":"ngClass.lt-lg","ngClass.lt-xl":"ngClass.lt-xl","ngClass.gt-xs":"ngClass.gt-xs","ngClass.gt-sm":"ngClass.gt-sm","ngClass.gt-md":"ngClass.gt-md","ngClass.gt-lg":"ngClass.gt-lg"},features:[c.qOj]}),i})();class Nie{constructor(e,t,n=!0){this.key=e,this.value=t,this.key=n?e.replace(/['"]/g,"").trim():e.trim(),this.value=n?t.replace(/['"]/g,"").trim():t.trim(),this.value=this.value.replace(/;/,"")}}function f6(i){let e=typeof i;return"object"===e?i.constructor===Array?"array":i.constructor===Set?"set":"object":e}function m6(i){const[e,...t]=i.split(":");return new Nie(e,t.join(":"))}function g6(i,e){return e.key&&(i[e.key]=e.value),i}let Uie=(()=>{class i extends js{constructor(t,n,r,s,o,a,l,h,f){super(t,null,n,r),this.sanitizer=s,this.ngStyleInstance=l,this.DIRECTIVE_KEY="ngStyle",this.ngStyleInstance||(this.ngStyleInstance=new Wa(t,o,a)),this.init();const m=this.nativeElement.getAttribute("style")??"";this.fallbackStyles=this.buildStyleMap(m),this.isServer=h&&ar(f)}updateWithValue(t){const n=this.buildStyleMap(t);this.ngStyleInstance.ngStyle={...this.fallbackStyles,...n},this.isServer&&this.applyStyleToElement(n),this.ngStyleInstance.ngDoCheck()}clearStyles(){this.ngStyleInstance.ngStyle=this.fallbackStyles,this.ngStyleInstance.ngDoCheck()}buildStyleMap(t){const n=r=>this.sanitizer.sanitize(c.q3G.STYLE,r)??"";if(t)switch(f6(t)){case"string":return _6(function Bie(i,e=";"){return String(i).trim().split(e).map(t=>t.trim()).filter(t=>""!==t)}(t),n);case"array":return _6(t,n);default:return function p6(i,e){let t=[];return"set"===f6(i)?i.forEach(n=>t.push(n)):Object.keys(i).forEach(n=>{t.push(`${n}:${i[n]}`)}),function jie(i,e){return i.map(m6).filter(n=>!!n).map(n=>(e&&(n.value=e(n.value)),n)).reduce(g6,{})}(t,e)}(t,n)}return{}}ngDoCheck(){this.ngStyleInstance.ngDoCheck()}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(ds),c.Y36(Rs),c.Y36(Ml),c.Y36(c.aQg),c.Y36(c.Qsj),c.Y36(Wa,10),c.Y36(ET),c.Y36(c.Lbi))},i.\u0275dir=c.lG2({type:i,features:[c.qOj]}),i})();const Vie=["ngStyle","ngStyle.xs","ngStyle.sm","ngStyle.md","ngStyle.lg","ngStyle.xl","ngStyle.lt-sm","ngStyle.lt-md","ngStyle.lt-lg","ngStyle.lt-xl","ngStyle.gt-xs","ngStyle.gt-sm","ngStyle.gt-md","ngStyle.gt-lg"];let mP=(()=>{class i extends Uie{constructor(){super(...arguments),this.inputs=Vie}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275dir=c.lG2({type:i,selectors:[["","ngStyle",""],["","ngStyle.xs",""],["","ngStyle.sm",""],["","ngStyle.md",""],["","ngStyle.lg",""],["","ngStyle.xl",""],["","ngStyle.lt-sm",""],["","ngStyle.lt-md",""],["","ngStyle.lt-lg",""],["","ngStyle.lt-xl",""],["","ngStyle.gt-xs",""],["","ngStyle.gt-sm",""],["","ngStyle.gt-md",""],["","ngStyle.gt-lg",""]],inputs:{ngStyle:"ngStyle","ngStyle.xs":"ngStyle.xs","ngStyle.sm":"ngStyle.sm","ngStyle.md":"ngStyle.md","ngStyle.lg":"ngStyle.lg","ngStyle.xl":"ngStyle.xl","ngStyle.lt-sm":"ngStyle.lt-sm","ngStyle.lt-md":"ngStyle.lt-md","ngStyle.lt-lg":"ngStyle.lt-lg","ngStyle.lt-xl":"ngStyle.lt-xl","ngStyle.gt-xs":"ngStyle.gt-xs","ngStyle.gt-sm":"ngStyle.gt-sm","ngStyle.gt-md":"ngStyle.gt-md","ngStyle.gt-lg":"ngStyle.gt-lg"},features:[c.qOj]}),i})();function _6(i,e){return i.map(m6).filter(n=>!!n).map(n=>(e&&(n.value=e(n.value)),n)).reduce(g6,{})}let v6=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[S3]}),i})();function y6(...i){const e=(0,Pi.jO)(i),{args:t,keys:n}=Uc(i),r=new bs.y(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,h=o;for(let f=0;f<o;f++){let m=!1;(0,Fr.Xf)(t[f]).subscribe((0,Tr.x)(s,g=>{m||(m=!0,h--),a[f]=g},()=>l--,void 0,()=>{(!l||!m)&&(h||s.next(n?Da(n,a):a),s.complete())}))}});return e?r.pipe(Kd(e)):r}var b6=se(3099);class Gie{}class C_{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const r=t.slice(0,n),s=r.toLowerCase(),o=t.slice(n+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let n=e[t];const r=t.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof C_?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new C_;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof C_?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...n),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class zie{encodeKey(e){return x6(e)}encodeValue(e){return x6(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Wie=/%(\d[a-f0-9])/gi,qie={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function x6(i){return encodeURIComponent(i).replace(Wie,(e,t)=>qie[t]??e)}function gP(i){return`${i}`}class E_{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new zie,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Hie(i,e){const t=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t],r=Array.isArray(n)?n.map(gP):[gP(n)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const r=e[n];Array.isArray(r)?r.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new E_({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(gP(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const r=n.indexOf(gP(e.value));-1!==r&&n.splice(r,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Zie{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function T6(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer}function w6(i){return typeof Blob<"u"&&i instanceof Blob}function M6(i){return typeof FormData<"u"&&i instanceof FormData}class DE{constructor(e,t,n,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Yie(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,s=r):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new C_),this.context||(this.context=new Zie),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new E_,this.urlWithParams=t}serializeBody(){return null===this.body?null:T6(this.body)||w6(this.body)||M6(this.body)||function Kie(i){return typeof URLSearchParams<"u"&&i instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof E_?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||M6(this.body)?null:w6(this.body)?this.body.type||null:T6(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof E_?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,n=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,h=e.params||this.params;const f=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((m,g)=>m.set(g,e.setHeaders[g]),l)),e.setParams&&(h=Object.keys(e.setParams).reduce((m,g)=>m.set(g,e.setParams[g]),h)),new DE(t,n,s,{params:h,headers:l,context:f,reportProgress:a,responseType:r,withCredentials:o})}}var Na=(()=>((Na=Na||{})[Na.Sent=0]="Sent",Na[Na.UploadProgress=1]="UploadProgress",Na[Na.ResponseHeader=2]="ResponseHeader",Na[Na.DownloadProgress=3]="DownloadProgress",Na[Na.Response=4]="Response",Na[Na.User=5]="User",Na))();class P3 extends class Xie{constructor(e,t=200,n="OK"){this.headers=e.headers||new C_,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}{constructor(e={}){super(e),this.type=Na.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new P3({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}function F3(i,e){return{body:e,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials}}let C6=(()=>{class i{constructor(t){this.handler=t}request(t,n,r={}){let s;if(t instanceof DE)s=t;else{let l,h;l=r.headers instanceof C_?r.headers:new C_(r.headers),r.params&&(h=r.params instanceof E_?r.params:new E_({fromObject:r.params})),s=new DE(t,n,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:h,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=Tn(s).pipe(Ra(l=>this.handler.handle(l)));if(t instanceof DE||"events"===r.observe)return o;const a=o.pipe(fr(l=>l instanceof P3));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe((0,Sn.U)(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe((0,Sn.U)(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe((0,Sn.U)(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe((0,Sn.U)(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:(new E_).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,r={}){return this.request("PATCH",t,F3(r,n))}post(t,n,r={}){return this.request("POST",t,F3(r,n))}put(t,n,r={}){return this.request("PUT",t,F3(r,n))}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Gie))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})();const Qie=["*"];let _P;function RE(i){return function Jie(){if(void 0===_P&&(_P=null,typeof window<"u")){const i=window;void 0!==i.trustedTypes&&(_P=i.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return _P}()?.createHTML(i)||i}function E6(i){return Error(`Unable to find icon with the name "${i}"`)}function A6(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function D6(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}class M0{constructor(e,t,n){this.url=e,this.svgText=t,this.options=n}}let vP=(()=>{class i{constructor(t,n,r,s){this._httpClient=t,this._sanitizer=n,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(t,n,r){return this.addSvgIconInNamespace("",t,n,r)}addSvgIconLiteral(t,n,r){return this.addSvgIconLiteralInNamespace("",t,n,r)}addSvgIconInNamespace(t,n,r,s){return this._addSvgIconConfig(t,n,new M0(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,n,r,s){const o=this._sanitizer.sanitize(c.q3G.HTML,r);if(!o)throw D6(r);const a=RE(o);return this._addSvgIconConfig(t,n,new M0("",a,s))}addSvgIconSet(t,n){return this.addSvgIconSetInNamespace("",t,n)}addSvgIconSetLiteral(t,n){return this.addSvgIconSetLiteralInNamespace("",t,n)}addSvgIconSetInNamespace(t,n,r){return this._addSvgIconSetConfig(t,new M0(n,null,r))}addSvgIconSetLiteralInNamespace(t,n,r){const s=this._sanitizer.sanitize(c.q3G.HTML,n);if(!s)throw D6(n);const o=RE(s);return this._addSvgIconSetConfig(t,new M0("",o,r))}registerFontClassAlias(t,n=t){return this._fontCssClassesByAlias.set(t,n),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const n=this._sanitizer.sanitize(c.q3G.RESOURCE_URL,t);if(!n)throw A6(t);const r=this._cachedIconsByUrl.get(n);return r?Tn(yP(r)):this._loadSvgIconFromConfig(new M0(t,null)).pipe((0,Lr.b)(s=>this._cachedIconsByUrl.set(n,s)),(0,Sn.U)(s=>yP(s)))}getNamedSvgIcon(t,n=""){const r=R6(n,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(n,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(n);return o?this._getSvgFromIconSetConfigs(t,o):Bu(E6(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?Tn(yP(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe((0,Sn.U)(n=>yP(n)))}_getSvgFromIconSetConfigs(t,n){const r=this._extractIconWithNameFromAnySet(t,n);return r?Tn(r):y6(n.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(ic(a=>{const h=`Loading icon set URL: ${this._sanitizer.sanitize(c.q3G.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(h)),Tn(null)})))).pipe((0,Sn.U)(()=>{const o=this._extractIconWithNameFromAnySet(t,n);if(!o)throw E6(t);return o}))}_extractIconWithNameFromAnySet(t,n){for(let r=n.length-1;r>=0;r--){const s=n[r];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,t,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe((0,Lr.b)(n=>t.svgText=n),(0,Sn.U)(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?Tn(null):this._fetchIcon(t).pipe((0,Lr.b)(n=>t.svgText=n))}_extractSvgIconFromSet(t,n,r){const s=t.querySelector(`[id="${n}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,r);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),r);const a=this._svgElementFromString(RE("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,r)}_svgElementFromString(t){const n=this._document.createElement("DIV");n.innerHTML=t;const r=n.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const n=this._svgElementFromString(RE("<svg></svg>")),r=t.attributes;for(let s=0;s<r.length;s++){const{name:o,value:a}=r[s];"id"!==o&&n.setAttribute(o,a)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&n.appendChild(t.childNodes[s].cloneNode(!0));return n}_setSvgAttributes(t,n){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),n&&n.viewBox&&t.setAttribute("viewBox",n.viewBox),t}_fetchIcon(t){const{url:n,options:r}=t,s=r?.withCredentials??!1;if(!this._httpClient)throw function ere(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==n)throw Error(`Cannot fetch icon from URL "${n}".`);const o=this._sanitizer.sanitize(c.q3G.RESOURCE_URL,n);if(!o)throw A6(n);const a=this._inProgressUrlFetches.get(o);if(a)return a;const l=this._httpClient.get(o,{responseType:"text",withCredentials:s}).pipe((0,Sn.U)(h=>RE(h)),Vu(()=>this._inProgressUrlFetches.delete(o)),(0,b6.B)());return this._inProgressUrlFetches.set(o,l),l}_addSvgIconConfig(t,n,r){return this._svgIconConfigs.set(R6(t,n),r),this}_addSvgIconSetConfig(t,n){const r=this._iconSetConfigs.get(t);return r?r.push(n):this._iconSetConfigs.set(t,[n]),this}_svgElementFromConfig(t){if(!t.svgElement){const n=this._svgElementFromString(t.svgText);this._setSvgAttributes(n,t.options),t.svgElement=n}return t.svgElement}_getIconConfigFromResolvers(t,n){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](n,t);if(s)return nre(s)?new M0(s.url,null,s.options):new M0(s,null)}}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(C6,8),c.LFG(Ml),c.LFG(Oe,8),c.LFG(c.qLn))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function yP(i){return i.cloneNode(!0)}function R6(i,e){return i+":"+e}function nre(i){return!(!i.url||!i.options)}const ire=TE(class{constructor(i){this._elementRef=i}}),rre=new c.OlP("MAT_ICON_DEFAULT_OPTIONS"),sre=new c.OlP("mat-icon-location",{providedIn:"root",factory:function ore(){const i=(0,c.f3M)(Oe),e=i?i.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),I6=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],are=I6.map(i=>`[${i}]`).join(", "),lre=/^url\(['"]?#(.*?)['"]?\)$/;let IE=(()=>{class i extends ire{constructor(t,n,r,s,o,a){super(t),this._iconRegistry=n,this._location=s,this._errorHandler=o,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=ei.w0.EMPTY,a&&(a.color&&(this.color=this.defaultColor=a.color),a.fontSet&&(this.fontSet=a.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(t){this._inline=$r(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const n=this._cleanupFontValue(t);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const n=this._cleanupFontValue(t);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}_splitIconName(t){if(!t)return["",""];const n=t.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let n=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){const r=t.childNodes[n];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,n=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),n.forEach(r=>t.classList.add(r)),this._previousFontSetClass=n,this.fontIcon!==this._previousFontIconClass&&!n.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const n=this._elementsWithExternalReferences;n&&n.forEach((r,s)=>{r.forEach(o=>{s.setAttribute(o.name,`url('${t}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(t){const n=t.querySelectorAll(are),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<n.length;s++)I6.forEach(o=>{const a=n[s],l=a.getAttribute(o),h=l?l.match(lre):null;if(h){let f=r.get(a);f||(f=[],r.set(a,f)),f.push({name:o,value:h[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[n,r]=this._splitIconName(t);n&&(this._svgNamespace=n),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,n).pipe(Ns(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${n}:${r}! ${s.message}`))})}}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(vP),c.$8M("aria-hidden"),c.Y36(sre),c.Y36(c.qLn),c.Y36(rre,8))},i.\u0275cmp=c.Xpm({type:i,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(t,n){2&t&&(c.uIk("data-mat-icon-type",n._usingFontIcon()?"font":"svg")("data-mat-icon-name",n._svgName||n.fontIcon)("data-mat-icon-namespace",n._svgNamespace||n.fontSet),c.ekj("mat-icon-inline",n.inline)("mat-icon-no-color","primary"!==n.color&&"accent"!==n.color&&"warn"!==n.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[c.qOj],ngContentSelectors:Qie,decls:1,vars:0,template:function(t,n){1&t&&(c.F$t(),c.Hsn(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),i})(),cre=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[Qr,Qr]}),i})();function ure(i,e){if(1&i&&(c.TgZ(0,"span",8)(1,"span"),c._uU(2,"Rent"),c.qZA(),c.TgZ(3,"span"),c._uU(4),c.qZA()()),2&i){const t=c.oxw(2);c.xp6(4),c.hij("",t.data.card.rentCosts.normal,"\u20ac")}}function hre(i,e){if(1&i&&(c.TgZ(0,"span",8)(1,"span"),c._uU(2,"Rent with color set"),c.qZA(),c.TgZ(3,"span"),c._uU(4),c.qZA()()),2&i){const t=c.oxw(2);c.xp6(4),c.hij("",t.data.card.rentCosts.completedSeriesBasic,"\u20ac")}}function dre(i,e){1&i&&(c.TgZ(0,"span",25)(1,"mat-icon"),c._uU(2,"cottage"),c.qZA()())}function fre(i,e){if(1&i&&(c.TgZ(0,"span",25),c._uU(1),c.qZA()),2&i){const t=c.oxw(3);c.xp6(1),c.hij("",t.data.card.rentCosts.hotel,"\u20ac")}}function pre(i,e){if(1&i&&(c.TgZ(0,"span",19)(1,"span"),c._uU(2,"Rent with property"),c.qZA(),c.TgZ(3,"div",20)(4,"div",21)(5,"span",22)(6,"mat-icon"),c._uU(7,"cottage"),c.qZA(),c.TgZ(8,"span"),c._uU(9,"1"),c.qZA()(),c.TgZ(10,"span",22)(11,"mat-icon"),c._uU(12,"cottage"),c.qZA(),c.TgZ(13,"span"),c._uU(14,"2"),c.qZA()(),c.TgZ(15,"span",22)(16,"mat-icon"),c._uU(17,"cottage"),c.qZA(),c.TgZ(18,"span"),c._uU(19,"3"),c.qZA()(),c.TgZ(20,"span",22)(21,"mat-icon"),c._uU(22,"cottage"),c.qZA(),c.TgZ(23,"span"),c._uU(24,"4"),c.qZA()(),c.YNc(25,dre,3,0,"span",23),c.qZA(),c.TgZ(26,"div",24)(27,"span",22),c._uU(28),c.qZA(),c.TgZ(29,"span",22),c._uU(30),c.qZA(),c.TgZ(31,"span",22),c._uU(32),c.qZA(),c.TgZ(33,"span",22),c._uU(34),c.qZA(),c.YNc(35,fre,2,1,"span",23),c.qZA()()()),2&i){const t=c.oxw(2);c.xp6(25),c.Q6J("ngIf",t.data.card.rentCosts&&t.data.card.rentCosts.hotel),c.xp6(3),c.hij("",t.data.card.rentCosts.one,"\u20ac"),c.xp6(2),c.hij("",t.data.card.rentCosts.two,"\u20ac"),c.xp6(2),c.hij("",t.data.card.rentCosts.three,"\u20ac"),c.xp6(2),c.hij("",t.data.card.rentCosts.four,"\u20ac"),c.xp6(1),c.Q6J("ngIf",t.data.card.rentCosts&&t.data.card.rentCosts.hotel)}}function mre(i,e){if(1&i&&(c.TgZ(0,"span",8)(1,"span"),c._uU(2,"House price"),c.qZA(),c.TgZ(3,"span"),c._uU(4),c.qZA()()),2&i){const t=c.oxw(2);c.xp6(4),c.hij("",t.data.card.houseCost,"\u20ac")}}function gre(i,e){if(1&i&&(c.TgZ(0,"span",8)(1,"span"),c._uU(2,"Hotel price"),c.qZA(),c.TgZ(3,"span"),c._uU(4),c.qZA()()),2&i){const t=c.oxw(2);c.xp6(4),c.hij("",t.data.card.hotelCost,"\u20ac")}}function _re(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",26),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(2);return r.gameService.buyProperty(r.data.card),c.KtG(r.close())}),c._uU(1,"Compra"),c.qZA()}if(2&i){const t=c.oxw(2);c.Q6J("disabled",t.gameService.players[t.gameService.turn].money<t.data.card.cost)}}function vre(i,e){1&i&&(c.TgZ(0,"button",27),c._uU(1,"Asta"),c.qZA()),2&i&&c.Q6J("disabled",!0)}function yre(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",28),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(2);return r.gameService.distrainProperty(r.data.card),c.KtG(r.close())}),c.TgZ(1,"mat-icon"),c._uU(2,"credit_card"),c.qZA()()}2&i&&c.Q6J("matTooltipPosition","above")}function bre(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",29),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(2);return c.KtG(r.gameService.cancelDistrainedFromProperty(r.data.card))}),c.TgZ(1,"mat-icon"),c._uU(2,"credit_card_off"),c.qZA()()}if(2&i){const t=c.oxw(2);c.Q6J("disabled",t.gameService.players[t.gameService.turn].money<t.data.card.distrainedCost)("matTooltipPosition","above")}}function xre(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",40),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(5);return c.KtG(r.addHouse())}),c.TgZ(1,"mat-icon"),c._uU(2,"add"),c.qZA(),c.TgZ(3,"mat-icon",37),c._uU(4,"cottage"),c.qZA()()}if(2&i){const t=c.oxw(5);c.Q6J("fxFlex","50%")("disabled",t.gameService.players[t.gameService.turn].money<t.data.card.houseCost)("matTooltipPosition","above")}}function Tre(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",41),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(5);return c.KtG(r.addHotel())}),c.TgZ(1,"mat-icon"),c._uU(2,"add"),c.qZA(),c.TgZ(3,"mat-icon",42),c._uU(4,"cottage"),c.qZA()()}if(2&i){const t=c.oxw(5);c.Q6J("fxFlex","50%")("disabled",t.gameService.players[t.gameService.turn].money<t.data.card.hotelCost),c.xp6(3),c.Q6J("matTooltipPosition","above")}}function wre(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"div",35)(1,"button",36),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(4);return c.KtG(r.removeHouse())}),c.TgZ(2,"mat-icon"),c._uU(3,"remove"),c.qZA(),c.TgZ(4,"mat-icon",37),c._uU(5,"cottage"),c.qZA()(),c.YNc(6,xre,5,3,"button",38),c.YNc(7,Tre,5,3,"button",39),c.qZA()}if(2&i){const t=c.oxw(4);c.Q6J("fxFlex","100%"),c.xp6(1),c.Q6J("disabled",!t.data.card.housesCounter)("fxFlex","50%")("matTooltipPosition","above"),c.xp6(5),c.Q6J("ngIf",t.data.card.housesCounter<4),c.xp6(1),c.Q6J("ngIf",4==t.data.card.housesCounter)}}function Mre(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"div",43)(1,"button",44),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(4);return c.KtG(r.removeHotel())}),c.TgZ(2,"mat-icon"),c._uU(3,"remove"),c.qZA(),c.TgZ(4,"mat-icon",45),c._uU(5,"cottage"),c.qZA()()()}2&i&&(c.Q6J("fxFlex","100%"),c.xp6(1),c.Q6J("fxFlex","50%")("matTooltipPosition","above"))}function Sre(i,e){if(1&i&&(c.TgZ(0,"div",32),c.YNc(1,wre,8,6,"div",33),c.YNc(2,Mre,6,3,"div",34),c.qZA()),2&i){const t=c.oxw(3);c.xp6(1),c.Q6J("ngIf",!t.data.card.hotelCounter),c.xp6(1),c.Q6J("ngIf",t.data.card.hotelCounter)}}function Cre(i,e){if(1&i&&(c.TgZ(0,"div",30),c.YNc(1,Sre,3,2,"div",31),c.qZA()),2&i){const t=c.oxw(2);c.xp6(1),c.Q6J("ngIf","property"==t.data.card.cardType)}}const P6=function(i){return{background:i}},F6=function(i){return{color:i}};function Ere(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"div",2)(1,"button",3),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.gameService.closeDialog(r.dialogRef))}),c.TgZ(2,"mat-icon"),c._uU(3,"close"),c.qZA()(),c.TgZ(4,"mat-card",4)(5,"span",5)(6,"span",6),c._uU(7),c.qZA()(),c.TgZ(8,"div",7)(9,"span",8)(10,"span"),c._uU(11,"Property cost"),c.qZA(),c.TgZ(12,"span"),c._uU(13),c.qZA()(),c.YNc(14,ure,5,1,"span",9),c.YNc(15,hre,5,1,"span",9),c.YNc(16,pre,36,6,"span",10),c._UZ(17,"hr",11),c.YNc(18,mre,5,1,"span",9),c.YNc(19,gre,5,1,"span",9),c.TgZ(20,"span",8)(21,"span"),c._uU(22,"Distrain price"),c.qZA(),c.TgZ(23,"span"),c._uU(24),c.qZA()()()(),c._UZ(25,"div",12),c.TgZ(26,"div",13),c.YNc(27,_re,2,1,"button",14),c.YNc(28,vre,2,1,"button",15),c.YNc(29,yre,3,1,"button",16),c.YNc(30,bre,3,2,"button",17),c.YNc(31,Cre,2,1,"div",18),c.qZA()()}if(2&i){const t=c.oxw();c.xp6(5),c.Q6J("ngStyle",c.VKq(15,P6,t.gameService.checkCardColorDistrict(t.data.card.district))),c.xp6(1),c.Q6J("ngStyle",c.VKq(17,F6,t.getContrastColor(t.gameService.checkCardColorDistrict(t.data.card.district)))),c.xp6(1),c.Oqu(t.data.card.name),c.xp6(6),c.hij("",t.data.card.cost,"\u20ac"),c.xp6(1),c.Q6J("ngIf",t.data.card.rentCosts),c.xp6(1),c.Q6J("ngIf",t.data.card.rentCosts&&t.data.card.rentCosts.completedSeriesBasic),c.xp6(1),c.Q6J("ngIf",t.data.card.rentCosts&&t.data.card.rentCosts.one),c.xp6(2),c.Q6J("ngIf",t.data.card.houseCost),c.xp6(1),c.Q6J("ngIf",t.data.card.hotelCost),c.xp6(5),c.hij("",t.data.card.distrainedCost,"\u20ac"),c.xp6(3),c.Q6J("ngIf",t.data.card.canBuy),c.xp6(1),c.Q6J("ngIf",t.data.card.canBuy),c.xp6(1),c.Q6J("ngIf",!t.data.card.distrained&&t.data.card.owner==t.gameService.players[t.gameService.turn].id),c.xp6(1),c.Q6J("ngIf",t.data.card.distrained&&t.data.card.owner==t.gameService.players[t.gameService.turn].id),c.xp6(1),c.Q6J("ngIf",t.data.card.completedSeries&&t.data.card.owner==t.gameService.players[t.gameService.turn].id)}}function Are(i,e){if(1&i&&(c.TgZ(0,"span",8)(1,"span"),c._uU(2,"Rent"),c.qZA(),c.TgZ(3,"span"),c._uU(4),c.qZA()()),2&i){const t=c.oxw().$implicit;c.xp6(4),c.hij("",t.rentCosts.normal,"\u20ac")}}function Dre(i,e){if(1&i&&(c.TgZ(0,"span",8)(1,"span"),c._uU(2,"Rent with color set"),c.qZA(),c.TgZ(3,"span"),c._uU(4),c.qZA()()),2&i){const t=c.oxw().$implicit;c.xp6(4),c.hij("",t.rentCosts.completedSeriesBasic,"\u20ac")}}function Rre(i,e){1&i&&(c.TgZ(0,"span",25)(1,"mat-icon"),c._uU(2,"cottage"),c.qZA()())}function Ire(i,e){if(1&i&&(c.TgZ(0,"span",25),c._uU(1),c.qZA()),2&i){const t=c.oxw(2).$implicit;c.xp6(1),c.hij("",t.rentCosts.hotel,"\u20ac")}}function Pre(i,e){if(1&i&&(c.TgZ(0,"span",19)(1,"span"),c._uU(2,"Rent with property"),c.qZA(),c.TgZ(3,"div",20)(4,"div",21)(5,"span",22)(6,"mat-icon"),c._uU(7,"cottage"),c.qZA(),c.TgZ(8,"span"),c._uU(9,"1"),c.qZA()(),c.TgZ(10,"span",22)(11,"mat-icon"),c._uU(12,"cottage"),c.qZA(),c.TgZ(13,"span"),c._uU(14,"2"),c.qZA()(),c.TgZ(15,"span",22)(16,"mat-icon"),c._uU(17,"cottage"),c.qZA(),c.TgZ(18,"span"),c._uU(19,"3"),c.qZA()(),c.TgZ(20,"span",22)(21,"mat-icon"),c._uU(22,"cottage"),c.qZA(),c.TgZ(23,"span"),c._uU(24,"4"),c.qZA()(),c.YNc(25,Rre,3,0,"span",23),c.qZA(),c.TgZ(26,"div",24)(27,"span",22),c._uU(28),c.qZA(),c.TgZ(29,"span",22),c._uU(30),c.qZA(),c.TgZ(31,"span",22),c._uU(32),c.qZA(),c.TgZ(33,"span",22),c._uU(34),c.qZA(),c.YNc(35,Ire,2,1,"span",23),c.qZA()()()),2&i){const t=c.oxw().$implicit;c.xp6(25),c.Q6J("ngIf",t.rentCosts&&t.rentCosts.hotel),c.xp6(3),c.hij("",t.rentCosts.one,"\u20ac"),c.xp6(2),c.hij("",t.rentCosts.two,"\u20ac"),c.xp6(2),c.hij("",t.rentCosts.three,"\u20ac"),c.xp6(2),c.hij("",t.rentCosts.four,"\u20ac"),c.xp6(1),c.Q6J("ngIf",t.rentCosts&&t.rentCosts.hotel)}}function Fre(i,e){if(1&i&&(c.TgZ(0,"span",8)(1,"span"),c._uU(2,"House price"),c.qZA(),c.TgZ(3,"span"),c._uU(4),c.qZA()()),2&i){const t=c.oxw().$implicit;c.xp6(4),c.hij("",t.houseCost,"\u20ac")}}function Lre(i,e){if(1&i&&(c.TgZ(0,"span",8)(1,"span"),c._uU(2,"Hotel price"),c.qZA(),c.TgZ(3,"span"),c._uU(4),c.qZA()()),2&i){const t=c.oxw().$implicit;c.xp6(4),c.hij("",t.hotelCost,"\u20ac")}}function Ore(i,e){if(1&i&&(c.TgZ(0,"mat-card",4)(1,"span",5)(2,"span",6),c._uU(3),c.qZA()(),c.TgZ(4,"div",7)(5,"span",8)(6,"span"),c._uU(7,"Property cost"),c.qZA(),c.TgZ(8,"span"),c._uU(9),c.qZA()(),c.YNc(10,Are,5,1,"span",9),c.YNc(11,Dre,5,1,"span",9),c.YNc(12,Pre,36,6,"span",10),c._UZ(13,"hr",11),c.YNc(14,Fre,5,1,"span",9),c.YNc(15,Lre,5,1,"span",9),c.TgZ(16,"span",8)(17,"span"),c._uU(18,"Distrain price"),c.qZA(),c.TgZ(19,"span"),c._uU(20),c.qZA()()()()),2&i){const t=e.$implicit,n=c.oxw(2);c.xp6(1),c.Q6J("ngStyle",c.VKq(10,P6,n.gameService.checkCardColorDistrict(t.district))),c.xp6(1),c.Q6J("ngStyle",c.VKq(12,F6,n.getContrastColor(n.gameService.checkCardColorDistrict(t.district)))),c.xp6(1),c.Oqu(t.name),c.xp6(6),c.hij("",t.cost,"\u20ac"),c.xp6(1),c.Q6J("ngIf",t.rentCosts),c.xp6(1),c.Q6J("ngIf",t.rentCosts&&t.rentCosts.completedSeriesBasic),c.xp6(1),c.Q6J("ngIf",t.rentCosts&&t.rentCosts.one),c.xp6(2),c.Q6J("ngIf",t.houseCost),c.xp6(1),c.Q6J("ngIf",t.hotelCost),c.xp6(5),c.hij("",t.distrainedCost,"\u20ac")}}function kre(i,e){1&i&&(c.TgZ(0,"div",49)(1,"span"),c._uU(2,"Completed Series"),c.qZA()())}function Nre(i,e){if(1&i&&(c.TgZ(0,"div",46),c.YNc(1,Ore,21,14,"mat-card",47),c.YNc(2,kre,3,0,"div",48),c.qZA()),2&i){const t=c.oxw();c.Q6J("ngClass",t.data.cards.length>2?"three":"two"),c.xp6(1),c.Q6J("ngForOf",t.data.cards),c.xp6(1),c.Q6J("ngIf",!t.data.card&&t.data.cards)}}let L6=(()=>{class i{constructor(t,n,r){this.data=t,this.dialogRef=n,this.gameService=r,this.houses=[],this.hotel=!1}ngOnInit(){this.data.completedSeries&&setTimeout(()=>{this.gameService.closeDialog(this.dialogRef)},1500)}close(){this.dialogRef.close()}counterHouses(){if(this.data.card.hotelCounter)this.data.card.hotelCounter&&(this.hotel=!0);else for(let t=0;t<this.data.card.housesCounter;t++)this.houses.push("")}addHouse(){this.data.card.housesCounter++,this.gameService.addingRemovingMoney("remove",this.data.card.houseCost,250)}removeHouse(){this.data.card.housesCounter--,this.gameService.addingRemovingMoney("add",this.data.card.houseCost/100*50,250)}addHotel(){this.data.card.hotelCounter++,this.gameService.addingRemovingMoney("remove",this.data.card.hotelCost,250)}removeHotel(){this.data.card.hotelCounter--,this.gameService.addingRemovingMoney("add",this.data.card.hotelCost/100*50,250)}getContrastColor(t){var n="#"===t.charAt(0)?t.substring(1,7):t;return.299*parseInt(n.substring(0,2),16)+.587*parseInt(n.substring(2,4),16)+.114*parseInt(n.substring(4,6),16)>186?"#000":"#fff"}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(lP),c.Y36(aP),c.Y36(wd))},i.\u0275cmp=c.Xpm({type:i,selectors:[["app-card-dialog"]],decls:2,vars:2,consts:[["id","cardInfo","fxLayout","column","fxLayoutAlign","start start",4,"ngIf"],["id","completedSeries-info","fxLayoutAlign","center center",3,"ngClass",4,"ngIf"],["id","cardInfo","fxLayout","column","fxLayoutAlign","start start"],["mat-raised-button","",3,"click"],[1,"cardForm"],["fxLayoutAlign","center center",1,"propDistrict",3,"ngStyle"],[1,"cardName",3,"ngStyle"],["fxLayout","column",1,"cardCosts"],["fxLayoutAlign","space-between center",1,"cardCost"],["class","cardCost","fxLayoutAlign","space-between center",4,"ngIf"],["class","cardCost",4,"ngIf"],[1,"separator"],["id","auctionContainer"],["fxLayoutAlign","end center",1,"cardBtns"],["mat-raised-button","",3,"disabled","click",4,"ngIf"],["mat-raised-button","",3,"disabled",4,"ngIf"],["mat-raised-button","","matTooltip","Mortgage",3,"matTooltipPosition","click",4,"ngIf"],["mat-raised-button","","matTooltip","Remove mortgage",3,"disabled","matTooltipPosition","click",4,"ngIf"],["class","housesManager",4,"ngIf"],[1,"cardCost"],["fxLayout","row",1,"rentsWithProps"],["fxLayout","column",1,"props"],["fxLayoutAlign","center center",1,"house"],["class","hotel","fxLayoutAlign","center center",4,"ngIf"],["fxLayout","column","fxLayoutAlign","space-around end",1,"rent"],["fxLayoutAlign","center center",1,"hotel"],["mat-raised-button","",3,"disabled","click"],["mat-raised-button","",3,"disabled"],["mat-raised-button","","matTooltip","Mortgage",3,"matTooltipPosition","click"],["mat-raised-button","","matTooltip","Remove mortgage",3,"disabled","matTooltipPosition","click"],[1,"housesManager"],["fxLayout","row","fxLayoutAlign","start center",4,"ngIf"],["fxLayout","row","fxLayoutAlign","start center"],["class","houses",3,"fxFlex",4,"ngIf"],["class","hotel",3,"fxFlex",4,"ngIf"],[1,"houses",3,"fxFlex"],["mat-raised-button","","matTooltip","Remove house",3,"disabled","fxFlex","matTooltipPosition","click"],[1,"houseIcon"],["mat-raised-button","","matTooltip","Add house",3,"fxFlex","disabled","matTooltipPosition","click",4,"ngIf"],["mat-raised-button","",3,"fxFlex","disabled","click",4,"ngIf"],["mat-raised-button","","matTooltip","Add house",3,"fxFlex","disabled","matTooltipPosition","click"],["mat-raised-button","",3,"fxFlex","disabled","click"],["matTooltip","Add hotel",1,"hotelIcon",3,"matTooltipPosition"],[1,"hotel",3,"fxFlex"],["mat-raised-button","","matTooltip","Remove hotel",3,"fxFlex","matTooltipPosition","click"],[1,"hotelIcon"],["id","completedSeries-info","fxLayoutAlign","center center",3,"ngClass"],["class","cardForm",4,"ngFor","ngForOf"],["class","completedText",4,"ngIf"],[1,"completedText"]],template:function(t,n){1&t&&(c.YNc(0,Ere,32,19,"div",0),c.YNc(1,Nre,3,3,"div",1)),2&t&&(c.Q6J("ngIf",n.data.card&&!n.data.cards),c.xp6(1),c.Q6J("ngIf",!n.data.card&&n.data.cards))},dependencies:[Ha,xr,qr,Wa,CE,uP,hP,w0,S_,h6,R3,mP,IE],styles:[".disabled[_ngcontent-%COMP%]{opacity:.7;color:gray;pointer-events:none}.cardForm[_ngcontent-%COMP%]{width:220px;height:350px;position:relative}.cardForm[_ngcontent-%COMP%]   .propDistrict[_ngcontent-%COMP%]{position:absolute;top:10px;height:50px;width:90%}.cardForm[_ngcontent-%COMP%]   .cardCosts[_ngcontent-%COMP%]{margin-top:55px}.cardForm[_ngcontent-%COMP%]   .cardCosts[_ngcontent-%COMP%]   .rentsWithProps[_ngcontent-%COMP%]   .props[_ngcontent-%COMP%]   .house[_ngcontent-%COMP%], .cardForm[_ngcontent-%COMP%]   .cardCosts[_ngcontent-%COMP%]   .rentsWithProps[_ngcontent-%COMP%]   .props[_ngcontent-%COMP%]   .hotel[_ngcontent-%COMP%]{height:20px;position:relative;margin-top:5px}.cardForm[_ngcontent-%COMP%]   .cardCosts[_ngcontent-%COMP%]   .rentsWithProps[_ngcontent-%COMP%]   .props[_ngcontent-%COMP%]   .house[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .cardForm[_ngcontent-%COMP%]   .cardCosts[_ngcontent-%COMP%]   .rentsWithProps[_ngcontent-%COMP%]   .props[_ngcontent-%COMP%]   .hotel[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;z-index:2;font-size:10px;color:#fff}.cardForm[_ngcontent-%COMP%]   .cardCosts[_ngcontent-%COMP%]   .rentsWithProps[_ngcontent-%COMP%]   .props[_ngcontent-%COMP%]   .hotel[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:red}.cardForm[_ngcontent-%COMP%]   .cardCosts[_ngcontent-%COMP%]   .rentsWithProps[_ngcontent-%COMP%]   .props[_ngcontent-%COMP%]   .hotel[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:red}.cardForm[_ngcontent-%COMP%]   .cardCosts[_ngcontent-%COMP%]   .rentsWithProps[_ngcontent-%COMP%]   .props[_ngcontent-%COMP%]   .house[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:green}.cardForm[_ngcontent-%COMP%]   .cardCosts[_ngcontent-%COMP%]   .rentsWithProps[_ngcontent-%COMP%]   .props[_ngcontent-%COMP%]   .house[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:green}.cardForm[_ngcontent-%COMP%]   .cardCosts[_ngcontent-%COMP%]   .rentsWithProps[_ngcontent-%COMP%]   .rent[_ngcontent-%COMP%]{width:100%}.cardForm[_ngcontent-%COMP%]   .cardCosts[_ngcontent-%COMP%]   .rentsWithProps[_ngcontent-%COMP%]   .rent[_ngcontent-%COMP%]   .house[_ngcontent-%COMP%], .cardForm[_ngcontent-%COMP%]   .cardCosts[_ngcontent-%COMP%]   .rentsWithProps[_ngcontent-%COMP%]   .rent[_ngcontent-%COMP%]   .hotel[_ngcontent-%COMP%]{margin-top:5px}.cardForm[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{height:.5px;width:100%;background:grey}.cardBtns[_ngcontent-%COMP%]   .housesManager[_ngcontent-%COMP%]   .houseIcon[_ngcontent-%COMP%]{color:green}.cardBtns[_ngcontent-%COMP%]   .housesManager[_ngcontent-%COMP%]   .hotelIcon[_ngcontent-%COMP%]{color:red}#completedSeries-info.three[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]:first-child{margin-right:-50px;margin-bottom:-80px;z-index:0}#completedSeries-info.three[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]:not(:first-child):not(:last-of-type){z-index:1}#completedSeries-info.three[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]:last-of-type{margin-left:-50px;margin-bottom:-80px;z-index:0}#completedSeries-info.two[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]:first-child{margin-right:-20px;z-index:0}#completedSeries-info.two[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]:last-of-type{margin-left:-20px;z-index:0}#completedSeries-info[_ngcontent-%COMP%]   .completedText[_ngcontent-%COMP%]{position:absolute;top:0px;z-index:2;height:50px;width:300px;background:#fff;display:flex;align-items:center;justify-content:center;border-radius:5px}@media screen and (min-width: 600px){#completedSeries-info.three[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]:first-child{transform:scale(.8) rotate(-5deg)}#completedSeries-info.three[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]:last-of-type{transform:scale(.8) rotate(5deg)}#completedSeries-info.two[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]:first-child{transform:rotate(-5deg)}#completedSeries-info.two[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]:last-of-type{transform:rotate(5deg)}}@media screen and (max-width: 600px){#completedSeries-info.three[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]:first-child{transform:scale(.5) rotate(-5deg);left:-50px;margin-bottom:-50px;z-index:0}#completedSeries-info.three[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]:not(:first-child):not(:last-of-type){transform:scale(.6)}#completedSeries-info.three[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]:last-of-type{transform:scale(.5) rotate(5deg);right:-50px;margin-bottom:-50px;z-index:0}#completedSeries-info.two[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]:first-child{transform:scale(.5) rotate(-5deg);left:20px}#completedSeries-info.two[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]:last-of-type{transform:scale(.5) rotate(5deg);right:20px}#completedSeries-info[_ngcontent-%COMP%]   .cardForm[_ngcontent-%COMP%]{position:absolute}}"]}),i})();function Bre(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",7),c.NdJ("click",function(){const s=c.CHM(t).$implicit,o=c.oxw(2);return c.KtG(o.selectPlayerToExchange(s))}),c.TgZ(1,"span"),c._uU(2),c.qZA()()}if(2&i){const t=e.$implicit;c.Q6J("disabled",t.bankrupt),c.xp6(2),c.Oqu(t.name)}}function jre(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"div",4)(1,"button",5),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.gameService.closeDialog(r.dialogRef))}),c.TgZ(2,"mat-icon"),c._uU(3,"close"),c.qZA()(),c.YNc(4,Bre,3,2,"button",6),c.qZA()}if(2&i){const t=c.oxw();c.xp6(4),c.Q6J("ngForOf",t.getPlayersToExchangeWith())}}function Ure(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",17),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(2);return c.KtG(r.changeActualExpanded(r.gameService.players[r.gameService.turn].id))}),c.TgZ(1,"mat-icon",15),c._uU(2),c.qZA()()}if(2&i){const t=c.oxw(2);c.xp6(2),c.Oqu(t.actualExpanded==t.gameService.players[t.gameService.turn].id?"expand_less":"expand_more")}}function Vre(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"div",18)(1,"mat-form-field",19)(2,"mat-label"),c._uU(3,"Amount of Money"),c.qZA(),c.TgZ(4,"input",20),c.NdJ("ngModelChange",function(r){c.CHM(t);const s=c.oxw(2);return c.KtG(s.moneyToExchange[0]=r)}),c.qZA()(),c._UZ(5,"app-player-properties",21),c.qZA()}if(2&i){const t=c.oxw(2);c.Q6J("@mmAnimationGrowHeight",void 0),c.xp6(4),c.Q6J("ngModel",t.moneyToExchange[0]),c.xp6(1),c.Q6J("playerId",t.gameService.players[t.gameService.turn].id)("imInExchange",!0)}}function Gre(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",17),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(2);return c.KtG(r.changeActualExpanded(r.playerToExchangeWith.id))}),c.TgZ(1,"mat-icon",15),c._uU(2),c.qZA()()}if(2&i){const t=c.oxw(2);c.xp6(2),c.Oqu(t.actualExpanded==t.playerToExchangeWith.id?"expand_less":"expand_more")}}function zre(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"div",18)(1,"mat-form-field",19)(2,"mat-label"),c._uU(3,"Amount of Money"),c.qZA(),c.TgZ(4,"input",20),c.NdJ("ngModelChange",function(r){c.CHM(t);const s=c.oxw(2);return c.KtG(s.moneyToExchange[1]=r)}),c.qZA()(),c._UZ(5,"app-player-properties",21),c.qZA()}if(2&i){const t=c.oxw(2);c.Q6J("@mmAnimationGrowHeight",void 0),c.xp6(4),c.Q6J("ngModel",t.moneyToExchange[1]),c.xp6(1),c.Q6J("playerId",t.playerToExchangeWith.id)("imInExchange",!0)}}function Hre(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"span"),c._uU(5),c.qZA(),c.YNc(6,Ure,3,1,"button",12),c.qZA(),c.YNc(7,Vre,6,4,"div",13),c.qZA(),c.TgZ(8,"div",10)(9,"div",11)(10,"button",14),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.goBackToSelection())}),c.TgZ(11,"mat-icon",15),c._uU(12,"arrow_back"),c.qZA()(),c.TgZ(13,"span"),c._uU(14),c.qZA(),c.YNc(15,Gre,3,1,"button",12),c.qZA(),c.YNc(16,zre,6,4,"div",13),c.qZA()(),c.TgZ(17,"button",16),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.startExchange=!0)}),c.TgZ(18,"mat-icon"),c._uU(19,"handshake"),c.qZA()()()}if(2&i){const t=c.oxw();c.xp6(5),c.Oqu(t.gameService.players[t.gameService.turn].name),c.xp6(1),c.Q6J("ngIf",!t.gameService.userDevice.includes("computer")),c.xp6(1),c.Q6J("ngIf",t.actualExpanded==t.gameService.players[t.gameService.turn].id||t.gameService.userDevice.includes("computer")),c.xp6(3),c.Q6J("matTooltipPosition","above"),c.xp6(4),c.Oqu(t.playerToExchangeWith.name),c.xp6(1),c.Q6J("ngIf",!t.gameService.userDevice.includes("computer")),c.xp6(1),c.Q6J("ngIf",t.actualExpanded==t.playerToExchangeWith.id||t.gameService.userDevice.includes("computer")),c.xp6(1),c.Q6J("matTooltipPosition","above")}}function Wre(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"div")(1,"button",5),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.finaliseExchange("refuse"))}),c.TgZ(2,"mat-icon"),c._uU(3,"close"),c.qZA()(),c.TgZ(4,"button",5),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.finaliseExchange("accept"))}),c.TgZ(5,"mat-icon"),c._uU(6,"done"),c.qZA()()()}}let O6=(()=>{class i{constructor(t,n,r){this.data=t,this.dialogRef=n,this.gameService=r,this.playerToExchangeWith="",this.playerToExchangeProps=[],this.actualPlayerProps=[],this.moneyToExchange=[[0],[0]],this.startExchange=!1,this.actualExpanded=""}ngOnInit(){}ngAfterViewInit(){}close(){this.dialogRef.close()}goBackToSelection(){this.playerToExchangeWith="",this.moneyToExchange[0]=0,this.moneyToExchange[1]=0,this.startExchange=!1}getPlayersToExchangeWith(){return this.gameService.players.filter(t=>t.id!==this.gameService.players[this.gameService.turn].id)}selectPlayerToExchange(t){this.playerToExchangeWith=t,this.actualPlayerProps=this.gameService.sortProperties(this.gameService.gameTable.cards.filter(n=>n.owner==this.gameService.players[this.gameService.turn].id)),this.playerToExchangeProps=this.gameService.sortProperties(this.gameService.gameTable.cards.filter(n=>n.owner==t.id)),this.actualExpanded=this.gameService.players[this.gameService.turn].id}finaliseExchange(t){"accept"==t&&(this.playerToExchangeProps.filter(n=>n.exchangeSelected).length&&this.playerToExchangeProps.filter(n=>n.exchangeSelected).forEach(n=>{const r=this.gameService.gameTable.cards.find(s=>s.name==n.name);r.owner=this.gameService.players[this.gameService.turn].id,r.exchangeSelected=!1,n.completedSeries||this.gameService.checkCompletedSeries(n,this.gameService.players[this.gameService.turn].id)}),this.actualPlayerProps.filter(n=>n.exchangeSelected).length&&this.actualPlayerProps.filter(n=>n.exchangeSelected).forEach(n=>{const r=this.gameService.gameTable.cards.find(s=>s.name==n.name);r.owner=this.playerToExchangeWith.id,r.exchangeSelected=!1,n.completedSeries||this.gameService.checkCompletedSeries(n,this.playerToExchangeWith.id)}),this.moneyToExchange[0]>0&&(this.gameService.addingRemovingMoney("remove",this.moneyToExchange[0],1e3),this.gameService.addingRemovingMoney("add",this.moneyToExchange[0],1e3,this.playerToExchangeWith)),this.moneyToExchange[1]>0&&(this.gameService.addingRemovingMoney("add",this.moneyToExchange[1],1e3),this.gameService.addingRemovingMoney("remove",this.moneyToExchange[1],1e3,this.playerToExchangeWith))),this.goBackToSelection(),this.close()}changeActualExpanded(t){this.actualExpanded=this.actualExpanded==t?"":t}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(lP),c.Y36(aP),c.Y36(wd))},i.\u0275cmp=c.Xpm({type:i,selectors:[["app-exchange"]],decls:4,vars:3,consts:[["id","exchangeContainer","fxLayout","row","fxLayoutAlign","space-around center"],["class","choosePlayer",4,"ngIf"],["class","exchangeContainer","fxLayout","column","fxLayoutAlign","space-around center",4,"ngIf"],[4,"ngIf"],[1,"choosePlayer"],["mat-raised-button","",3,"click"],["mat-raised-button","",3,"disabled","click",4,"ngFor","ngForOf"],["mat-raised-button","",3,"disabled","click"],["fxLayout","column","fxLayoutAlign","space-around center",1,"exchangeContainer"],[1,"exchangeProperties"],["fxLayout","column","fxLayoutAlign","space-around center",1,"playerContainer"],["fxLayoutAlign","start center",1,"titleContainer"],["mat-icon-button","","class","expandMore","fxLayoutAlign","center center",3,"click",4,"ngIf"],["class","exchangeOptions","fxLayout","column","fxLayoutAlign","start center",4,"ngIf"],["mat-icon-button","","fxLayoutAlign","center center","matTooltip","Change Player",1,"exchangeGoBackBtn",3,"matTooltipPosition","click"],["fxLayoutAlign","center center"],["mat-raised-button","","matTooltip","Finalise Exchange",1,"handshakeButton",3,"matTooltipPosition","click"],["mat-icon-button","","fxLayoutAlign","center center",1,"expandMore",3,"click"],["fxLayout","column","fxLayoutAlign","start center",1,"exchangeOptions"],["appearance","fill"],["matInput","","type","number",3,"ngModel","ngModelChange"],[3,"playerId","imInExchange"]],template:function(t,n){1&t&&(c.TgZ(0,"div",0),c.YNc(1,jre,5,1,"div",1),c.YNc(2,Hre,20,8,"div",2),c.YNc(3,Wre,7,0,"div",3),c.qZA()),2&t&&(c.xp6(1),c.Q6J("ngIf",!n.playerToExchangeWith),c.xp6(1),c.Q6J("ngIf",n.playerToExchangeWith&&!n.startExchange),c.xp6(1),c.Q6J("ngIf",n.startExchange))},styles:["#exchangeContainer[_ngcontent-%COMP%]   .choosePlayer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;flex-wrap:wrap}#exchangeContainer[_ngcontent-%COMP%]   .choosePlayer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:65px;min-width:100px}#exchangeContainer[_ngcontent-%COMP%]   .exchangeContainer[_ngcontent-%COMP%]   .exchangeProperties[_ngcontent-%COMP%]{display:flex;align-items:start;justify-content:start;width:100%}#exchangeContainer[_ngcontent-%COMP%]   .exchangeContainer[_ngcontent-%COMP%]   .exchangeProperties[_ngcontent-%COMP%]   .playerContainer[_ngcontent-%COMP%]{width:100%;box-shadow:0 2px 1px -1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f;padding:15px}#exchangeContainer[_ngcontent-%COMP%]   .exchangeContainer[_ngcontent-%COMP%]   .exchangeProperties[_ngcontent-%COMP%]   .playerContainer[_ngcontent-%COMP%]   .titleContainer[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:start;position:relative;height:30px}#exchangeContainer[_ngcontent-%COMP%]   .exchangeContainer[_ngcontent-%COMP%]   .exchangeProperties[_ngcontent-%COMP%]   .playerContainer[_ngcontent-%COMP%]   .titleContainer[_ngcontent-%COMP%]   .exchangeGoBackBtn[_ngcontent-%COMP%], #exchangeContainer[_ngcontent-%COMP%]   .exchangeContainer[_ngcontent-%COMP%]   .exchangeProperties[_ngcontent-%COMP%]   .playerContainer[_ngcontent-%COMP%]   .titleContainer[_ngcontent-%COMP%]   .expandMore[_ngcontent-%COMP%]{width:30px;height:30px;min-width:unset;min-height:unset;border-radius:3px}#exchangeContainer[_ngcontent-%COMP%]   .exchangeContainer[_ngcontent-%COMP%]   .exchangeProperties[_ngcontent-%COMP%]   .playerContainer[_ngcontent-%COMP%]   .titleContainer[_ngcontent-%COMP%]   .expandMore[_ngcontent-%COMP%]{position:absolute;right:0}#exchangeContainer[_ngcontent-%COMP%]   .exchangeContainer[_ngcontent-%COMP%]   .exchangeProperties[_ngcontent-%COMP%]   .playerContainer[_ngcontent-%COMP%]   .titleContainer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700;margin-left:10px}#exchangeContainer[_ngcontent-%COMP%]   .exchangeContainer[_ngcontent-%COMP%]   .exchangeProperties[_ngcontent-%COMP%]   .playerContainer[_ngcontent-%COMP%]   .exchangeOptions[_ngcontent-%COMP%]{margin-top:20px}#exchangeContainer[_ngcontent-%COMP%]   .exchangeContainer[_ngcontent-%COMP%]   .handshakeButton[_ngcontent-%COMP%]{margin-top:20px;width:200px;height:50px;background:#7cb77c;font-weight:700;color:#fff}@media screen and (max-width: 600px){.exchangeProperties[_ngcontent-%COMP%]{flex-direction:column}.choosePlayer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:not(:nth-child(1)):not(:nth-child(2)){margin-top:20px}}@media screen and (min-width: 600px){.exchangeProperties[_ngcontent-%COMP%]{flex-direction:row}.exchangeProperties[_ngcontent-%COMP%] > .playerContainer[_ngcontent-%COMP%]:nth-child(2){margin-left:20px}.choosePlayer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:not(:nth-child(1)){margin-left:20px}}"],data:{animation:[jf("mmAnimationGrowHeight",[ka(":enter",[Qi({height:"0",opacity:0}),ul("300ms ease-in",Qi({height:"*",opacity:1}))]),ka(":leave",[Qi({height:"*",opacity:1}),ul("300ms ease-out",Qi({height:"0",opacity:0}))])])]}}),i})();const k6={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let bP;const qre=new Uint8Array(16);function Zre(){if(!bP&&(bP=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!bP))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return bP(qre)}const Ba=[];for(let i=0;i<256;++i)Ba.push((i+256).toString(16).slice(1));const Kre=function Yre(i,e,t){if(k6.randomUUID&&!e&&!i)return k6.randomUUID();const n=(i=i||{}).random||(i.rng||Zre)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){t=t||0;for(let r=0;r<16;++r)e[t+r]=n[r];return e}return function N6(i,e=0){return(Ba[i[e+0]]+Ba[i[e+1]]+Ba[i[e+2]]+Ba[i[e+3]]+"-"+Ba[i[e+4]]+Ba[i[e+5]]+"-"+Ba[i[e+6]]+Ba[i[e+7]]+"-"+Ba[i[e+8]]+Ba[i[e+9]]+"-"+Ba[i[e+10]]+Ba[i[e+11]]+Ba[i[e+12]]+Ba[i[e+13]]+Ba[i[e+14]]+Ba[i[e+15]]).toLowerCase()}(n)};function Tm(i){if(void 0===i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function B6(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.__proto__=e}var L3,dc,No,Us,sh,j3,U3,W6,Y6,LT,jE,au={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},DT={duration:.5,overwrite:!1,delay:0},rh=1e8,Or=1e-8,O3=2*Math.PI,Xre=O3/4,$re=0,j6=Math.sqrt,Qre=Math.cos,Jre=Math.sin,xa=function(e){return"string"==typeof e},no=function(e){return"function"==typeof e},wm=function(e){return"number"==typeof e},k3=function(e){return typeof e>"u"},Vf=function(e){return"object"==typeof e},fc=function(e){return!1!==e},U6=function(){return typeof window<"u"},xP=function(e){return no(e)||xa(e)},V6="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},hl=Array.isArray,N3=/(?:-?\.?\d|\.)+/gi,G6=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,RT=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,B3=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,z6=/[+-]=-?[.\d]+/,H6=/[^,'"\[\]\s]+/gi,ese=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,lu={},TP={},q6=function(e){return(TP=C0(e,lu))&&hu},V3=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},wP=function(e,t){return!t&&console.warn(e)},Z6=function(e,t){return e&&(lu[e]=t)&&TP&&(TP[e]=t)||lu},PE=function(){return 0},tse={suppressEvents:!0,isStart:!0,kill:!1},MP={suppressEvents:!0,kill:!1},nse={suppressEvents:!0},G3={},A_=[],z3={},cu={},H3={},K6=30,SP=[],W3="",q3=function(e){var n,r,t=e[0];if(Vf(t)||no(t)||(e=[e]),!(n=(t._gsap||{}).harness)){for(r=SP.length;r--&&!SP[r].targetTest(t););n=SP[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new TW(e[r],n)))||e.splice(r,1);return e},S0=function(e){return e._gsap||q3(lh(e))[0]._gsap},X6=function(e,t,n){return(n=e[t])&&no(n)?e[t]():k3(n)&&e.getAttribute&&e.getAttribute(t)||n},pc=function(e,t){return(e=e.split(",")).forEach(t)||e},_o=function(e){return Math.round(1e5*e)/1e5||0},ja=function(e){return Math.round(1e7*e)/1e7||0},IT=function(e,t){var n=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),"+"===n?e+r:"-"===n?e-r:"*"===n?e*r:e/r},ise=function(e,t){for(var n=t.length,r=0;e.indexOf(t[r])<0&&++r<n;);return r<n},CP=function(){var n,r,e=A_.length,t=A_.slice(0);for(z3={},A_.length=0,n=0;n<e;n++)(r=t[n])&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},$6=function(e,t,n,r){A_.length&&CP(),e.render(t,n,r||dc&&t<0&&(e._initted||e._startAt)),A_.length&&CP()},Q6=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(H6).length<2?t:xa(e)?e.trim():e},J6=function(e){return e},oh=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},C0=function(e,t){for(var n in t)e[n]=t[n];return e},eW=function i(e,t){for(var n in t)"__proto__"!==n&&"constructor"!==n&&"prototype"!==n&&(e[n]=Vf(t[n])?i(e[n]||(e[n]={}),t[n]):t[n]);return e},EP=function(e,t){var r,n={};for(r in e)r in t||(n[r]=e[r]);return n},FE=function(e){var t=e.parent||Us,n=e.keyframes?function(e){return function(t,n){for(var r in n)r in t||"duration"===r&&e||"ease"===r||(t[r]=n[r])}}(hl(e.keyframes)):oh;if(fc(e.inherit))for(;t;)n(e,t.vars.defaults),t=t.parent||t._dp;return e},tW=function(e,t,n,r,s){void 0===n&&(n="_first"),void 0===r&&(r="_last");var a,o=e[r];if(s)for(a=t[s];o&&o[s]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[r]=t,t._prev=o,t.parent=t._dp=e,t},AP=function(e,t,n,r){void 0===n&&(n="_first"),void 0===r&&(r="_last");var s=t._prev,o=t._next;s?s._next=o:e[n]===t&&(e[n]=o),o?o._prev=s:e[r]===t&&(e[r]=s),t._next=t._prev=t.parent=null},D_=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},E0=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},ose=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},Z3=function(e,t,n,r){return e._startAt&&(dc?e._startAt.revert(MP):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,r))},ase=function i(e){return!e||e._ts&&i(e.parent)},nW=function(e){return e._repeat?PT(e._tTime,e=e.duration()+e._rDelay)*e:0},PT=function(e,t){var n=Math.floor(e/=t);return e&&n===e?n-1:n},DP=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},RP=function(e){return e._end=ja(e._start+(e._tDur/Math.abs(e._ts||e._rts||Or)||0))},IP=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=ja(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),RP(e),n._dirty||E0(n,e)),e},iW=function(e,t){var n;if((t._time||t._initted&&!t._dur)&&(n=DP(e.rawTime(),t),(!t._dur||OE(0,t.totalDuration(),n)-t._tTime>Or)&&t.render(n,!0)),E0(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-Or}},Gf=function(e,t,n,r){return t.parent&&D_(t),t._start=ja((wm(n)?n:n||e!==Us?ah(e,n,t):e._time)+t._delay),t._end=ja(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),tW(e,t,"_first","_last",e._sort?"_start":0),Y3(t)||(e._recent=t),r||iW(e,t),e._ts<0&&IP(e,e._tTime),e},rW=function(e,t){return(lu.ScrollTrigger||V3("scrollTrigger",t))&&lu.ScrollTrigger.create(t,e)},sW=function(e,t,n,r,s){return ij(e,t,s),e._initted?!n&&e._pt&&!dc&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&Y6!==uu.frame?(A_.push(e),e._lazy=[s,r],1):void 0:1},lse=function i(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||i(t))},Y3=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},FT=function(e,t,n,r){var s=e._repeat,o=ja(t)||0,a=e._tTime/e._tDur;return a&&!r&&(e._time*=o/e._dur),e._dur=o,e._tDur=s?s<0?1e10:ja(o*(s+1)+e._rDelay*s):o,a>0&&!r&&IP(e,e._tTime=e._tDur*a),e.parent&&RP(e),n||E0(e.parent,e),e},oW=function(e){return e instanceof mc?E0(e):FT(e,e._dur)},hse={_start:0,endTime:PE,totalDuration:PE},ah=function i(e,t,n){var a,l,h,r=e.labels,s=e._recent||hse,o=e.duration()>=rh?s.endTime(!1):e._dur;return xa(t)&&(isNaN(t)||t in r)?(l=t.charAt(0),h="%"===t.substr(-1),a=t.indexOf("="),"<"===l||">"===l?(a>=0&&(t=t.replace(/=/,"")),("<"===l?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(h?(a<0?s:n).totalDuration()/100:1)):a<0?(t in r||(r[t]=o),r[t]):(l=parseFloat(t.charAt(a-1)+t.substr(a+1)),h&&n&&(l=l/100*(hl(n)?n[0]:n).totalDuration()),a>1?i(e,t.substr(0,a-1),n)+l:o+l)):null==t?o:+t},LE=function(e,t,n){var a,l,r=wm(t[1]),s=(r?2:1)+(e<2?0:1),o=t[s];if(r&&(o.duration=t[1]),o.parent=n,e){for(a=o,l=n;l&&!("immediateRender"in a);)a=l.vars.defaults||{},l=fc(l.vars.inherit)&&l.parent;o.immediateRender=fc(a.immediateRender),e<2?o.runBackwards=1:o.startAt=t[s-1]}return new na(t[0],o,t[s+1])},R_=function(e,t){return e||0===e?t(e):t},OE=function(e,t,n){return n<e?e:n>t?t:n},dl=function(e,t){return xa(e)&&(t=ese.exec(e))?t[1]:""},K3=[].slice,aW=function(e,t){return e&&Vf(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Vf(e[0]))&&!e.nodeType&&e!==sh},lh=function(e,t,n){return No&&!t&&No.selector?No.selector(e):!xa(e)||n||!j3&&OT()?hl(e)?function(e,t,n){return void 0===n&&(n=[]),e.forEach(function(r){var s;return xa(r)&&!t||aW(r,1)?(s=n).push.apply(s,lh(r)):n.push(r)})||n}(e,n):aW(e)?K3.call(e,0):e?[e]:[]:K3.call((t||U3).querySelectorAll(e),0)},X3=function(e){return e=lh(e)[0]||wP("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return lh(t,n.querySelectorAll?n:n===e?wP("Invalid scope")||U3.createElement("div"):e)}},lW=function(e){return e.sort(function(){return.5-Math.random()})},cW=function(e){if(no(e))return e;var t=Vf(e)?e:{each:e},n=A0(t.ease),r=t.from||0,s=parseFloat(t.base)||0,o={},a=r>0&&r<1,l=isNaN(r)||a,h=t.axis,f=r,m=r;return xa(r)?f=m={center:.5,edges:.5,end:1}[r]||0:!a&&l&&(f=r[0],m=r[1]),function(g,v,y){var S,C,R,I,L,N,U,k,z,b=(y||t).length,T=o[b];if(!T){if(!(z="auto"===t.grid?0:(t.grid||[1,rh])[1])){for(U=-rh;U<(U=y[z++].getBoundingClientRect().left)&&z<b;);z--}for(T=o[b]=[],S=l?Math.min(z,b)*f-.5:r%z,C=z===rh?0:l?b*m/z-.5:r/z|0,U=0,k=rh,N=0;N<b;N++)R=N%z-S,I=C-(N/z|0),T[N]=L=h?Math.abs("y"===h?I:R):j6(R*R+I*I),L>U&&(U=L),L<k&&(k=L);"random"===r&&lW(T),T.max=U-k,T.min=k,T.v=b=(parseFloat(t.amount)||parseFloat(t.each)*(z>b?b-1:h?"y"===h?b/z:z:Math.max(z,b/z))||0)*("edges"===r?-1:1),T.b=b<0?s-b:s,T.u=dl(t.amount||t.each)||0,n=n&&b<0?yW(n):n}return b=(T[g]-T.min)/T.max||0,ja(T.b+(n?n(b):b)*T.v)+T.u}},$3=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var r=ja(Math.round(parseFloat(n)/e)*e*t);return(r-r%1)/t+(wm(n)?0:dl(n))}},uW=function(e,t){var r,s,n=hl(e);return!n&&Vf(e)&&(r=n=e.radius||rh,e.values?(e=lh(e.values),(s=!wm(e[0]))&&(r*=r)):e=$3(e.increment)),R_(t,n?no(e)?function(o){return s=e(o),Math.abs(s-o)<=r?s:o}:function(o){for(var g,v,a=parseFloat(s?o.x:o),l=parseFloat(s?o.y:0),h=rh,f=0,m=e.length;m--;)(g=s?(g=e[m].x-a)*g+(v=e[m].y-l)*v:Math.abs(e[m]-a))<h&&(h=g,f=m);return f=!r||h<=r?e[f]:o,s||f===o||wm(o)?f:f+dl(o)}:$3(e))},hW=function(e,t,n,r){return R_(hl(e)?!t:!0===n?!!(n=0):!r,function(){return hl(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+.99*n))/n)*n*r)/r})},dW=function(e,t,n){return R_(n,function(r){return e[~~t(r)]})},kE=function(e){for(var r,s,o,a,t=0,n="";~(r=e.indexOf("random(",t));)o=e.indexOf(")",r),a="["===e.charAt(r+7),s=e.substr(r+7,o-r-7).match(a?H6:N3),n+=e.substr(t,r-t)+hW(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),t=o+1;return n+e.substr(t,e.length-t)},fW=function(e,t,n,r,s){var o=t-e,a=r-n;return R_(s,function(l){return n+((l-e)/o*a||0)})},pW=function(e,t,n){var o,a,l,r=e.labels,s=rh;for(o in r)(a=r[o]-t)<0==!!n&&a&&s>(a=Math.abs(a))&&(l=o,s=a);return l},ch=function(e,t,n){var l,h,f,r=e.vars,s=r[t],o=No,a=e._ctx;if(s)return l=r[t+"Params"],h=r.callbackScope||e,n&&A_.length&&CP(),a&&(No=a),f=l?s.apply(h,l):s.call(h),No=o,f},NE=function(e){return D_(e),e.scrollTrigger&&e.scrollTrigger.kill(!!dc),e.progress()<1&&ch(e,"onInterrupt"),e},bse=function(e){var t=(e=!e.name&&e.default||e).name,n=no(e),r=t&&!n&&e.init?function(){this._props=[]}:e,s={init:PE,render:oj,add:tj,kill:kse,modifier:Ose,rawVars:0},o={targetTest:0,get:0,getSetter:sj,aliases:{},register:0};if(OT(),e!==r){if(cu[t])return;oh(r,oh(EP(e,s),o)),C0(r.prototype,C0(s,EP(e,o))),cu[r.prop=t]=r,e.targetTest&&(SP.push(r),G3[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}Z6(t,r),e.register&&e.register(hu,r,gc)},Hr=255,BE={aqua:[0,Hr,Hr],lime:[0,Hr,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Hr],navy:[0,0,128],white:[Hr,Hr,Hr],olive:[128,128,0],yellow:[Hr,Hr,0],orange:[Hr,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Hr,0,0],pink:[Hr,192,203],cyan:[0,Hr,Hr],transparent:[Hr,Hr,Hr,0]},Q3=function(e,t,n){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(n-t)*e*6:e<.5?n:3*e<2?t+(n-t)*(2/3-e)*6:t)*Hr+.5|0},mW=function(e,t,n){var s,o,a,l,h,f,m,g,v,y,r=e?wm(e)?[e>>16,e>>8&Hr,e&Hr]:0:BE.black;if(!r){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),BE[e])r=BE[e];else if("#"===e.charAt(0)){if(e.length<6&&(s=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+s+s+o+o+a+a+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(r=parseInt(e.substr(1,6),16))>>16,r>>8&Hr,r&Hr,parseInt(e.substr(7),16)/255];r=[(e=parseInt(e.substr(1),16))>>16,e>>8&Hr,e&Hr]}else if("hsl"===e.substr(0,3))if(r=y=e.match(N3),t){if(~e.indexOf("="))return r=e.match(G6),n&&r.length<4&&(r[3]=1),r}else l=+r[0]%360/360,h=+r[1]/100,s=2*(f=+r[2]/100)-(o=f<=.5?f*(h+1):f+h-f*h),r.length>3&&(r[3]*=1),r[0]=Q3(l+1/3,s,o),r[1]=Q3(l,s,o),r[2]=Q3(l-1/3,s,o);else r=e.match(N3)||BE.transparent;r=r.map(Number)}return t&&!y&&(s=r[0]/Hr,o=r[1]/Hr,a=r[2]/Hr,f=((m=Math.max(s,o,a))+(g=Math.min(s,o,a)))/2,m===g?l=h=0:(v=m-g,h=f>.5?v/(2-m-g):v/(m+g),l=m===s?(o-a)/v+(o<a?6:0):m===o?(a-s)/v+2:(s-o)/v+4,l*=60),r[0]=~~(l+.5),r[1]=~~(100*h+.5),r[2]=~~(100*f+.5)),n&&r.length<4&&(r[3]=1),r},gW=function(e){var t=[],n=[],r=-1;return e.split(I_).forEach(function(s){var o=s.match(RT)||[];t.push.apply(t,o),n.push(r+=o.length+1)}),t.c=n,t},_W=function(e,t,n){var l,h,f,m,r="",s=(e+r).match(I_),o=t?"hsla(":"rgba(",a=0;if(!s)return e;if(s=s.map(function(g){return(g=mW(g,t,1))&&o+(t?g[0]+","+g[1]+"%,"+g[2]+"%,"+g[3]:g.join(","))+")"}),n&&(f=gW(e),(l=n.c).join(r)!==f.c.join(r)))for(m=(h=e.replace(I_,"1").split(RT)).length-1;a<m;a++)r+=h[a]+(~l.indexOf(a)?s.shift()||o+"0,0,0,0)":(f.length?f:s.length?s:n).shift());if(!h)for(m=(h=e.split(I_)).length-1;a<m;a++)r+=h[a]+s[a];return r+h[m]},I_=function(){var e,i="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in BE)i+="|"+e+"\\b";return new RegExp(i+")","gi")}(),xse=/hsl[a]?\(/,vW=function(e){var n,t=e.join(" ");if(I_.lastIndex=0,I_.test(t))return n=xse.test(t),e[1]=_W(e[1],n),e[0]=_W(e[0],n,gW(e[1])),!0},uu=function(){var l,h,f,m,g,v,i=Date.now,e=500,t=33,n=i(),r=n,s=1e3/240,o=s,a=[],y=function b(T){var R,I,L,N,S=i()-r,C=!0===T;if(S>e&&(n+=S-t),((R=(L=(r+=S)-n)-o)>0||C)&&(N=++m.frame,g=L-1e3*m.time,m.time=L/=1e3,o+=R+(R>=s?4:s-R),I=1),C||(l=h(b)),I)for(v=0;v<a.length;v++)a[v](L,g,N,T)};return m={time:0,frame:0,tick:function(){y(!0)},deltaRatio:function(T){return g/(1e3/(T||60))},wake:function(){W6&&(!j3&&U6()&&(sh=j3=window,U3=sh.document||{},lu.gsap=hu,(sh.gsapVersions||(sh.gsapVersions=[])).push(hu.version),q6(TP||sh.GreenSockGlobals||!sh.gsap&&sh||{}),f=sh.requestAnimationFrame),l&&m.sleep(),h=f||function(T){return setTimeout(T,o-1e3*m.time+1|0)},jE=1,y(2))},sleep:function(){(f?sh.cancelAnimationFrame:clearTimeout)(l),jE=0,h=PE},lagSmoothing:function(T,S){e=T||1/Or,t=Math.min(S,e,0)},fps:function(T){o=1e3*m.time+(s=1e3/(T||240))},add:function(T,S,C){var R=S?function(I,L,N,U){T(I,L,N,U),m.remove(R)}:T;return m.remove(T),a[C?"unshift":"push"](R),OT(),R},remove:function(T,S){~(S=a.indexOf(T))&&a.splice(S,1)&&v>=S&&v--},_listeners:a}}(),OT=function(){return!jE&&uu.wake()},Ji={},Tse=/^[\d.\-M][\d.\-,\s]/,wse=/["']/g,Mse=function(e){for(var a,l,h,t={},n=e.substr(1,e.length-3).split(":"),r=n[0],s=1,o=n.length;s<o;s++)l=n[s],a=s!==o-1?l.lastIndexOf(","):l.length,h=l.substr(0,a),t[r]=isNaN(h)?h.replace(wse,"").trim():+h,r=l.substr(a+1).trim();return t},yW=function(e){return function(t){return 1-e(1-t)}},bW=function i(e,t){for(var r,n=e._first;n;)n instanceof mc?i(n,t):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==t&&(n.timeline?i(n.timeline,t):(r=n._ease,n._ease=n._yEase,n._yEase=r,n._yoyo=t)),n=n._next},A0=function(e,t){return e&&(no(e)?e:Ji[e]||function(e){var t=(e+"").split("("),n=Ji[t[0]];return n&&t.length>1&&n.config?n.config.apply(null,~e.indexOf("{")?[Mse(t[1])]:function(e){var t=e.indexOf("(")+1,n=e.indexOf(")"),r=e.indexOf("(",t);return e.substring(t,~r&&r<n?e.indexOf(")",n+1):n)}(e).split(",").map(Q6)):Ji._CE&&Tse.test(e)?Ji._CE("",e):n}(e))||t},D0=function(e,t,n,r){void 0===n&&(n=function(l){return 1-t(1-l)}),void 0===r&&(r=function(l){return l<.5?t(2*l)/2:1-t(2*(1-l))/2});var o,s={easeIn:t,easeOut:n,easeInOut:r};return pc(e,function(a){for(var l in Ji[a]=lu[a]=s,Ji[o=a.toLowerCase()]=n,s)Ji[o+("easeIn"===l?".in":"easeOut"===l?".out":".inOut")]=Ji[a+"."+l]=s[l]}),s},xW=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},J3=function i(e,t,n){var r=t>=1?t:1,s=(n||(e?.3:.45))/(t<1?t:1),o=s/O3*(Math.asin(1/r)||0),a=function(f){return 1===f?1:r*Math.pow(2,-10*f)*Jre((f-o)*s)+1},l="out"===e?a:"in"===e?function(h){return 1-a(1-h)}:xW(a);return s=O3/s,l.config=function(h,f){return i(e,h,f)},l},ej=function i(e,t){void 0===t&&(t=1.70158);var n=function(o){return o?--o*o*((t+1)*o+t)+1:0},r="out"===e?n:"in"===e?function(s){return 1-n(1-s)}:xW(n);return r.config=function(s){return i(e,s)},r};pc("Linear,Quad,Cubic,Quart,Quint,Strong",function(i,e){var t=e<5?e+1:e;D0(i+",Power"+(t-1),e?function(n){return Math.pow(n,t)}:function(n){return n},function(n){return 1-Math.pow(1-n,t)},function(n){return n<.5?Math.pow(2*n,t)/2:1-Math.pow(2*(1-n),t)/2})}),Ji.Linear.easeNone=Ji.none=Ji.Linear.easeIn,D0("Elastic",J3("in"),J3("out"),J3()),function(i,e){var s=function(a){return a<.36363636363636365?i*a*a:a<.7272727272727273?i*Math.pow(a-1.5/e,2)+.75:a<.9090909090909092?i*(a-=2.25/e)*a+.9375:i*Math.pow(a-2.625/e,2)+.984375};D0("Bounce",function(o){return 1-s(1-o)},s)}(7.5625,2.75),D0("Expo",function(i){return i?Math.pow(2,10*(i-1)):0}),D0("Circ",function(i){return-(j6(1-i*i)-1)}),D0("Sine",function(i){return 1===i?1:1-Qre(i*Xre)}),D0("Back",ej("in"),ej("out"),ej()),Ji.SteppedEase=Ji.steps=lu.SteppedEase={config:function(e,t){void 0===e&&(e=1);var n=1/e,r=e+(t?0:1),s=t?1:0;return function(a){return((r*OE(0,.99999999,a)|0)+s)*n}}},DT.ease=Ji["quad.out"],pc("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(i){return W3+=i+","+i+"Params,"});var TW=function(e,t){this.id=$re++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:X6,this.set=t?t.getSetter:sj},kT=function(){function i(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,FT(this,+t.duration,1,1),this.data=t.data,No&&(this._ctx=No,No.data.push(this)),jE||uu.wake()}var e=i.prototype;return e.delay=function(n){return n||0===n?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},e.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},e.totalDuration=function(n){return arguments.length?(this._dirty=0,FT(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(n,r){if(OT(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(IP(this,n),!s._dp||s.parent||iW(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&Gf(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===Or||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),$6(this,n,r)),this},e.time=function(n,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+nW(this))%(this._dur+this._rDelay)||(n?this._dur:0),r):this._time},e.totalProgress=function(n,r){return arguments.length?this.totalTime(this.totalDuration()*n,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(n,r){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?n:1-n)+nW(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(n,r){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*s,r):this._repeat?PT(this._tTime,s)+1:1},e.timeScale=function(n){if(!arguments.length)return this._rts===-Or?0:this._rts;if(this._rts===n)return this;var r=this.parent&&this._ts?DP(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-Or?0:this._rts,this.totalTime(OE(-this._delay,this._tDur,r),!0),RP(this),ose(this)},e.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(OT(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==Or&&(this._tTime-=Or)))),this):this._ps},e.startTime=function(n){if(arguments.length){this._start=n;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&Gf(r,this,n-this._delay),this}return this._start},e.endTime=function(n){return this._start+(fc(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(n){var r=this.parent||this._dp;return r?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?DP(r.rawTime(n),this):this._tTime:this._tTime},e.revert=function(n){void 0===n&&(n=nse);var r=dc;return dc=n,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(n),this.totalTime(-.01,n.suppressEvents)),"nested"!==this.data&&!1!==n.kill&&this.kill(),dc=r,this},e.globalTime=function(n){for(var r=this,s=arguments.length?n:r.rawTime();r;)s=r._start+s/(r._ts||1),r=r._dp;return!this.parent&&this.vars.immediateRender?-1:s},e.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,oW(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(n){if(arguments.length){var r=this._time;return this._rDelay=n,oW(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},e.seek=function(n,r){return this.totalTime(ah(this,n),fc(r))},e.restart=function(n,r){return this.play().totalTime(n?-this._delay:0,fc(r))},e.play=function(n,r){return null!=n&&this.seek(n,r),this.reversed(!1).paused(!1)},e.reverse=function(n,r){return null!=n&&this.seek(n||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(n,r){return null!=n&&this.seek(n,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-Or:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Or,this},e.isActive=function(){var s,n=this.parent||this._dp,r=this._start;return!(n&&!(this._ts&&this._initted&&n.isActive()&&(s=n.rawTime(!0))>=r&&s<this.endTime(!0)-Or))},e.eventCallback=function(n,r,s){var o=this.vars;return arguments.length>1?(r?(o[n]=r,s&&(o[n+"Params"]=s),"onUpdate"===n&&(this._onUpdate=r)):delete o[n],this):o[n]},e.then=function(n){var r=this;return new Promise(function(s){var o=no(n)?n:J6,a=function(){var h=r.then;r.then=null,no(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=h),s(o),r.then=h};r._initted&&1===r.totalProgress()&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},e.kill=function(){NE(this)},i}();oh(kT.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Or,_prom:0,_ps:!1,_rts:1});var mc=function(i){function e(n,r){var s;return void 0===n&&(n={}),(s=i.call(this,n)||this).labels={},s.smoothChildTiming=!!n.smoothChildTiming,s.autoRemoveChildren=!!n.autoRemoveChildren,s._sort=fc(n.sortChildren),Us&&Gf(n.parent||Us,Tm(s),r),n.reversed&&s.reverse(),n.paused&&s.paused(!0),n.scrollTrigger&&rW(Tm(s),n.scrollTrigger),s}B6(e,i);var t=e.prototype;return t.to=function(r,s,o){return LE(0,arguments,this),this},t.from=function(r,s,o){return LE(1,arguments,this),this},t.fromTo=function(r,s,o,a){return LE(2,arguments,this),this},t.set=function(r,s,o){return s.duration=0,s.parent=this,FE(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new na(r,s,ah(this,o),1),this},t.call=function(r,s,o){return Gf(this,na.delayedCall(0,r,s),o)},t.staggerTo=function(r,s,o,a,l,h,f){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=h,o.onCompleteParams=f,o.parent=this,new na(r,o,ah(this,l)),this},t.staggerFrom=function(r,s,o,a,l,h,f){return o.runBackwards=1,FE(o).immediateRender=fc(o.immediateRender),this.staggerTo(r,s,o,a,l,h,f)},t.staggerFromTo=function(r,s,o,a,l,h,f,m){return a.startAt=o,FE(a).immediateRender=fc(a.immediateRender),this.staggerTo(r,s,a,l,h,f,m)},t.render=function(r,s,o){var g,v,y,b,T,S,C,R,I,L,N,U,a=this._time,l=this._dirty?this.totalDuration():this._tDur,h=this._dur,f=r<=0?0:ja(r),m=this._zTime<0!=r<0&&(this._initted||!h);if(this!==Us&&f>l&&r>=0&&(f=l),f!==this._tTime||o||m){if(a!==this._time&&h&&(f+=this._time-a,r+=this._time-a),g=f,I=this._start,S=!(R=this._ts),m&&(h||(a=this._zTime),(r||!s)&&(this._zTime=r)),this._repeat){if(N=this._yoyo,T=h+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(100*T+r,s,o);if(g=ja(f%T),f===l?(b=this._repeat,g=h):((b=~~(f/T))&&b===f/T&&(g=h,b--),g>h&&(g=h)),L=PT(this._tTime,T),!a&&this._tTime&&L!==b&&(L=b),N&&1&b&&(g=h-g,U=1),b!==L&&!this._lock){var k=N&&1&L,z=k===(N&&1&b);if(b<L&&(k=!k),a=k?0:h,this._lock=1,this.render(a||(U?0:ja(b*T)),s,!h)._lock=0,this._tTime=f,!s&&this.parent&&ch(this,"onRepeat"),this.vars.repeatRefresh&&!U&&(this.invalidate()._lock=1),a&&a!==this._time||S!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(h=this._dur,l=this._tDur,z&&(this._lock=2,this.render(a=k?h:-1e-4,!0),this.vars.repeatRefresh&&!U&&this.invalidate()),this._lock=0,!this._ts&&!S)return this;bW(this,U)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(C=function(e,t,n){var r;if(n>t)for(r=e._first;r&&r._start<=n;){if("isPause"===r.data&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=n;){if("isPause"===r.data&&r._start<t)return r;r=r._prev}}(this,ja(a),ja(g)),C&&(f-=g-(g=C._start))),this._tTime=f,this._time=g,this._act=!R,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&g&&!s&&(ch(this,"onStart"),this._tTime!==f))return this;if(g>=a&&r>=0)for(v=this._first;v;){if(y=v._next,(v._act||g>=v._start)&&v._ts&&C!==v){if(v.parent!==this)return this.render(r,s,o);if(v.render(v._ts>0?(g-v._start)*v._ts:(v._dirty?v.totalDuration():v._tDur)+(g-v._start)*v._ts,s,o),g!==this._time||!this._ts&&!S){C=0,y&&(f+=this._zTime=-Or);break}}v=y}else{v=this._last;for(var K=r<0?r:g;v;){if(y=v._prev,(v._act||K<=v._end)&&v._ts&&C!==v){if(v.parent!==this)return this.render(r,s,o);if(v.render(v._ts>0?(K-v._start)*v._ts:(v._dirty?v.totalDuration():v._tDur)+(K-v._start)*v._ts,s,o||dc&&(v._initted||v._startAt)),g!==this._time||!this._ts&&!S){C=0,y&&(f+=this._zTime=K?-Or:Or);break}}v=y}}if(C&&!s&&(this.pause(),C.render(g>=a?0:-Or)._zTime=g>=a?1:-1,this._ts))return this._start=I,RP(this),this.render(r,s,o);this._onUpdate&&!s&&ch(this,"onUpdate",!0),(f===l&&this._tTime>=this.totalDuration()||!f&&a)&&(I===this._start||Math.abs(R)!==Math.abs(this._ts))&&(this._lock||((r||!h)&&(f===l&&this._ts>0||!f&&this._ts<0)&&D_(this,1),!s&&(!(r<0)||a)&&(f||a||!l)&&(ch(this,f===l&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(f<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(r,s){var o=this;if(wm(s)||(s=ah(this,s,r)),!(r instanceof kT)){if(hl(r))return r.forEach(function(a){return o.add(a,s)}),this;if(xa(r))return this.addLabel(r,s);if(!no(r))return this;r=na.delayedCall(0,r)}return this!==r?Gf(this,r,s):this},t.getChildren=function(r,s,o,a){void 0===r&&(r=!0),void 0===s&&(s=!0),void 0===o&&(o=!0),void 0===a&&(a=-rh);for(var l=[],h=this._first;h;)h._start>=a&&(h instanceof na?s&&l.push(h):(o&&l.push(h),r&&l.push.apply(l,h.getChildren(!0,s,o)))),h=h._next;return l},t.getById=function(r){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===r)return s[o]},t.remove=function(r){return xa(r)?this.removeLabel(r):no(r)?this.killTweensOf(r):(AP(this,r),r===this._recent&&(this._recent=this._last),E0(this))},t.totalTime=function(r,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=ja(uu.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),i.prototype.totalTime.call(this,r,s),this._forcing=0,this):this._tTime},t.addLabel=function(r,s){return this.labels[r]=ah(this,s),this},t.removeLabel=function(r){return delete this.labels[r],this},t.addPause=function(r,s,o){var a=na.delayedCall(0,s||PE,o);return a.data="isPause",this._hasPause=1,Gf(this,a,ah(this,r))},t.removePause=function(r){var s=this._first;for(r=ah(this,r);s;)s._start===r&&"isPause"===s.data&&D_(s),s=s._next},t.killTweensOf=function(r,s,o){for(var a=this.getTweensOf(r,o),l=a.length;l--;)P_!==a[l]&&a[l].kill(r,s);return this},t.getTweensOf=function(r,s){for(var f,o=[],a=lh(r),l=this._first,h=wm(s);l;)l instanceof na?ise(l._targets,a)&&(h?(!P_||l._initted&&l._ts)&&l.globalTime(0)<=s&&l.globalTime(l.totalDuration())>s:!s||l.isActive())&&o.push(l):(f=l.getTweensOf(a,s)).length&&o.push.apply(o,f),l=l._next;return o},t.tweenTo=function(r,s){s=s||{};var v,o=this,a=ah(o,r),h=s.startAt,f=s.onStart,m=s.onStartParams,g=s.immediateRender,y=na.to(o,oh({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(h&&"time"in h?h.time:o._time))/o.timeScale())||Or,onStart:function(){if(o.pause(),!v){var T=s.duration||Math.abs((a-(h&&"time"in h?h.time:o._time))/o.timeScale());y._dur!==T&&FT(y,T,0,1).render(y._time,!0,!0),v=1}f&&f.apply(y,m||[])}},s));return g?y.render(0):y},t.tweenFromTo=function(r,s,o){return this.tweenTo(s,oh({startAt:{time:ah(this,r)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(r){return void 0===r&&(r=this._time),pW(this,ah(this,r))},t.previousLabel=function(r){return void 0===r&&(r=this._time),pW(this,ah(this,r),1)},t.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+Or)},t.shiftChildren=function(r,s,o){void 0===o&&(o=0);for(var h,a=this._first,l=this.labels;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(s)for(h in l)l[h]>=o&&(l[h]+=r);return E0(this)},t.invalidate=function(r){var s=this._first;for(this._lock=0;s;)s.invalidate(r),s=s._next;return i.prototype.invalidate.call(this,r)},t.clear=function(r){void 0===r&&(r=!0);for(var o,s=this._first;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),E0(this)},t.totalDuration=function(r){var h,f,m,s=0,o=this,a=o._last,l=rh;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(m=o.parent;a;)h=a._prev,a._dirty&&a.totalDuration(),(f=a._start)>l&&o._sort&&a._ts&&!o._lock?(o._lock=1,Gf(o,a,f-a._delay,1)._lock=0):l=f,f<0&&a._ts&&(s-=f,(!m&&!o._dp||m&&m.smoothChildTiming)&&(o._start+=f/o._ts,o._time-=f,o._tTime-=f),o.shiftChildren(-f,!1,-1/0),l=0),a._end>s&&a._ts&&(s=a._end),a=h;FT(o,o===Us&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(r){if(Us._ts&&($6(Us,DP(r,Us)),Y6=uu.frame),uu.frame>=K6){K6+=au.autoSleep||120;var s=Us._first;if((!s||!s._ts)&&au.autoSleep&&uu._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||uu.sleep()}}},e}(kT);oh(mc.prototype,{_lock:0,_hasPause:0,_forcing:0});var P_,nj,Ese=function(e,t,n,r,s,o,a){var m,g,v,y,b,T,S,C,l=new gc(this._pt,e,t,0,1,AW,null,s),h=0,f=0;for(l.b=n,l.e=r,n+="",(S=~(r+="").indexOf("random("))&&(r=kE(r)),o&&(o(C=[n,r],e,t),n=C[0],r=C[1]),g=n.match(B3)||[];m=B3.exec(r);)y=m[0],b=r.substring(h,m.index),v?v=(v+1)%5:"rgba("===b.substr(-5)&&(v=1),y!==g[f++]&&(T=parseFloat(g[f-1])||0,l._pt={_next:l._pt,p:b||1===f?b:",",s:T,c:"="===y.charAt(1)?IT(T,y)-T:parseFloat(y)-T,m:v&&v<4?Math.round:0},h=B3.lastIndex);return l.c=h<r.length?r.substring(h,r.length):"",l.fp=a,(z6.test(r)||S)&&(l.e=0),this._pt=l,l},tj=function(e,t,n,r,s,o,a,l,h,f){no(r)&&(r=r(s||0,e,o));var y,m=e[t],g="get"!==n?n:no(m)?h?e[t.indexOf("set")||!no(e["get"+t.substr(3)])?t:"get"+t.substr(3)](h):e[t]():m,v=no(m)?h?Pse:CW:rj;if(xa(r)&&(~r.indexOf("random(")&&(r=kE(r)),"="===r.charAt(1)&&((y=IT(g,r)+(dl(g)||0))||0===y)&&(r=y)),!f||g!==r||nj)return isNaN(g*r)||""===r?(!m&&!(t in e)&&V3(t,r),Ese.call(this,e,t,g,r,v,l||au.stringFilter,h)):(y=new gc(this._pt,e,t,+g||0,r-(g||0),"boolean"==typeof m?Lse:EW,0,v),h&&(y.fp=h),a&&y.modifier(a,this,e),this._pt=y)},wW=function(e,t,n,r,s,o){var a,l,h,f;if(cu[e]&&!1!==(a=new cu[e]).init(s,a.rawVars?t[e]:function(e,t,n,r,s){if(no(e)&&(e=UE(e,s,t,n,r)),!Vf(e)||e.style&&e.nodeType||hl(e)||V6(e))return xa(e)?UE(e,s,t,n,r):e;var a,o={};for(a in e)o[a]=UE(e[a],s,t,n,r);return o}(t[e],r,s,o,n),n,r,o)&&(n._pt=l=new gc(n._pt,s,e,0,1,a.render,a,0,a.priority),n!==LT))for(h=n._ptLookup[n._targets.indexOf(s)],f=a._props.length;f--;)h[a._props[f]]=l;return a},ij=function i(e,t,n){var U,k,z,K,te,fe,ie,ne,le,Z,he,me,ce,r=e.vars,s=r.ease,o=r.startAt,a=r.immediateRender,l=r.lazy,h=r.onUpdate,f=r.onUpdateParams,m=r.callbackScope,g=r.runBackwards,v=r.yoyoEase,y=r.keyframes,b=r.autoRevert,T=e._dur,S=e._startAt,C=e._targets,R=e.parent,I=R&&"nested"===R.data?R.vars.targets:C,L="auto"===e._overwrite&&!L3,N=e.timeline;if(N&&(!y||!s)&&(s="none"),e._ease=A0(s,DT.ease),e._yEase=v?yW(A0(!0===v?s:v,DT.ease)):0,v&&e._yoyo&&!e._repeat&&(v=e._yEase,e._yEase=e._ease,e._ease=v),e._from=!N&&!!r.runBackwards,!N||y&&!r.stagger){if(me=(ne=C[0]?S0(C[0]).harness:0)&&r[ne.prop],U=EP(r,G3),S&&(S._zTime<0&&S.progress(1),t<0&&g&&a&&!b?S.render(-1,!0):S.revert(g&&T?MP:tse),S._lazy=0),o){if(D_(e._startAt=na.set(C,oh({data:"isStart",overwrite:!1,parent:R,immediateRender:!0,lazy:fc(l),startAt:null,delay:0,onUpdate:h,onUpdateParams:f,callbackScope:m,stagger:0},o))),e._startAt._dp=0,t<0&&(dc||!a&&!b)&&e._startAt.revert(MP),a&&T&&t<=0&&n<=0)return void(t&&(e._zTime=t))}else if(g&&T&&!S)if(t&&(a=!1),z=oh({overwrite:!1,data:"isFromStart",lazy:a&&fc(l),immediateRender:a,stagger:0,parent:R},U),me&&(z[ne.prop]=me),D_(e._startAt=na.set(C,z)),e._startAt._dp=0,t<0&&(dc?e._startAt.revert(MP):e._startAt.render(-1,!0)),e._zTime=t,a){if(!t)return}else i(e._startAt,Or,Or);for(e._pt=e._ptCache=0,l=T&&fc(l)||l&&!T,k=0;k<C.length;k++){if(ie=(te=C[k])._gsap||q3(C)[k]._gsap,e._ptLookup[k]=Z={},z3[ie.id]&&A_.length&&CP(),he=I===C?k:I.indexOf(te),ne&&!1!==(le=new ne).init(te,me||U,e,he,I)&&(e._pt=K=new gc(e._pt,te,le.name,0,1,le.render,le,0,le.priority),le._props.forEach(function(be){Z[be]=K}),le.priority&&(fe=1)),!ne||me)for(z in U)cu[z]&&(le=wW(z,U,e,he,te,I))?le.priority&&(fe=1):Z[z]=K=tj.call(e,te,z,"get",U[z],he,I,0,r.stringFilter);e._op&&e._op[k]&&e.kill(te,e._op[k]),L&&e._pt&&(P_=e,Us.killTweensOf(te,Z,e.globalTime(t)),ce=!e.parent,P_=0),e._pt&&l&&(z3[ie.id]=1)}fe&&DW(e),e._onInit&&e._onInit(e)}e._onUpdate=h,e._initted=(!e._op||e._pt)&&!ce,y&&t<=0&&N.render(rh,!0,!0)},Ise=function(e,t,n,r){var o,a,s=t.ease||r||"power1.inOut";if(hl(t))a=n[e]||(n[e]=[]),t.forEach(function(l,h){return a.push({t:h/(t.length-1)*100,v:l,e:s})});else for(o in t)a=n[o]||(n[o]=[]),"ease"===o||a.push({t:parseFloat(e),v:t[o],e:s})},UE=function(e,t,n,r,s){return no(e)?e.call(t,n,r,s):xa(e)&&~e.indexOf("random(")?kE(e):e},MW=W3+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",SW={};pc(MW+",id,stagger,delay,duration,paused,scrollTrigger",function(i){return SW[i]=1});var na=function(i){function e(n,r,s,o){var a;"number"==typeof r&&(s.duration=r,r=s,s=null);var I,L,N,U,k,z,K,te,l=(a=i.call(this,o?r:FE(r))||this).vars,h=l.duration,f=l.delay,m=l.immediateRender,g=l.stagger,v=l.overwrite,y=l.keyframes,b=l.defaults,T=l.scrollTrigger,S=l.yoyoEase,C=r.parent||Us,R=(hl(n)||V6(n)?wm(n[0]):"length"in r)?[n]:lh(n);if(a._targets=R.length?q3(R):wP("GSAP target "+n+" not found. https://greensock.com",!au.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=v,y||g||xP(h)||xP(f)){if(r=a.vars,(I=a.timeline=new mc({data:"nested",defaults:b||{},targets:C&&"nested"===C.data?C.vars.targets:R})).kill(),I.parent=I._dp=Tm(a),I._start=0,g||xP(h)||xP(f)){if(U=R.length,K=g&&cW(g),Vf(g))for(k in g)~MW.indexOf(k)&&(te||(te={}),te[k]=g[k]);for(L=0;L<U;L++)(N=EP(r,SW)).stagger=0,S&&(N.yoyoEase=S),te&&C0(N,te),z=R[L],N.duration=+UE(h,Tm(a),L,z,R),N.delay=(+UE(f,Tm(a),L,z,R)||0)-a._delay,!g&&1===U&&N.delay&&(a._delay=f=N.delay,a._start+=f,N.delay=0),I.to(z,N,K?K(L,z,R):0),I._ease=Ji.none;I.duration()?h=f=0:a.timeline=0}else if(y){FE(oh(I.vars.defaults,{ease:"none"})),I._ease=A0(y.ease||r.ease||"none");var ie,ne,le,fe=0;if(hl(y))y.forEach(function(Z){return I.to(R,Z,">")}),I.duration();else{for(k in N={},y)"ease"===k||"easeEach"===k||Ise(k,y[k],N,y.easeEach);for(k in N)for(ie=N[k].sort(function(Z,he){return Z.t-he.t}),fe=0,L=0;L<ie.length;L++)(le={ease:(ne=ie[L]).e,duration:(ne.t-(L?ie[L-1].t:0))/100*h})[k]=ne.v,I.to(R,le,fe),fe+=le.duration;I.duration()<h&&I.to({},{duration:h-I.duration()})}}h||a.duration(h=I.duration())}else a.timeline=0;return!0===v&&!L3&&(P_=Tm(a),Us.killTweensOf(R),P_=0),Gf(C,Tm(a),s),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(m||!h&&!y&&a._start===ja(C._time)&&fc(m)&&ase(Tm(a))&&"nested"!==C.data)&&(a._tTime=-Or,a.render(Math.max(0,-f)||0)),T&&rW(Tm(a),T),a}B6(e,i);var t=e.prototype;return t.render=function(r,s,o){var g,v,y,b,T,S,C,R,I,a=this._time,l=this._tDur,h=this._dur,f=r<0,m=r>l-Or&&!f?l:r<Or?0:r;if(h){if(m!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==f){if(g=m,R=this.timeline,this._repeat){if(b=h+this._rDelay,this._repeat<-1&&f)return this.totalTime(100*b+r,s,o);if(g=ja(m%b),m===l?(y=this._repeat,g=h):((y=~~(m/b))&&y===m/b&&(g=h,y--),g>h&&(g=h)),(S=this._yoyo&&1&y)&&(I=this._yEase,g=h-g),T=PT(this._tTime,b),g===a&&!o&&this._initted)return this._tTime=m,this;y!==T&&(R&&this._yEase&&bW(R,S),this.vars.repeatRefresh&&!S&&!this._lock&&(this._lock=o=1,this.render(ja(b*y),!0).invalidate()._lock=0))}if(!this._initted){if(sW(this,f?r:g,o,s,m))return this._tTime=0,this;if(a!==this._time)return this;if(h!==this._dur)return this.render(r,s,o)}if(this._tTime=m,this._time=g,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=C=(I||this._ease)(g/h),this._from&&(this.ratio=C=1-C),g&&!a&&!s&&(ch(this,"onStart"),this._tTime!==m))return this;for(v=this._pt;v;)v.r(C,v.d),v=v._next;R&&R.render(r<0?r:!g&&S?-Or:R._dur*R._ease(g/this._dur),s,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!s&&(f&&Z3(this,r,0,o),ch(this,"onUpdate")),this._repeat&&y!==T&&this.vars.onRepeat&&!s&&this.parent&&ch(this,"onRepeat"),(m===this._tDur||!m)&&this._tTime===m&&(f&&!this._onUpdate&&Z3(this,r,0,!0),(r||!h)&&(m===this._tDur&&this._ts>0||!m&&this._ts<0)&&D_(this,1),!s&&(!f||a)&&(m||a||S)&&(ch(this,m===l?"onComplete":"onReverseComplete",!0),this._prom&&!(m<l&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,n,r){var h,f,m,s=e.ratio,o=t<0||!t&&(!e._start&&lse(e)&&(e._initted||!Y3(e))||(e._ts<0||e._dp._ts<0)&&!Y3(e))?0:1,a=e._rDelay,l=0;if(a&&e._repeat&&(l=OE(0,e._tDur,t),f=PT(l,a),e._yoyo&&1&f&&(o=1-o),f!==PT(e._tTime,a)&&(s=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==s||dc||r||e._zTime===Or||!t&&e._zTime){if(!e._initted&&sW(e,t,r,n,l))return;for(m=e._zTime,e._zTime=t||(n?Or:0),n||(n=t&&!m),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=l,h=e._pt;h;)h.r(o,h.d),h=h._next;t<0&&Z3(e,t,0,!0),e._onUpdate&&!n&&ch(e,"onUpdate"),l&&e._repeat&&!n&&e.parent&&ch(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&D_(e,1),!n&&!dc&&(ch(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,r,s,o);return this},t.targets=function(){return this._targets},t.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),i.prototype.invalidate.call(this,r)},t.resetTo=function(r,s,o,a){jE||uu.wake(),this._ts||this.play();var l=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||ij(this,l),function(e,t,n,r,s,o,a){var h,f,m,g,l=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!l)for(l=e._ptCache[t]=[],m=e._ptLookup,g=e._targets.length;g--;){if((h=m[g][t])&&h.d&&h.d._pt)for(h=h.d._pt;h&&h.p!==t&&h.fp!==t;)h=h._next;if(!h)return nj=1,e.vars[t]="+=0",ij(e,a),nj=0,1;l.push(h)}for(g=l.length;g--;)(h=(f=l[g])._pt||f).s=!r&&0!==r||s?h.s+(r||0)+o*h.c:r,h.c=n-h.s,f.e&&(f.e=_o(n)+dl(f.e)),f.b&&(f.b=h.s+dl(f.b))}(this,r,s,o,a,this._ease(l/this._dur),l)?this.resetTo(r,s,o,a):(IP(this,0),this.parent||tW(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(r,s){if(void 0===s&&(s="all"),!(r||s&&"all"!==s))return this._lazy=this._pt=0,this.parent?NE(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,s,P_&&!0!==P_.vars.overwrite)._first||NE(this),this.parent&&o!==this.timeline.totalDuration()&&FT(this,this._dur*this.timeline._tDur/o,0,1),this}var m,g,v,y,b,T,S,a=this._targets,l=r?lh(r):a,h=this._ptLookup,f=this._pt;if((!s||"all"===s)&&function(e,t){for(var n=e.length,r=n===t.length;r&&n--&&e[n]===t[n];);return n<0}(a,l))return"all"===s&&(this._pt=0),NE(this);for(m=this._op=this._op||[],"all"!==s&&(xa(s)&&(b={},pc(s,function(C){return b[C]=1}),s=b),s=function(e,t){var s,o,a,l,n=e[0]?S0(e[0]).harness:0,r=n&&n.aliases;if(!r)return t;for(o in s=C0({},t),r)if(o in s)for(a=(l=r[o].split(",")).length;a--;)s[l[a]]=s[o];return s}(a,s)),S=a.length;S--;)if(~l.indexOf(a[S]))for(b in g=h[S],"all"===s?(m[S]=s,y=g,v={}):(v=m[S]=m[S]||{},y=s),y)(T=g&&g[b])&&((!("kill"in T.d)||!0===T.d.kill(b))&&AP(this,T,"_pt"),delete g[b]),"all"!==v&&(v[b]=1);return this._initted&&!this._pt&&f&&NE(this),this},e.to=function(r,s){return new e(r,s,arguments[2])},e.from=function(r,s){return LE(1,arguments)},e.delayedCall=function(r,s,o,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(r,s,o){return LE(2,arguments)},e.set=function(r,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(r,s)},e.killTweensOf=function(r,s,o){return Us.killTweensOf(r,s,o)},e}(kT);oh(na.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),pc("staggerTo,staggerFrom,staggerFromTo",function(i){na[i]=function(){var e=new mc,t=K3.call(arguments,0);return t.splice("staggerFromTo"===i?5:4,0,0),e[i].apply(e,t)}});var rj=function(e,t,n){return e[t]=n},CW=function(e,t,n){return e[t](n)},Pse=function(e,t,n,r){return e[t](r.fp,n)},Fse=function(e,t,n){return e.setAttribute(t,n)},sj=function(e,t){return no(e[t])?CW:k3(e[t])&&e.setAttribute?Fse:rj},EW=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},Lse=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},AW=function(e,t){var n=t._pt,r="";if(!e&&t.b)r=t.b;else if(1===e&&t.e)r=t.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*e):Math.round(1e4*(n.s+n.c*e))/1e4)+r,n=n._next;r+=t.c}t.set(t.t,t.p,r,t)},oj=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},Ose=function(e,t,n,r){for(var o,s=this._pt;s;)o=s._next,s.p===r&&s.modifier(e,t,n),s=o},kse=function(e){for(var n,r,t=this._pt;t;)r=t._next,t.p===e&&!t.op||t.op===e?AP(this,t,"_pt"):t.dep||(n=1),t=r;return!n},Nse=function(e,t,n,r){r.mSet(e,t,r.m.call(r.tween,n,r.mt),r)},DW=function(e){for(var n,r,s,o,t=e._pt;t;){for(n=t._next,r=s;r&&r.pr>t.pr;)r=r._next;(t._prev=r?r._prev:o)?t._prev._next=t:s=t,(t._next=r)?r._prev=t:o=t,t=n}e._pt=s},gc=function(){function i(t,n,r,s,o,a,l,h,f){this.t=n,this.s=s,this.c=o,this.p=r,this.r=a||EW,this.d=l||this,this.set=h||rj,this.pr=f||0,this._next=t,t&&(t._prev=this)}return i.prototype.modifier=function(n,r,s){this.mSet=this.mSet||this.set,this.set=Nse,this.m=n,this.mt=s,this.tween=r},i}();pc(W3+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(i){return G3[i]=1}),lu.TweenMax=lu.TweenLite=na,lu.TimelineLite=lu.TimelineMax=mc,Us=new mc({sortChildren:!1,defaults:DT,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),au.stringFilter=vW;var NT=[],PP={},Bse=[],RW=0,aj=function(e){return(PP[e]||Bse).map(function(t){return t()})},lj=function(){var e=Date.now(),t=[];e-RW>2&&(aj("matchMediaInit"),NT.forEach(function(n){var o,a,l,h,r=n.queries,s=n.conditions;for(a in r)(o=sh.matchMedia(r[a]).matches)&&(l=1),o!==s[a]&&(s[a]=o,h=1);h&&(n.revert(),l&&t.push(n))}),aj("matchMediaRevert"),t.forEach(function(n){return n.onMatch(n)}),RW=e,aj("matchMedia"))},IW=function(){function i(t,n){this.selector=n&&X3(n),this.data=[],this._r=[],this.isReverted=!1,t&&this.add(t)}var e=i.prototype;return e.add=function(n,r,s){no(n)&&(s=r,r=n,n=no);var o=this,a=function(){var m,h=No,f=o.selector;return h&&h!==o&&h.data.push(o),s&&(o.selector=X3(s)),No=o,m=r.apply(o,arguments),no(m)&&o._r.push(m),No=h,o.selector=f,o.isReverted=!1,m};return o.last=a,n===no?a(o):n?o[n]=a:a},e.ignore=function(n){var r=No;No=null,n(this),No=r},e.getTweens=function(){var n=[];return this.data.forEach(function(r){return r instanceof i?n.push.apply(n,r.getTweens()):r instanceof na&&!(r.parent&&"nested"===r.parent.data)&&n.push(r)}),n},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(n,r){var s=this;if(n){var o=this.getTweens();this.data.forEach(function(l){"isFlip"===l.data&&(l.revert(),l.getChildren(!0,!0,!1).forEach(function(h){return o.splice(o.indexOf(h),1)}))}),o.map(function(l){return{g:l.globalTime(0),t:l}}).sort(function(l,h){return h.g-l.g||-1}).forEach(function(l){return l.t.revert(n)}),this.data.forEach(function(l){return!(l instanceof kT)&&l.revert&&l.revert(n)}),this._r.forEach(function(l){return l(n,s)}),this.isReverted=!0}else this.data.forEach(function(l){return l.kill&&l.kill()});if(this.clear(),r){var a=NT.indexOf(this);~a&&NT.splice(a,1)}},e.revert=function(n){this.kill(n||{})},i}(),jse=function(){function i(t){this.contexts=[],this.scope=t}var e=i.prototype;return e.add=function(n,r,s){Vf(n)||(n={matches:n});var l,h,f,o=new IW(0,s||this.scope),a=o.conditions={};for(h in this.contexts.push(o),r=o.add("onMatch",r),o.queries=n,n)"all"===h?f=1:(l=sh.matchMedia(n[h]))&&(NT.indexOf(o)<0&&NT.push(o),(a[h]=l.matches)&&(f=1),l.addListener?l.addListener(lj):l.addEventListener("change",lj));return f&&r(o),this},e.revert=function(n){this.kill(n||{})},e.kill=function(n){this.contexts.forEach(function(r){return r.kill(n,!0)})},i}(),FP={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(r){return bse(r)})},timeline:function(e){return new mc(e)},getTweensOf:function(e,t){return Us.getTweensOf(e,t)},getProperty:function(e,t,n,r){xa(e)&&(e=lh(e)[0]);var s=S0(e||{}).get,o=n?J6:Q6;return"native"===n&&(n=""),e&&(t?o((cu[t]&&cu[t].get||s)(e,t,n,r)):function(a,l,h){return o((cu[a]&&cu[a].get||s)(e,a,l,h))})},quickSetter:function(e,t,n){if((e=lh(e)).length>1){var r=e.map(function(f){return hu.quickSetter(f,t,n)}),s=r.length;return function(f){for(var m=s;m--;)r[m](f)}}var o=cu[t],a=S0(e=e[0]||{}),l=a.harness&&(a.harness.aliases||{})[t]||t,h=o?function(f){var m=new o;LT._pt=0,m.init(e,n?f+n:f,LT,0,[e]),m.render(1,m),LT._pt&&oj(1,LT)}:a.set(e,l);return o?h:function(f){return h(e,l,n?f+n:f,a,1)}},quickTo:function(e,t,n){var r,s=hu.to(e,C0(((r={})[t]="+=0.1",r.paused=!0,r),n||{})),o=function(l,h,f){return s.resetTo(t,l,h,f)};return o.tween=s,o},isTweening:function(e){return Us.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=A0(e.ease,DT.ease)),eW(DT,e||{})},config:function(e){return eW(au,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,s=e.defaults,o=e.extendTimeline;(e.plugins||"").split(",").forEach(function(a){return a&&!cu[a]&&!lu[a]&&wP(t+" effect requires "+a+" plugin.")}),H3[t]=function(a,l,h){return n(lh(a),oh(l||{},s),h)},o&&(mc.prototype[t]=function(a,l,h){return this.add(H3[t](a,Vf(l)?l:(h=l)&&{},this),h)})},registerEase:function(e,t){Ji[e]=A0(t)},parseEase:function(e,t){return arguments.length?A0(e,t):Ji},getById:function(e){return Us.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var r,s,n=new mc(e);for(n.smoothChildTiming=fc(e.smoothChildTiming),Us.remove(n),n._dp=0,n._time=n._tTime=Us._time,r=Us._first;r;)s=r._next,(t||!(!r._dur&&r instanceof na&&r.vars.onComplete===r._targets[0]))&&Gf(n,r,r._start-r._delay),r=s;return Gf(Us,n,0),n},context:function(e,t){return e?new IW(e,t):No},matchMedia:function(e){return new jse(e)},matchMediaRefresh:function(){return NT.forEach(function(e){var n,r,t=e.conditions;for(r in t)t[r]&&(t[r]=!1,n=1);n&&e.revert()})||lj()},addEventListener:function(e,t){var n=PP[e]||(PP[e]=[]);~n.indexOf(t)||n.push(t)},removeEventListener:function(e,t){var n=PP[e],r=n&&n.indexOf(t);r>=0&&n.splice(r,1)},utils:{wrap:function i(e,t,n){var r=t-e;return hl(e)?dW(e,i(0,e.length),t):R_(n,function(s){return(r+(s-e)%r)%r+e})},wrapYoyo:function i(e,t,n){var r=t-e,s=2*r;return hl(e)?dW(e,i(0,e.length-1),t):R_(n,function(o){return e+((o=(s+(o-e)%s)%s||0)>r?s-o:o)})},distribute:cW,random:hW,snap:uW,normalize:function(e,t,n){return fW(e,t,0,1,n)},getUnit:dl,clamp:function(e,t,n){return R_(n,function(r){return OE(e,t,r)})},splitColor:mW,toArray:lh,selector:X3,mapRange:fW,pipe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){return t.reduce(function(s,o){return o(s)},r)}},unitize:function(e,t){return function(n){return e(parseFloat(n))+(t||dl(n))}},interpolate:function i(e,t,n,r){var s=isNaN(e+t)?0:function(v){return(1-v)*e+v*t};if(!s){var l,h,f,m,g,o=xa(e),a={};if(!0===n&&(r=1)&&(n=null),o)e={p:e},t={p:t};else if(hl(e)&&!hl(t)){for(f=[],g=(m=e.length)-2,h=1;h<m;h++)f.push(i(e[h-1],e[h]));m--,s=function(y){y*=m;var b=Math.min(g,~~y);return f[b](y-b)},n=t}else r||(e=C0(hl(e)?[]:{},e));if(!f){for(l in t)tj.call(a,e,l,"get",t[l]);s=function(y){return oj(y,a)||(o?e.p:e)}}}return R_(n,s)},shuffle:lW},install:q6,effects:H3,ticker:uu,updateRoot:mc.updateRoot,plugins:cu,globalTimeline:Us,core:{PropTween:gc,globals:Z6,Tween:na,Timeline:mc,Animation:kT,getCache:S0,_removeLinkedListItem:AP,reverting:function(){return dc},context:function(e){return e&&No&&(No.data.push(e),e._ctx=No),No},suppressOverwrites:function(e){return L3=e}}};pc("to,from,fromTo,delayedCall,set,killTweensOf",function(i){return FP[i]=na[i]}),uu.add(mc.updateRoot),LT=FP.to({},{duration:0});var Use=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},cj=function(e,t){return{name:e,rawVars:1,init:function(r,s,o){o._onInit=function(a){var l,h;if(xa(s)&&(l={},pc(s,function(f){return l[f]=1}),s=l),t){for(h in l={},s)l[h]=t(s[h]);s=l}!function(e,t){var r,s,o,n=e._targets;for(r in t)for(s=n.length;s--;)(o=e._ptLookup[s][r])&&(o=o.d)&&(o._pt&&(o=Use(o,r)),o&&o.modifier&&o.modifier(t[r],e,n[s],r))}(a,s)}}}},hu=FP.registerPlugin({name:"attr",init:function(e,t,n,r,s){var o,a,l;for(o in this.tween=n,t)l=e.getAttribute(o)||"",(a=this.add(e,"setAttribute",(l||0)+"",t[o],r,s,0,0,o)).op=o,a.b=l,this._props.push(o)},render:function(e,t){for(var n=t._pt;n;)dc?n.set(n.t,n.p,n.b,n):n.r(e,n.d),n=n._next}},{name:"endArray",init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n],0,0,0,0,0,1)}},cj("roundProps",$3),cj("modifiers"),cj("snap",uW))||FP;na.version=mc.version=hu.version="3.11.3",W6=1,U6()&&OT();var PW,F_,BT,uj,R0,FW,hj,jW,Mm={},I0=180/Math.PI,jT=Math.PI/180,UT=Math.atan2,LW=1e8,dj=/([A-Z])/g,Hse=/(left|right|width|margin|padding|x)/i,Wse=/[\s,\(]\S/,Sm={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},fj=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},qse=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},Zse=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},Yse=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},OW=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},kW=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},Kse=function(e,t,n){return e.style[t]=n},Xse=function(e,t,n){return e.style.setProperty(t,n)},$se=function(e,t,n){return e._gsap[t]=n},Qse=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},Jse=function(e,t,n,r,s){var o=e._gsap;o.scaleX=o.scaleY=n,o.renderTransform(s,o)},eoe=function(e,t,n,r,s){var o=e._gsap;o[t]=n,o.renderTransform(s,o)},Vs="transform",md=Vs+"Origin",toe=function(e,t){var n=this,r=this.target,s=r.style;if(e in Mm){if(this.tfm=this.tfm||{},"transform"!==e&&(~(e=Sm[e]||e).indexOf(",")?e.split(",").forEach(function(o){return n.tfm[o]=Cm(r,o)}):this.tfm[e]=r._gsap.x?r._gsap[e]:Cm(r,e)),this.props.indexOf(Vs)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(md,t,"")),e=Vs}(s||t)&&this.props.push(e,t,s[e])},NW=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},noe=function(){var s,o,e=this.props,t=this.target,n=t.style,r=t._gsap;for(s=0;s<e.length;s+=3)e[s+1]?t[e[s]]=e[s+2]:e[s+2]?n[e[s]]=e[s+2]:n.removeProperty(e[s].replace(dj,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),(s=hj())&&!s.isStart&&!n[Vs]&&(NW(n),r.uncache=1)}},BW=function(e,t){var n={target:e,props:[],revert:noe,save:toe};return t&&t.split(",").forEach(function(r){return n.save(r)}),n},pj=function(e,t){var n=F_.createElementNS?F_.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):F_.createElement(e);return n.style?n:F_.createElement(e)},zf=function i(e,t,n){var r=getComputedStyle(e);return r[t]||r.getPropertyValue(t.replace(dj,"-$1").toLowerCase())||r.getPropertyValue(t)||!n&&i(e,VT(t)||t,1)||""},UW="O,Moz,ms,Ms,Webkit".split(","),VT=function(e,t,n){var s=(t||R0).style,o=5;if(e in s&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(UW[o]+e in s););return o<0?null:(3===o?"ms":o>=0?UW[o]:"")+e},mj=function(){typeof window<"u"&&window.document&&(PW=window,BT=(F_=PW.document).documentElement,R0=pj("div")||{style:{}},pj("div"),Vs=VT(Vs),md=Vs+"Origin",R0.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",jW=!!VT("perspective"),hj=hu.core.reverting,uj=1)},gj=function i(e){var o,t=pj("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=this.parentNode,r=this.nextSibling,s=this.style.cssText;if(BT.appendChild(t),t.appendChild(this),this.style.display="block",e)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=i}catch{}else this._gsapBBox&&(o=this._gsapBBox());return n&&(r?n.insertBefore(this,r):n.appendChild(this)),BT.removeChild(t),this.style.cssText=s,o},VW=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},GW=function(e){var t;try{t=e.getBBox()}catch{t=gj.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===gj||(t=gj.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+VW(e,["x","cx","x1"])||0,y:+VW(e,["y","cy","y1"])||0,width:0,height:0}},zW=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!GW(e))},VE=function(e,t){if(t){var n=e.style;t in Mm&&t!==md&&(t=Vs),n.removeProperty?(("ms"===t.substr(0,2)||"webkit"===t.substr(0,6))&&(t="-"+t),n.removeProperty(t.replace(dj,"-$1").toLowerCase())):n.removeAttribute(t)}},L_=function(e,t,n,r,s,o){var a=new gc(e._pt,t,n,0,1,o?kW:OW);return e._pt=a,a.b=r,a.e=s,e._props.push(n),a},HW={deg:1,rad:1,turn:1},ioe={grid:1,flex:1},O_=function i(e,t,n,r){var y,b,T,S,s=parseFloat(n)||0,o=(n+"").trim().substr((s+"").length)||"px",a=R0.style,l=Hse.test(t),h="svg"===e.tagName.toLowerCase(),f=(h?"client":"offset")+(l?"Width":"Height"),m=100,g="px"===r,v="%"===r;return r===o||!s||HW[r]||HW[o]?s:("px"!==o&&!g&&(s=i(e,t,n,"px")),S=e.getCTM&&zW(e),!v&&"%"!==o||!Mm[t]&&!~t.indexOf("adius")?(a[l?"width":"height"]=m+(g?o:r),b=~t.indexOf("adius")||"em"===r&&e.appendChild&&!h?e:e.parentNode,S&&(b=(e.ownerSVGElement||{}).parentNode),(!b||b===F_||!b.appendChild)&&(b=F_.body),(T=b._gsap)&&v&&T.width&&l&&T.time===uu.time&&!T.uncache?_o(s/T.width*m):((v||"%"===o)&&!ioe[zf(b,"display")]&&(a.position=zf(e,"position")),b===e&&(a.position="static"),b.appendChild(R0),y=R0[f],b.removeChild(R0),a.position="absolute",l&&v&&((T=S0(b)).time=uu.time,T.width=b[f]),_o(g?y*s/m:y&&s?m/y*s:0))):(y=S?e.getBBox()[l?"width":"height"]:e[f],_o(v?s/y*m:s/100*y)))},Cm=function(e,t,n,r){var s;return uj||mj(),t in Sm&&"transform"!==t&&~(t=Sm[t]).indexOf(",")&&(t=t.split(",")[0]),Mm[t]&&"transform"!==t?(s=zE(e,r),s="transformOrigin"!==t?s[t]:s.svg?s.origin:OP(zf(e,md))+" "+s.zOrigin+"px"):(!(s=e.style[t])||"auto"===s||r||~(s+"").indexOf("calc("))&&(s=LP[t]&&LP[t](e,t,n)||zf(e,t)||X6(e,t)||("opacity"===t?1:0)),n&&!~(s+"").trim().indexOf(" ")?O_(e,t,s,n)+n:s},roe=function(e,t,n,r){if(!n||"none"===n){var s=VT(t,e,1),o=s&&zf(e,s,1);o&&o!==n?(t=s,n=o):"borderColor"===t&&(n=zf(e,"borderTopColor"))}var f,m,g,v,y,b,T,S,C,R,I,a=new gc(this._pt,e.style,t,0,1,AW),l=0,h=0;if(a.b=n,a.e=r,n+="","auto"==(r+="")&&(e.style[t]=r,r=zf(e,t)||r,e.style[t]=n),vW(f=[n,r]),r=f[1],g=(n=f[0]).match(RT)||[],(r.match(RT)||[]).length){for(;m=RT.exec(r);)T=m[0],C=r.substring(l,m.index),y?y=(y+1)%5:("rgba("===C.substr(-5)||"hsla("===C.substr(-5))&&(y=1),T!==(b=g[h++]||"")&&(v=parseFloat(b)||0,I=b.substr((v+"").length),"="===T.charAt(1)&&(T=IT(v,T)+I),S=parseFloat(T),R=T.substr((S+"").length),l=RT.lastIndex-R.length,R||(R=R||au.units[t]||I,l===r.length&&(r+=R,a.e+=R)),I!==R&&(v=O_(e,t,b,R)||0),a._pt={_next:a._pt,p:C||1===h?C:",",s:v,c:S-v,m:y&&y<4||"zIndex"===t?Math.round:0});a.c=l<r.length?r.substring(l,r.length):""}else a.r="display"===t&&"none"===r?kW:OW;return z6.test(r)&&(a.e=0),this._pt=a,a},WW={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},soe=function(e){var t=e.split(" "),n=t[0],r=t[1]||"50%";return("top"===n||"bottom"===n||"left"===r||"right"===r)&&(e=n,n=r,r=e),t[0]=WW[n]||n,t[1]=WW[r]||r,t.join(" ")},ooe=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var a,l,h,n=t.t,r=n.style,s=t.u,o=n._gsap;if("all"===s||!0===s)r.cssText="",l=1;else for(h=(s=s.split(",")).length;--h>-1;)Mm[a=s[h]]&&(l=1,a="transformOrigin"===a?md:Vs),VE(n,a);l&&(VE(n,Vs),o&&(o.svg&&n.removeAttribute("transform"),zE(n,1),o.uncache=1,NW(r)))}},LP={clearProps:function(e,t,n,r,s){if("isFromStart"!==s.data){var o=e._pt=new gc(e._pt,t,n,0,0,ooe);return o.u=r,o.pr=-10,o.tween=s,e._props.push(n),1}}},GE=[1,0,0,1,0,0],qW={},ZW=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},YW=function(e){var t=zf(e,Vs);return ZW(t)?GE:t.substr(7).match(G6).map(_o)},_j=function(e,t){var o,a,l,h,n=e._gsap||S0(e),r=e.style,s=YW(e);return n.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(s=[(l=e.transform.baseVal.consolidate().matrix).a,l.b,l.c,l.d,l.e,l.f]).join(",")?GE:s:(s===GE&&!e.offsetParent&&e!==BT&&!n.svg&&(l=r.display,r.display="block",(!(o=e.parentNode)||!e.offsetParent)&&(h=1,a=e.nextElementSibling,BT.appendChild(e)),s=YW(e),l?r.display=l:VE(e,"display"),h&&(a?o.insertBefore(e,a):o?o.appendChild(e):BT.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},vj=function(e,t,n,r,s,o){var N,U,z,a=e._gsap,l=s||_j(e,!0),h=a.xOrigin||0,f=a.yOrigin||0,m=a.xOffset||0,g=a.yOffset||0,v=l[0],y=l[1],b=l[2],T=l[3],S=l[4],C=l[5],R=t.split(" "),I=parseFloat(R[0])||0,L=parseFloat(R[1])||0;n?l!==GE&&(U=v*T-y*b)&&(z=I*(-y/U)+L*(v/U)-(v*C-y*S)/U,I=I*(T/U)+L*(-b/U)+(b*C-T*S)/U,L=z):(I=(N=GW(e)).x+(~R[0].indexOf("%")?I/100*N.width:I),L=N.y+(~(R[1]||R[0]).indexOf("%")?L/100*N.height:L)),r||!1!==r&&a.smooth?(a.xOffset=m+((S=I-h)*v+(C=L-f)*b)-S,a.yOffset=g+(S*y+C*T)-C):a.xOffset=a.yOffset=0,a.xOrigin=I,a.yOrigin=L,a.smooth=!!r,a.origin=t,a.originIsAbsolute=!!n,e.style[md]="0px 0px",o&&(L_(o,a,"xOrigin",h,I),L_(o,a,"yOrigin",f,L),L_(o,a,"xOffset",m,a.xOffset),L_(o,a,"yOffset",g,a.yOffset)),e.setAttribute("data-svg-origin",I+" "+L)},zE=function(e,t){var n=e._gsap||new TW(e);if("x"in n&&!t&&!n.uncache)return n;var f,m,g,v,y,b,T,S,C,R,I,L,N,U,k,z,K,te,fe,ie,ne,le,Z,he,me,ce,be,Ge,Ee,mt,it,Gt,r=e.style,s=n.scaleX<0,o="px",a="deg",l=getComputedStyle(e),h=zf(e,md)||"0";return f=m=g=b=T=S=C=R=I=0,v=y=1,n.svg=!(!e.getCTM||!zW(e)),l.translate&&(("none"!==l.translate||"none"!==l.scale||"none"!==l.rotate)&&(r[Vs]=("none"!==l.translate?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==l.rotate?"rotate("+l.rotate+") ":"")+("none"!==l.scale?"scale("+l.scale.split(" ").join(",")+") ":"")+("none"!==l[Vs]?l[Vs]:"")),r.scale=r.rotate=r.translate="none"),U=_j(e,n.svg),n.svg&&(n.uncache?(me=e.getBBox(),h=n.xOrigin-me.x+"px "+(n.yOrigin-me.y)+"px",he=""):he=!t&&e.getAttribute("data-svg-origin"),vj(e,he||h,!!he||n.originIsAbsolute,!1!==n.smooth,U)),L=n.xOrigin||0,N=n.yOrigin||0,U!==GE&&(te=U[0],fe=U[1],ie=U[2],ne=U[3],f=le=U[4],m=Z=U[5],6===U.length?(v=Math.sqrt(te*te+fe*fe),y=Math.sqrt(ne*ne+ie*ie),b=te||fe?UT(fe,te)*I0:0,(C=ie||ne?UT(ie,ne)*I0+b:0)&&(y*=Math.abs(Math.cos(C*jT))),n.svg&&(f-=L-(L*te+N*ie),m-=N-(L*fe+N*ne))):(mt=U[7],be=U[8],Ge=U[9],it=U[11],f=U[12],m=U[13],g=U[14],T=(k=UT(Gt=U[6],Ee=U[10]))*I0,k&&(he=le*(z=Math.cos(-k))+be*(K=Math.sin(-k)),me=Z*z+Ge*K,ce=Gt*z+Ee*K,be=le*-K+be*z,Ge=Z*-K+Ge*z,Ee=Gt*-K+Ee*z,it=mt*-K+it*z,le=he,Z=me,Gt=ce),S=(k=UT(-ie,Ee))*I0,k&&(z=Math.cos(-k),it=ne*(K=Math.sin(-k))+it*z,te=he=te*z-be*K,fe=me=fe*z-Ge*K,ie=ce=ie*z-Ee*K),b=(k=UT(fe,te))*I0,k&&(he=te*(z=Math.cos(k))+fe*(K=Math.sin(k)),me=le*z+Z*K,fe=fe*z-te*K,Z=Z*z-le*K,te=he,le=me),T&&Math.abs(T)+Math.abs(b)>359.9&&(T=b=0,S=180-S),v=_o(Math.sqrt(te*te+fe*fe+ie*ie)),y=_o(Math.sqrt(Z*Z+Gt*Gt)),k=UT(le,Z),C=Math.abs(k)>2e-4?k*I0:0,I=it?1/(it<0?-it:it):0),n.svg&&(he=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!ZW(zf(e,Vs)),he&&e.setAttribute("transform",he))),Math.abs(C)>90&&Math.abs(C)<270&&(s?(v*=-1,C+=b<=0?180:-180,b+=b<=0?180:-180):(y*=-1,C+=C<=0?180:-180)),t=t||n.uncache,n.x=f-((n.xPercent=f&&(!t&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-f)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+o,n.y=m-((n.yPercent=m&&(!t&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-m)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+o,n.z=g+o,n.scaleX=_o(v),n.scaleY=_o(y),n.rotation=_o(b)+a,n.rotationX=_o(T)+a,n.rotationY=_o(S)+a,n.skewX=C+a,n.skewY=R+a,n.transformPerspective=I+o,(n.zOrigin=parseFloat(h.split(" ")[2])||0)&&(r[md]=OP(h)),n.xOffset=n.yOffset=0,n.force3D=au.force3D,n.renderTransform=n.svg?loe:jW?KW:aoe,n.uncache=0,n},OP=function(e){return(e=e.split(" "))[0]+" "+e[1]},yj=function(e,t,n){var r=dl(t);return _o(parseFloat(t)+parseFloat(O_(e,"x",n+"px",r)))+r},aoe=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,KW(e,t)},P0="0deg",HE="0px",F0=") ",KW=function(e,t){var n=t||this,r=n.xPercent,s=n.yPercent,o=n.x,a=n.y,l=n.z,h=n.rotation,f=n.rotationY,m=n.rotationX,g=n.skewX,v=n.skewY,y=n.scaleX,b=n.scaleY,T=n.transformPerspective,S=n.force3D,C=n.target,R=n.zOrigin,I="",L="auto"===S&&e&&1!==e||!0===S;if(R&&(m!==P0||f!==P0)){var z,N=parseFloat(f)*jT,U=Math.sin(N),k=Math.cos(N);N=parseFloat(m)*jT,z=Math.cos(N),o=yj(C,o,U*z*-R),a=yj(C,a,-Math.sin(N)*-R),l=yj(C,l,k*z*-R+R)}T!==HE&&(I+="perspective("+T+F0),(r||s)&&(I+="translate("+r+"%, "+s+"%) "),(L||o!==HE||a!==HE||l!==HE)&&(I+=l!==HE||L?"translate3d("+o+", "+a+", "+l+") ":"translate("+o+", "+a+F0),h!==P0&&(I+="rotate("+h+F0),f!==P0&&(I+="rotateY("+f+F0),m!==P0&&(I+="rotateX("+m+F0),(g!==P0||v!==P0)&&(I+="skew("+g+", "+v+F0),(1!==y||1!==b)&&(I+="scale("+y+", "+b+F0),C.style[Vs]=I||"translate(0, 0)"},loe=function(e,t){var L,N,U,k,z,n=t||this,r=n.xPercent,s=n.yPercent,o=n.x,a=n.y,l=n.rotation,h=n.skewX,f=n.skewY,m=n.scaleX,g=n.scaleY,v=n.target,y=n.xOrigin,b=n.yOrigin,T=n.xOffset,S=n.yOffset,C=n.forceCSS,R=parseFloat(o),I=parseFloat(a);l=parseFloat(l),h=parseFloat(h),(f=parseFloat(f))&&(h+=f=parseFloat(f),l+=f),l||h?(l*=jT,h*=jT,L=Math.cos(l)*m,N=Math.sin(l)*m,U=Math.sin(l-h)*-g,k=Math.cos(l-h)*g,h&&(f*=jT,z=Math.tan(h-f),U*=z=Math.sqrt(1+z*z),k*=z,f&&(z=Math.tan(f),L*=z=Math.sqrt(1+z*z),N*=z)),L=_o(L),N=_o(N),U=_o(U),k=_o(k)):(L=m,k=g,N=U=0),(R&&!~(o+"").indexOf("px")||I&&!~(a+"").indexOf("px"))&&(R=O_(v,"x",o,"px"),I=O_(v,"y",a,"px")),(y||b||T||S)&&(R=_o(R+y-(y*L+b*U)+T),I=_o(I+b-(y*N+b*k)+S)),(r||s)&&(z=v.getBBox(),R=_o(R+r/100*z.width),I=_o(I+s/100*z.height)),v.setAttribute("transform",z="matrix("+L+","+N+","+U+","+k+","+R+","+I+")"),C&&(v.style[Vs]=z)},coe=function(e,t,n,r,s){var m,g,o=360,a=xa(s),h=parseFloat(s)*(a&&~s.indexOf("rad")?I0:1)-r,f=r+h+"deg";return a&&("short"===(m=s.split("_")[1])&&(h%=o)!=h%180&&(h+=h<0?o:-o),"cw"===m&&h<0?h=(h+o*LW)%o-~~(h/o)*o:"ccw"===m&&h>0&&(h=(h-o*LW)%o-~~(h/o)*o)),e._pt=g=new gc(e._pt,t,n,r,h,qse),g.e=f,g.u="deg",e._props.push(n),g},XW=function(e,t){for(var n in t)e[n]=t[n];return e},uoe=function(e,t,n){var a,l,h,f,m,g,y,r=XW({},n._gsap),o=n.style;for(l in r.svg?(h=n.getAttribute("transform"),n.setAttribute("transform",""),o[Vs]=t,a=zE(n,1),VE(n,Vs),n.setAttribute("transform",h)):(h=getComputedStyle(n)[Vs],o[Vs]=t,a=zE(n,1),o[Vs]=h),Mm)(h=r[l])!==(f=a[l])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(l)<0&&(m=dl(h)!==(y=dl(f))?O_(n,l,h,y):parseFloat(h),g=parseFloat(f),e._pt=new gc(e._pt,a,l,m,g-m,fj),e._pt.u=y||0,e._props.push(l));XW(a,r)};pc("padding,margin,Width,Radius",function(i,e){var t="Top",n="Right",r="Bottom",s="Left",o=(e<3?[t,n,r,s]:[t+s,t+n,r+n,r+s]).map(function(a){return e<2?i+a:"border"+a+i});LP[e>1?"border"+i:i]=function(a,l,h,f,m){var g,v;if(arguments.length<4)return g=o.map(function(y){return Cm(a,y,h)}),5===(v=g.join(" ")).split(g[0]).length?g[0]:v;g=(f+"").split(" "),v={},o.forEach(function(y,b){return v[y]=g[b]=g[b]||g[(b-1)/2|0]}),a.init(l,v,m)}});var $W={name:"css",register:mj,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,r,s){var h,f,m,g,v,y,b,T,S,C,R,I,L,N,U,k,o=this._props,a=e.style,l=n.vars.startAt;for(b in uj||mj(),this.styles=this.styles||BW(e),k=this.styles.props,this.tween=n,t)if("autoRound"!==b&&(f=t[b],!cu[b]||!wW(b,t,n,r,e,s)))if(y=LP[b],"function"==(v=typeof f)&&(v=typeof(f=f.call(n,r,e,s))),"string"===v&&~f.indexOf("random(")&&(f=kE(f)),y)y(this,e,b,f,n)&&(U=1);else if("--"===b.substr(0,2))h=(getComputedStyle(e).getPropertyValue(b)+"").trim(),f+="",I_.lastIndex=0,I_.test(h)||(T=dl(h),S=dl(f)),S?T!==S&&(h=O_(e,b,h,S)+S):T&&(f+=T),this.add(a,"setProperty",h,f,r,s,0,0,b),o.push(b),k.push(b,0,a[b]);else if("undefined"!==v){if(l&&b in l?(h="function"==typeof l[b]?l[b].call(n,r,e,s):l[b],xa(h)&&~h.indexOf("random(")&&(h=kE(h)),dl(h+"")||(h+=au.units[b]||dl(Cm(e,b))||""),"="===(h+"").charAt(1)&&(h=Cm(e,b))):h=Cm(e,b),g=parseFloat(h),(C="string"===v&&"="===f.charAt(1)&&f.substr(0,2))&&(f=f.substr(2)),m=parseFloat(f),b in Sm&&("autoAlpha"===b&&(1===g&&"hidden"===Cm(e,"visibility")&&m&&(g=0),k.push("visibility",0,a.visibility),L_(this,a,"visibility",g?"inherit":"hidden",m?"inherit":"hidden",!m)),"scale"!==b&&"transform"!==b&&~(b=Sm[b]).indexOf(",")&&(b=b.split(",")[0])),R=b in Mm)if(this.styles.save(b),I||((L=e._gsap).renderTransform&&!t.parseTransform||zE(e,t.parseTransform),N=!1!==t.smoothOrigin&&L.smooth,(I=this._pt=new gc(this._pt,a,Vs,0,1,L.renderTransform,L,0,-1)).dep=1),"scale"===b)this._pt=new gc(this._pt,L,"scaleY",g,(C?IT(g,C+m):m)-g||0,fj),this._pt.u=0,o.push("scaleY",b),b+="X";else{if("transformOrigin"===b){k.push(md,0,a[md]),f=soe(f),L.svg?vj(e,f,0,N,0,this):((S=parseFloat(f.split(" ")[2])||0)!==L.zOrigin&&L_(this,L,"zOrigin",L.zOrigin,S),L_(this,a,b,OP(h),OP(f)));continue}if("svgOrigin"===b){vj(e,f,1,N,0,this);continue}if(b in qW){coe(this,L,b,g,C?IT(g,C+f):f);continue}if("smoothOrigin"===b){L_(this,L,"smooth",L.smooth,f);continue}if("force3D"===b){L[b]=f;continue}if("transform"===b){uoe(this,f,e);continue}}else b in a||(b=VT(b)||b);if(R||(m||0===m)&&(g||0===g)&&!Wse.test(f)&&b in a)m||(m=0),(T=(h+"").substr((g+"").length))!==(S=dl(f)||(b in au.units?au.units[b]:T))&&(g=O_(e,b,h,S)),this._pt=new gc(this._pt,R?L:a,b,g,(C?IT(g,C+m):m)-g,R||"px"!==S&&"zIndex"!==b||!1===t.autoRound?fj:Yse),this._pt.u=S||0,T!==S&&"%"!==S&&(this._pt.b=h,this._pt.r=Zse);else if(b in a)roe.call(this,e,b,h,C?C+f:f);else{if(!(b in e)){V3(b,f);continue}this.add(e,b,h||e[b],C?C+f:f,r,s)}R||(b in a?k.push(b,0,a[b]):k.push(b,1,h||e[b])),o.push(b)}U&&DW(this)},render:function(e,t){if(t.tween._time||!hj())for(var n=t._pt;n;)n.r(e,n.d),n=n._next;else t.styles.revert()},get:Cm,aliases:Sm,getSetter:function(e,t,n){var r=Sm[t];return r&&r.indexOf(",")<0&&(t=r),t in Mm&&t!==md&&(e._gsap.x||Cm(e,"x"))?n&&FW===n?"scale"===t?Qse:$se:(FW=n||{})&&("scale"===t?Jse:eoe):e.style&&!k3(e.style[t])?Kse:~t.indexOf("-")?Xse:sj(e,t)},core:{_removeProperty:VE,_getMatrix:_j}};hu.utils.checkPrefix=VT,hu.core.getStyleSaver=BW,function(i,e,t,n){var r=pc(i+","+e+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(s){Mm[s]=1});pc(e,function(s){au.units[s]="deg",qW[s]=1}),Sm[r[13]]=i+","+e,pc("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(s){var o=s.split(":");Sm[o[1]]=r[o[0]]})}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY"),pc("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(i){au.units[i]="px"}),hu.registerPlugin($W);var fl=hu.registerPlugin($W)||hu;const k0=1e3,Ol=1001,Bo=1003,io=1006,B_=1008,du=1009,N0=1014,hh=1015,Wf=1016,WT=1020,kl=1023,B0=1026,qT=1027,$E=2300,ZT=2301,j0=3e3,ur=3001,Dm="srgb",V0="srgb-linear";class G0{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const pl=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let F8=1234567;const z0=Math.PI/180,QE=180/Math.PI;function fu(){const i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(pl[255&i]+pl[i>>8&255]+pl[i>>16&255]+pl[i>>24&255]+"-"+pl[255&e]+pl[e>>8&255]+"-"+pl[e>>16&15|64]+pl[e>>24&255]+"-"+pl[63&t|128]+pl[t>>8&255]+"-"+pl[t>>16&255]+pl[t>>24&255]+pl[255&n]+pl[n>>8&255]+pl[n>>16&255]+pl[n>>24&255]).toLowerCase()}function vo(i,e,t){return Math.max(e,Math.min(t,i))}function Fj(i,e){return(i%e+e)%e}function JE(i,e,t){return(1-t)*i+t*e}function Lj(i){return 0==(i&i-1)&&0!==i}function L8(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function zP(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}var HP=Object.freeze({__proto__:null,DEG2RAD:z0,RAD2DEG:QE,generateUUID:fu,clamp:vo,euclideanModulo:Fj,mapLinear:function aae(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)},inverseLerp:function lae(i,e,t){return i!==e?(t-i)/(e-i):0},lerp:JE,damp:function cae(i,e,t,n){return JE(i,e,1-Math.exp(-t*n))},pingpong:function uae(i,e=1){return e-Math.abs(Fj(i,2*e)-e)},smoothstep:function hae(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*(3-2*i)},smootherstep:function dae(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*i*(i*(6*i-15)+10)},randInt:function fae(i,e){return i+Math.floor(Math.random()*(e-i+1))},randFloat:function pae(i,e){return i+Math.random()*(e-i)},randFloatSpread:function mae(i){return i*(.5-Math.random())},seededRandom:function gae(i){void 0!==i&&(F8=i);let e=F8+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function _ae(i){return i*z0},radToDeg:function vae(i){return i*QE},isPowerOfTwo:Lj,ceilPowerOfTwo:L8,floorPowerOfTwo:zP,setQuaternionFromProperEuler:function yae(i,e,t,n,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),h=s((e+n)/2),f=o((e+n)/2),m=s((e-n)/2),g=o((e-n)/2),v=s((n-e)/2),y=o((n-e)/2);switch(r){case"XYX":i.set(a*f,l*m,l*g,a*h);break;case"YZY":i.set(l*g,a*f,l*m,a*h);break;case"ZXZ":i.set(l*m,l*g,a*f,a*h);break;case"XZX":i.set(a*f,l*y,l*v,a*h);break;case"YXY":i.set(l*v,a*f,l*y,a*h);break;case"ZYZ":i.set(l*y,l*v,a*f,a*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:function xae(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return Math.round(65535*i);case Uint8Array:return Math.round(255*i);case Int16Array:return Math.round(32767*i);case Int8Array:return Math.round(127*i);default:throw new Error("Invalid component type.")}},denormalize:function bae(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}});class Je{constructor(e=0,t=0){Je.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class pu{constructor(){pu.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,r,s,o,a,l,h){const f=this.elements;return f[0]=e,f[1]=r,f[2]=a,f[3]=t,f[4]=s,f[5]=l,f[6]=n,f[7]=o,f[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],h=n[1],f=n[4],m=n[7],g=n[2],v=n[5],y=n[8],b=r[0],T=r[3],S=r[6],C=r[1],R=r[4],I=r[7],L=r[2],N=r[5],U=r[8];return s[0]=o*b+a*C+l*L,s[3]=o*T+a*R+l*N,s[6]=o*S+a*I+l*U,s[1]=h*b+f*C+m*L,s[4]=h*T+f*R+m*N,s[7]=h*S+f*I+m*U,s[2]=g*b+v*C+y*L,s[5]=g*T+v*R+y*N,s[8]=g*S+v*I+y*U,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],h=e[7],f=e[8];return t*o*f-t*a*h-n*s*f+n*a*l+r*s*h-r*o*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],h=e[7],f=e[8],m=f*o-a*h,g=a*l-f*s,v=h*s-o*l,y=t*m+n*g+r*v;if(0===y)return this.set(0,0,0,0,0,0,0,0,0);const b=1/y;return e[0]=m*b,e[1]=(r*h-f*n)*b,e[2]=(a*n-r*o)*b,e[3]=g*b,e[4]=(f*t-r*l)*b,e[5]=(r*s-a*t)*b,e[6]=v*b,e[7]=(n*l-h*t)*b,e[8]=(o*t-n*s)*b,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){const l=Math.cos(s),h=Math.sin(s);return this.set(n*l,n*h,-n*(l*o+h*a)+o+e,-r*h,r*l,-r*(-h*o+l*a)+a+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=this.elements,s=r[0],o=r[3],a=r[6],l=r[1],h=r[4],f=r[7];return r[0]=t*s+n*l,r[3]=t*o+n*h,r[6]=t*a+n*f,r[1]=-n*s+t*l,r[4]=-n*o+t*h,r[7]=-n*a+t*f,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function O8(i){for(let e=i.length-1;e>=0;--e)if(i[e]>65535)return!0;return!1}function eA(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function H0(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function WP(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const Oj={[Dm]:{[V0]:H0},[V0]:{[Dm]:WP}},gd={legacyMode:!0,get workingColorSpace(){return V0},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(this.legacyMode||e===t||!e||!t)return i;if(Oj[e]&&void 0!==Oj[e][t]){const n=Oj[e][t];return i.r=n(i.r),i.g=n(i.g),i.b=n(i.b),i}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}},k8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ia={r:0,g:0,b:0},_d={h:0,s:0,l:0},qP={h:0,s:0,l:0};function kj(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+6*(e-i)*t:t<.5?e:t<2/3?i+6*(e-i)*(2/3-t):i}function ZP(i,e){return e.r=i.r,e.g=i.g,e.b=i.b,e}let $T,sn=(()=>{class i{constructor(t,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,n=Dm){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,gd.toWorkingColorSpace(this,n),this}setRGB(t,n,r,s=V0){return this.r=t,this.g=n,this.b=r,gd.toWorkingColorSpace(this,s),this}setHSL(t,n,r,s=V0){if(t=Fj(t,1),n=vo(n,0,1),r=vo(r,0,1),0===n)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+n):r+n-r*n,a=2*r-o;this.r=kj(a,o,t+1/3),this.g=kj(a,o,t),this.b=kj(a,o,t-1/3)}return gd.toWorkingColorSpace(this,s),this}setStyle(t,n=Dm){function r(o){void 0!==o&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let o;const l=s[2];switch(s[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,gd.toWorkingColorSpace(this,n),r(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,gd.toWorkingColorSpace(this,n),r(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l)){const h=parseFloat(o[1])/360,f=parseInt(o[2],10)/100,m=parseInt(o[3],10)/100;return r(o[4]),this.setHSL(h,f,m,n)}}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const o=s[1],a=o.length;if(3===a)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,gd.toWorkingColorSpace(this,n),this;if(6===a)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,gd.toWorkingColorSpace(this,n),this}return t&&t.length>0?this.setColorName(t,n):this}setColorName(t,n=Dm){const r=k8[t.toLowerCase()];return void 0!==r?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=H0(t.r),this.g=H0(t.g),this.b=H0(t.b),this}copyLinearToSRGB(t){return this.r=WP(t.r),this.g=WP(t.g),this.b=WP(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Dm){return gd.fromWorkingColorSpace(ZP(this,ia),t),vo(255*ia.r,0,255)<<16^vo(255*ia.g,0,255)<<8^vo(255*ia.b,0,255)<<0}getHexString(t=Dm){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,n=V0){gd.fromWorkingColorSpace(ZP(this,ia),n);const r=ia.r,s=ia.g,o=ia.b,a=Math.max(r,s,o),l=Math.min(r,s,o);let h,f;const m=(l+a)/2;if(l===a)h=0,f=0;else{const g=a-l;switch(f=m<=.5?g/(a+l):g/(2-a-l),a){case r:h=(s-o)/g+(s<o?6:0);break;case s:h=(o-r)/g+2;break;case o:h=(r-s)/g+4}h/=6}return t.h=h,t.s=f,t.l=m,t}getRGB(t,n=V0){return gd.fromWorkingColorSpace(ZP(this,ia),n),t.r=ia.r,t.g=ia.g,t.b=ia.b,t}getStyle(t=Dm){return gd.fromWorkingColorSpace(ZP(this,ia),t),t!==Dm?`color(${t} ${ia.r} ${ia.g} ${ia.b})`:`rgb(${255*ia.r|0},${255*ia.g|0},${255*ia.b|0})`}offsetHSL(t,n,r){return this.getHSL(_d),_d.h+=t,_d.s+=n,_d.l+=r,this.setHSL(_d.h,_d.s,_d.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,r){return this.r=t.r+(n.r-t.r)*r,this.g=t.g+(n.g-t.g)*r,this.b=t.b+(n.b-t.b)*r,this}lerpHSL(t,n){this.getHSL(_d),t.getHSL(qP);const r=JE(_d.h,qP.h,n),s=JE(_d.s,qP.s,n),o=JE(_d.l,qP.l,n);return this.setHSL(r,s,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}return i.NAMES=k8,i})();class N8{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===$T&&($T=eA("canvas")),$T.width=e.width,$T.height=e.height;const n=$T.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=$T}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=eA("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*H0(s[o]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*H0(t[n]/255)):H0(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class QT{constructor(e=null){this.isSource=!0,this.uuid=fu(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(Nj(r[o].isDataTexture?r[o].image:r[o]))}else s=Nj(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function Nj(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?N8.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let wae=0,vd=(()=>{class i extends G0{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=Ol,s=Ol,o=io,a=B_,l=kl,h=du,f=1,m=j0){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:wae++}),this.uuid=fu(),this.name="",this.source=new QT(t),this.mipmaps=[],this.mapping=n,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=f,this.format=l,this.internalFormat=null,this.type=h,this.offset=new Je(0,0),this.repeat=new Je(1,1),this.center=new Je(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new pu,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=m,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=void 0===t||"string"==typeof t;if(!n&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case k0:t.x=t.x-Math.floor(t.x);break;case Ol:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case k0:t.y=t.y-Math.floor(t.y);break;case Ol:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=300,i})();class hr{constructor(e=0,t=0,n=0,r=1){hr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const l=e.elements,h=l[0],f=l[4],m=l[8],g=l[1],v=l[5],y=l[9],b=l[2],T=l[6],S=l[10];if(Math.abs(f-g)<.01&&Math.abs(m-b)<.01&&Math.abs(y-T)<.01){if(Math.abs(f+g)<.1&&Math.abs(m+b)<.1&&Math.abs(y+T)<.1&&Math.abs(h+v+S-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const R=(h+1)/2,I=(v+1)/2,L=(S+1)/2,N=(f+g)/4,U=(m+b)/4,k=(y+T)/4;return R>I&&R>L?R<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(R),r=N/n,s=U/n):I>L?I<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(I),n=N/r,s=k/r):L<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(L),n=U/s,r=k/s),this.set(n,r,s,t),this}let C=Math.sqrt((T-y)*(T-y)+(m-b)*(m-b)+(g-f)*(g-f));return Math.abs(C)<.001&&(C=1),this.x=(T-y)/C,this.y=(m-b)/C,this.z=(g-f)/C,this.w=Math.acos((h+v+S-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ra extends G0{constructor(e,t,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new hr(0,0,e,t),this.scissorTest=!1,this.viewport=new hr(0,0,e,t),this.texture=new vd({width:e,height:t,depth:1},n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:io,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new QT(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Bj extends vd{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Bo,this.minFilter=Bo,this.wrapR=Ol,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class B8 extends vd{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Bo,this.minFilter=Bo,this.wrapR=Ol,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class sa{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,o,a){let l=n[r+0],h=n[r+1],f=n[r+2],m=n[r+3];const g=s[o+0],v=s[o+1],y=s[o+2],b=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=h,e[t+2]=f,void(e[t+3]=m);if(1===a)return e[t+0]=g,e[t+1]=v,e[t+2]=y,void(e[t+3]=b);if(m!==b||l!==g||h!==v||f!==y){let T=1-a;const S=l*g+h*v+f*y+m*b,C=S>=0?1:-1,R=1-S*S;if(R>Number.EPSILON){const L=Math.sqrt(R),N=Math.atan2(L,S*C);T=Math.sin(T*N)/L,a=Math.sin(a*N)/L}const I=a*C;if(l=l*T+g*I,h=h*T+v*I,f=f*T+y*I,m=m*T+b*I,T===1-a){const L=1/Math.sqrt(l*l+h*h+f*f+m*m);l*=L,h*=L,f*=L,m*=L}}e[t]=l,e[t+1]=h,e[t+2]=f,e[t+3]=m}static multiplyQuaternionsFlat(e,t,n,r,s,o){const a=n[r],l=n[r+1],h=n[r+2],f=n[r+3],m=s[o],g=s[o+1],v=s[o+2],y=s[o+3];return e[t]=a*y+f*m+l*v-h*g,e[t+1]=l*y+f*g+h*m-a*v,e[t+2]=h*y+f*v+a*g-l*m,e[t+3]=f*y-a*m-l*g-h*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,h=a(n/2),f=a(r/2),m=a(s/2),g=l(n/2),v=l(r/2),y=l(s/2);switch(o){case"XYZ":this._x=g*f*m+h*v*y,this._y=h*v*m-g*f*y,this._z=h*f*y+g*v*m,this._w=h*f*m-g*v*y;break;case"YXZ":this._x=g*f*m+h*v*y,this._y=h*v*m-g*f*y,this._z=h*f*y-g*v*m,this._w=h*f*m+g*v*y;break;case"ZXY":this._x=g*f*m-h*v*y,this._y=h*v*m+g*f*y,this._z=h*f*y+g*v*m,this._w=h*f*m-g*v*y;break;case"ZYX":this._x=g*f*m-h*v*y,this._y=h*v*m+g*f*y,this._z=h*f*y-g*v*m,this._w=h*f*m+g*v*y;break;case"YZX":this._x=g*f*m+h*v*y,this._y=h*v*m+g*f*y,this._z=h*f*y-g*v*m,this._w=h*f*m-g*v*y;break;case"XZY":this._x=g*f*m-h*v*y,this._y=h*v*m-g*f*y,this._z=h*f*y+g*v*m,this._w=h*f*m+g*v*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],h=t[2],f=t[6],m=t[10],g=n+a+m;if(g>0){const v=.5/Math.sqrt(g+1);this._w=.25/v,this._x=(f-l)*v,this._y=(s-h)*v,this._z=(o-r)*v}else if(n>a&&n>m){const v=2*Math.sqrt(1+n-a-m);this._w=(f-l)/v,this._x=.25*v,this._y=(r+o)/v,this._z=(s+h)/v}else if(a>m){const v=2*Math.sqrt(1+a-n-m);this._w=(s-h)/v,this._x=(r+o)/v,this._y=.25*v,this._z=(l+f)/v}else{const v=2*Math.sqrt(1+m-n-a);this._w=(o-r)/v,this._x=(s+h)/v,this._y=(l+f)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(vo(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,h=t._z,f=t._w;return this._x=n*f+o*a+r*h-s*l,this._y=r*f+o*l+s*a-n*h,this._z=s*f+o*h+n*l-r*a,this._w=o*f-n*a-r*l-s*h,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const v=1-t;return this._w=v*o+t*this._w,this._x=v*n+t*this._x,this._y=v*r+t*this._y,this._z=v*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(l),f=Math.atan2(h,a),m=Math.sin((1-t)*f)/h,g=Math.sin(t*f)/h;return this._w=o*m+this._w*g,this._x=n*m+this._x*g,this._y=r*m+this._y*g,this._z=s*m+this._z*g,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(s),n*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Q{constructor(e=0,t=0,n=0){Q.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(j8.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(j8.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,h=l*t+o*r-a*n,f=l*n+a*t-s*r,m=l*r+s*n-o*t,g=-s*t-o*n-a*r;return this.x=h*l+g*-s+f*-a-m*-o,this.y=f*l+g*-o+m*-s-h*-a,this.z=m*l+g*-a+h*-o-f*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return jj.copy(this).projectOnVector(e),this.sub(jj)}reflect(e){return this.sub(jj.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(vo(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const jj=new Q,j8=new sa;class W0{constructor(e=new Q(1/0,1/0,1/0),t=new Q(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,h=e.length;l<h;l+=3){const f=e[l],m=e[l+1],g=e[l+2];f<t&&(t=f),m<n&&(n=m),g<r&&(r=g),f>s&&(s=f),m>o&&(o=m),g>a&&(a=g)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,h=e.count;l<h;l++){const f=e.getX(l),m=e.getY(l),g=e.getZ(l);f<t&&(t=f),m<n&&(n=m),g<r&&(r=g),f>s&&(s=f),m>o&&(o=m),g>a&&(a=g)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=q0.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const s=n.attributes.position;for(let o=0,a=s.count;o<a;o++)q0.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(q0)}else null===n.boundingBox&&n.computeBoundingBox(),Uj.copy(n.boundingBox),Uj.applyMatrix4(e.matrixWorld),this.union(Uj);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,q0),q0.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(tA),YP.subVectors(this.max,tA),JT.subVectors(e.a,tA),ew.subVectors(e.b,tA),tw.subVectors(e.c,tA),j_.subVectors(ew,JT),U_.subVectors(tw,ew),Z0.subVectors(JT,tw);let t=[0,-j_.z,j_.y,0,-U_.z,U_.y,0,-Z0.z,Z0.y,j_.z,0,-j_.x,U_.z,0,-U_.x,Z0.z,0,-Z0.x,-j_.y,j_.x,0,-U_.y,U_.x,0,-Z0.y,Z0.x,0];return!(!Vj(t,JT,ew,tw,YP)||(t=[1,0,0,0,1,0,0,0,1],!Vj(t,JT,ew,tw,YP)))&&(KP.crossVectors(j_,U_),t=[KP.x,KP.y,KP.z],Vj(t,JT,ew,tw,YP))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return q0.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(q0).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Rm[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Rm[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Rm[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Rm[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Rm[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Rm[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Rm[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Rm[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Rm)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Rm=[new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q],q0=new Q,Uj=new W0,JT=new Q,ew=new Q,tw=new Q,j_=new Q,U_=new Q,Z0=new Q,tA=new Q,YP=new Q,KP=new Q,Y0=new Q;function Vj(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){Y0.fromArray(i,s);const a=r.x*Math.abs(Y0.x)+r.y*Math.abs(Y0.y)+r.z*Math.abs(Y0.z),l=e.dot(Y0),h=t.dot(Y0),f=n.dot(Y0);if(Math.max(-Math.max(l,h,f),Math.min(l,h,f))>a)return!1}return!0}const Mae=new W0,U8=new Q,XP=new Q,Gj=new Q;class K0{constructor(e=new Q,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):Mae.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){Gj.subVectors(e,this.center);const t=Gj.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=.5*(n-this.radius);this.center.add(Gj.multiplyScalar(r/n)),this.radius+=r}return this}union(e){return!0===this.center.equals(e.center)?XP.set(0,0,1).multiplyScalar(e.radius):XP.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(U8.copy(e.center).add(XP)),this.expandByPoint(U8.copy(e.center).sub(XP)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Im=new Q,zj=new Q,$P=new Q,V_=new Q,Hj=new Q,QP=new Q,Wj=new Q;class JP{constructor(e=new Q,t=new Q(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Im)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Im.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Im.copy(this.direction).multiplyScalar(t).add(this.origin),Im.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){zj.copy(e).add(t).multiplyScalar(.5),$P.copy(t).sub(e).normalize(),V_.copy(this.origin).sub(zj);const s=.5*e.distanceTo(t),o=-this.direction.dot($P),a=V_.dot(this.direction),l=-V_.dot($P),h=V_.lengthSq(),f=Math.abs(1-o*o);let m,g,v,y;if(f>0)if(m=o*l-a,g=o*a-l,y=s*f,m>=0)if(g>=-y)if(g<=y){const b=1/f;m*=b,g*=b,v=m*(m+o*g+2*a)+g*(o*m+g+2*l)+h}else g=s,m=Math.max(0,-(o*g+a)),v=-m*m+g*(g+2*l)+h;else g=-s,m=Math.max(0,-(o*g+a)),v=-m*m+g*(g+2*l)+h;else g<=-y?(m=Math.max(0,-(-o*s+a)),g=m>0?-s:Math.min(Math.max(-s,-l),s),v=-m*m+g*(g+2*l)+h):g<=y?(m=0,g=Math.min(Math.max(-s,-l),s),v=g*(g+2*l)+h):(m=Math.max(0,-(o*s+a)),g=m>0?s:Math.min(Math.max(-s,-l),s),v=-m*m+g*(g+2*l)+h);else g=o>0?-s:s,m=Math.max(0,-(o*g+a)),v=-m*m+g*(g+2*l)+h;return n&&n.copy(this.direction).multiplyScalar(m).add(this.origin),r&&r.copy($P).multiplyScalar(g).add(zj),v}intersectSphere(e,t){Im.subVectors(e.center,this.origin);const n=Im.dot(this.direction),r=Im.dot(Im)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return a<0&&l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,l;const h=1/this.direction.x,f=1/this.direction.y,m=1/this.direction.z,g=this.origin;return h>=0?(n=(e.min.x-g.x)*h,r=(e.max.x-g.x)*h):(n=(e.max.x-g.x)*h,r=(e.min.x-g.x)*h),f>=0?(s=(e.min.y-g.y)*f,o=(e.max.y-g.y)*f):(s=(e.max.y-g.y)*f,o=(e.min.y-g.y)*f),n>o||s>r||((s>n||n!=n)&&(n=s),(o<r||r!=r)&&(r=o),m>=0?(a=(e.min.z-g.z)*m,l=(e.max.z-g.z)*m):(a=(e.max.z-g.z)*m,l=(e.min.z-g.z)*m),n>l||a>r)||((a>n||n!=n)&&(n=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Im)}intersectTriangle(e,t,n,r,s){Hj.subVectors(t,e),QP.subVectors(n,e),Wj.crossVectors(Hj,QP);let a,o=this.direction.dot(Wj);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}V_.subVectors(this.origin,e);const l=a*this.direction.dot(QP.crossVectors(V_,QP));if(l<0)return null;const h=a*this.direction.dot(Hj.cross(V_));if(h<0||l+h>o)return null;const f=-a*V_.dot(Wj);return f<0?null:this.at(f/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Jn{constructor(){Jn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,r,s,o,a,l,h,f,m,g,v,y,b,T){const S=this.elements;return S[0]=e,S[4]=t,S[8]=n,S[12]=r,S[1]=s,S[5]=o,S[9]=a,S[13]=l,S[2]=h,S[6]=f,S[10]=m,S[14]=g,S[3]=v,S[7]=y,S[11]=b,S[15]=T,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Jn).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/nw.setFromMatrixColumn(e,0).length(),s=1/nw.setFromMatrixColumn(e,1).length(),o=1/nw.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),h=Math.sin(r),f=Math.cos(s),m=Math.sin(s);if("XYZ"===e.order){const g=o*f,v=o*m,y=a*f,b=a*m;t[0]=l*f,t[4]=-l*m,t[8]=h,t[1]=v+y*h,t[5]=g-b*h,t[9]=-a*l,t[2]=b-g*h,t[6]=y+v*h,t[10]=o*l}else if("YXZ"===e.order){const g=l*f,v=l*m,y=h*f,b=h*m;t[0]=g+b*a,t[4]=y*a-v,t[8]=o*h,t[1]=o*m,t[5]=o*f,t[9]=-a,t[2]=v*a-y,t[6]=b+g*a,t[10]=o*l}else if("ZXY"===e.order){const g=l*f,v=l*m,y=h*f,b=h*m;t[0]=g-b*a,t[4]=-o*m,t[8]=y+v*a,t[1]=v+y*a,t[5]=o*f,t[9]=b-g*a,t[2]=-o*h,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const g=o*f,v=o*m,y=a*f,b=a*m;t[0]=l*f,t[4]=y*h-v,t[8]=g*h+b,t[1]=l*m,t[5]=b*h+g,t[9]=v*h-y,t[2]=-h,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const g=o*l,v=o*h,y=a*l,b=a*h;t[0]=l*f,t[4]=b-g*m,t[8]=y*m+v,t[1]=m,t[5]=o*f,t[9]=-a*f,t[2]=-h*f,t[6]=v*m+y,t[10]=g-b*m}else if("XZY"===e.order){const g=o*l,v=o*h,y=a*l,b=a*h;t[0]=l*f,t[4]=-m,t[8]=h*f,t[1]=g*m+b,t[5]=o*f,t[9]=v*m-y,t[2]=y*m-v,t[6]=a*f,t[10]=b*m+g}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Sae,e,Cae)}lookAt(e,t,n){const r=this.elements;return mu.subVectors(e,t),0===mu.lengthSq()&&(mu.z=1),mu.normalize(),G_.crossVectors(n,mu),0===G_.lengthSq()&&(1===Math.abs(n.z)?mu.x+=1e-4:mu.z+=1e-4,mu.normalize(),G_.crossVectors(n,mu)),G_.normalize(),eF.crossVectors(mu,G_),r[0]=G_.x,r[4]=eF.x,r[8]=mu.x,r[1]=G_.y,r[5]=eF.y,r[9]=mu.y,r[2]=G_.z,r[6]=eF.z,r[10]=mu.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],h=n[12],f=n[1],m=n[5],g=n[9],v=n[13],y=n[2],b=n[6],T=n[10],S=n[14],C=n[3],R=n[7],I=n[11],L=n[15],N=r[0],U=r[4],k=r[8],z=r[12],K=r[1],te=r[5],fe=r[9],ie=r[13],ne=r[2],le=r[6],Z=r[10],he=r[14],me=r[3],ce=r[7],be=r[11],Ge=r[15];return s[0]=o*N+a*K+l*ne+h*me,s[4]=o*U+a*te+l*le+h*ce,s[8]=o*k+a*fe+l*Z+h*be,s[12]=o*z+a*ie+l*he+h*Ge,s[1]=f*N+m*K+g*ne+v*me,s[5]=f*U+m*te+g*le+v*ce,s[9]=f*k+m*fe+g*Z+v*be,s[13]=f*z+m*ie+g*he+v*Ge,s[2]=y*N+b*K+T*ne+S*me,s[6]=y*U+b*te+T*le+S*ce,s[10]=y*k+b*fe+T*Z+S*be,s[14]=y*z+b*ie+T*he+S*Ge,s[3]=C*N+R*K+I*ne+L*me,s[7]=C*U+R*te+I*le+L*ce,s[11]=C*k+R*fe+I*Z+L*be,s[15]=C*z+R*ie+I*he+L*Ge,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],h=e[13],f=e[2],m=e[6],g=e[10],v=e[14];return e[3]*(+s*l*m-r*h*m-s*a*g+n*h*g+r*a*v-n*l*v)+e[7]*(+t*l*v-t*h*g+s*o*g-r*o*v+r*h*f-s*l*f)+e[11]*(+t*h*m-t*a*v-s*o*m+n*o*v+s*a*f-n*h*f)+e[15]*(-r*a*f-t*l*m+t*a*g+r*o*m-n*o*g+n*l*f)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],h=e[7],f=e[8],m=e[9],g=e[10],v=e[11],y=e[12],b=e[13],T=e[14],S=e[15],C=m*T*h-b*g*h+b*l*v-a*T*v-m*l*S+a*g*S,R=y*g*h-f*T*h-y*l*v+o*T*v+f*l*S-o*g*S,I=f*b*h-y*m*h+y*a*v-o*b*v-f*a*S+o*m*S,L=y*m*l-f*b*l-y*a*g+o*b*g+f*a*T-o*m*T,N=t*C+n*R+r*I+s*L;if(0===N)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const U=1/N;return e[0]=C*U,e[1]=(b*g*s-m*T*s-b*r*v+n*T*v+m*r*S-n*g*S)*U,e[2]=(a*T*s-b*l*s+b*r*h-n*T*h-a*r*S+n*l*S)*U,e[3]=(m*l*s-a*g*s-m*r*h+n*g*h+a*r*v-n*l*v)*U,e[4]=R*U,e[5]=(f*T*s-y*g*s+y*r*v-t*T*v-f*r*S+t*g*S)*U,e[6]=(y*l*s-o*T*s-y*r*h+t*T*h+o*r*S-t*l*S)*U,e[7]=(o*g*s-f*l*s+f*r*h-t*g*h-o*r*v+t*l*v)*U,e[8]=I*U,e[9]=(y*m*s-f*b*s-y*n*v+t*b*v+f*n*S-t*m*S)*U,e[10]=(o*b*s-y*a*s+y*n*h-t*b*h-o*n*S+t*a*S)*U,e[11]=(f*a*s-o*m*s-f*n*h+t*m*h+o*n*v-t*a*v)*U,e[12]=L*U,e[13]=(f*b*r-y*m*r+y*n*g-t*b*g-f*n*T+t*m*T)*U,e[14]=(y*a*r-o*b*r-y*n*l+t*b*l+o*n*T-t*a*T)*U,e[15]=(o*m*r-f*a*r+f*n*l-t*m*l-o*n*g+t*a*g)*U,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,l=e.z,h=s*o,f=s*a;return this.set(h*o+n,h*a-r*l,h*l+r*a,0,h*a+r*l,f*a+n,f*l-r*o,0,h*l-r*a,f*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,h=s+s,f=o+o,m=a+a,g=s*h,v=s*f,y=s*m,b=o*f,T=o*m,S=a*m,C=l*h,R=l*f,I=l*m,L=n.x,N=n.y,U=n.z;return r[0]=(1-(b+S))*L,r[1]=(v+I)*L,r[2]=(y-R)*L,r[3]=0,r[4]=(v-I)*N,r[5]=(1-(g+S))*N,r[6]=(T+C)*N,r[7]=0,r[8]=(y+R)*U,r[9]=(T-C)*U,r[10]=(1-(g+b))*U,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=nw.set(r[0],r[1],r[2]).length();const o=nw.set(r[4],r[5],r[6]).length(),a=nw.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],yd.copy(this);const h=1/s,f=1/o,m=1/a;return yd.elements[0]*=h,yd.elements[1]*=h,yd.elements[2]*=h,yd.elements[4]*=f,yd.elements[5]*=f,yd.elements[6]*=f,yd.elements[8]*=m,yd.elements[9]*=m,yd.elements[10]*=m,t.setFromRotationMatrix(yd),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o){const a=this.elements,h=2*s/(n-r),f=(t+e)/(t-e),m=(n+r)/(n-r),g=-(o+s)/(o-s),v=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=f,a[12]=0,a[1]=0,a[5]=h,a[9]=m,a[13]=0,a[2]=0,a[6]=0,a[10]=g,a[14]=v,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,r,s,o){const a=this.elements,l=1/(t-e),h=1/(n-r),f=1/(o-s),m=(t+e)*l,g=(n+r)*h,v=(o+s)*f;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-m,a[1]=0,a[5]=2*h,a[9]=0,a[13]=-g,a[2]=0,a[6]=0,a[10]=-2*f,a[14]=-v,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const nw=new Q,yd=new Jn,Sae=new Q(0,0,0),Cae=new Q(1,1,1),G_=new Q,eF=new Q,mu=new Q,V8=new Jn,G8=new sa;let tF=(()=>{class i{constructor(t=0,n=0,r=0,s=i.DefaultOrder){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,s=this._order){return this._x=t,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],h=s[1],f=s[5],m=s[9],g=s[2],v=s[6],y=s[10];switch(n){case"XYZ":this._y=Math.asin(vo(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-m,y),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(v,f),this._z=0);break;case"YXZ":this._x=Math.asin(-vo(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(l,y),this._z=Math.atan2(h,f)):(this._y=Math.atan2(-g,o),this._z=0);break;case"ZXY":this._x=Math.asin(vo(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(-g,y),this._z=Math.atan2(-a,f)):(this._y=0,this._z=Math.atan2(h,o));break;case"ZYX":this._y=Math.asin(-vo(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(v,y),this._z=Math.atan2(h,o)):(this._x=0,this._z=Math.atan2(-a,f));break;case"YZX":this._z=Math.asin(vo(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-m,f),this._y=Math.atan2(-g,o)):(this._x=0,this._y=Math.atan2(l,y));break;case"XZY":this._z=Math.asin(-vo(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(v,f),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-m,y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return V8.makeRotationFromQuaternion(t),this.setFromRotationMatrix(V8,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return G8.setFromEuler(this),this.setFromQuaternion(G8,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}return i.DefaultOrder="XYZ",i.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],i})();class qj{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Eae=0;const z8=new Q,iw=new sa,Pm=new Jn,nF=new Q,nA=new Q,Aae=new Q,Dae=new sa,H8=new Q(1,0,0),W8=new Q(0,1,0),q8=new Q(0,0,1),Rae={type:"added"},Z8={type:"removed"};let oa=(()=>{class i extends G0{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Eae++}),this.uuid=fu(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=i.DefaultUp.clone();const t=new Q,n=new tF,r=new sa,s=new Q(1,1,1);n._onChange(function o(){r.setFromEuler(n,!1)}),r._onChange(function a(){n.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Jn},normalMatrix:{value:new pu}}),this.matrix=new Jn,this.matrixWorld=new Jn,this.matrixAutoUpdate=i.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new qj,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return iw.setFromAxisAngle(t,n),this.quaternion.multiply(iw),this}rotateOnWorldAxis(t,n){return iw.setFromAxisAngle(t,n),this.quaternion.premultiply(iw),this}rotateX(t){return this.rotateOnAxis(H8,t)}rotateY(t){return this.rotateOnAxis(W8,t)}rotateZ(t){return this.rotateOnAxis(q8,t)}translateOnAxis(t,n){return z8.copy(t).applyQuaternion(this.quaternion),this.position.add(z8.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(H8,t)}translateY(t){return this.translateOnAxis(W8,t)}translateZ(t){return this.translateOnAxis(q8,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(Pm.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?nF.copy(t):nF.set(t,n,r);const s=this.parent;this.updateWorldMatrix(!0,!1),nA.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Pm.lookAt(nA,nF,this.up):Pm.lookAt(nF,nA,this.up),this.quaternion.setFromRotationMatrix(Pm),s&&(Pm.extractRotation(s.matrixWorld),iw.setFromRotationMatrix(Pm),this.quaternion.premultiply(iw.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Rae)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Z8)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const n=this.children[t];n.parent=null,n.dispatchEvent(Z8)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Pm.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Pm.multiply(t.parent.matrixWorld)),t.applyMatrix4(Pm),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,n);if(void 0!==a)return a}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(nA,t,Aae),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(nA,Dae,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverseVisible(t)}traverseAncestors(t){const n=this.parent;null!==n&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].updateMatrixWorld(t)}updateWorldMatrix(t,n){const r=this.parent;if(!0===t&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===n){const s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(t){const n=void 0===t||"string"==typeof t,r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,h){return void 0===l[h.uuid]&&(l[h.uuid]=h.toJSON(t)),h.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const h=l.shapes;if(Array.isArray(h))for(let f=0,m=h.length;f<m;f++)o(t.shapes,h[f]);else o(t.shapes,h)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let h=0,f=this.material.length;h<f;h++)l.push(o(t.materials,this.material[h]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(n){const l=a(t.geometries),h=a(t.materials),f=a(t.textures),m=a(t.images),g=a(t.shapes),v=a(t.skeletons),y=a(t.animations),b=a(t.nodes);l.length>0&&(r.geometries=l),h.length>0&&(r.materials=h),f.length>0&&(r.textures=f),m.length>0&&(r.images=m),g.length>0&&(r.shapes=g),v.length>0&&(r.skeletons=v),y.length>0&&(r.animations=y),b.length>0&&(r.nodes=b)}return r.object=s,r;function a(l){const h=[];for(const f in l){const m=l[f];delete m.metadata,h.push(m)}return h}}clone(t){return(new this.constructor).copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===n)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return i.DefaultUp=new Q(0,1,0),i.DefaultMatrixAutoUpdate=!0,i})();const bd=new Q,Fm=new Q,Zj=new Q,Lm=new Q,rw=new Q,sw=new Q,Y8=new Q,Yj=new Q,Kj=new Q,Xj=new Q;class dh{constructor(e=new Q,t=new Q,n=new Q){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),bd.subVectors(e,t),r.cross(bd);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){bd.subVectors(r,t),Fm.subVectors(n,t),Zj.subVectors(e,t);const o=bd.dot(bd),a=bd.dot(Fm),l=bd.dot(Zj),h=Fm.dot(Fm),f=Fm.dot(Zj),m=o*h-a*a;if(0===m)return s.set(-2,-1,-1);const g=1/m,v=(h*l-a*f)*g,y=(o*f-a*l)*g;return s.set(1-v-y,y,v)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Lm),Lm.x>=0&&Lm.y>=0&&Lm.x+Lm.y<=1}static getUV(e,t,n,r,s,o,a,l){return this.getBarycoord(e,t,n,r,Lm),l.set(0,0),l.addScaledVector(s,Lm.x),l.addScaledVector(o,Lm.y),l.addScaledVector(a,Lm.z),l}static isFrontFacing(e,t,n,r){return bd.subVectors(n,t),Fm.subVectors(e,t),bd.cross(Fm).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return bd.subVectors(this.c,this.b),Fm.subVectors(this.a,this.b),.5*bd.cross(Fm).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return dh.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return dh.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,s){return dh.getUV(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return dh.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return dh.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let o,a;rw.subVectors(r,n),sw.subVectors(s,n),Yj.subVectors(e,n);const l=rw.dot(Yj),h=sw.dot(Yj);if(l<=0&&h<=0)return t.copy(n);Kj.subVectors(e,r);const f=rw.dot(Kj),m=sw.dot(Kj);if(f>=0&&m<=f)return t.copy(r);const g=l*m-f*h;if(g<=0&&l>=0&&f<=0)return o=l/(l-f),t.copy(n).addScaledVector(rw,o);Xj.subVectors(e,s);const v=rw.dot(Xj),y=sw.dot(Xj);if(y>=0&&v<=y)return t.copy(s);const b=v*h-l*y;if(b<=0&&h>=0&&y<=0)return a=h/(h-y),t.copy(n).addScaledVector(sw,a);const T=f*y-v*m;if(T<=0&&m-f>=0&&v-y>=0)return Y8.subVectors(s,r),a=(m-f)/(m-f+(v-y)),t.copy(r).addScaledVector(Y8,a);const S=1/(T+b+g);return o=b*S,a=g*S,t.copy(n).addScaledVector(rw,o).addScaledVector(sw,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Iae=0;class fh extends G0{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Iae++}),this.uuid=fu(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Ta extends fh{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new sn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const jo=new Q,iF=new Je;class Uo{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new sn),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new Je),t[n++]=o.x,t[n++]=o.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new Q),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new hr),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)iF.fromBufferAttribute(this,t),iF.applyMatrix3(e),this.setXY(t,iF.x,iF.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)jo.fromBufferAttribute(this,t),jo.applyMatrix3(e),this.setXYZ(t,jo.x,jo.y,jo.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)jo.fromBufferAttribute(this,t),jo.applyMatrix4(e),this.setXYZ(t,jo.x,jo.y,jo.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)jo.fromBufferAttribute(this,t),jo.applyNormalMatrix(e),this.setXYZ(t,jo.x,jo.y,jo.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)jo.fromBufferAttribute(this,t),jo.transformDirection(e),this.setXYZ(t,jo.x,jo.y,jo.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class K8 extends Uo{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class $j extends Uo{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class On extends Uo{constructor(e,t,n){super(new Float32Array(e),t,n)}}let Pae=0;const ph=new Jn,Qj=new oa,ow=new Q,gu=new W0,iA=new W0,wa=new Q;class Di extends G0{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Pae++}),this.uuid=fu(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(O8(e)?$j:K8)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const s=(new pu).getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return ph.makeRotationFromQuaternion(e),this.applyMatrix4(ph),this}rotateX(e){return ph.makeRotationX(e),this.applyMatrix4(ph),this}rotateY(e){return ph.makeRotationY(e),this.applyMatrix4(ph),this}rotateZ(e){return ph.makeRotationZ(e),this.applyMatrix4(ph),this}translate(e,t,n){return ph.makeTranslation(e,t,n),this.applyMatrix4(ph),this}scale(e,t,n){return ph.makeScale(e,t,n),this.applyMatrix4(ph),this}lookAt(e){return Qj.lookAt(e),Qj.updateMatrix(),this.applyMatrix4(Qj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ow).negate(),this.translate(ow.x,ow.y,ow.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new On(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new W0);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Q(-1/0,-1/0,-1/0),new Q(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++)gu.setFromBufferAttribute(t[n]),this.morphTargetsRelative?(wa.addVectors(this.boundingBox.min,gu.min),this.boundingBox.expandByPoint(wa),wa.addVectors(this.boundingBox.max,gu.max),this.boundingBox.expandByPoint(wa)):(this.boundingBox.expandByPoint(gu.min),this.boundingBox.expandByPoint(gu.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new K0);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Q,1/0);if(e){const n=this.boundingSphere.center;if(gu.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)iA.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(wa.addVectors(gu.min,iA.min),gu.expandByPoint(wa),wa.addVectors(gu.max,iA.max),gu.expandByPoint(wa)):(gu.expandByPoint(iA.min),gu.expandByPoint(iA.max));gu.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)wa.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(wa));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let h=0,f=a.count;h<f;h++)wa.fromBufferAttribute(a,h),l&&(ow.fromBufferAttribute(e,h),wa.add(ow)),r=Math.max(r,n.distanceToSquared(wa))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Uo(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,h=[],f=[];for(let K=0;K<a;K++)h[K]=new Q,f[K]=new Q;const m=new Q,g=new Q,v=new Q,y=new Je,b=new Je,T=new Je,S=new Q,C=new Q;function R(K,te,fe){m.fromArray(r,3*K),g.fromArray(r,3*te),v.fromArray(r,3*fe),y.fromArray(o,2*K),b.fromArray(o,2*te),T.fromArray(o,2*fe),g.sub(m),v.sub(m),b.sub(y),T.sub(y);const ie=1/(b.x*T.y-T.x*b.y);!isFinite(ie)||(S.copy(g).multiplyScalar(T.y).addScaledVector(v,-b.y).multiplyScalar(ie),C.copy(v).multiplyScalar(b.x).addScaledVector(g,-T.x).multiplyScalar(ie),h[K].add(S),h[te].add(S),h[fe].add(S),f[K].add(C),f[te].add(C),f[fe].add(C))}let I=this.groups;0===I.length&&(I=[{start:0,count:n.length}]);for(let K=0,te=I.length;K<te;++K){const fe=I[K],ie=fe.start;for(let le=ie,Z=ie+fe.count;le<Z;le+=3)R(n[le+0],n[le+1],n[le+2])}const L=new Q,N=new Q,U=new Q,k=new Q;function z(K){U.fromArray(s,3*K),k.copy(U);const te=h[K];L.copy(te),L.sub(U.multiplyScalar(U.dot(te))).normalize(),N.crossVectors(k,te);const ie=N.dot(f[K])<0?-1:1;l[4*K]=L.x,l[4*K+1]=L.y,l[4*K+2]=L.z,l[4*K+3]=ie}for(let K=0,te=I.length;K<te;++K){const fe=I[K],ie=fe.start;for(let le=ie,Z=ie+fe.count;le<Z;le+=3)z(n[le+0]),z(n[le+1]),z(n[le+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new Uo(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let g=0,v=n.count;g<v;g++)n.setXYZ(g,0,0,0);const r=new Q,s=new Q,o=new Q,a=new Q,l=new Q,h=new Q,f=new Q,m=new Q;if(e)for(let g=0,v=e.count;g<v;g+=3){const y=e.getX(g+0),b=e.getX(g+1),T=e.getX(g+2);r.fromBufferAttribute(t,y),s.fromBufferAttribute(t,b),o.fromBufferAttribute(t,T),f.subVectors(o,s),m.subVectors(r,s),f.cross(m),a.fromBufferAttribute(n,y),l.fromBufferAttribute(n,b),h.fromBufferAttribute(n,T),a.add(f),l.add(f),h.add(f),n.setXYZ(y,a.x,a.y,a.z),n.setXYZ(b,l.x,l.y,l.z),n.setXYZ(T,h.x,h.y,h.z)}else for(let g=0,v=t.count;g<v;g+=3)r.fromBufferAttribute(t,g+0),s.fromBufferAttribute(t,g+1),o.fromBufferAttribute(t,g+2),f.subVectors(o,s),m.subVectors(r,s),f.cross(m),n.setXYZ(g+0,f.x,f.y,f.z),n.setXYZ(g+1,f.x,f.y,f.z),n.setXYZ(g+2,f.x,f.y,f.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(void 0===e.attributes[r])continue;const o=n[r].array,a=e.attributes[r],l=a.array,h=a.itemSize*t,f=Math.min(l.length,o.length-h);for(let m=0,g=h;m<f;m++,g++)o[g]=l[m]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)wa.fromBufferAttribute(e,t),wa.normalize(),e.setXYZ(t,wa.x,wa.y,wa.z)}toNonIndexed(){function e(a,l){const h=a.array,f=a.itemSize,m=a.normalized,g=new h.constructor(l.length*f);let v=0,y=0;for(let b=0,T=l.length;b<T;b++){v=a.isInterleavedBufferAttribute?l[b]*a.data.stride+a.offset:l[b]*f;for(let S=0;S<f;S++)g[y++]=h[v++]}return new Uo(g,f,m)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Di,n=this.index.array,r=this.attributes;for(const a in r){const h=e(r[a],n);t.setAttribute(a,h)}const s=this.morphAttributes;for(const a in s){const l=[],h=s[a];for(let f=0,m=h.length;f<m;f++){const v=e(h[f],n);l.push(v)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const h=o[a];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const h in l)void 0!==l[h]&&(e[h]=l[h]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n)e.data.attributes[l]=n[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const h=this.morphAttributes[l],f=[];for(let m=0,g=h.length;m<g;m++)f.push(h[m].toJSON(e.data));f.length>0&&(r[l]=f,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const h in r)this.setAttribute(h,r[h].clone(t));const s=e.morphAttributes;for(const h in s){const f=[],m=s[h];for(let g=0,v=m.length;g<v;g++)f.push(m[g].clone(t));this.morphAttributes[h]=f}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let h=0,f=o.length;h<f;h++){const m=o[h];this.addGroup(m.start,m.count,m.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const X8=new Jn,aw=new JP,Jj=new K0,z_=new Q,H_=new Q,W_=new Q,eU=new Q,tU=new Q,nU=new Q,rF=new Q,sF=new Q,oF=new Q,aF=new Je,lF=new Je,cF=new Je,iU=new Q,uF=new Q;class aa extends oa{constructor(e=new Di,t=new Ta){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===n.boundingSphere&&n.computeBoundingSphere(),Jj.copy(n.boundingSphere),Jj.applyMatrix4(s),!1===e.ray.intersectsSphere(Jj))||(X8.copy(s).invert(),aw.copy(e.ray).applyMatrix4(X8),null!==n.boundingBox&&!1===aw.intersectsBox(n.boundingBox)))return;let o;const a=n.index,l=n.attributes.position,h=n.morphAttributes.position,f=n.morphTargetsRelative,m=n.attributes.uv,g=n.attributes.uv2,v=n.groups,y=n.drawRange;if(null!==a)if(Array.isArray(r))for(let b=0,T=v.length;b<T;b++){const S=v[b],C=r[S.materialIndex];for(let L=Math.max(S.start,y.start),N=Math.min(a.count,Math.min(S.start+S.count,y.start+y.count));L<N;L+=3){const U=a.getX(L),k=a.getX(L+1),z=a.getX(L+2);o=hF(this,C,e,aw,l,h,f,m,g,U,k,z),o&&(o.faceIndex=Math.floor(L/3),o.face.materialIndex=S.materialIndex,t.push(o))}}else for(let S=Math.max(0,y.start),C=Math.min(a.count,y.start+y.count);S<C;S+=3){const R=a.getX(S),I=a.getX(S+1),L=a.getX(S+2);o=hF(this,r,e,aw,l,h,f,m,g,R,I,L),o&&(o.faceIndex=Math.floor(S/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let b=0,T=v.length;b<T;b++){const S=v[b],C=r[S.materialIndex];for(let L=Math.max(S.start,y.start),N=Math.min(l.count,Math.min(S.start+S.count,y.start+y.count));L<N;L+=3)o=hF(this,C,e,aw,l,h,f,m,g,L,L+1,L+2),o&&(o.faceIndex=Math.floor(L/3),o.face.materialIndex=S.materialIndex,t.push(o))}else for(let S=Math.max(0,y.start),C=Math.min(l.count,y.start+y.count);S<C;S+=3)o=hF(this,r,e,aw,l,h,f,m,g,S,S+1,S+2),o&&(o.faceIndex=Math.floor(S/3),t.push(o))}}function hF(i,e,t,n,r,s,o,a,l,h,f,m){z_.fromBufferAttribute(r,h),H_.fromBufferAttribute(r,f),W_.fromBufferAttribute(r,m);const g=i.morphTargetInfluences;if(s&&g){rF.set(0,0,0),sF.set(0,0,0),oF.set(0,0,0);for(let y=0,b=s.length;y<b;y++){const T=g[y],S=s[y];0!==T&&(eU.fromBufferAttribute(S,h),tU.fromBufferAttribute(S,f),nU.fromBufferAttribute(S,m),o?(rF.addScaledVector(eU,T),sF.addScaledVector(tU,T),oF.addScaledVector(nU,T)):(rF.addScaledVector(eU.sub(z_),T),sF.addScaledVector(tU.sub(H_),T),oF.addScaledVector(nU.sub(W_),T)))}z_.add(rF),H_.add(sF),W_.add(oF)}i.isSkinnedMesh&&(i.boneTransform(h,z_),i.boneTransform(f,H_),i.boneTransform(m,W_));const v=function Fae(i,e,t,n,r,s,o,a){let l;if(l=1===e.side?n.intersectTriangle(o,s,r,!0,a):n.intersectTriangle(r,s,o,2!==e.side,a),null===l)return null;uF.copy(a),uF.applyMatrix4(i.matrixWorld);const h=t.ray.origin.distanceTo(uF);return h<t.near||h>t.far?null:{distance:h,point:uF.clone(),object:i}}(i,e,t,n,z_,H_,W_,iU);if(v){a&&(aF.fromBufferAttribute(a,h),lF.fromBufferAttribute(a,f),cF.fromBufferAttribute(a,m),v.uv=dh.getUV(iU,z_,H_,W_,aF,lF,cF,new Je)),l&&(aF.fromBufferAttribute(l,h),lF.fromBufferAttribute(l,f),cF.fromBufferAttribute(l,m),v.uv2=dh.getUV(iU,z_,H_,W_,aF,lF,cF,new Je));const y={a:h,b:f,c:m,normal:new Q,materialIndex:0};dh.getNormal(z_,H_,W_,y.normal),v.face=y}return v}class q_ extends Di{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],h=[],f=[],m=[];let g=0,v=0;function y(b,T,S,C,R,I,L,N,U,k,z){const K=I/U,te=L/k,fe=I/2,ie=L/2,ne=N/2,le=U+1,Z=k+1;let he=0,me=0;const ce=new Q;for(let be=0;be<Z;be++){const Ge=be*te-ie;for(let Ee=0;Ee<le;Ee++)ce[b]=(Ee*K-fe)*C,ce[T]=Ge*R,ce[S]=ne,h.push(ce.x,ce.y,ce.z),ce[b]=0,ce[T]=0,ce[S]=N>0?1:-1,f.push(ce.x,ce.y,ce.z),m.push(Ee/U),m.push(1-be/k),he+=1}for(let be=0;be<k;be++)for(let Ge=0;Ge<U;Ge++){const mt=g+Ge+le*(be+1),it=g+(Ge+1)+le*(be+1),Gt=g+(Ge+1)+le*be;l.push(g+Ge+le*be,mt,Gt),l.push(mt,it,Gt),me+=6}a.addGroup(v,me,z),v+=me,g+=he}y("z","y","x",-1,-1,n,t,e,o,s,0),y("z","y","x",1,-1,n,t,-e,o,s,1),y("x","z","y",1,1,e,n,t,r,o,2),y("x","z","y",1,-1,e,n,-t,r,o,3),y("x","y","z",1,-1,e,t,n,r,s,4),y("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new On(h,3)),this.setAttribute("normal",new On(f,3)),this.setAttribute("uv",new On(m,2))}static fromJSON(e){return new q_(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function lw(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];e[t][n]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function ml(i){const e={};for(let t=0;t<i.length;t++){const n=lw(i[t]);for(const r in n)e[r]=n[r]}return e}const cw={clone:lw,merge:ml};class la extends fh{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=lw(e.uniforms),this.uniformsGroups=function Lae(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class dF extends oa{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Jn,this.projectionMatrix=new Jn,this.projectionMatrixInverse=new Jn}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Ma extends dF{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*QE*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*z0*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*QE*Math.atan(Math.tan(.5*z0*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*z0*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,h=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*n/h,r*=o.width/l,n*=o.height/h}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class Nae extends oa{constructor(e,t,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new Ma(90,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Q(1,0,0)),this.add(r);const s=new Ma(90,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Q(-1,0,0)),this.add(s);const o=new Ma(90,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new Q(0,1,0)),this.add(o);const a=new Ma(90,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new Q(0,-1,0)),this.add(a);const l=new Ma(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new Q(0,0,1)),this.add(l);const h=new Ma(90,1,e,t);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new Q(0,0,-1)),this.add(h)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,s,o,a,l,h]=this.children,f=e.getRenderTarget(),m=e.toneMapping,g=e.xr.enabled;e.toneMapping=0,e.xr.enabled=!1;const v=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,s),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,a),e.setRenderTarget(n,4),e.render(t,l),n.texture.generateMipmaps=v,e.setRenderTarget(n,5),e.render(t,h),e.setRenderTarget(f),e.toneMapping=m,e.xr.enabled=g,n.texture.needsPMREMUpdate=!0}}class fF extends vd{constructor(e,t,n,r,s,o,a,l,h,f){super(e=void 0!==e?e:[],t=void 0!==t?t:301,n,r,s,o,a,l,h,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Bae extends ra{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1};this.texture=new fF([n,n,n,n,n,n],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:io}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new q_(5,5,5),s=new la({name:"CubemapFromEquirect",uniforms:lw(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new aa(r,s),a=t.minFilter;return t.minFilter===B_&&(t.minFilter=io),new Nae(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}}const rU=new Q,jae=new Q,Uae=new pu;class Om{constructor(e=new Q(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=rU.subVectors(n,t).cross(jae.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(rU),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(n).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Uae.getNormalMatrix(e),r=this.coplanarPoint(rU).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const dw=new K0,pF=new Q;class sU{constructor(e=new Om,t=new Om,n=new Om,r=new Om,s=new Om,o=new Om){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,r=n[0],s=n[1],o=n[2],a=n[3],l=n[4],h=n[5],f=n[6],m=n[7],g=n[8],v=n[9],y=n[10],b=n[11],T=n[12],S=n[13],C=n[14],R=n[15];return t[0].setComponents(a-r,m-l,b-g,R-T).normalize(),t[1].setComponents(a+r,m+l,b+g,R+T).normalize(),t[2].setComponents(a+s,m+h,b+v,R+S).normalize(),t[3].setComponents(a-s,m-h,b-v,R-S).normalize(),t[4].setComponents(a-o,m-f,b-y,R-C).normalize(),t[5].setComponents(a+o,m+f,b+y,R+C).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),dw.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(dw)}intersectsSprite(e){return dw.center.set(0,0,0),dw.radius=.7071067811865476,dw.applyMatrix4(e.matrixWorld),this.intersectsSphere(dw)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(pF.x=r.normal.x>0?e.max.x:e.min.x,pF.y=r.normal.y>0?e.max.y:e.min.y,pF.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(pF)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function $8(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function Vae(i,e){const t=e.isWebGL2,n=new WeakMap;return{get:function o(h){return h.isInterleavedBufferAttribute&&(h=h.data),n.get(h)},remove:function a(h){h.isInterleavedBufferAttribute&&(h=h.data);const f=n.get(h);f&&(i.deleteBuffer(f.buffer),n.delete(h))},update:function l(h,f){if(h.isGLBufferAttribute){const g=n.get(h);return void((!g||g.version<h.version)&&n.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version}))}h.isInterleavedBufferAttribute&&(h=h.data);const m=n.get(h);void 0===m?n.set(h,function r(h,f){const m=h.array,g=h.usage,v=i.createBuffer();let y;if(i.bindBuffer(f,v),i.bufferData(f,m,g),h.onUploadCallback(),m instanceof Float32Array)y=5126;else if(m instanceof Uint16Array)if(h.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");y=5131}else y=5123;else if(m instanceof Int16Array)y=5122;else if(m instanceof Uint32Array)y=5125;else if(m instanceof Int32Array)y=5124;else if(m instanceof Int8Array)y=5120;else if(m instanceof Uint8Array)y=5121;else{if(!(m instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+m);y=5121}return{buffer:v,type:y,bytesPerElement:m.BYTES_PER_ELEMENT,version:h.version}}(h,f)):m.version<h.version&&(function s(h,f,m){const g=f.array,v=f.updateRange;i.bindBuffer(m,h),-1===v.count?i.bufferSubData(m,0,g):(t?i.bufferSubData(m,v.offset*g.BYTES_PER_ELEMENT,g,v.offset,v.count):i.bufferSubData(m,v.offset*g.BYTES_PER_ELEMENT,g.subarray(v.offset,v.offset+v.count)),v.count=-1)}(m.buffer,h,f),m.version=h.version)}}}class fw extends Di{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(n),l=Math.floor(r),h=a+1,f=l+1,m=e/a,g=t/l,v=[],y=[],b=[],T=[];for(let S=0;S<f;S++){const C=S*g-o;for(let R=0;R<h;R++)y.push(R*m-s,-C,0),b.push(0,0,1),T.push(R/a),T.push(1-S/l)}for(let S=0;S<l;S++)for(let C=0;C<a;C++){const I=C+h*(S+1),L=C+1+h*(S+1),N=C+1+h*S;v.push(C+h*S,I,N),v.push(I,L,N)}this.setIndex(v),this.setAttribute("position",new On(y,3)),this.setAttribute("normal",new On(b,3)),this.setAttribute("uv",new On(T,2))}static fromJSON(e){return new fw(e.width,e.height,e.widthSegments,e.heightSegments)}}const Wi={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},bn={common:{diffuse:{value:new sn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new pu},uv2Transform:{value:new pu},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Je(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new sn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new sn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new pu}},sprite:{diffuse:{value:new sn(16777215)},opacity:{value:1},center:{value:new Je(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new pu}}},qf={basic:{uniforms:ml([bn.common,bn.specularmap,bn.envmap,bn.aomap,bn.lightmap,bn.fog]),vertexShader:Wi.meshbasic_vert,fragmentShader:Wi.meshbasic_frag},lambert:{uniforms:ml([bn.common,bn.specularmap,bn.envmap,bn.aomap,bn.lightmap,bn.emissivemap,bn.fog,bn.lights,{emissive:{value:new sn(0)}}]),vertexShader:Wi.meshlambert_vert,fragmentShader:Wi.meshlambert_frag},phong:{uniforms:ml([bn.common,bn.specularmap,bn.envmap,bn.aomap,bn.lightmap,bn.emissivemap,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.fog,bn.lights,{emissive:{value:new sn(0)},specular:{value:new sn(1118481)},shininess:{value:30}}]),vertexShader:Wi.meshphong_vert,fragmentShader:Wi.meshphong_frag},standard:{uniforms:ml([bn.common,bn.envmap,bn.aomap,bn.lightmap,bn.emissivemap,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.roughnessmap,bn.metalnessmap,bn.fog,bn.lights,{emissive:{value:new sn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Wi.meshphysical_vert,fragmentShader:Wi.meshphysical_frag},toon:{uniforms:ml([bn.common,bn.aomap,bn.lightmap,bn.emissivemap,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.gradientmap,bn.fog,bn.lights,{emissive:{value:new sn(0)}}]),vertexShader:Wi.meshtoon_vert,fragmentShader:Wi.meshtoon_frag},matcap:{uniforms:ml([bn.common,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.fog,{matcap:{value:null}}]),vertexShader:Wi.meshmatcap_vert,fragmentShader:Wi.meshmatcap_frag},points:{uniforms:ml([bn.points,bn.fog]),vertexShader:Wi.points_vert,fragmentShader:Wi.points_frag},dashed:{uniforms:ml([bn.common,bn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Wi.linedashed_vert,fragmentShader:Wi.linedashed_frag},depth:{uniforms:ml([bn.common,bn.displacementmap]),vertexShader:Wi.depth_vert,fragmentShader:Wi.depth_frag},normal:{uniforms:ml([bn.common,bn.bumpmap,bn.normalmap,bn.displacementmap,{opacity:{value:1}}]),vertexShader:Wi.meshnormal_vert,fragmentShader:Wi.meshnormal_frag},sprite:{uniforms:ml([bn.sprite,bn.fog]),vertexShader:Wi.sprite_vert,fragmentShader:Wi.sprite_frag},background:{uniforms:{uvTransform:{value:new pu},t2D:{value:null}},vertexShader:Wi.background_vert,fragmentShader:Wi.background_frag},cube:{uniforms:ml([bn.envmap,{opacity:{value:1}}]),vertexShader:Wi.cube_vert,fragmentShader:Wi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Wi.equirect_vert,fragmentShader:Wi.equirect_frag},distanceRGBA:{uniforms:ml([bn.common,bn.displacementmap,{referencePosition:{value:new Q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Wi.distanceRGBA_vert,fragmentShader:Wi.distanceRGBA_frag},shadow:{uniforms:ml([bn.lights,bn.fog,{color:{value:new sn(0)},opacity:{value:1}}]),vertexShader:Wi.shadow_vert,fragmentShader:Wi.shadow_frag}};function jce(i,e,t,n,r,s){const o=new sn(0);let l,h,a=!0===r?0:1,f=null,m=0,g=null;function y(b,T){t.buffers.color.setClear(b.r,b.g,b.b,T,s)}return{getClearColor:function(){return o},setClearColor:function(b,T=1){o.set(b),a=T,y(o,a)},getClearAlpha:function(){return a},setClearAlpha:function(b){a=b,y(o,a)},render:function v(b,T){let S=!1,C=!0===T.isScene?T.background:null;C&&C.isTexture&&(C=e.get(C));const R=i.xr,I=R.getSession&&R.getSession();I&&"additive"===I.environmentBlendMode&&(C=null),null===C?y(o,a):C&&C.isColor&&(y(C,1),S=!0),(i.autoClear||S)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),C&&(C.isCubeTexture||306===C.mapping)?(void 0===h&&(h=new aa(new q_(1,1,1),new la({name:"BackgroundCubeMaterial",uniforms:lw(qf.cube.uniforms),vertexShader:qf.cube.vertexShader,fragmentShader:qf.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(L,N,U){this.matrixWorld.copyPosition(U.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(h)),h.material.uniforms.envMap.value=C,h.material.uniforms.flipEnvMap.value=C.isCubeTexture&&!1===C.isRenderTargetTexture?-1:1,(f!==C||m!==C.version||g!==i.toneMapping)&&(h.material.needsUpdate=!0,f=C,m=C.version,g=i.toneMapping),h.layers.enableAll(),b.unshift(h,h.geometry,h.material,0,0,null)):C&&C.isTexture&&(void 0===l&&(l=new aa(new fw(2,2),new la({name:"BackgroundMaterial",uniforms:lw(qf.background.uniforms),vertexShader:qf.background.vertexShader,fragmentShader:qf.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(l)),l.material.uniforms.t2D.value=C,!0===C.matrixAutoUpdate&&C.updateMatrix(),l.material.uniforms.uvTransform.value.copy(C.matrix),(f!==C||m!==C.version||g!==i.toneMapping)&&(l.material.needsUpdate=!0,f=C,m=C.version,g=i.toneMapping),l.layers.enableAll(),b.unshift(l,l.geometry,l.material,0,0,null))}}}function Uce(i,e,t,n){const r=i.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||null!==s,a={},l=T(null);let h=l,f=!1;function v(ne){return n.isWebGL2?i.bindVertexArray(ne):s.bindVertexArrayOES(ne)}function y(ne){return n.isWebGL2?i.deleteVertexArray(ne):s.deleteVertexArrayOES(ne)}function T(ne){const le=[],Z=[],he=[];for(let me=0;me<r;me++)le[me]=0,Z[me]=0,he[me]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:le,enabledAttributes:Z,attributeDivisors:he,object:ne,attributes:{},index:null}}function R(){const ne=h.newAttributes;for(let le=0,Z=ne.length;le<Z;le++)ne[le]=0}function I(ne){L(ne,0)}function L(ne,le){const he=h.enabledAttributes,me=h.attributeDivisors;h.newAttributes[ne]=1,0===he[ne]&&(i.enableVertexAttribArray(ne),he[ne]=1),me[ne]!==le&&((n.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](ne,le),me[ne]=le)}function N(){const ne=h.newAttributes,le=h.enabledAttributes;for(let Z=0,he=le.length;Z<he;Z++)le[Z]!==ne[Z]&&(i.disableVertexAttribArray(Z),le[Z]=0)}function U(ne,le,Z,he,me,ce){!0!==n.isWebGL2||5124!==Z&&5125!==Z?i.vertexAttribPointer(ne,le,Z,he,me,ce):i.vertexAttribIPointer(ne,le,Z,me,ce)}function fe(){ie(),f=!0,h!==l&&(h=l,v(h.object))}function ie(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function m(ne,le,Z,he,me){let ce=!1;if(o){const be=function b(ne,le,Z){const he=!0===Z.wireframe;let me=a[ne.id];void 0===me&&(me={},a[ne.id]=me);let ce=me[le.id];void 0===ce&&(ce={},me[le.id]=ce);let be=ce[he];return void 0===be&&(be=T(function g(){return n.isWebGL2?i.createVertexArray():s.createVertexArrayOES()}()),ce[he]=be),be}(he,Z,le);h!==be&&(h=be,v(h.object)),ce=function S(ne,le,Z,he){const me=h.attributes,ce=le.attributes;let be=0;const Ge=Z.getAttributes();for(const Ee in Ge)if(Ge[Ee].location>=0){const it=me[Ee];let Gt=ce[Ee];if(void 0===Gt&&("instanceMatrix"===Ee&&ne.instanceMatrix&&(Gt=ne.instanceMatrix),"instanceColor"===Ee&&ne.instanceColor&&(Gt=ne.instanceColor)),void 0===it||it.attribute!==Gt||Gt&&it.data!==Gt.data)return!0;be++}return h.attributesNum!==be||h.index!==he}(ne,he,Z,me),ce&&function C(ne,le,Z,he){const me={},ce=le.attributes;let be=0;const Ge=Z.getAttributes();for(const Ee in Ge)if(Ge[Ee].location>=0){let it=ce[Ee];void 0===it&&("instanceMatrix"===Ee&&ne.instanceMatrix&&(it=ne.instanceMatrix),"instanceColor"===Ee&&ne.instanceColor&&(it=ne.instanceColor));const Gt={};Gt.attribute=it,it&&it.data&&(Gt.data=it.data),me[Ee]=Gt,be++}h.attributes=me,h.attributesNum=be,h.index=he}(ne,he,Z,me)}else{const be=!0===le.wireframe;(h.geometry!==he.id||h.program!==Z.id||h.wireframe!==be)&&(h.geometry=he.id,h.program=Z.id,h.wireframe=be,ce=!0)}null!==me&&t.update(me,34963),(ce||f)&&(f=!1,function k(ne,le,Z,he){if(!1===n.isWebGL2&&(ne.isInstancedMesh||he.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;R();const me=he.attributes,ce=Z.getAttributes(),be=le.defaultAttributeValues;for(const Ge in ce){const Ee=ce[Ge];if(Ee.location>=0){let mt=me[Ge];if(void 0===mt&&("instanceMatrix"===Ge&&ne.instanceMatrix&&(mt=ne.instanceMatrix),"instanceColor"===Ge&&ne.instanceColor&&(mt=ne.instanceColor)),void 0!==mt){const it=mt.normalized,Gt=mt.itemSize,Ve=t.get(mt);if(void 0===Ve)continue;const Ie=Ve.buffer,pt=Ve.type,Wt=Ve.bytesPerElement;if(mt.isInterleavedBufferAttribute){const It=mt.data,wn=It.stride,ft=mt.offset;if(It.isInstancedInterleavedBuffer){for(let vt=0;vt<Ee.locationSize;vt++)L(Ee.location+vt,It.meshPerAttribute);!0!==ne.isInstancedMesh&&void 0===he._maxInstanceCount&&(he._maxInstanceCount=It.meshPerAttribute*It.count)}else for(let vt=0;vt<Ee.locationSize;vt++)I(Ee.location+vt);i.bindBuffer(34962,Ie);for(let vt=0;vt<Ee.locationSize;vt++)U(Ee.location+vt,Gt/Ee.locationSize,pt,it,wn*Wt,(ft+Gt/Ee.locationSize*vt)*Wt)}else{if(mt.isInstancedBufferAttribute){for(let It=0;It<Ee.locationSize;It++)L(Ee.location+It,mt.meshPerAttribute);!0!==ne.isInstancedMesh&&void 0===he._maxInstanceCount&&(he._maxInstanceCount=mt.meshPerAttribute*mt.count)}else for(let It=0;It<Ee.locationSize;It++)I(Ee.location+It);i.bindBuffer(34962,Ie);for(let It=0;It<Ee.locationSize;It++)U(Ee.location+It,Gt/Ee.locationSize,pt,it,Gt*Wt,Gt/Ee.locationSize*It*Wt)}}else if(void 0!==be){const it=be[Ge];if(void 0!==it)switch(it.length){case 2:i.vertexAttrib2fv(Ee.location,it);break;case 3:i.vertexAttrib3fv(Ee.location,it);break;case 4:i.vertexAttrib4fv(Ee.location,it);break;default:i.vertexAttrib1fv(Ee.location,it)}}}}N()}(ne,le,Z,he),null!==me&&i.bindBuffer(34963,t.get(me).buffer))},reset:fe,resetDefaultState:ie,dispose:function z(){fe();for(const ne in a){const le=a[ne];for(const Z in le){const he=le[Z];for(const me in he)y(he[me].object),delete he[me];delete le[Z]}delete a[ne]}},releaseStatesOfGeometry:function K(ne){if(void 0===a[ne.id])return;const le=a[ne.id];for(const Z in le){const he=le[Z];for(const me in he)y(he[me].object),delete he[me];delete le[Z]}delete a[ne.id]},releaseStatesOfProgram:function te(ne){for(const le in a){const Z=a[le];if(void 0===Z[ne.id])continue;const he=Z[ne.id];for(const me in he)y(he[me].object),delete he[me];delete Z[ne.id]}},initAttributes:R,enableAttribute:I,disableUnusedAttributes:N}}function Vce(i,e,t,n){const r=n.isWebGL2;let s;this.setMode=function o(h){s=h},this.render=function a(h,f){i.drawArrays(s,h,f),t.update(f,s,1)},this.renderInstances=function l(h,f,m){if(0===m)return;let g,v;if(r)g=i,v="drawArraysInstanced";else if(g=e.get("ANGLE_instanced_arrays"),v="drawArraysInstancedANGLE",null===g)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");g[v](s,h,f,m),t.update(f,s,m)}}function Gce(i,e,t){let n;function s(U){if("highp"===U){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";U="mediump"}return"mediump"===U&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&i instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&i instanceof WebGL2ComputeRenderingContext;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const h=o||e.has("WEBGL_draw_buffers"),f=!0===t.logarithmicDepthBuffer,m=i.getParameter(34930),g=i.getParameter(35660),v=i.getParameter(3379),y=i.getParameter(34076),b=i.getParameter(34921),T=i.getParameter(36347),S=i.getParameter(36348),C=i.getParameter(36349),R=g>0,I=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:h,getMaxAnisotropy:function r(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const U=e.get("EXT_texture_filter_anisotropic");n=i.getParameter(U.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:f,maxTextures:m,maxVertexTextures:g,maxTextureSize:v,maxCubemapSize:y,maxAttributes:b,maxVertexUniforms:T,maxVaryings:S,maxFragmentUniforms:C,vertexTextures:R,floatFragmentTextures:I,floatVertexTextures:R&&I,maxSamples:o?i.getParameter(36183):0}}function zce(i){const e=this;let t=null,n=0,r=!1,s=!1;const o=new Om,a=new pu,l={value:null,needsUpdate:!1};function h(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function f(m,g,v,y){const b=null!==m?m.length:0;let T=null;if(0!==b){if(T=l.value,!0!==y||null===T){const S=v+4*b,C=g.matrixWorldInverse;a.getNormalMatrix(C),(null===T||T.length<S)&&(T=new Float32Array(S));for(let R=0,I=v;R!==b;++R,I+=4)o.copy(m[R]).applyMatrix4(C,a),o.normal.toArray(T,I),T[I+3]=o.constant}l.value=T,l.needsUpdate=!0}return e.numPlanes=b,e.numIntersection=0,T}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(m,g,v){const y=0!==m.length||g||0!==n||r;return r=g,t=f(m,v,0),n=m.length,y},this.beginShadows=function(){s=!0,f(null)},this.endShadows=function(){s=!1,h()},this.setState=function(m,g,v){const y=m.clippingPlanes,b=m.clipIntersection,T=m.clipShadows,S=i.get(m);if(!r||null===y||0===y.length||s&&!T)s?f(null):h();else{const C=s?0:n,R=4*C;let I=S.clippingState||null;l.value=I,I=f(y,g,R,v);for(let L=0;L!==R;++L)I[L]=t[L];S.clippingState=I,this.numIntersection=b?this.numPlanes:0,this.numPlanes+=C}}}function Hce(i){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=301:304===a&&(o.mapping=302),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function n(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const h=new Bae(l.height/2);return h.fromEquirectangularTexture(i,o),e.set(o,h),o.addEventListener("dispose",r),t(h.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}qf.physical={uniforms:ml([qf.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Je(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new sn(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Je},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new sn(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new sn(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Wi.meshphysical_vert,fragmentShader:Wi.meshphysical_frag};class pw extends dF{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=h*this.view.offsetX,o=s+h*this.view.width,a-=f*this.view.offsetY,l=a-f*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Q8=[.125,.215,.35,.446,.526,.582],oU=new pw,J8=new sn;let aU=null;const $0=(1+Math.sqrt(5))/2,gw=1/$0,eq=[new Q(1,1,1),new Q(-1,1,1),new Q(1,1,-1),new Q(-1,1,-1),new Q(0,$0,gw),new Q(0,$0,-gw),new Q(gw,0,$0),new Q(-gw,0,$0),new Q($0,gw,0),new Q(-$0,gw,0)];class tq{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){aU=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=rq(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=iq(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(aU),e.scissorTest=!1,mF(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),aU=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:io,minFilter:io,generateMipmaps:!1,type:Wf,format:kl,encoding:j0,depthBuffer:!1},r=nq(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=nq(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function Wce(i){const e=[],t=[],n=[];let r=i;const s=i-4+1+Q8.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>i-4?l=Q8[o-i+4-1]:0===o&&(l=0),n.push(l);const h=1/(a-2),f=-h,m=1+h,g=[f,f,m,f,m,m,f,f,m,m,f,m],v=6,y=6,b=3,T=2,S=1,C=new Float32Array(b*y*v),R=new Float32Array(T*y*v),I=new Float32Array(S*y*v);for(let N=0;N<v;N++){const U=N%3*2/3-1,k=N>2?0:-1;C.set([U,k,0,U+2/3,k,0,U+2/3,k+1,0,U,k,0,U+2/3,k+1,0,U,k+1,0],b*y*N),R.set(g,T*y*N),I.set([N,N,N,N,N,N],S*y*N)}const L=new Di;L.setAttribute("position",new Uo(C,b)),L.setAttribute("uv",new Uo(R,T)),L.setAttribute("faceIndex",new Uo(I,S)),e.push(L),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}(s)),this._blurMaterial=function qce(i,e,t){const n=new Float32Array(20),r=new Q(0,1,0);return new la({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new aa(this._lodPlanes[0],e);this._renderer.compile(t,oU)}_sceneToCubeUV(e,t,n,r){const a=new Ma(90,1,t,n),l=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],f=this._renderer,m=f.autoClear,g=f.toneMapping;f.getClearColor(J8),f.toneMapping=0,f.autoClear=!1;const v=new Ta({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),y=new aa(new q_,v);let b=!1;const T=e.background;T?T.isColor&&(v.color.copy(T),e.background=null,b=!0):(v.color.copy(J8),b=!0);for(let S=0;S<6;S++){const C=S%3;0===C?(a.up.set(0,l[S],0),a.lookAt(h[S],0,0)):1===C?(a.up.set(0,0,l[S]),a.lookAt(0,h[S],0)):(a.up.set(0,l[S],0),a.lookAt(0,0,h[S]));const R=this._cubeSize;mF(r,C*R,S>2?R:0,R,R),f.setRenderTarget(r),b&&f.render(y,a),f.render(e,a)}y.geometry.dispose(),y.material.dispose(),f.toneMapping=g,f.autoClear=m,e.background=T}_textureToCubeUV(e,t){const n=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=rq()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=iq());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new aa(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;mF(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(o,oU)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,eq[(r-1)%eq.length])}t.autoClear=n}_blur(e,t,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){const l=this._renderer,h=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const m=new aa(this._lodPlanes[r],h),g=h.uniforms,v=this._sizeLods[n]-1,y=isFinite(s)?Math.PI/(2*v):2*Math.PI/39,b=s/y,T=isFinite(s)?1+Math.floor(3*b):20;T>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${T} samples when the maximum is set to 20`);const S=[];let C=0;for(let U=0;U<20;++U){const k=U/b,z=Math.exp(-k*k/2);S.push(z),0===U?C+=z:U<T&&(C+=2*z)}for(let U=0;U<S.length;U++)S[U]=S[U]/C;g.envMap.value=e.texture,g.samples.value=T,g.weights.value=S,g.latitudinal.value="latitudinal"===o,a&&(g.poleAxis.value=a);const{_lodMax:R}=this;g.dTheta.value=y,g.mipInt.value=R-n;const I=this._sizeLods[r];mF(t,3*I*(r>R-4?r-R+4:0),4*(this._cubeSize-I),3*I,2*I),l.setRenderTarget(t),l.render(m,oU)}}function nq(i,e,t){const n=new ra(i,e,t);return n.texture.mapping=306,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function mF(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function iq(){return new la({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function rq(){return new la({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Zce(i){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const h=e.get(l);void 0!==h&&(e.delete(l),h.dispose())}return{get:function n(a){if(a&&a.isTexture){const l=a.mapping,h=303===l||304===l,f=301===l||302===l;if(h||f){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let m=e.get(a);return null===t&&(t=new tq(i)),m=h?t.fromEquirectangular(a,m):t.fromCubemap(a,m),e.set(a,m),m.texture}if(e.has(a))return e.get(a).texture;{const m=a.image;if(h&&m&&m.height>0||f&&m&&function r(a){let l=0;for(let f=0;f<6;f++)void 0!==a[f]&&l++;return 6===l}(m)){null===t&&(t=new tq(i));const g=h?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,g),a.addEventListener("dispose",s),g.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Yce(i){const e={};function t(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return null!==t(n)},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const r=t(n);return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function Kce(i,e,t,n){const r={},s=new WeakMap;function o(m){const g=m.target;null!==g.index&&e.remove(g.index);for(const y in g.attributes)e.remove(g.attributes[y]);g.removeEventListener("dispose",o),delete r[g.id];const v=s.get(g);v&&(e.remove(v),s.delete(g)),n.releaseStatesOfGeometry(g),!0===g.isInstancedBufferGeometry&&delete g._maxInstanceCount,t.memory.geometries--}function h(m){const g=[],v=m.index,y=m.attributes.position;let b=0;if(null!==v){const C=v.array;b=v.version;for(let R=0,I=C.length;R<I;R+=3){const L=C[R+0],N=C[R+1],U=C[R+2];g.push(L,N,N,U,U,L)}}else{b=y.version;for(let R=0,I=y.array.length/3-1;R<I;R+=3){const L=R+0,N=R+1,U=R+2;g.push(L,N,N,U,U,L)}}const T=new(O8(g)?$j:K8)(g,1);T.version=b;const S=s.get(m);S&&e.remove(S),s.set(m,T)}return{get:function a(m,g){return!0===r[g.id]||(g.addEventListener("dispose",o),r[g.id]=!0,t.memory.geometries++),g},update:function l(m){const g=m.attributes;for(const y in g)e.update(g[y],34962);const v=m.morphAttributes;for(const y in v){const b=v[y];for(let T=0,S=b.length;T<S;T++)e.update(b[T],34962)}},getWireframeAttribute:function f(m){const g=s.get(m);if(g){const v=m.index;null!==v&&g.version<v.version&&h(m)}else h(m);return s.get(m)}}}function Xce(i,e,t,n){const r=n.isWebGL2;let s,a,l;this.setMode=function o(g){s=g},this.setIndex=function h(g){a=g.type,l=g.bytesPerElement},this.render=function f(g,v){i.drawElements(s,v,a,g*l),t.update(v,s,1)},this.renderInstances=function m(g,v,y){if(0===y)return;let b,T;if(r)b=i,T="drawElementsInstanced";else if(b=e.get("ANGLE_instanced_arrays"),T="drawElementsInstancedANGLE",null===b)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");b[T](s,v,a,g*l,y),t.update(v,s,y)}}function $ce(i){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function n(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function Qce(i,e){return i[0]-e[0]}function Jce(i,e){return Math.abs(e[1])-Math.abs(i[1])}function cU(i,e){let t=1;const n=e.isInterleavedBufferAttribute?e.data.array:e.array;n instanceof Int8Array?t=127:n instanceof Uint8Array?t=255:n instanceof Uint16Array?t=65535:n instanceof Int16Array?t=32767:n instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",n),i.divideScalar(t)}function eue(i,e,t){const n={},r=new Float32Array(8),s=new WeakMap,o=new hr,a=[];for(let h=0;h<8;h++)a[h]=[h,0];return{update:function l(h,f,m,g){const v=h.morphTargetInfluences;if(!0===e.isWebGL2){const y=f.morphAttributes.position||f.morphAttributes.normal||f.morphAttributes.color,b=void 0!==y?y.length:0;let T=s.get(f);if(void 0===T||T.count!==b){let le=function(){ie.dispose(),s.delete(f),f.removeEventListener("dispose",le)};void 0!==T&&T.texture.dispose();const R=void 0!==f.morphAttributes.position,I=void 0!==f.morphAttributes.normal,L=void 0!==f.morphAttributes.color,N=f.morphAttributes.position||[],U=f.morphAttributes.normal||[],k=f.morphAttributes.color||[];let z=0;!0===R&&(z=1),!0===I&&(z=2),!0===L&&(z=3);let K=f.attributes.position.count*z,te=1;K>e.maxTextureSize&&(te=Math.ceil(K/e.maxTextureSize),K=e.maxTextureSize);const fe=new Float32Array(K*te*4*b),ie=new Bj(fe,K,te,b);ie.type=hh,ie.needsUpdate=!0;const ne=4*z;for(let Z=0;Z<b;Z++){const he=N[Z],me=U[Z],ce=k[Z],be=K*te*4*Z;for(let Ge=0;Ge<he.count;Ge++){const Ee=Ge*ne;!0===R&&(o.fromBufferAttribute(he,Ge),!0===he.normalized&&cU(o,he),fe[be+Ee+0]=o.x,fe[be+Ee+1]=o.y,fe[be+Ee+2]=o.z,fe[be+Ee+3]=0),!0===I&&(o.fromBufferAttribute(me,Ge),!0===me.normalized&&cU(o,me),fe[be+Ee+4]=o.x,fe[be+Ee+5]=o.y,fe[be+Ee+6]=o.z,fe[be+Ee+7]=0),!0===L&&(o.fromBufferAttribute(ce,Ge),!0===ce.normalized&&cU(o,ce),fe[be+Ee+8]=o.x,fe[be+Ee+9]=o.y,fe[be+Ee+10]=o.z,fe[be+Ee+11]=4===ce.itemSize?o.w:1)}}T={count:b,texture:ie,size:new Je(K,te)},s.set(f,T),f.addEventListener("dispose",le)}let S=0;for(let R=0;R<v.length;R++)S+=v[R];const C=f.morphTargetsRelative?1:1-S;g.getUniforms().setValue(i,"morphTargetBaseInfluence",C),g.getUniforms().setValue(i,"morphTargetInfluences",v),g.getUniforms().setValue(i,"morphTargetsTexture",T.texture,t),g.getUniforms().setValue(i,"morphTargetsTextureSize",T.size)}else{const y=void 0===v?0:v.length;let b=n[f.id];if(void 0===b||b.length!==y){b=[];for(let I=0;I<y;I++)b[I]=[I,0];n[f.id]=b}for(let I=0;I<y;I++){const L=b[I];L[0]=I,L[1]=v[I]}b.sort(Jce);for(let I=0;I<8;I++)I<y&&b[I][1]?(a[I][0]=b[I][0],a[I][1]=b[I][1]):(a[I][0]=Number.MAX_SAFE_INTEGER,a[I][1]=0);a.sort(Qce);const T=f.morphAttributes.position,S=f.morphAttributes.normal;let C=0;for(let I=0;I<8;I++){const L=a[I],N=L[0],U=L[1];N!==Number.MAX_SAFE_INTEGER&&U?(T&&f.getAttribute("morphTarget"+I)!==T[N]&&f.setAttribute("morphTarget"+I,T[N]),S&&f.getAttribute("morphNormal"+I)!==S[N]&&f.setAttribute("morphNormal"+I,S[N]),r[I]=U,C+=U):(T&&!0===f.hasAttribute("morphTarget"+I)&&f.deleteAttribute("morphTarget"+I),S&&!0===f.hasAttribute("morphNormal"+I)&&f.deleteAttribute("morphNormal"+I),r[I]=0)}const R=f.morphTargetsRelative?1:1-C;g.getUniforms().setValue(i,"morphTargetBaseInfluence",R),g.getUniforms().setValue(i,"morphTargetInfluences",r)}}}}function tue(i,e,t,n){let r=new WeakMap;function a(l){const h=l.target;h.removeEventListener("dispose",a),t.remove(h.instanceMatrix),null!==h.instanceColor&&t.remove(h.instanceColor)}return{update:function s(l){const h=n.render.frame,m=e.get(l,l.geometry);return r.get(m)!==h&&(e.update(m),r.set(m,h)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),m},dispose:function o(){r=new WeakMap}}}const sq=new vd,oq=new Bj,aq=new B8,lq=new fF,cq=[],uq=[],hq=new Float32Array(16),dq=new Float32Array(9),fq=new Float32Array(4);function _w(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=cq[r];if(void 0===s&&(s=new Float32Array(r),cq[r]=s),0!==e){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function Nl(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function Bl(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function gF(i,e){let t=uq[e];void 0===t&&(t=new Int32Array(e),uq[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function nue(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function iue(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Nl(t,e))return;i.uniform2fv(this.addr,e),Bl(t,e)}}function rue(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Nl(t,e))return;i.uniform3fv(this.addr,e),Bl(t,e)}}function sue(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Nl(t,e))return;i.uniform4fv(this.addr,e),Bl(t,e)}}function oue(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Nl(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Bl(t,e)}else{if(Nl(t,n))return;fq.set(n),i.uniformMatrix2fv(this.addr,!1,fq),Bl(t,n)}}function aue(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Nl(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Bl(t,e)}else{if(Nl(t,n))return;dq.set(n),i.uniformMatrix3fv(this.addr,!1,dq),Bl(t,n)}}function lue(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Nl(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Bl(t,e)}else{if(Nl(t,n))return;hq.set(n),i.uniformMatrix4fv(this.addr,!1,hq),Bl(t,n)}}function cue(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function uue(i,e){const t=this.cache;Nl(t,e)||(i.uniform2iv(this.addr,e),Bl(t,e))}function hue(i,e){const t=this.cache;Nl(t,e)||(i.uniform3iv(this.addr,e),Bl(t,e))}function due(i,e){const t=this.cache;Nl(t,e)||(i.uniform4iv(this.addr,e),Bl(t,e))}function fue(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function pue(i,e){const t=this.cache;Nl(t,e)||(i.uniform2uiv(this.addr,e),Bl(t,e))}function mue(i,e){const t=this.cache;Nl(t,e)||(i.uniform3uiv(this.addr,e),Bl(t,e))}function gue(i,e){const t=this.cache;Nl(t,e)||(i.uniform4uiv(this.addr,e),Bl(t,e))}function _ue(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2D(e||sq,r)}function vue(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||aq,r)}function yue(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||lq,r)}function bue(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||oq,r)}function Tue(i,e){i.uniform1fv(this.addr,e)}function wue(i,e){const t=_w(e,this.size,2);i.uniform2fv(this.addr,t)}function Mue(i,e){const t=_w(e,this.size,3);i.uniform3fv(this.addr,t)}function Sue(i,e){const t=_w(e,this.size,4);i.uniform4fv(this.addr,t)}function Cue(i,e){const t=_w(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function Eue(i,e){const t=_w(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function Aue(i,e){const t=_w(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function Due(i,e){i.uniform1iv(this.addr,e)}function Rue(i,e){i.uniform2iv(this.addr,e)}function Iue(i,e){i.uniform3iv(this.addr,e)}function Pue(i,e){i.uniform4iv(this.addr,e)}function Fue(i,e){i.uniform1uiv(this.addr,e)}function Lue(i,e){i.uniform2uiv(this.addr,e)}function Oue(i,e){i.uniform3uiv(this.addr,e)}function kue(i,e){i.uniform4uiv(this.addr,e)}function Nue(i,e,t){const n=e.length,r=gF(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture2D(e[s]||sq,r[s])}function Bue(i,e,t){const n=e.length,r=gF(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture3D(e[s]||aq,r[s])}function jue(i,e,t){const n=e.length,r=gF(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTextureCube(e[s]||lq,r[s])}function Uue(i,e,t){const n=e.length,r=gF(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture2DArray(e[s]||oq,r[s])}class Gue{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function xue(i){switch(i){case 5126:return nue;case 35664:return iue;case 35665:return rue;case 35666:return sue;case 35674:return oue;case 35675:return aue;case 35676:return lue;case 5124:case 35670:return cue;case 35667:case 35671:return uue;case 35668:case 35672:return hue;case 35669:case 35673:return due;case 5125:return fue;case 36294:return pue;case 36295:return mue;case 36296:return gue;case 35678:case 36198:case 36298:case 36306:case 35682:return _ue;case 35679:case 36299:case 36307:return vue;case 35680:case 36300:case 36308:case 36293:return yue;case 36289:case 36303:case 36311:case 36292:return bue}}(t.type)}}class zue{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function Vue(i){switch(i){case 5126:return Tue;case 35664:return wue;case 35665:return Mue;case 35666:return Sue;case 35674:return Cue;case 35675:return Eue;case 35676:return Aue;case 5124:case 35670:return Due;case 35667:case 35671:return Rue;case 35668:case 35672:return Iue;case 35669:case 35673:return Pue;case 5125:return Fue;case 36294:return Lue;case 36295:return Oue;case 36296:return kue;case 35678:case 36198:case 36298:case 36306:case 35682:return Nue;case 35679:case 36299:case 36307:return Bue;case 35680:case 36300:case 36308:case 36293:return jue;case 36289:case 36303:case 36311:case 36292:return Uue}}(t.type)}}class Hue{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],n)}}}const uU=/(\w+)(\])?(\[|\.)?/g;function pq(i,e){i.seq.push(e),i.map[e.id]=e}function Wue(i,e,t){const n=i.name,r=n.length;for(uU.lastIndex=0;;){const s=uU.exec(n),o=uU.lastIndex;let a=s[1];const h=s[3];if("]"===s[2]&&(a|=0),void 0===h||"["===h&&o+2===r){pq(t,void 0===h?new Gue(a,i,e):new zue(a,i,e));break}{let m=t.map[a];void 0===m&&(m=new Hue(a),pq(t,m)),t=m}}}class _F{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let r=0;r<n;++r){const s=e.getActiveUniform(t,r);Wue(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,n,r){const s=this.map[t];void 0!==s&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=n[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&n.push(o)}return n}}function mq(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}let que=0;function gq(i,e,t){const n=i.getShaderParameter(e,35713),r=i.getShaderInfoLog(e).trim();if(n&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function Zue(i,e){const t=i.split("\n"),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join("\n")}(i.getShaderSource(e),o)}return r}function Kue(i,e){const t=function Yue(i){switch(i){case j0:return["Linear","( value )"];case ur:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}(e);return"vec4 "+i+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function Xue(i,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function rA(i){return""!==i}function _q(i,e){return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function vq(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const ehe=/^[ \t]*#include +<([\w\d./]+)>/gm;function hU(i){return i.replace(ehe,the)}function the(i,e){const t=Wi[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return hU(t)}const nhe=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,ihe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function yq(i){return i.replace(ihe,bq).replace(nhe,rhe)}function rhe(i,e,t,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),bq(0,e,t,n)}function bq(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function xq(i){let e="precision "+i.precision+" float;\nprecision "+i.precision+" int;";return"highp"===i.precision?e+="\n#define HIGH_PRECISION":"mediump"===i.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===i.precision&&(e+="\n#define LOW_PRECISION"),e}function uhe(i,e,t,n){const r=i.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function she(i){let e="SHADOWMAP_TYPE_BASIC";return 1===i.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===i.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===i.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),h=function ohe(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),f=function ahe(i){let e="ENVMAP_MODE_REFLECTION";return i.envMap&&302===i.envMapMode&&(e="ENVMAP_MODE_REFRACTION"),e}(t),m=function lhe(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),g=function che(i){const e=i.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(t),v=t.isWebGL2?"":function $ue(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||"physical"===i.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(rA).join("\n")}(t),y=function Que(i){const e=[];for(const t in i){const n=i[t];!1!==n&&e.push("#define "+t+" "+n)}return e.join("\n")}(s),b=r.createProgram();let T,S,C=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(T=[y].filter(rA).join("\n"),T.length>0&&(T+="\n"),S=[v,y].filter(rA).join("\n"),S.length>0&&(S+="\n")):(T=[xq(t),"#define SHADER_NAME "+t.shaderName,y,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(rA).join("\n"),S=[v,xq(t),"#define SHADER_NAME "+t.shaderName,y,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+f:"",t.envMap?"#define "+m:"",g?"#define CUBEUV_TEXEL_WIDTH "+g.texelWidth:"",g?"#define CUBEUV_TEXEL_HEIGHT "+g.texelHeight:"",g?"#define CUBEUV_MAX_MIP "+g.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?Wi.tonemapping_pars_fragment:"",0!==t.toneMapping?Xue("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Wi.encodings_pars_fragment,Kue("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(rA).join("\n")),o=hU(o),o=_q(o,t),o=vq(o,t),a=hU(a),a=_q(a,t),a=vq(a,t),o=yq(o),a=yq(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(C="#version 300 es\n",T=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+T,S=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+S);const I=C+S+a,L=mq(r,35633,C+T+o),N=mq(r,35632,I);if(r.attachShader(b,L),r.attachShader(b,N),void 0!==t.index0AttributeName?r.bindAttribLocation(b,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(b,0,"position"),r.linkProgram(b),i.debug.checkShaderErrors){const z=r.getProgramInfoLog(b).trim(),K=r.getShaderInfoLog(L).trim(),te=r.getShaderInfoLog(N).trim();let fe=!0,ie=!0;if(!1===r.getProgramParameter(b,35714)){fe=!1;const ne=gq(r,L,"vertex"),le=gq(r,N,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(b,35715)+"\n\nProgram Info Log: "+z+"\n"+ne+"\n"+le)}else""!==z?console.warn("THREE.WebGLProgram: Program Info Log:",z):(""===K||""===te)&&(ie=!1);ie&&(this.diagnostics={runnable:fe,programLog:z,vertexShader:{log:K,prefix:T},fragmentShader:{log:te,prefix:S}})}let U,k;return r.deleteShader(L),r.deleteShader(N),this.getUniforms=function(){return void 0===U&&(U=new _F(r,b)),U},this.getAttributes=function(){return void 0===k&&(k=function Jue(i,e){const t={},n=i.getProgramParameter(e,35721);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}(r,b)),k},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(b),this.program=void 0},this.name=t.shaderName,this.id=que++,this.cacheKey=e,this.usedTimes=1,this.program=b,this.vertexShader=L,this.fragmentShader=N,this}let hhe=0;class dhe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const n=new fhe(e);t.set(e,n)}return t.get(e)}}class fhe{constructor(e){this.id=hhe++,this.code=e,this.usedTimes=0}}function phe(i,e,t,n,r,s,o){const a=new qj,l=new dhe,h=[],f=r.isWebGL2,m=r.logarithmicDepthBuffer,g=r.vertexTextures;let v=r.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function b(k,z,K,te,fe){const ie=te.fog,ne=fe.geometry,Z=(k.isMeshStandardMaterial?t:e).get(k.envMap||(k.isMeshStandardMaterial?te.environment:null)),he=Z&&306===Z.mapping?Z.image.height:null,me=y[k.type];null!==k.precision&&(v=r.getMaxPrecision(k.precision),v!==k.precision&&console.warn("THREE.WebGLProgram.getParameters:",k.precision,"not supported, using",v,"instead."));const ce=ne.morphAttributes.position||ne.morphAttributes.normal||ne.morphAttributes.color,be=void 0!==ce?ce.length:0;let Ee,mt,it,Gt,Ge=0;if(void 0!==ne.morphAttributes.position&&(Ge=1),void 0!==ne.morphAttributes.normal&&(Ge=2),void 0!==ne.morphAttributes.color&&(Ge=3),me){const wn=qf[me];Ee=wn.vertexShader,mt=wn.fragmentShader}else Ee=k.vertexShader,mt=k.fragmentShader,l.update(k),it=l.getVertexShaderID(k),Gt=l.getFragmentShaderID(k);const Ve=i.getRenderTarget(),pt=k.clearcoat>0,Wt=k.iridescence>0;return{isWebGL2:f,shaderID:me,shaderName:k.type,vertexShader:Ee,fragmentShader:mt,defines:k.defines,customVertexShaderID:it,customFragmentShaderID:Gt,isRawShaderMaterial:!0===k.isRawShaderMaterial,glslVersion:k.glslVersion,precision:v,instancing:!0===fe.isInstancedMesh,instancingColor:!0===fe.isInstancedMesh&&null!==fe.instanceColor,supportsVertexTextures:g,outputEncoding:null===Ve?i.outputEncoding:!0===Ve.isXRRenderTarget?Ve.texture.encoding:j0,map:!!k.map,matcap:!!k.matcap,envMap:!!Z,envMapMode:Z&&Z.mapping,envMapCubeUVHeight:he,lightMap:!!k.lightMap,aoMap:!!k.aoMap,emissiveMap:!!k.emissiveMap,bumpMap:!!k.bumpMap,normalMap:!!k.normalMap,objectSpaceNormalMap:1===k.normalMapType,tangentSpaceNormalMap:0===k.normalMapType,decodeVideoTexture:!!k.map&&!0===k.map.isVideoTexture&&k.map.encoding===ur,clearcoat:pt,clearcoatMap:pt&&!!k.clearcoatMap,clearcoatRoughnessMap:pt&&!!k.clearcoatRoughnessMap,clearcoatNormalMap:pt&&!!k.clearcoatNormalMap,iridescence:Wt,iridescenceMap:Wt&&!!k.iridescenceMap,iridescenceThicknessMap:Wt&&!!k.iridescenceThicknessMap,displacementMap:!!k.displacementMap,roughnessMap:!!k.roughnessMap,metalnessMap:!!k.metalnessMap,specularMap:!!k.specularMap,specularIntensityMap:!!k.specularIntensityMap,specularColorMap:!!k.specularColorMap,opaque:!1===k.transparent&&1===k.blending,alphaMap:!!k.alphaMap,alphaTest:k.alphaTest>0,gradientMap:!!k.gradientMap,sheen:k.sheen>0,sheenColorMap:!!k.sheenColorMap,sheenRoughnessMap:!!k.sheenRoughnessMap,transmission:k.transmission>0,transmissionMap:!!k.transmissionMap,thicknessMap:!!k.thicknessMap,combine:k.combine,vertexTangents:!!k.normalMap&&!!ne.attributes.tangent,vertexColors:k.vertexColors,vertexAlphas:!0===k.vertexColors&&!!ne.attributes.color&&4===ne.attributes.color.itemSize,vertexUvs:!!(k.map||k.bumpMap||k.normalMap||k.specularMap||k.alphaMap||k.emissiveMap||k.roughnessMap||k.metalnessMap||k.clearcoatMap||k.clearcoatRoughnessMap||k.clearcoatNormalMap||k.iridescenceMap||k.iridescenceThicknessMap||k.displacementMap||k.transmissionMap||k.thicknessMap||k.specularIntensityMap||k.specularColorMap||k.sheenColorMap||k.sheenRoughnessMap),uvsVertexOnly:!(k.map||k.bumpMap||k.normalMap||k.specularMap||k.alphaMap||k.emissiveMap||k.roughnessMap||k.metalnessMap||k.clearcoatNormalMap||k.iridescenceMap||k.iridescenceThicknessMap||k.transmission>0||k.transmissionMap||k.thicknessMap||k.specularIntensityMap||k.specularColorMap||k.sheen>0||k.sheenColorMap||k.sheenRoughnessMap||!k.displacementMap),fog:!!ie,useFog:!0===k.fog,fogExp2:ie&&ie.isFogExp2,flatShading:!!k.flatShading,sizeAttenuation:k.sizeAttenuation,logarithmicDepthBuffer:m,skinning:!0===fe.isSkinnedMesh,morphTargets:void 0!==ne.morphAttributes.position,morphNormals:void 0!==ne.morphAttributes.normal,morphColors:void 0!==ne.morphAttributes.color,morphTargetsCount:be,morphTextureStride:Ge,numDirLights:z.directional.length,numPointLights:z.point.length,numSpotLights:z.spot.length,numRectAreaLights:z.rectArea.length,numHemiLights:z.hemi.length,numDirLightShadows:z.directionalShadowMap.length,numPointLightShadows:z.pointShadowMap.length,numSpotLightShadows:z.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:k.dithering,shadowMapEnabled:i.shadowMap.enabled&&K.length>0,shadowMapType:i.shadowMap.type,toneMapping:k.toneMapped?i.toneMapping:0,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:k.premultipliedAlpha,doubleSided:2===k.side,flipSided:1===k.side,useDepthPacking:!!k.depthPacking,depthPacking:k.depthPacking||0,index0AttributeName:k.index0AttributeName,extensionDerivatives:k.extensions&&k.extensions.derivatives,extensionFragDepth:k.extensions&&k.extensions.fragDepth,extensionDrawBuffers:k.extensions&&k.extensions.drawBuffers,extensionShaderTextureLOD:k.extensions&&k.extensions.shaderTextureLOD,rendererExtensionFragDepth:f||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:f||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:f||n.has("EXT_shader_texture_lod"),customProgramCacheKey:k.customProgramCacheKey()}},getProgramCacheKey:function T(k){const z=[];if(k.shaderID?z.push(k.shaderID):(z.push(k.customVertexShaderID),z.push(k.customFragmentShaderID)),void 0!==k.defines)for(const K in k.defines)z.push(K),z.push(k.defines[K]);return!1===k.isRawShaderMaterial&&(function S(k,z){k.push(z.precision),k.push(z.outputEncoding),k.push(z.envMapMode),k.push(z.envMapCubeUVHeight),k.push(z.combine),k.push(z.vertexUvs),k.push(z.fogExp2),k.push(z.sizeAttenuation),k.push(z.morphTargetsCount),k.push(z.morphAttributeCount),k.push(z.numDirLights),k.push(z.numPointLights),k.push(z.numSpotLights),k.push(z.numHemiLights),k.push(z.numRectAreaLights),k.push(z.numDirLightShadows),k.push(z.numPointLightShadows),k.push(z.numSpotLightShadows),k.push(z.shadowMapType),k.push(z.toneMapping),k.push(z.numClippingPlanes),k.push(z.numClipIntersection),k.push(z.depthPacking)}(z,k),function C(k,z){a.disableAll(),z.isWebGL2&&a.enable(0),z.supportsVertexTextures&&a.enable(1),z.instancing&&a.enable(2),z.instancingColor&&a.enable(3),z.map&&a.enable(4),z.matcap&&a.enable(5),z.envMap&&a.enable(6),z.lightMap&&a.enable(7),z.aoMap&&a.enable(8),z.emissiveMap&&a.enable(9),z.bumpMap&&a.enable(10),z.normalMap&&a.enable(11),z.objectSpaceNormalMap&&a.enable(12),z.tangentSpaceNormalMap&&a.enable(13),z.clearcoat&&a.enable(14),z.clearcoatMap&&a.enable(15),z.clearcoatRoughnessMap&&a.enable(16),z.clearcoatNormalMap&&a.enable(17),z.iridescence&&a.enable(18),z.iridescenceMap&&a.enable(19),z.iridescenceThicknessMap&&a.enable(20),z.displacementMap&&a.enable(21),z.specularMap&&a.enable(22),z.roughnessMap&&a.enable(23),z.metalnessMap&&a.enable(24),z.gradientMap&&a.enable(25),z.alphaMap&&a.enable(26),z.alphaTest&&a.enable(27),z.vertexColors&&a.enable(28),z.vertexAlphas&&a.enable(29),z.vertexUvs&&a.enable(30),z.vertexTangents&&a.enable(31),z.uvsVertexOnly&&a.enable(32),z.fog&&a.enable(33),k.push(a.mask),a.disableAll(),z.useFog&&a.enable(0),z.flatShading&&a.enable(1),z.logarithmicDepthBuffer&&a.enable(2),z.skinning&&a.enable(3),z.morphTargets&&a.enable(4),z.morphNormals&&a.enable(5),z.morphColors&&a.enable(6),z.premultipliedAlpha&&a.enable(7),z.shadowMapEnabled&&a.enable(8),z.physicallyCorrectLights&&a.enable(9),z.doubleSided&&a.enable(10),z.flipSided&&a.enable(11),z.useDepthPacking&&a.enable(12),z.dithering&&a.enable(13),z.specularIntensityMap&&a.enable(14),z.specularColorMap&&a.enable(15),z.transmission&&a.enable(16),z.transmissionMap&&a.enable(17),z.thicknessMap&&a.enable(18),z.sheen&&a.enable(19),z.sheenColorMap&&a.enable(20),z.sheenRoughnessMap&&a.enable(21),z.decodeVideoTexture&&a.enable(22),z.opaque&&a.enable(23),k.push(a.mask)}(z,k),z.push(i.outputEncoding)),z.push(k.customProgramCacheKey),z.join()},getUniforms:function R(k){const z=y[k.type];let K;return K=z?cw.clone(qf[z].uniforms):k.uniforms,K},acquireProgram:function I(k,z){let K;for(let te=0,fe=h.length;te<fe;te++){const ie=h[te];if(ie.cacheKey===z){K=ie,++K.usedTimes;break}}return void 0===K&&(K=new uhe(i,z,k,s),h.push(K)),K},releaseProgram:function L(k){if(0==--k.usedTimes){const z=h.indexOf(k);h[z]=h[h.length-1],h.pop(),k.destroy()}},releaseShaderCache:function N(k){l.remove(k)},programs:h,dispose:function U(){l.dispose()}}}function mhe(){let i=new WeakMap;return{get:function e(s){let o=i.get(s);return void 0===o&&(o={},i.set(s,o)),o},remove:function t(s){i.delete(s)},update:function n(s,o,a){i.get(s)[o]=a},dispose:function r(){i=new WeakMap}}}function ghe(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function Tq(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function wq(){const i=[];let e=0;const t=[],n=[],r=[];function o(m,g,v,y,b,T){let S=i[e];return void 0===S?(S={id:m.id,object:m,geometry:g,material:v,groupOrder:y,renderOrder:m.renderOrder,z:b,group:T},i[e]=S):(S.id=m.id,S.object=m,S.geometry=g,S.material=v,S.groupOrder=y,S.renderOrder=m.renderOrder,S.z=b,S.group=T),e++,S}return{opaque:t,transmissive:n,transparent:r,init:function s(){e=0,t.length=0,n.length=0,r.length=0},push:function a(m,g,v,y,b,T){const S=o(m,g,v,y,b,T);v.transmission>0?n.push(S):!0===v.transparent?r.push(S):t.push(S)},unshift:function l(m,g,v,y,b,T){const S=o(m,g,v,y,b,T);v.transmission>0?n.unshift(S):!0===v.transparent?r.unshift(S):t.unshift(S)},finish:function f(){for(let m=e,g=i.length;m<g;m++){const v=i[m];if(null===v.id)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}},sort:function h(m,g){t.length>1&&t.sort(m||ghe),n.length>1&&n.sort(g||Tq),r.length>1&&r.sort(g||Tq)}}}function _he(){let i=new WeakMap;return{get:function e(n,r){let s;return!1===i.has(n)?(s=new wq,i.set(n,[s])):r>=i.get(n).length?(s=new wq,i.get(n).push(s)):s=i.get(n)[r],s},dispose:function t(){i=new WeakMap}}}function vhe(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Q,color:new sn};break;case"SpotLight":t={position:new Q,direction:new Q,color:new sn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Q,color:new sn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Q,skyColor:new sn,groundColor:new sn};break;case"RectAreaLight":t={color:new sn,position:new Q,halfWidth:new Q,halfHeight:new Q}}return i[e.id]=t,t}}}let bhe=0;function xhe(i,e){return(e.castShadow?1:0)-(i.castShadow?1:0)}function The(i,e){const t=new vhe,n=function yhe(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Je};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Je,shadowCameraNear:1,shadowCameraFar:1e3}}return i[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let f=0;f<9;f++)r.probe.push(new Q);const s=new Q,o=new Jn,a=new Jn;return{setup:function l(f,m){let g=0,v=0,y=0;for(let z=0;z<9;z++)r.probe[z].set(0,0,0);let b=0,T=0,S=0,C=0,R=0,I=0,L=0,N=0;f.sort(xhe);const U=!0!==m?Math.PI:1;for(let z=0,K=f.length;z<K;z++){const te=f[z],fe=te.color,ie=te.intensity,ne=te.distance,le=te.shadow&&te.shadow.map?te.shadow.map.texture:null;if(te.isAmbientLight)g+=fe.r*ie*U,v+=fe.g*ie*U,y+=fe.b*ie*U;else if(te.isLightProbe)for(let Z=0;Z<9;Z++)r.probe[Z].addScaledVector(te.sh.coefficients[Z],ie);else if(te.isDirectionalLight){const Z=t.get(te);if(Z.color.copy(te.color).multiplyScalar(te.intensity*U),te.castShadow){const he=te.shadow,me=n.get(te);me.shadowBias=he.bias,me.shadowNormalBias=he.normalBias,me.shadowRadius=he.radius,me.shadowMapSize=he.mapSize,r.directionalShadow[b]=me,r.directionalShadowMap[b]=le,r.directionalShadowMatrix[b]=te.shadow.matrix,I++}r.directional[b]=Z,b++}else if(te.isSpotLight){const Z=t.get(te);if(Z.position.setFromMatrixPosition(te.matrixWorld),Z.color.copy(fe).multiplyScalar(ie*U),Z.distance=ne,Z.coneCos=Math.cos(te.angle),Z.penumbraCos=Math.cos(te.angle*(1-te.penumbra)),Z.decay=te.decay,te.castShadow){const he=te.shadow,me=n.get(te);me.shadowBias=he.bias,me.shadowNormalBias=he.normalBias,me.shadowRadius=he.radius,me.shadowMapSize=he.mapSize,r.spotShadow[S]=me,r.spotShadowMap[S]=le,r.spotShadowMatrix[S]=te.shadow.matrix,N++}r.spot[S]=Z,S++}else if(te.isRectAreaLight){const Z=t.get(te);Z.color.copy(fe).multiplyScalar(ie),Z.halfWidth.set(.5*te.width,0,0),Z.halfHeight.set(0,.5*te.height,0),r.rectArea[C]=Z,C++}else if(te.isPointLight){const Z=t.get(te);if(Z.color.copy(te.color).multiplyScalar(te.intensity*U),Z.distance=te.distance,Z.decay=te.decay,te.castShadow){const he=te.shadow,me=n.get(te);me.shadowBias=he.bias,me.shadowNormalBias=he.normalBias,me.shadowRadius=he.radius,me.shadowMapSize=he.mapSize,me.shadowCameraNear=he.camera.near,me.shadowCameraFar=he.camera.far,r.pointShadow[T]=me,r.pointShadowMap[T]=le,r.pointShadowMatrix[T]=te.shadow.matrix,L++}r.point[T]=Z,T++}else if(te.isHemisphereLight){const Z=t.get(te);Z.skyColor.copy(te.color).multiplyScalar(ie*U),Z.groundColor.copy(te.groundColor).multiplyScalar(ie*U),r.hemi[R]=Z,R++}}C>0&&(e.isWebGL2||!0===i.has("OES_texture_float_linear")?(r.rectAreaLTC1=bn.LTC_FLOAT_1,r.rectAreaLTC2=bn.LTC_FLOAT_2):!0===i.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=bn.LTC_HALF_1,r.rectAreaLTC2=bn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=g,r.ambient[1]=v,r.ambient[2]=y;const k=r.hash;(k.directionalLength!==b||k.pointLength!==T||k.spotLength!==S||k.rectAreaLength!==C||k.hemiLength!==R||k.numDirectionalShadows!==I||k.numPointShadows!==L||k.numSpotShadows!==N)&&(r.directional.length=b,r.spot.length=S,r.rectArea.length=C,r.point.length=T,r.hemi.length=R,r.directionalShadow.length=I,r.directionalShadowMap.length=I,r.pointShadow.length=L,r.pointShadowMap.length=L,r.spotShadow.length=N,r.spotShadowMap.length=N,r.directionalShadowMatrix.length=I,r.pointShadowMatrix.length=L,r.spotShadowMatrix.length=N,k.directionalLength=b,k.pointLength=T,k.spotLength=S,k.rectAreaLength=C,k.hemiLength=R,k.numDirectionalShadows=I,k.numPointShadows=L,k.numSpotShadows=N,r.version=bhe++)},setupView:function h(f,m){let g=0,v=0,y=0,b=0,T=0;const S=m.matrixWorldInverse;for(let C=0,R=f.length;C<R;C++){const I=f[C];if(I.isDirectionalLight){const L=r.directional[g];L.direction.setFromMatrixPosition(I.matrixWorld),s.setFromMatrixPosition(I.target.matrixWorld),L.direction.sub(s),L.direction.transformDirection(S),g++}else if(I.isSpotLight){const L=r.spot[y];L.position.setFromMatrixPosition(I.matrixWorld),L.position.applyMatrix4(S),L.direction.setFromMatrixPosition(I.matrixWorld),s.setFromMatrixPosition(I.target.matrixWorld),L.direction.sub(s),L.direction.transformDirection(S),y++}else if(I.isRectAreaLight){const L=r.rectArea[b];L.position.setFromMatrixPosition(I.matrixWorld),L.position.applyMatrix4(S),a.identity(),o.copy(I.matrixWorld),o.premultiply(S),a.extractRotation(o),L.halfWidth.set(.5*I.width,0,0),L.halfHeight.set(0,.5*I.height,0),L.halfWidth.applyMatrix4(a),L.halfHeight.applyMatrix4(a),b++}else if(I.isPointLight){const L=r.point[v];L.position.setFromMatrixPosition(I.matrixWorld),L.position.applyMatrix4(S),v++}else if(I.isHemisphereLight){const L=r.hemi[T];L.direction.setFromMatrixPosition(I.matrixWorld),L.direction.transformDirection(S),T++}}},state:r}}function Mq(i,e){const t=new The(i,e),n=[],r=[];return{init:function s(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:t},setupLights:function l(m){t.setup(n,m)},setupLightsView:function h(m){t.setupView(n,m)},pushLight:function o(m){n.push(m)},pushShadow:function a(m){r.push(m)}}}function whe(i,e){let t=new WeakMap;return{get:function n(s,o=0){let a;return!1===t.has(s)?(a=new Mq(i,e),t.set(s,[a])):o>=t.get(s).length?(a=new Mq(i,e),t.get(s).push(a)):a=t.get(s)[o],a},dispose:function r(){t=new WeakMap}}}class dU extends fh{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Sq extends fh{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Q,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Che(i,e,t){let n=new sU;const r=new Je,s=new Je,o=new hr,a=new dU({depthPacking:3201}),l=new Sq,h={},f=t.maxTextureSize,m={0:1,1:0,2:2},g=new la({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Je},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),v=g.clone();v.defines.HORIZONTAL_PASS=1;const y=new Di;y.setAttribute("position",new Uo(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const b=new aa(y,g),T=this;function S(I,L){const N=e.update(b);g.defines.VSM_SAMPLES!==I.blurSamples&&(g.defines.VSM_SAMPLES=I.blurSamples,v.defines.VSM_SAMPLES=I.blurSamples,g.needsUpdate=!0,v.needsUpdate=!0),null===I.mapPass&&(I.mapPass=new ra(r.x,r.y)),g.uniforms.shadow_pass.value=I.map.texture,g.uniforms.resolution.value=I.mapSize,g.uniforms.radius.value=I.radius,i.setRenderTarget(I.mapPass),i.clear(),i.renderBufferDirect(L,null,N,g,b,null),v.uniforms.shadow_pass.value=I.mapPass.texture,v.uniforms.resolution.value=I.mapSize,v.uniforms.radius.value=I.radius,i.setRenderTarget(I.map),i.clear(),i.renderBufferDirect(L,null,N,v,b,null)}function C(I,L,N,U,k,z){let K=null;const te=!0===N.isPointLight?I.customDistanceMaterial:I.customDepthMaterial;if(K=void 0!==te?te:!0===N.isPointLight?l:a,i.localClippingEnabled&&!0===L.clipShadows&&Array.isArray(L.clippingPlanes)&&0!==L.clippingPlanes.length||L.displacementMap&&0!==L.displacementScale||L.alphaMap&&L.alphaTest>0){const fe=K.uuid,ie=L.uuid;let ne=h[fe];void 0===ne&&(ne={},h[fe]=ne);let le=ne[ie];void 0===le&&(le=K.clone(),ne[ie]=le),K=le}return K.visible=L.visible,K.wireframe=L.wireframe,K.side=3===z?null!==L.shadowSide?L.shadowSide:L.side:null!==L.shadowSide?L.shadowSide:m[L.side],K.alphaMap=L.alphaMap,K.alphaTest=L.alphaTest,K.clipShadows=L.clipShadows,K.clippingPlanes=L.clippingPlanes,K.clipIntersection=L.clipIntersection,K.displacementMap=L.displacementMap,K.displacementScale=L.displacementScale,K.displacementBias=L.displacementBias,K.wireframeLinewidth=L.wireframeLinewidth,K.linewidth=L.linewidth,!0===N.isPointLight&&!0===K.isMeshDistanceMaterial&&(K.referencePosition.setFromMatrixPosition(N.matrixWorld),K.nearDistance=U,K.farDistance=k),K}function R(I,L,N,U,k){if(!1===I.visible)return;if(I.layers.test(L.layers)&&(I.isMesh||I.isLine||I.isPoints)&&(I.castShadow||I.receiveShadow&&3===k)&&(!I.frustumCulled||n.intersectsObject(I))){I.modelViewMatrix.multiplyMatrices(N.matrixWorldInverse,I.matrixWorld);const te=e.update(I),fe=I.material;if(Array.isArray(fe)){const ie=te.groups;for(let ne=0,le=ie.length;ne<le;ne++){const Z=ie[ne],he=fe[Z.materialIndex];if(he&&he.visible){const me=C(I,he,U,N.near,N.far,k);i.renderBufferDirect(N,null,te,me,I,Z)}}}else if(fe.visible){const ie=C(I,fe,U,N.near,N.far,k);i.renderBufferDirect(N,null,te,ie,I,null)}}const K=I.children;for(let te=0,fe=K.length;te<fe;te++)R(K[te],L,N,U,k)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(I,L,N){if(!1===T.enabled||!1===T.autoUpdate&&!1===T.needsUpdate||0===I.length)return;const U=i.getRenderTarget(),k=i.getActiveCubeFace(),z=i.getActiveMipmapLevel(),K=i.state;K.setBlending(0),K.buffers.color.setClear(1,1,1,1),K.buffers.depth.setTest(!0),K.setScissorTest(!1);for(let te=0,fe=I.length;te<fe;te++){const ie=I[te],ne=ie.shadow;if(void 0===ne){console.warn("THREE.WebGLShadowMap:",ie,"has no shadow.");continue}if(!1===ne.autoUpdate&&!1===ne.needsUpdate)continue;r.copy(ne.mapSize);const le=ne.getFrameExtents();r.multiply(le),s.copy(ne.mapSize),(r.x>f||r.y>f)&&(r.x>f&&(s.x=Math.floor(f/le.x),r.x=s.x*le.x,ne.mapSize.x=s.x),r.y>f&&(s.y=Math.floor(f/le.y),r.y=s.y*le.y,ne.mapSize.y=s.y)),null===ne.map&&(ne.map=new ra(r.x,r.y,3!==this.type?{minFilter:Bo,magFilter:Bo}:{}),ne.map.texture.name=ie.name+".shadowMap",ne.camera.updateProjectionMatrix()),i.setRenderTarget(ne.map),i.clear();const Z=ne.getViewportCount();for(let he=0;he<Z;he++){const me=ne.getViewport(he);o.set(s.x*me.x,s.y*me.y,s.x*me.z,s.y*me.w),K.viewport(o),ne.updateMatrices(ie,he),n=ne.getFrustum(),R(L,N,ne.camera,ie,this.type)}!0!==ne.isPointLightShadow&&3===this.type&&S(ne,N),ne.needsUpdate=!1}T.needsUpdate=!1,i.setRenderTarget(U,k,z)}}function Ehe(i,e,t){const n=t.isWebGL2,a=new function r(){let Pe=!1;const Yt=new hr;let bt=null;const lt=new hr(0,0,0,0);return{setMask:function(mn){bt!==mn&&!Pe&&(i.colorMask(mn,mn,mn,mn),bt=mn)},setLocked:function(mn){Pe=mn},setClear:function(mn,rr,zo,Ws,tp){!0===tp&&(mn*=Ws,rr*=Ws,zo*=Ws),Yt.set(mn,rr,zo,Ws),!1===lt.equals(Yt)&&(i.clearColor(mn,rr,zo,Ws),lt.copy(Yt))},reset:function(){Pe=!1,bt=null,lt.set(-1,0,0,0)}}},l=new function s(){let Pe=!1,Yt=null,bt=null,lt=null;return{setTest:function(mn){mn?Ie(2929):pt(2929)},setMask:function(mn){Yt!==mn&&!Pe&&(i.depthMask(mn),Yt=mn)},setFunc:function(mn){if(bt!==mn){if(mn)switch(mn){case 0:i.depthFunc(512);break;case 1:i.depthFunc(519);break;case 2:i.depthFunc(513);break;case 3:default:i.depthFunc(515);break;case 4:i.depthFunc(514);break;case 5:i.depthFunc(518);break;case 6:i.depthFunc(516);break;case 7:i.depthFunc(517)}else i.depthFunc(515);bt=mn}},setLocked:function(mn){Pe=mn},setClear:function(mn){lt!==mn&&(i.clearDepth(mn),lt=mn)},reset:function(){Pe=!1,Yt=null,bt=null,lt=null}}},h=new function o(){let Pe=!1,Yt=null,bt=null,lt=null,mn=null,rr=null,zo=null,Ws=null,tp=null;return{setTest:function(Fs){Pe||(Fs?Ie(2960):pt(2960))},setMask:function(Fs){Yt!==Fs&&!Pe&&(i.stencilMask(Fs),Yt=Fs)},setFunc:function(Fs,Rd,xc){(bt!==Fs||lt!==Rd||mn!==xc)&&(i.stencilFunc(Fs,Rd,xc),bt=Fs,lt=Rd,mn=xc)},setOp:function(Fs,Rd,xc){(rr!==Fs||zo!==Rd||Ws!==xc)&&(i.stencilOp(Fs,Rd,xc),rr=Fs,zo=Rd,Ws=xc)},setLocked:function(Fs){Pe=Fs},setClear:function(Fs){tp!==Fs&&(i.clearStencil(Fs),tp=Fs)},reset:function(){Pe=!1,Yt=null,bt=null,lt=null,mn=null,rr=null,zo=null,Ws=null,tp=null}}},f=new WeakMap,m=new WeakMap;let g={},v={},y=new WeakMap,b=[],T=null,S=!1,C=null,R=null,I=null,L=null,N=null,U=null,k=null,z=!1,K=null,te=null,fe=null,ie=null,ne=null;const le=i.getParameter(35661);let Z=!1,he=0;const me=i.getParameter(7938);-1!==me.indexOf("WebGL")?(he=parseFloat(/^WebGL (\d)/.exec(me)[1]),Z=he>=1):-1!==me.indexOf("OpenGL ES")&&(he=parseFloat(/^OpenGL ES (\d)/.exec(me)[1]),Z=he>=2);let ce=null,be={};const Ge=i.getParameter(3088),Ee=i.getParameter(2978),mt=(new hr).fromArray(Ge),it=(new hr).fromArray(Ee);function Gt(Pe,Yt,bt){const lt=new Uint8Array(4),mn=i.createTexture();i.bindTexture(Pe,mn),i.texParameteri(Pe,10241,9728),i.texParameteri(Pe,10240,9728);for(let rr=0;rr<bt;rr++)i.texImage2D(Yt+rr,0,6408,1,1,0,6408,5121,lt);return mn}const Ve={};function Ie(Pe){!0!==g[Pe]&&(i.enable(Pe),g[Pe]=!0)}function pt(Pe){!1!==g[Pe]&&(i.disable(Pe),g[Pe]=!1)}Ve[3553]=Gt(3553,3553,1),Ve[34067]=Gt(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),h.setClear(0),Ie(2929),l.setFunc(3),dn(!1),pi(1),Ie(2884),Bt(0);const ft={100:32774,101:32778,102:32779};if(n)ft[103]=32775,ft[104]=32776;else{const Pe=e.get("EXT_blend_minmax");null!==Pe&&(ft[103]=Pe.MIN_EXT,ft[104]=Pe.MAX_EXT)}const vt={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function Bt(Pe,Yt,bt,lt,mn,rr,zo,Ws){if(0!==Pe){if(!1===S&&(Ie(3042),S=!0),5===Pe)mn=mn||Yt,rr=rr||bt,zo=zo||lt,(Yt!==R||mn!==N)&&(i.blendEquationSeparate(ft[Yt],ft[mn]),R=Yt,N=mn),(bt!==I||lt!==L||rr!==U||zo!==k)&&(i.blendFuncSeparate(vt[bt],vt[lt],vt[rr],vt[zo]),I=bt,L=lt,U=rr,k=zo),C=Pe,z=null;else if(Pe!==C||Ws!==z){if((100!==R||100!==N)&&(i.blendEquation(32774),R=100,N=100),Ws)switch(Pe){case 1:i.blendFuncSeparate(1,771,1,771);break;case 2:i.blendFunc(1,1);break;case 3:i.blendFuncSeparate(0,769,0,1);break;case 4:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Pe)}else switch(Pe){case 1:i.blendFuncSeparate(770,771,1,771);break;case 2:i.blendFunc(770,1);break;case 3:i.blendFuncSeparate(0,769,0,1);break;case 4:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Pe)}I=null,L=null,U=null,k=null,C=Pe,z=Ws}}else!0===S&&(pt(3042),S=!1)}function dn(Pe){K!==Pe&&(i.frontFace(Pe?2304:2305),K=Pe)}function pi(Pe){0!==Pe?(Ie(2884),Pe!==te&&i.cullFace(1===Pe?1029:2===Pe?1028:1032)):pt(2884),te=Pe}function Kn(Pe,Yt,bt){Pe?(Ie(32823),(ie!==Yt||ne!==bt)&&(i.polygonOffset(Yt,bt),ie=Yt,ne=bt)):pt(32823)}function Yi(Pe){void 0===Pe&&(Pe=33984+le-1),ce!==Pe&&(i.activeTexture(Pe),ce=Pe)}return{buffers:{color:a,depth:l,stencil:h},enable:Ie,disable:pt,bindFramebuffer:function Wt(Pe,Yt){return v[Pe]!==Yt&&(i.bindFramebuffer(Pe,Yt),v[Pe]=Yt,n&&(36009===Pe&&(v[36160]=Yt),36160===Pe&&(v[36009]=Yt)),!0)},drawBuffers:function It(Pe,Yt){let bt=b,lt=!1;if(Pe)if(bt=y.get(Yt),void 0===bt&&(bt=[],y.set(Yt,bt)),Pe.isWebGLMultipleRenderTargets){const mn=Pe.texture;if(bt.length!==mn.length||36064!==bt[0]){for(let rr=0,zo=mn.length;rr<zo;rr++)bt[rr]=36064+rr;bt.length=mn.length,lt=!0}}else 36064!==bt[0]&&(bt[0]=36064,lt=!0);else 1029!==bt[0]&&(bt[0]=1029,lt=!0);lt&&(t.isWebGL2?i.drawBuffers(bt):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(bt))},useProgram:function wn(Pe){return T!==Pe&&(i.useProgram(Pe),T=Pe,!0)},setBlending:Bt,setMaterial:function Mn(Pe,Yt){2===Pe.side?pt(2884):Ie(2884);let bt=1===Pe.side;Yt&&(bt=!bt),dn(bt),1===Pe.blending&&!1===Pe.transparent?Bt(0):Bt(Pe.blending,Pe.blendEquation,Pe.blendSrc,Pe.blendDst,Pe.blendEquationAlpha,Pe.blendSrcAlpha,Pe.blendDstAlpha,Pe.premultipliedAlpha),l.setFunc(Pe.depthFunc),l.setTest(Pe.depthTest),l.setMask(Pe.depthWrite),a.setMask(Pe.colorWrite);const lt=Pe.stencilWrite;h.setTest(lt),lt&&(h.setMask(Pe.stencilWriteMask),h.setFunc(Pe.stencilFunc,Pe.stencilRef,Pe.stencilFuncMask),h.setOp(Pe.stencilFail,Pe.stencilZFail,Pe.stencilZPass)),Kn(Pe.polygonOffset,Pe.polygonOffsetFactor,Pe.polygonOffsetUnits),!0===Pe.alphaToCoverage?Ie(32926):pt(32926)},setFlipSided:dn,setCullFace:pi,setLineWidth:function ni(Pe){Pe!==fe&&(Z&&i.lineWidth(Pe),fe=Pe)},setPolygonOffset:Kn,setScissorTest:function ir(Pe){Pe?Ie(3089):pt(3089)},activeTexture:Yi,bindTexture:function _e(Pe,Yt){null===ce&&Yi();let bt=be[ce];void 0===bt&&(bt={type:void 0,texture:void 0},be[ce]=bt),(bt.type!==Pe||bt.texture!==Yt)&&(i.bindTexture(Pe,Yt||Ve[Pe]),bt.type=Pe,bt.texture=Yt)},unbindTexture:function oe(){const Pe=be[ce];void 0!==Pe&&void 0!==Pe.type&&(i.bindTexture(Pe.type,null),Pe.type=void 0,Pe.texture=void 0)},compressedTexImage2D:function ht(){try{i.compressedTexImage2D.apply(i,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}},texImage2D:function Ft(){try{i.texImage2D.apply(i,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}},texImage3D:function Qt(){try{i.texImage3D.apply(i,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}},updateUBOMapping:function Vn(Pe,Yt){let bt=m.get(Yt);void 0===bt&&(bt=new WeakMap,m.set(Yt,bt));let lt=bt.get(Pe);void 0===lt&&(lt=i.getUniformBlockIndex(Yt,Pe.name),bt.set(Pe,lt))},uniformBlockBinding:function ki(Pe,Yt){const lt=m.get(Yt).get(Pe);f.get(Pe)!==lt&&(i.uniformBlockBinding(Yt,lt,Pe.__bindingPointIndex),f.set(Pe,lt))},texStorage2D:function $n(){try{i.texStorage2D.apply(i,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}},texStorage3D:function ue(){try{i.texStorage3D.apply(i,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}},texSubImage2D:function Zt(){try{i.texSubImage2D.apply(i,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}},texSubImage3D:function tn(){try{i.texSubImage3D.apply(i,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}},compressedTexSubImage2D:function gn(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}},scissor:function xn(Pe){!1===mt.equals(Pe)&&(i.scissor(Pe.x,Pe.y,Pe.z,Pe.w),mt.copy(Pe))},viewport:function pn(Pe){!1===it.equals(Pe)&&(i.viewport(Pe.x,Pe.y,Pe.z,Pe.w),it.copy(Pe))},reset:function cr(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),!0===n&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),g={},ce=null,be={},v={},y=new WeakMap,b=[],T=null,S=!1,C=null,R=null,I=null,L=null,N=null,U=null,k=null,z=!1,K=null,te=null,fe=null,ie=null,ne=null,mt.set(0,0,i.canvas.width,i.canvas.height),it.set(0,0,i.canvas.width,i.canvas.height),a.reset(),l.reset(),h.reset()}}}function Ahe(i,e,t,n,r,s,o){const a=r.isWebGL2,l=r.maxTextures,h=r.maxCubemapSize,f=r.maxTextureSize,m=r.maxSamples,g=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,v=/OculusBrowser/g.test(navigator.userAgent),y=new WeakMap;let b;const T=new WeakMap;let S=!1;try{S=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function C(_e,oe){return S?new OffscreenCanvas(_e,oe):eA("canvas")}function R(_e,oe,ht,Zt){let tn=1;if((_e.width>Zt||_e.height>Zt)&&(tn=Zt/Math.max(_e.width,_e.height)),tn<1||!0===oe){if(typeof HTMLImageElement<"u"&&_e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_e instanceof ImageBitmap){const gn=oe?zP:Math.floor,$n=gn(tn*_e.width),ue=gn(tn*_e.height);void 0===b&&(b=C($n,ue));const Ft=ht?C($n,ue):b;return Ft.width=$n,Ft.height=ue,Ft.getContext("2d").drawImage(_e,0,0,$n,ue),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+_e.width+"x"+_e.height+") to ("+$n+"x"+ue+")."),Ft}return"data"in _e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+_e.width+"x"+_e.height+")."),_e}return _e}function I(_e){return Lj(_e.width)&&Lj(_e.height)}function N(_e,oe){return _e.generateMipmaps&&oe&&_e.minFilter!==Bo&&_e.minFilter!==io}function U(_e){i.generateMipmap(_e)}function k(_e,oe,ht,Zt,tn=!1){if(!1===a)return oe;if(null!==_e){if(void 0!==i[_e])return i[_e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+_e+"'")}let gn=oe;return 6403===oe&&(5126===ht&&(gn=33326),5131===ht&&(gn=33325),5121===ht&&(gn=33321)),33319===oe&&(5126===ht&&(gn=33328),5131===ht&&(gn=33327),5121===ht&&(gn=33323)),6408===oe&&(5126===ht&&(gn=34836),5131===ht&&(gn=34842),5121===ht&&(gn=Zt===ur&&!1===tn?35907:32856),32819===ht&&(gn=32854),32820===ht&&(gn=32855)),(33325===gn||33326===gn||33327===gn||33328===gn||34842===gn||34836===gn)&&e.get("EXT_color_buffer_float"),gn}function z(_e,oe,ht){return!0===N(_e,ht)||_e.isFramebufferTexture&&_e.minFilter!==Bo&&_e.minFilter!==io?Math.log2(Math.max(oe.width,oe.height))+1:void 0!==_e.mipmaps&&_e.mipmaps.length>0?_e.mipmaps.length:_e.isCompressedTexture&&Array.isArray(_e.image)?oe.mipmaps.length:1}function K(_e){return _e===Bo||1004===_e||1005===_e?9728:9729}function te(_e){const oe=_e.target;oe.removeEventListener("dispose",te),function ie(_e){const oe=n.get(_e);if(void 0===oe.__webglInit)return;const ht=_e.source,Zt=T.get(ht);if(Zt){const tn=Zt[oe.__cacheKey];tn.usedTimes--,0===tn.usedTimes&&ne(_e),0===Object.keys(Zt).length&&T.delete(ht)}n.remove(_e)}(oe),oe.isVideoTexture&&y.delete(oe)}function fe(_e){const oe=_e.target;oe.removeEventListener("dispose",fe),function le(_e){const oe=_e.texture,ht=n.get(_e),Zt=n.get(oe);if(void 0!==Zt.__webglTexture&&(i.deleteTexture(Zt.__webglTexture),o.memory.textures--),_e.depthTexture&&_e.depthTexture.dispose(),_e.isWebGLCubeRenderTarget)for(let tn=0;tn<6;tn++)i.deleteFramebuffer(ht.__webglFramebuffer[tn]),ht.__webglDepthbuffer&&i.deleteRenderbuffer(ht.__webglDepthbuffer[tn]);else{if(i.deleteFramebuffer(ht.__webglFramebuffer),ht.__webglDepthbuffer&&i.deleteRenderbuffer(ht.__webglDepthbuffer),ht.__webglMultisampledFramebuffer&&i.deleteFramebuffer(ht.__webglMultisampledFramebuffer),ht.__webglColorRenderbuffer)for(let tn=0;tn<ht.__webglColorRenderbuffer.length;tn++)ht.__webglColorRenderbuffer[tn]&&i.deleteRenderbuffer(ht.__webglColorRenderbuffer[tn]);ht.__webglDepthRenderbuffer&&i.deleteRenderbuffer(ht.__webglDepthRenderbuffer)}if(_e.isWebGLMultipleRenderTargets)for(let tn=0,gn=oe.length;tn<gn;tn++){const $n=n.get(oe[tn]);$n.__webglTexture&&(i.deleteTexture($n.__webglTexture),o.memory.textures--),n.remove(oe[tn])}n.remove(oe),n.remove(_e)}(oe)}function ne(_e){const oe=n.get(_e);i.deleteTexture(oe.__webglTexture),delete T.get(_e.source)[oe.__cacheKey],o.memory.textures--}let Z=0;function be(_e,oe){const ht=n.get(_e);if(_e.isVideoTexture&&function ir(_e){const oe=o.render.frame;y.get(_e)!==oe&&(y.set(_e,oe),_e.update())}(_e),!1===_e.isRenderTargetTexture&&_e.version>0&&ht.__version!==_e.version){const Zt=_e.image;if(null===Zt)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Zt.complete)return void pt(ht,_e,oe);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+oe),t.bindTexture(3553,ht.__webglTexture)}const it={[k0]:10497,[Ol]:33071,1002:33648},Gt={[Bo]:9728,1004:9984,1005:9986,[io]:9729,1007:9985,[B_]:9987};function Ve(_e,oe,ht){if(ht?(i.texParameteri(_e,10242,it[oe.wrapS]),i.texParameteri(_e,10243,it[oe.wrapT]),(32879===_e||35866===_e)&&i.texParameteri(_e,32882,it[oe.wrapR]),i.texParameteri(_e,10240,Gt[oe.magFilter]),i.texParameteri(_e,10241,Gt[oe.minFilter])):(i.texParameteri(_e,10242,33071),i.texParameteri(_e,10243,33071),(32879===_e||35866===_e)&&i.texParameteri(_e,32882,33071),(oe.wrapS!==Ol||oe.wrapT!==Ol)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(_e,10240,K(oe.magFilter)),i.texParameteri(_e,10241,K(oe.minFilter)),oe.minFilter!==Bo&&oe.minFilter!==io&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const Zt=e.get("EXT_texture_filter_anisotropic");if(oe.type===hh&&!1===e.has("OES_texture_float_linear")||!1===a&&oe.type===Wf&&!1===e.has("OES_texture_half_float_linear"))return;(oe.anisotropy>1||n.get(oe).__currentAnisotropy)&&(i.texParameterf(_e,Zt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(oe.anisotropy,r.getMaxAnisotropy())),n.get(oe).__currentAnisotropy=oe.anisotropy)}}function Ie(_e,oe){let ht=!1;void 0===_e.__webglInit&&(_e.__webglInit=!0,oe.addEventListener("dispose",te));const Zt=oe.source;let tn=T.get(Zt);void 0===tn&&(tn={},T.set(Zt,tn));const gn=function ce(_e){const oe=[];return oe.push(_e.wrapS),oe.push(_e.wrapT),oe.push(_e.magFilter),oe.push(_e.minFilter),oe.push(_e.anisotropy),oe.push(_e.internalFormat),oe.push(_e.format),oe.push(_e.type),oe.push(_e.generateMipmaps),oe.push(_e.premultiplyAlpha),oe.push(_e.flipY),oe.push(_e.unpackAlignment),oe.push(_e.encoding),oe.join()}(oe);if(gn!==_e.__cacheKey){void 0===tn[gn]&&(tn[gn]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,ht=!0),tn[gn].usedTimes++;const $n=tn[_e.__cacheKey];void 0!==$n&&(tn[_e.__cacheKey].usedTimes--,0===$n.usedTimes&&ne(oe)),_e.__cacheKey=gn,_e.__webglTexture=tn[gn].texture}return ht}function pt(_e,oe,ht){let Zt=3553;oe.isDataArrayTexture&&(Zt=35866),oe.isData3DTexture&&(Zt=32879);const tn=Ie(_e,oe),gn=oe.source;if(t.activeTexture(33984+ht),t.bindTexture(Zt,_e.__webglTexture),gn.version!==gn.__currentVersion||!0===tn){i.pixelStorei(37440,oe.flipY),i.pixelStorei(37441,oe.premultiplyAlpha),i.pixelStorei(3317,oe.unpackAlignment),i.pixelStorei(37443,0);const $n=function L(_e){return!a&&(_e.wrapS!==Ol||_e.wrapT!==Ol||_e.minFilter!==Bo&&_e.minFilter!==io)}(oe)&&!1===I(oe.image);let ue=R(oe.image,$n,!1,f);ue=Yi(oe,ue);const Ft=I(ue)||a,Qt=s.convert(oe.format,oe.encoding);let Vn,xn=s.convert(oe.type),pn=k(oe.internalFormat,Qt,xn,oe.encoding,oe.isVideoTexture);Ve(Zt,oe,Ft);const ki=oe.mipmaps,cr=a&&!0!==oe.isVideoTexture,Pe=void 0===gn.__currentVersion||!0===tn,Yt=z(oe,ue,Ft);if(oe.isDepthTexture)pn=6402,a?pn=oe.type===hh?36012:oe.type===N0?33190:oe.type===WT?35056:33189:oe.type===hh&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),oe.format===B0&&6402===pn&&1012!==oe.type&&oe.type!==N0&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),oe.type=N0,xn=s.convert(oe.type)),oe.format===qT&&6402===pn&&(pn=34041,oe.type!==WT&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),oe.type=WT,xn=s.convert(oe.type))),Pe&&(cr?t.texStorage2D(3553,1,pn,ue.width,ue.height):t.texImage2D(3553,0,pn,ue.width,ue.height,0,Qt,xn,null));else if(oe.isDataTexture)if(ki.length>0&&Ft){cr&&Pe&&t.texStorage2D(3553,Yt,pn,ki[0].width,ki[0].height);for(let bt=0,lt=ki.length;bt<lt;bt++)Vn=ki[bt],cr?t.texSubImage2D(3553,bt,0,0,Vn.width,Vn.height,Qt,xn,Vn.data):t.texImage2D(3553,bt,pn,Vn.width,Vn.height,0,Qt,xn,Vn.data);oe.generateMipmaps=!1}else cr?(Pe&&t.texStorage2D(3553,Yt,pn,ue.width,ue.height),t.texSubImage2D(3553,0,0,0,ue.width,ue.height,Qt,xn,ue.data)):t.texImage2D(3553,0,pn,ue.width,ue.height,0,Qt,xn,ue.data);else if(oe.isCompressedTexture){cr&&Pe&&t.texStorage2D(3553,Yt,pn,ki[0].width,ki[0].height);for(let bt=0,lt=ki.length;bt<lt;bt++)Vn=ki[bt],oe.format!==kl?null!==Qt?cr?t.compressedTexSubImage2D(3553,bt,0,0,Vn.width,Vn.height,Qt,Vn.data):t.compressedTexImage2D(3553,bt,pn,Vn.width,Vn.height,0,Vn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):cr?t.texSubImage2D(3553,bt,0,0,Vn.width,Vn.height,Qt,xn,Vn.data):t.texImage2D(3553,bt,pn,Vn.width,Vn.height,0,Qt,xn,Vn.data)}else if(oe.isDataArrayTexture)cr?(Pe&&t.texStorage3D(35866,Yt,pn,ue.width,ue.height,ue.depth),t.texSubImage3D(35866,0,0,0,0,ue.width,ue.height,ue.depth,Qt,xn,ue.data)):t.texImage3D(35866,0,pn,ue.width,ue.height,ue.depth,0,Qt,xn,ue.data);else if(oe.isData3DTexture)cr?(Pe&&t.texStorage3D(32879,Yt,pn,ue.width,ue.height,ue.depth),t.texSubImage3D(32879,0,0,0,0,ue.width,ue.height,ue.depth,Qt,xn,ue.data)):t.texImage3D(32879,0,pn,ue.width,ue.height,ue.depth,0,Qt,xn,ue.data);else if(oe.isFramebufferTexture){if(Pe)if(cr)t.texStorage2D(3553,Yt,pn,ue.width,ue.height);else{let bt=ue.width,lt=ue.height;for(let mn=0;mn<Yt;mn++)t.texImage2D(3553,mn,pn,bt,lt,0,Qt,xn,null),bt>>=1,lt>>=1}}else if(ki.length>0&&Ft){cr&&Pe&&t.texStorage2D(3553,Yt,pn,ki[0].width,ki[0].height);for(let bt=0,lt=ki.length;bt<lt;bt++)Vn=ki[bt],cr?t.texSubImage2D(3553,bt,0,0,Qt,xn,Vn):t.texImage2D(3553,bt,pn,Qt,xn,Vn);oe.generateMipmaps=!1}else cr?(Pe&&t.texStorage2D(3553,Yt,pn,ue.width,ue.height),t.texSubImage2D(3553,0,0,0,Qt,xn,ue)):t.texImage2D(3553,0,pn,Qt,xn,ue);N(oe,Ft)&&U(Zt),gn.__currentVersion=gn.version,oe.onUpdate&&oe.onUpdate(oe)}_e.__version=oe.version}function It(_e,oe,ht,Zt,tn){const gn=s.convert(ht.format,ht.encoding),$n=s.convert(ht.type),ue=k(ht.internalFormat,gn,$n,ht.encoding);n.get(oe).__hasExternalTextures||(32879===tn||35866===tn?t.texImage3D(tn,0,ue,oe.width,oe.height,oe.depth,0,gn,$n,null):t.texImage2D(tn,0,ue,oe.width,oe.height,0,gn,$n,null)),t.bindFramebuffer(36160,_e),Kn(oe)?g.framebufferTexture2DMultisampleEXT(36160,Zt,tn,n.get(ht).__webglTexture,0,ni(oe)):i.framebufferTexture2D(36160,Zt,tn,n.get(ht).__webglTexture,0),t.bindFramebuffer(36160,null)}function wn(_e,oe,ht){if(i.bindRenderbuffer(36161,_e),oe.depthBuffer&&!oe.stencilBuffer){let Zt=33189;if(ht||Kn(oe)){const tn=oe.depthTexture;tn&&tn.isDepthTexture&&(tn.type===hh?Zt=36012:tn.type===N0&&(Zt=33190));const gn=ni(oe);Kn(oe)?g.renderbufferStorageMultisampleEXT(36161,gn,Zt,oe.width,oe.height):i.renderbufferStorageMultisample(36161,gn,Zt,oe.width,oe.height)}else i.renderbufferStorage(36161,Zt,oe.width,oe.height);i.framebufferRenderbuffer(36160,36096,36161,_e)}else if(oe.depthBuffer&&oe.stencilBuffer){const Zt=ni(oe);ht&&!1===Kn(oe)?i.renderbufferStorageMultisample(36161,Zt,35056,oe.width,oe.height):Kn(oe)?g.renderbufferStorageMultisampleEXT(36161,Zt,35056,oe.width,oe.height):i.renderbufferStorage(36161,34041,oe.width,oe.height),i.framebufferRenderbuffer(36160,33306,36161,_e)}else{const Zt=!0===oe.isWebGLMultipleRenderTargets?oe.texture:[oe.texture];for(let tn=0;tn<Zt.length;tn++){const gn=Zt[tn],$n=s.convert(gn.format,gn.encoding),ue=s.convert(gn.type),Ft=k(gn.internalFormat,$n,ue,gn.encoding),Qt=ni(oe);ht&&!1===Kn(oe)?i.renderbufferStorageMultisample(36161,Qt,Ft,oe.width,oe.height):Kn(oe)?g.renderbufferStorageMultisampleEXT(36161,Qt,Ft,oe.width,oe.height):i.renderbufferStorage(36161,Ft,oe.width,oe.height)}}i.bindRenderbuffer(36161,null)}function vt(_e){const oe=n.get(_e),ht=!0===_e.isWebGLCubeRenderTarget;if(_e.depthTexture&&!oe.__autoAllocateDepthBuffer){if(ht)throw new Error("target.depthTexture not supported in Cube render targets");!function ft(_e,oe){if(oe&&oe.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,_e),!oe.depthTexture||!oe.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(oe.depthTexture).__webglTexture||oe.depthTexture.image.width!==oe.width||oe.depthTexture.image.height!==oe.height)&&(oe.depthTexture.image.width=oe.width,oe.depthTexture.image.height=oe.height,oe.depthTexture.needsUpdate=!0),be(oe.depthTexture,0);const Zt=n.get(oe.depthTexture).__webglTexture,tn=ni(oe);if(oe.depthTexture.format===B0)Kn(oe)?g.framebufferTexture2DMultisampleEXT(36160,36096,3553,Zt,0,tn):i.framebufferTexture2D(36160,36096,3553,Zt,0);else{if(oe.depthTexture.format!==qT)throw new Error("Unknown depthTexture format");Kn(oe)?g.framebufferTexture2DMultisampleEXT(36160,33306,3553,Zt,0,tn):i.framebufferTexture2D(36160,33306,3553,Zt,0)}}(oe.__webglFramebuffer,_e)}else if(ht){oe.__webglDepthbuffer=[];for(let Zt=0;Zt<6;Zt++)t.bindFramebuffer(36160,oe.__webglFramebuffer[Zt]),oe.__webglDepthbuffer[Zt]=i.createRenderbuffer(),wn(oe.__webglDepthbuffer[Zt],_e,!1)}else t.bindFramebuffer(36160,oe.__webglFramebuffer),oe.__webglDepthbuffer=i.createRenderbuffer(),wn(oe.__webglDepthbuffer,_e,!1);t.bindFramebuffer(36160,null)}function ni(_e){return Math.min(m,_e.samples)}function Kn(_e){const oe=n.get(_e);return a&&_e.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==oe.__useRenderToTexture}function Yi(_e,oe){const ht=_e.encoding,Zt=_e.format,tn=_e.type;return!0===_e.isCompressedTexture||!0===_e.isVideoTexture||1035===_e.format||ht!==j0&&(ht===ur?!1===a?!0===e.has("EXT_sRGB")&&Zt===kl?(_e.format=1035,_e.minFilter=io,_e.generateMipmaps=!1):oe=N8.sRGBToLinear(oe):(Zt!==kl||tn!==du)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ht)),oe}this.allocateTextureUnit=function me(){const _e=Z;return _e>=l&&console.warn("THREE.WebGLTextures: Trying to use "+_e+" texture units while this GPU supports only "+l),Z+=1,_e},this.resetTextureUnits=function he(){Z=0},this.setTexture2D=be,this.setTexture2DArray=function Ge(_e,oe){const ht=n.get(_e);_e.version>0&&ht.__version!==_e.version?pt(ht,_e,oe):(t.activeTexture(33984+oe),t.bindTexture(35866,ht.__webglTexture))},this.setTexture3D=function Ee(_e,oe){const ht=n.get(_e);_e.version>0&&ht.__version!==_e.version?pt(ht,_e,oe):(t.activeTexture(33984+oe),t.bindTexture(32879,ht.__webglTexture))},this.setTextureCube=function mt(_e,oe){const ht=n.get(_e);_e.version>0&&ht.__version!==_e.version?function Wt(_e,oe,ht){if(6!==oe.image.length)return;const Zt=Ie(_e,oe),tn=oe.source;if(t.activeTexture(33984+ht),t.bindTexture(34067,_e.__webglTexture),tn.version!==tn.__currentVersion||!0===Zt){i.pixelStorei(37440,oe.flipY),i.pixelStorei(37441,oe.premultiplyAlpha),i.pixelStorei(3317,oe.unpackAlignment),i.pixelStorei(37443,0);const gn=oe.isCompressedTexture||oe.image[0].isCompressedTexture,$n=oe.image[0]&&oe.image[0].isDataTexture,ue=[];for(let bt=0;bt<6;bt++)ue[bt]=gn||$n?$n?oe.image[bt].image:oe.image[bt]:R(oe.image[bt],!1,!0,h),ue[bt]=Yi(oe,ue[bt]);const Ft=ue[0],Qt=I(Ft)||a,xn=s.convert(oe.format,oe.encoding),pn=s.convert(oe.type),Vn=k(oe.internalFormat,xn,pn,oe.encoding),ki=a&&!0!==oe.isVideoTexture,cr=void 0===tn.__currentVersion||!0===Zt;let Yt,Pe=z(oe,Ft,Qt);if(Ve(34067,oe,Qt),gn){ki&&cr&&t.texStorage2D(34067,Pe,Vn,Ft.width,Ft.height);for(let bt=0;bt<6;bt++){Yt=ue[bt].mipmaps;for(let lt=0;lt<Yt.length;lt++){const mn=Yt[lt];oe.format!==kl?null!==xn?ki?t.compressedTexSubImage2D(34069+bt,lt,0,0,mn.width,mn.height,xn,mn.data):t.compressedTexImage2D(34069+bt,lt,Vn,mn.width,mn.height,0,mn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ki?t.texSubImage2D(34069+bt,lt,0,0,mn.width,mn.height,xn,pn,mn.data):t.texImage2D(34069+bt,lt,Vn,mn.width,mn.height,0,xn,pn,mn.data)}}}else{Yt=oe.mipmaps,ki&&cr&&(Yt.length>0&&Pe++,t.texStorage2D(34067,Pe,Vn,ue[0].width,ue[0].height));for(let bt=0;bt<6;bt++)if($n){ki?t.texSubImage2D(34069+bt,0,0,0,ue[bt].width,ue[bt].height,xn,pn,ue[bt].data):t.texImage2D(34069+bt,0,Vn,ue[bt].width,ue[bt].height,0,xn,pn,ue[bt].data);for(let lt=0;lt<Yt.length;lt++){const rr=Yt[lt].image[bt].image;ki?t.texSubImage2D(34069+bt,lt+1,0,0,rr.width,rr.height,xn,pn,rr.data):t.texImage2D(34069+bt,lt+1,Vn,rr.width,rr.height,0,xn,pn,rr.data)}}else{ki?t.texSubImage2D(34069+bt,0,0,0,xn,pn,ue[bt]):t.texImage2D(34069+bt,0,Vn,xn,pn,ue[bt]);for(let lt=0;lt<Yt.length;lt++){const mn=Yt[lt];ki?t.texSubImage2D(34069+bt,lt+1,0,0,xn,pn,mn.image[bt]):t.texImage2D(34069+bt,lt+1,Vn,xn,pn,mn.image[bt])}}}N(oe,Qt)&&U(34067),tn.__currentVersion=tn.version,oe.onUpdate&&oe.onUpdate(oe)}_e.__version=oe.version}(ht,_e,oe):(t.activeTexture(33984+oe),t.bindTexture(34067,ht.__webglTexture))},this.rebindTextures=function Bt(_e,oe,ht){const Zt=n.get(_e);void 0!==oe&&It(Zt.__webglFramebuffer,_e,_e.texture,36064,3553),void 0!==ht&&vt(_e)},this.setupRenderTarget=function Mn(_e){const oe=_e.texture,ht=n.get(_e),Zt=n.get(oe);_e.addEventListener("dispose",fe),!0!==_e.isWebGLMultipleRenderTargets&&(void 0===Zt.__webglTexture&&(Zt.__webglTexture=i.createTexture()),Zt.__version=oe.version,o.memory.textures++);const tn=!0===_e.isWebGLCubeRenderTarget,gn=!0===_e.isWebGLMultipleRenderTargets,$n=I(_e)||a;if(tn){ht.__webglFramebuffer=[];for(let ue=0;ue<6;ue++)ht.__webglFramebuffer[ue]=i.createFramebuffer()}else{if(ht.__webglFramebuffer=i.createFramebuffer(),gn)if(r.drawBuffers){const ue=_e.texture;for(let Ft=0,Qt=ue.length;Ft<Qt;Ft++){const xn=n.get(ue[Ft]);void 0===xn.__webglTexture&&(xn.__webglTexture=i.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&_e.samples>0&&!1===Kn(_e)){const ue=gn?oe:[oe];ht.__webglMultisampledFramebuffer=i.createFramebuffer(),ht.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,ht.__webglMultisampledFramebuffer);for(let Ft=0;Ft<ue.length;Ft++){const Qt=ue[Ft];ht.__webglColorRenderbuffer[Ft]=i.createRenderbuffer(),i.bindRenderbuffer(36161,ht.__webglColorRenderbuffer[Ft]);const xn=s.convert(Qt.format,Qt.encoding),pn=s.convert(Qt.type),Vn=k(Qt.internalFormat,xn,pn,Qt.encoding),ki=ni(_e);i.renderbufferStorageMultisample(36161,ki,Vn,_e.width,_e.height),i.framebufferRenderbuffer(36160,36064+Ft,36161,ht.__webglColorRenderbuffer[Ft])}i.bindRenderbuffer(36161,null),_e.depthBuffer&&(ht.__webglDepthRenderbuffer=i.createRenderbuffer(),wn(ht.__webglDepthRenderbuffer,_e,!0)),t.bindFramebuffer(36160,null)}}if(tn){t.bindTexture(34067,Zt.__webglTexture),Ve(34067,oe,$n);for(let ue=0;ue<6;ue++)It(ht.__webglFramebuffer[ue],_e,oe,36064,34069+ue);N(oe,$n)&&U(34067),t.unbindTexture()}else if(gn){const ue=_e.texture;for(let Ft=0,Qt=ue.length;Ft<Qt;Ft++){const xn=ue[Ft],pn=n.get(xn);t.bindTexture(3553,pn.__webglTexture),Ve(3553,xn,$n),It(ht.__webglFramebuffer,_e,xn,36064+Ft,3553),N(xn,$n)&&U(3553)}t.unbindTexture()}else{let ue=3553;(_e.isWebGL3DRenderTarget||_e.isWebGLArrayRenderTarget)&&(a?ue=_e.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(ue,Zt.__webglTexture),Ve(ue,oe,$n),It(ht.__webglFramebuffer,_e,oe,36064,ue),N(oe,$n)&&U(ue),t.unbindTexture()}_e.depthBuffer&&vt(_e)},this.updateRenderTargetMipmap=function dn(_e){const oe=I(_e)||a,ht=!0===_e.isWebGLMultipleRenderTargets?_e.texture:[_e.texture];for(let Zt=0,tn=ht.length;Zt<tn;Zt++){const gn=ht[Zt];if(N(gn,oe)){const $n=_e.isWebGLCubeRenderTarget?34067:3553,ue=n.get(gn).__webglTexture;t.bindTexture($n,ue),U($n),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function pi(_e){if(a&&_e.samples>0&&!1===Kn(_e)){const oe=_e.isWebGLMultipleRenderTargets?_e.texture:[_e.texture],ht=_e.width,Zt=_e.height;let tn=16384;const gn=[],$n=_e.stencilBuffer?33306:36096,ue=n.get(_e),Ft=!0===_e.isWebGLMultipleRenderTargets;if(Ft)for(let Qt=0;Qt<oe.length;Qt++)t.bindFramebuffer(36160,ue.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Qt,36161,null),t.bindFramebuffer(36160,ue.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Qt,3553,null,0);t.bindFramebuffer(36008,ue.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,ue.__webglFramebuffer);for(let Qt=0;Qt<oe.length;Qt++){gn.push(36064+Qt),_e.depthBuffer&&gn.push($n);const xn=void 0!==ue.__ignoreDepthValues&&ue.__ignoreDepthValues;if(!1===xn&&(_e.depthBuffer&&(tn|=256),_e.stencilBuffer&&(tn|=1024)),Ft&&i.framebufferRenderbuffer(36008,36064,36161,ue.__webglColorRenderbuffer[Qt]),!0===xn&&(i.invalidateFramebuffer(36008,[$n]),i.invalidateFramebuffer(36009,[$n])),Ft){const pn=n.get(oe[Qt]).__webglTexture;i.framebufferTexture2D(36009,36064,3553,pn,0)}i.blitFramebuffer(0,0,ht,Zt,0,0,ht,Zt,tn,9728),v&&i.invalidateFramebuffer(36008,gn)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),Ft)for(let Qt=0;Qt<oe.length;Qt++){t.bindFramebuffer(36160,ue.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Qt,36161,ue.__webglColorRenderbuffer[Qt]);const xn=n.get(oe[Qt]).__webglTexture;t.bindFramebuffer(36160,ue.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Qt,3553,xn,0)}t.bindFramebuffer(36009,ue.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=vt,this.setupFrameBufferTexture=It,this.useMultisampledRTT=Kn}function Dhe(i,e,t){const n=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===du)return 5121;if(1017===s)return 32819;if(1018===s)return 32820;if(1010===s)return 5120;if(1011===s)return 5122;if(1012===s)return 5123;if(1013===s)return 5124;if(s===N0)return 5125;if(s===hh)return 5126;if(s===Wf)return n?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return 6406;if(s===kl)return 6408;if(1024===s)return 6409;if(1025===s)return 6410;if(s===B0)return 6402;if(s===qT)return 34041;if(1028===s)return 6403;if(1022===s)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1029===s)return 36244;if(1030===s)return 33319;if(1031===s)return 33320;if(1033===s)return 36249;if(33776===s||33777===s||33778===s||33779===s)if(o===ur){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return o===ur?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return o===ur?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return o===ur?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}return s===WT?n?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==i[s]?i[s]:null}}}class Rhe extends Ma{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Z_ extends oa{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Ihe={type:"move"};class fU{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Z_,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Z_,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Q),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Z_,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Q),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,h=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(h&&e.hand){o=!0;for(const b of e.hand.values()){const T=t.getJointPose(b,n);if(void 0===h.joints[b.jointName]){const C=new Z_;C.matrixAutoUpdate=!1,C.visible=!1,h.joints[b.jointName]=C,h.add(C)}const S=h.joints[b.jointName];null!==T&&(S.matrix.fromArray(T.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.jointRadius=T.radius),S.visible=null!==T}const g=h.joints["index-finger-tip"].position.distanceTo(h.joints["thumb-tip"].position),v=.02,y=.005;h.inputState.pinching&&g>v+y?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&g<=v-y&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Ihe)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==h&&(h.visible=null!==o),this}}class Phe extends vd{constructor(e,t,n,r,s,o,a,l,h,f){if((f=void 0!==f?f:B0)!==B0&&f!==qT)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&f===B0&&(n=N0),void 0===n&&f===qT&&(n=WT),super(null,r,s,o,a,l,f,n,h),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:Bo,this.minFilter=void 0!==l?l:Bo,this.flipY=!1,this.generateMipmaps=!1}}class Fhe extends G0{constructor(e,t){super();const n=this;let r=null,s=1,o=null,a="local-floor",l=null,h=null,f=null,m=null,g=null,v=null;const y=t.getContextAttributes();let b=null,T=null;const S=[],C=[],R=new Ma;R.layers.enable(1),R.viewport=new hr;const I=new Ma;I.layers.enable(2),I.viewport=new hr;const L=[R,I],N=new Rhe;N.layers.enable(1),N.layers.enable(2);let U=null,k=null;function z(ce){const be=C.indexOf(ce.inputSource);if(-1===be)return;const Ge=S[be];void 0!==Ge&&Ge.dispatchEvent({type:ce.type,data:ce.inputSource})}function K(){r.removeEventListener("select",z),r.removeEventListener("selectstart",z),r.removeEventListener("selectend",z),r.removeEventListener("squeeze",z),r.removeEventListener("squeezestart",z),r.removeEventListener("squeezeend",z),r.removeEventListener("end",K),r.removeEventListener("inputsourceschange",te);for(let ce=0;ce<S.length;ce++){const be=C[ce];null!==be&&(C[ce]=null,S[ce].disconnect(be))}U=null,k=null,e.setRenderTarget(b),g=null,m=null,f=null,r=null,T=null,me.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function te(ce){for(let be=0;be<ce.removed.length;be++){const Ge=ce.removed[be],Ee=C.indexOf(Ge);Ee>=0&&(C[Ee]=null,S[Ee].dispatchEvent({type:"disconnected",data:Ge}))}for(let be=0;be<ce.added.length;be++){const Ge=ce.added[be];let Ee=C.indexOf(Ge);if(-1===Ee){for(let it=0;it<S.length;it++){if(it>=C.length){C.push(Ge),Ee=it;break}if(null===C[it]){C[it]=Ge,Ee=it;break}}if(-1===Ee)break}const mt=S[Ee];mt&&mt.dispatchEvent({type:"connected",data:Ge})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ce){let be=S[ce];return void 0===be&&(be=new fU,S[ce]=be),be.getTargetRaySpace()},this.getControllerGrip=function(ce){let be=S[ce];return void 0===be&&(be=new fU,S[ce]=be),be.getGripSpace()},this.getHand=function(ce){let be=S[ce];return void 0===be&&(be=new fU,S[ce]=be),be.getHandSpace()},this.setFramebufferScaleFactor=function(ce){s=ce,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ce){a=ce,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(ce){l=ce},this.getBaseLayer=function(){return null!==m?m:g},this.getBinding=function(){return f},this.getFrame=function(){return v},this.getSession=function(){return r},this.setSession=function(){var ce=(0,nt.Z)(function*(be){if(r=be,null!==r){if(b=e.getRenderTarget(),r.addEventListener("select",z),r.addEventListener("selectstart",z),r.addEventListener("selectend",z),r.addEventListener("squeeze",z),r.addEventListener("squeezestart",z),r.addEventListener("squeezeend",z),r.addEventListener("end",K),r.addEventListener("inputsourceschange",te),!0!==y.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)g=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||y.antialias,alpha:y.alpha,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:g}),T=new ra(g.framebufferWidth,g.framebufferHeight,{format:kl,type:du,encoding:e.outputEncoding});else{let Ge=null,Ee=null,mt=null;y.depth&&(mt=y.stencil?35056:33190,Ge=y.stencil?qT:B0,Ee=y.stencil?WT:N0);const it={colorFormat:32856,depthFormat:mt,scaleFactor:s};f=new XRWebGLBinding(r,t),m=f.createProjectionLayer(it),r.updateRenderState({layers:[m]}),T=new ra(m.textureWidth,m.textureHeight,{format:kl,type:du,depthTexture:new Phe(m.textureWidth,m.textureHeight,Ee,void 0,void 0,void 0,void 0,void 0,void 0,Ge),stencilBuffer:y.stencil,encoding:e.outputEncoding,samples:y.antialias?4:0}),e.properties.get(T).__ignoreDepthValues=m.ignoreDepthValues}T.isXRRenderTarget=!0,this.setFoveation(1),l=null,o=yield r.requestReferenceSpace(a),me.setContext(r),me.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(be){return ce.apply(this,arguments)}}();const fe=new Q,ie=new Q;function le(ce,be){null===be?ce.matrixWorld.copy(ce.matrix):ce.matrixWorld.multiplyMatrices(be.matrixWorld,ce.matrix),ce.matrixWorldInverse.copy(ce.matrixWorld).invert()}this.updateCamera=function(ce){if(null===r)return;N.near=I.near=R.near=ce.near,N.far=I.far=R.far=ce.far,(U!==N.near||k!==N.far)&&(r.updateRenderState({depthNear:N.near,depthFar:N.far}),U=N.near,k=N.far);const be=ce.parent,Ge=N.cameras;le(N,be);for(let mt=0;mt<Ge.length;mt++)le(Ge[mt],be);N.matrixWorld.decompose(N.position,N.quaternion,N.scale),ce.position.copy(N.position),ce.quaternion.copy(N.quaternion),ce.scale.copy(N.scale),ce.matrix.copy(N.matrix),ce.matrixWorld.copy(N.matrixWorld);const Ee=ce.children;for(let mt=0,it=Ee.length;mt<it;mt++)Ee[mt].updateMatrixWorld(!0);2===Ge.length?function ne(ce,be,Ge){fe.setFromMatrixPosition(be.matrixWorld),ie.setFromMatrixPosition(Ge.matrixWorld);const Ee=fe.distanceTo(ie),mt=be.projectionMatrix.elements,it=Ge.projectionMatrix.elements,Gt=mt[14]/(mt[10]-1),Ve=mt[14]/(mt[10]+1),Ie=(mt[9]+1)/mt[5],pt=(mt[9]-1)/mt[5],Wt=(mt[8]-1)/mt[0],It=(it[8]+1)/it[0],wn=Gt*Wt,ft=Gt*It,vt=Ee/(-Wt+It),Bt=vt*-Wt;be.matrixWorld.decompose(ce.position,ce.quaternion,ce.scale),ce.translateX(Bt),ce.translateZ(vt),ce.matrixWorld.compose(ce.position,ce.quaternion,ce.scale),ce.matrixWorldInverse.copy(ce.matrixWorld).invert();const Mn=Gt+vt,dn=Ve+vt;ce.projectionMatrix.makePerspective(wn-Bt,ft+(Ee-Bt),Ie*Ve/dn*Mn,pt*Ve/dn*Mn,Mn,dn)}(N,R,I):N.projectionMatrix.copy(R.projectionMatrix)},this.getCamera=function(){return N},this.getFoveation=function(){return null!==m?m.fixedFoveation:null!==g?g.fixedFoveation:void 0},this.setFoveation=function(ce){null!==m&&(m.fixedFoveation=ce),null!==g&&void 0!==g.fixedFoveation&&(g.fixedFoveation=ce)};let Z=null;const me=new $8;me.setAnimationLoop(function he(ce,be){if(h=be.getViewerPose(l||o),v=be,null!==h){const Ge=h.views;null!==g&&(e.setRenderTargetFramebuffer(T,g.framebuffer),e.setRenderTarget(T));let Ee=!1;Ge.length!==N.cameras.length&&(N.cameras.length=0,Ee=!0);for(let mt=0;mt<Ge.length;mt++){const it=Ge[mt];let Gt=null;if(null!==g)Gt=g.getViewport(it);else{const Ie=f.getViewSubImage(m,it);Gt=Ie.viewport,0===mt&&(e.setRenderTargetTextures(T,Ie.colorTexture,m.ignoreDepthValues?void 0:Ie.depthStencilTexture),e.setRenderTarget(T))}let Ve=L[mt];void 0===Ve&&(Ve=new Ma,Ve.layers.enable(mt),Ve.viewport=new hr,L[mt]=Ve),Ve.matrix.fromArray(it.transform.matrix),Ve.projectionMatrix.fromArray(it.projectionMatrix),Ve.viewport.set(Gt.x,Gt.y,Gt.width,Gt.height),0===mt&&N.matrix.copy(Ve.matrix),!0===Ee&&N.cameras.push(Ve)}}for(let Ge=0;Ge<S.length;Ge++){const Ee=C[Ge],mt=S[Ge];null!==Ee&&void 0!==mt&&mt.update(Ee,be,l||o)}Z&&Z(ce,be),v=null}),this.setAnimationLoop=function(ce){Z=ce},this.dispose=function(){}}}function Lhe(i,e){function r(b,T){b.opacity.value=T.opacity,T.color&&b.diffuse.value.copy(T.color),T.emissive&&b.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(b.map.value=T.map),T.alphaMap&&(b.alphaMap.value=T.alphaMap),T.bumpMap&&(b.bumpMap.value=T.bumpMap,b.bumpScale.value=T.bumpScale,1===T.side&&(b.bumpScale.value*=-1)),T.displacementMap&&(b.displacementMap.value=T.displacementMap,b.displacementScale.value=T.displacementScale,b.displacementBias.value=T.displacementBias),T.emissiveMap&&(b.emissiveMap.value=T.emissiveMap),T.normalMap&&(b.normalMap.value=T.normalMap,b.normalScale.value.copy(T.normalScale),1===T.side&&b.normalScale.value.negate()),T.specularMap&&(b.specularMap.value=T.specularMap),T.alphaTest>0&&(b.alphaTest.value=T.alphaTest);const S=e.get(T).envMap;if(S&&(b.envMap.value=S,b.flipEnvMap.value=S.isCubeTexture&&!1===S.isRenderTargetTexture?-1:1,b.reflectivity.value=T.reflectivity,b.ior.value=T.ior,b.refractionRatio.value=T.refractionRatio),T.lightMap){b.lightMap.value=T.lightMap;const I=!0!==i.physicallyCorrectLights?Math.PI:1;b.lightMapIntensity.value=T.lightMapIntensity*I}let C,R;T.aoMap&&(b.aoMap.value=T.aoMap,b.aoMapIntensity.value=T.aoMapIntensity),T.map?C=T.map:T.specularMap?C=T.specularMap:T.displacementMap?C=T.displacementMap:T.normalMap?C=T.normalMap:T.bumpMap?C=T.bumpMap:T.roughnessMap?C=T.roughnessMap:T.metalnessMap?C=T.metalnessMap:T.alphaMap?C=T.alphaMap:T.emissiveMap?C=T.emissiveMap:T.clearcoatMap?C=T.clearcoatMap:T.clearcoatNormalMap?C=T.clearcoatNormalMap:T.clearcoatRoughnessMap?C=T.clearcoatRoughnessMap:T.iridescenceMap?C=T.iridescenceMap:T.iridescenceThicknessMap?C=T.iridescenceThicknessMap:T.specularIntensityMap?C=T.specularIntensityMap:T.specularColorMap?C=T.specularColorMap:T.transmissionMap?C=T.transmissionMap:T.thicknessMap?C=T.thicknessMap:T.sheenColorMap?C=T.sheenColorMap:T.sheenRoughnessMap&&(C=T.sheenRoughnessMap),void 0!==C&&(C.isWebGLRenderTarget&&(C=C.texture),!0===C.matrixAutoUpdate&&C.updateMatrix(),b.uvTransform.value.copy(C.matrix)),T.aoMap?R=T.aoMap:T.lightMap&&(R=T.lightMap),void 0!==R&&(R.isWebGLRenderTarget&&(R=R.texture),!0===R.matrixAutoUpdate&&R.updateMatrix(),b.uv2Transform.value.copy(R.matrix))}return{refreshFogUniforms:function t(b,T){b.fogColor.value.copy(T.color),T.isFog?(b.fogNear.value=T.near,b.fogFar.value=T.far):T.isFogExp2&&(b.fogDensity.value=T.density)},refreshMaterialUniforms:function n(b,T,S,C,R){T.isMeshBasicMaterial||T.isMeshLambertMaterial?r(b,T):T.isMeshToonMaterial?(r(b,T),function f(b,T){T.gradientMap&&(b.gradientMap.value=T.gradientMap)}(b,T)):T.isMeshPhongMaterial?(r(b,T),function h(b,T){b.specular.value.copy(T.specular),b.shininess.value=Math.max(T.shininess,1e-4)}(b,T)):T.isMeshStandardMaterial?(r(b,T),function m(b,T){b.roughness.value=T.roughness,b.metalness.value=T.metalness,T.roughnessMap&&(b.roughnessMap.value=T.roughnessMap),T.metalnessMap&&(b.metalnessMap.value=T.metalnessMap),e.get(T).envMap&&(b.envMapIntensity.value=T.envMapIntensity)}(b,T),T.isMeshPhysicalMaterial&&function g(b,T,S){b.ior.value=T.ior,T.sheen>0&&(b.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),b.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(b.sheenColorMap.value=T.sheenColorMap),T.sheenRoughnessMap&&(b.sheenRoughnessMap.value=T.sheenRoughnessMap)),T.clearcoat>0&&(b.clearcoat.value=T.clearcoat,b.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(b.clearcoatMap.value=T.clearcoatMap),T.clearcoatRoughnessMap&&(b.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap),T.clearcoatNormalMap&&(b.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),b.clearcoatNormalMap.value=T.clearcoatNormalMap,1===T.side&&b.clearcoatNormalScale.value.negate())),T.iridescence>0&&(b.iridescence.value=T.iridescence,b.iridescenceIOR.value=T.iridescenceIOR,b.iridescenceThicknessMinimum.value=T.iridescenceThicknessRange[0],b.iridescenceThicknessMaximum.value=T.iridescenceThicknessRange[1],T.iridescenceMap&&(b.iridescenceMap.value=T.iridescenceMap),T.iridescenceThicknessMap&&(b.iridescenceThicknessMap.value=T.iridescenceThicknessMap)),T.transmission>0&&(b.transmission.value=T.transmission,b.transmissionSamplerMap.value=S.texture,b.transmissionSamplerSize.value.set(S.width,S.height),T.transmissionMap&&(b.transmissionMap.value=T.transmissionMap),b.thickness.value=T.thickness,T.thicknessMap&&(b.thicknessMap.value=T.thicknessMap),b.attenuationDistance.value=T.attenuationDistance,b.attenuationColor.value.copy(T.attenuationColor)),b.specularIntensity.value=T.specularIntensity,b.specularColor.value.copy(T.specularColor),T.specularIntensityMap&&(b.specularIntensityMap.value=T.specularIntensityMap),T.specularColorMap&&(b.specularColorMap.value=T.specularColorMap)}(b,T,R)):T.isMeshMatcapMaterial?(r(b,T),function v(b,T){T.matcap&&(b.matcap.value=T.matcap)}(b,T)):T.isMeshDepthMaterial?r(b,T):T.isMeshDistanceMaterial?(r(b,T),function y(b,T){b.referencePosition.value.copy(T.referencePosition),b.nearDistance.value=T.nearDistance,b.farDistance.value=T.farDistance}(b,T)):T.isMeshNormalMaterial?r(b,T):T.isLineBasicMaterial?(function s(b,T){b.diffuse.value.copy(T.color),b.opacity.value=T.opacity}(b,T),T.isLineDashedMaterial&&function o(b,T){b.dashSize.value=T.dashSize,b.totalSize.value=T.dashSize+T.gapSize,b.scale.value=T.scale}(b,T)):T.isPointsMaterial?function a(b,T,S,C){let R;b.diffuse.value.copy(T.color),b.opacity.value=T.opacity,b.size.value=T.size*S,b.scale.value=.5*C,T.map&&(b.map.value=T.map),T.alphaMap&&(b.alphaMap.value=T.alphaMap),T.alphaTest>0&&(b.alphaTest.value=T.alphaTest),T.map?R=T.map:T.alphaMap&&(R=T.alphaMap),void 0!==R&&(!0===R.matrixAutoUpdate&&R.updateMatrix(),b.uvTransform.value.copy(R.matrix))}(b,T,S,C):T.isSpriteMaterial?function l(b,T){let S;b.diffuse.value.copy(T.color),b.opacity.value=T.opacity,b.rotation.value=T.rotation,T.map&&(b.map.value=T.map),T.alphaMap&&(b.alphaMap.value=T.alphaMap),T.alphaTest>0&&(b.alphaTest.value=T.alphaTest),T.map?S=T.map:T.alphaMap&&(S=T.alphaMap),void 0!==S&&(!0===S.matrixAutoUpdate&&S.updateMatrix(),b.uvTransform.value.copy(S.matrix))}(b,T):T.isShadowMaterial?(b.color.value.copy(T.color),b.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}}}function Ohe(i,e,t,n){let r={},s={},o=[];const a=t.isWebGL2?i.getParameter(35375):0;function v(C,R,I){const L=C.value;if(void 0===I[R])return I[R]="number"==typeof L?L:L.clone(),!0;if("number"==typeof L){if(I[R]!==L)return I[R]=L,!0}else{const N=I[R];if(!1===N.equals(L))return N.copy(L),!0}return!1}function b(C){const R=C.value,I={boundary:0,storage:0};return"number"==typeof R?(I.boundary=4,I.storage=4):R.isVector2?(I.boundary=8,I.storage=8):R.isVector3||R.isColor?(I.boundary=16,I.storage=12):R.isVector4?(I.boundary=16,I.storage=16):R.isMatrix3?(I.boundary=48,I.storage=48):R.isMatrix4?(I.boundary=64,I.storage=64):R.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",R),I}function T(C){const R=C.target;R.removeEventListener("dispose",T);const I=o.indexOf(R.__bindingPointIndex);o.splice(I,1),i.deleteBuffer(r[R.id]),delete r[R.id],delete s[R.id]}return{bind:function l(C,R){n.uniformBlockBinding(C,R.program)},update:function h(C,R){let I=r[C.id];void 0===I&&(function y(C){const R=C.uniforms;let I=0;let N=0;for(let U=0,k=R.length;U<k;U++){const z=R[U],K=b(z);if(z.__data=new Float32Array(K.storage/Float32Array.BYTES_PER_ELEMENT),z.__offset=I,U>0){N=I%16;const te=16-N;0!==N&&te-K.boundary<0&&(I+=16-N,z.__offset=I)}I+=K.storage}N=I%16,N>0&&(I+=16-N),C.__size=I,C.__cache={}}(C),I=function f(C){const R=function m(){for(let C=0;C<a;C++)if(-1===o.indexOf(C))return o.push(C),C;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();C.__bindingPointIndex=R;const I=i.createBuffer(),L=C.__size,N=C.usage;return i.bindBuffer(35345,I),i.bufferData(35345,L,N),i.bindBuffer(35345,null),i.bindBufferBase(35345,R,I),I}(C),r[C.id]=I,C.addEventListener("dispose",T)),n.updateUBOMapping(C,R.program);const N=e.render.frame;s[C.id]!==N&&(function g(C){const I=C.uniforms,L=C.__cache;i.bindBuffer(35345,r[C.id]);for(let N=0,U=I.length;N<U;N++){const k=I[N];if(!0===v(k,N,L)){const z=k.value,K=k.__offset;"number"==typeof z?(k.__data[0]=z,i.bufferSubData(35345,K,k.__data)):(k.value.isMatrix3?(k.__data[0]=k.value.elements[0],k.__data[1]=k.value.elements[1],k.__data[2]=k.value.elements[2],k.__data[3]=k.value.elements[0],k.__data[4]=k.value.elements[3],k.__data[5]=k.value.elements[4],k.__data[6]=k.value.elements[5],k.__data[7]=k.value.elements[0],k.__data[8]=k.value.elements[6],k.__data[9]=k.value.elements[7],k.__data[10]=k.value.elements[8],k.__data[11]=k.value.elements[0]):z.toArray(k.__data),i.bufferSubData(35345,K,k.__data))}}i.bindBuffer(35345,null)}(C),s[C.id]=N)},dispose:function S(){for(const C in r)i.deleteBuffer(r[C]);o=[],r={},s={}}}}function Cq(i={}){this.isWebGLRenderer=!0;const e=void 0!==i.canvas?i.canvas:function khe(){const i=eA("canvas");return i.style.display="block",i}(),t=void 0!==i.context?i.context:null,n=void 0===i.depth||i.depth,r=void 0===i.stencil||i.stencil,s=void 0!==i.antialias&&i.antialias,o=void 0===i.premultipliedAlpha||i.premultipliedAlpha,a=void 0!==i.preserveDrawingBuffer&&i.preserveDrawingBuffer,l=void 0!==i.powerPreference?i.powerPreference:"default",h=void 0!==i.failIfMajorPerformanceCaveat&&i.failIfMajorPerformanceCaveat;let f;f=null!==t?t.getContextAttributes().alpha:void 0!==i.alpha&&i.alpha;let m=null,g=null;const v=[],y=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=j0,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const b=this;let T=!1,S=0,C=0,R=null,I=-1,L=null;const N=new hr,U=new hr;let k=null,z=e.width,K=e.height,te=1,fe=null,ie=null;const ne=new hr(0,0,z,K),le=new hr(0,0,z,K);let Z=!1;const he=new sU;let me=!1,ce=!1,be=null;const Ge=new Jn,Ee=new Je,mt=new Q,it={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Gt(){return null===R?te:1}let pt,Wt,It,wn,ft,vt,Bt,Mn,dn,pi,ni,Kn,ir,Yi,_e,oe,ht,Zt,tn,gn,$n,ue,Ft,Qt,Ve=t;function Ie(de,Qe){for(let qe=0;qe<de.length;qe++){const Lt=e.getContext(de[qe],Qe);if(null!==Lt)return Lt}return null}try{const de={alpha:!0,depth:n,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:h};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r143"),e.addEventListener("webglcontextlost",Vn,!1),e.addEventListener("webglcontextrestored",ki,!1),e.addEventListener("webglcontextcreationerror",cr,!1),null===Ve){const Qe=["webgl2","webgl","experimental-webgl"];if(!0===b.isWebGL1Renderer&&Qe.shift(),Ve=Ie(Qe,de),null===Ve)throw Ie(Qe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Ve.getShaderPrecisionFormat&&(Ve.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(de){throw console.error("THREE.WebGLRenderer: "+de.message),de}function xn(){pt=new Yce(Ve),Wt=new Gce(Ve,pt,i),pt.init(Wt),ue=new Dhe(Ve,pt,Wt),It=new Ehe(Ve,pt,Wt),wn=new $ce,ft=new mhe,vt=new Ahe(Ve,pt,It,ft,Wt,ue,wn),Bt=new Hce(b),Mn=new Zce(b),dn=new Vae(Ve,Wt),Ft=new Uce(Ve,pt,dn,Wt),pi=new Kce(Ve,dn,wn,Ft),ni=new tue(Ve,pi,dn,wn),tn=new eue(Ve,Wt,vt),oe=new zce(ft),Kn=new phe(b,Bt,Mn,pt,Wt,Ft,oe),ir=new Lhe(b,ft),Yi=new _he,_e=new whe(pt,Wt),Zt=new jce(b,Bt,It,ni,f,o),ht=new Che(b,ni,Wt),Qt=new Ohe(Ve,wn,Wt,It),gn=new Vce(Ve,pt,wn,Wt),$n=new Xce(Ve,pt,wn,Wt),wn.programs=Kn.programs,b.capabilities=Wt,b.extensions=pt,b.properties=ft,b.renderLists=Yi,b.shadowMap=ht,b.state=It,b.info=wn}xn();const pn=new Fhe(b,Ve);function Vn(de){de.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),T=!0}function ki(){console.log("THREE.WebGLRenderer: Context Restored."),T=!1;const de=wn.autoReset,Qe=ht.enabled,qe=ht.autoUpdate,rt=ht.needsUpdate,Lt=ht.type;xn(),wn.autoReset=de,ht.enabled=Qe,ht.autoUpdate=qe,ht.needsUpdate=rt,ht.type=Lt}function cr(de){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",de.statusMessage)}function Pe(de){const Qe=de.target;Qe.removeEventListener("dispose",Pe),function Yt(de){(function bt(de){const Qe=ft.get(de).programs;void 0!==Qe&&(Qe.forEach(function(qe){Kn.releaseProgram(qe)}),de.isShaderMaterial&&Kn.releaseShaderCache(de))})(de),ft.remove(de)}(Qe)}this.xr=pn,this.getContext=function(){return Ve},this.getContextAttributes=function(){return Ve.getContextAttributes()},this.forceContextLoss=function(){const de=pt.get("WEBGL_lose_context");de&&de.loseContext()},this.forceContextRestore=function(){const de=pt.get("WEBGL_lose_context");de&&de.restoreContext()},this.getPixelRatio=function(){return te},this.setPixelRatio=function(de){void 0!==de&&(te=de,this.setSize(z,K,!1))},this.getSize=function(de){return de.set(z,K)},this.setSize=function(de,Qe,qe){pn.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(z=de,K=Qe,e.width=Math.floor(de*te),e.height=Math.floor(Qe*te),!1!==qe&&(e.style.width=de+"px",e.style.height=Qe+"px"),this.setViewport(0,0,de,Qe))},this.getDrawingBufferSize=function(de){return de.set(z*te,K*te).floor()},this.setDrawingBufferSize=function(de,Qe,qe){z=de,K=Qe,te=qe,e.width=Math.floor(de*qe),e.height=Math.floor(Qe*qe),this.setViewport(0,0,de,Qe)},this.getCurrentViewport=function(de){return de.copy(N)},this.getViewport=function(de){return de.copy(ne)},this.setViewport=function(de,Qe,qe,rt){de.isVector4?ne.set(de.x,de.y,de.z,de.w):ne.set(de,Qe,qe,rt),It.viewport(N.copy(ne).multiplyScalar(te).floor())},this.getScissor=function(de){return de.copy(le)},this.setScissor=function(de,Qe,qe,rt){de.isVector4?le.set(de.x,de.y,de.z,de.w):le.set(de,Qe,qe,rt),It.scissor(U.copy(le).multiplyScalar(te).floor())},this.getScissorTest=function(){return Z},this.setScissorTest=function(de){It.setScissorTest(Z=de)},this.setOpaqueSort=function(de){fe=de},this.setTransparentSort=function(de){ie=de},this.getClearColor=function(de){return de.copy(Zt.getClearColor())},this.setClearColor=function(){Zt.setClearColor.apply(Zt,arguments)},this.getClearAlpha=function(){return Zt.getClearAlpha()},this.setClearAlpha=function(){Zt.setClearAlpha.apply(Zt,arguments)},this.clear=function(de=!0,Qe=!0,qe=!0){let rt=0;de&&(rt|=16384),Qe&&(rt|=256),qe&&(rt|=1024),Ve.clear(rt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Vn,!1),e.removeEventListener("webglcontextrestored",ki,!1),e.removeEventListener("webglcontextcreationerror",cr,!1),Yi.dispose(),_e.dispose(),ft.dispose(),Bt.dispose(),Mn.dispose(),ni.dispose(),Ft.dispose(),Qt.dispose(),Kn.dispose(),pn.dispose(),pn.removeEventListener("sessionstart",rr),pn.removeEventListener("sessionend",zo),be&&(be.dispose(),be=null),Ws.stop()},this.renderBufferDirect=function(de,Qe,qe,rt,Lt,H){null===Qe&&(Qe=it);const ee=Lt.isMesh&&Lt.matrixWorld.determinant()<0,ge=function ez(de,Qe,qe,rt,Lt){!0!==Qe.isScene&&(Qe=it),vt.resetTextureUnits();const H=Qe.fog,ge=null===R?b.outputEncoding:!0===R.isXRRenderTarget?R.texture.encoding:j0,Le=(rt.isMeshStandardMaterial?Mn:Bt).get(rt.envMap||(rt.isMeshStandardMaterial?Qe.environment:null)),tt=!0===rt.vertexColors&&!!qe.attributes.color&&4===qe.attributes.color.itemSize,We=!!rt.normalMap&&!!qe.attributes.tangent,Mt=!!qe.morphAttributes.position,Ut=!!qe.morphAttributes.normal,on=!!qe.morphAttributes.color,Vt=rt.toneMapped?b.toneMapping:0,Jt=qe.morphAttributes.position||qe.morphAttributes.normal||qe.morphAttributes.color,Cn=void 0!==Jt?Jt.length:0,en=ft.get(rt),ii=g.state.lights;!0!==me||!0!==ce&&de===L||oe.setState(rt,de,de===L&&rt.id===I);let Wn=!1;rt.version===en.__version?(en.needsLights&&en.lightsStateVersion!==ii.state.version||en.outputEncoding!==ge||Lt.isInstancedMesh&&!1===en.instancing||!Lt.isInstancedMesh&&!0===en.instancing||Lt.isSkinnedMesh&&!1===en.skinning||!Lt.isSkinnedMesh&&!0===en.skinning||en.envMap!==Le||!0===rt.fog&&en.fog!==H||void 0!==en.numClippingPlanes&&(en.numClippingPlanes!==oe.numPlanes||en.numIntersection!==oe.numIntersection)||en.vertexAlphas!==tt||en.vertexTangents!==We||en.morphTargets!==Mt||en.morphNormals!==Ut||en.morphColors!==on||en.toneMapping!==Vt||!0===Wt.isWebGL2&&en.morphTargetsCount!==Cn)&&(Wn=!0):(Wn=!0,en.__version=rt.version);let En=en.currentProgram;!0===Wn&&(En=d1(rt,Qe,Lt));let Gn=!1,Ei=!1,ns=!1;const Ki=En.getUniforms(),ua=en.uniforms;if(It.useProgram(En.program)&&(Gn=!0,Ei=!0,ns=!0),rt.id!==I&&(I=rt.id,Ei=!0),Gn||L!==de){if(Ki.setValue(Ve,"projectionMatrix",de.projectionMatrix),Wt.logarithmicDepthBuffer&&Ki.setValue(Ve,"logDepthBufFC",2/(Math.log(de.far+1)/Math.LN2)),L!==de&&(L=de,Ei=!0,ns=!0),rt.isShaderMaterial||rt.isMeshPhongMaterial||rt.isMeshToonMaterial||rt.isMeshStandardMaterial||rt.envMap){const yi=Ki.map.cameraPosition;void 0!==yi&&yi.setValue(Ve,mt.setFromMatrixPosition(de.matrixWorld))}(rt.isMeshPhongMaterial||rt.isMeshToonMaterial||rt.isMeshLambertMaterial||rt.isMeshBasicMaterial||rt.isMeshStandardMaterial||rt.isShaderMaterial)&&Ki.setValue(Ve,"isOrthographic",!0===de.isOrthographicCamera),(rt.isMeshPhongMaterial||rt.isMeshToonMaterial||rt.isMeshLambertMaterial||rt.isMeshBasicMaterial||rt.isMeshStandardMaterial||rt.isShaderMaterial||rt.isShadowMaterial||Lt.isSkinnedMesh)&&Ki.setValue(Ve,"viewMatrix",de.matrixWorldInverse)}if(Lt.isSkinnedMesh){Ki.setOptional(Ve,Lt,"bindMatrix"),Ki.setOptional(Ve,Lt,"bindMatrixInverse");const yi=Lt.skeleton;yi&&(Wt.floatVertexTextures?(null===yi.boneTexture&&yi.computeBoneTexture(),Ki.setValue(Ve,"boneTexture",yi.boneTexture,vt),Ki.setValue(Ve,"boneTextureSize",yi.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Ir=qe.morphAttributes;if((void 0!==Ir.position||void 0!==Ir.normal||void 0!==Ir.color&&!0===Wt.isWebGL2)&&tn.update(Lt,qe,rt,En),(Ei||en.receiveShadow!==Lt.receiveShadow)&&(en.receiveShadow=Lt.receiveShadow,Ki.setValue(Ve,"receiveShadow",Lt.receiveShadow)),Ei&&(Ki.setValue(Ve,"toneMappingExposure",b.toneMappingExposure),en.needsLights&&function $w(de,Qe){de.ambientLightColor.needsUpdate=Qe,de.lightProbe.needsUpdate=Qe,de.directionalLights.needsUpdate=Qe,de.directionalLightShadows.needsUpdate=Qe,de.pointLights.needsUpdate=Qe,de.pointLightShadows.needsUpdate=Qe,de.spotLights.needsUpdate=Qe,de.spotLightShadows.needsUpdate=Qe,de.rectAreaLights.needsUpdate=Qe,de.hemisphereLights.needsUpdate=Qe}(ua,ns),H&&!0===rt.fog&&ir.refreshFogUniforms(ua,H),ir.refreshMaterialUniforms(ua,rt,te,K,be),_F.upload(Ve,en.uniformsList,ua,vt)),rt.isShaderMaterial&&!0===rt.uniformsNeedUpdate&&(_F.upload(Ve,en.uniformsList,ua,vt),rt.uniformsNeedUpdate=!1),rt.isSpriteMaterial&&Ki.setValue(Ve,"center",Lt.center),Ki.setValue(Ve,"modelViewMatrix",Lt.modelViewMatrix),Ki.setValue(Ve,"normalMatrix",Lt.normalMatrix),Ki.setValue(Ve,"modelMatrix",Lt.matrixWorld),rt.isShaderMaterial||rt.isRawShaderMaterial){const yi=rt.uniformsGroups;for(let qs=0,Tc=yi.length;qs<Tc;qs++)if(Wt.isWebGL2){const xo=yi[qs];Qt.update(xo,En),Qt.bind(xo,En)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return En}(de,Qe,qe,rt,Lt);It.setMaterial(rt,ee);let Le=qe.index;const tt=qe.attributes.position;if(null===Le){if(void 0===tt||0===tt.count)return}else if(0===Le.count)return;let We=1;!0===rt.wireframe&&(Le=pi.getWireframeAttribute(qe),We=2),Ft.setup(Lt,rt,ge,qe,Le);let Mt,Ut=gn;null!==Le&&(Mt=dn.get(Le),Ut=$n,Ut.setIndex(Mt));const on=null!==Le?Le.count:tt.count,Vt=qe.drawRange.start*We,Jt=qe.drawRange.count*We,Cn=null!==H?H.start*We:0,en=null!==H?H.count*We:1/0,ii=Math.max(Vt,Cn),Wn=Math.min(on,Vt+Jt,Cn+en)-1,En=Math.max(0,Wn-ii+1);if(0!==En){if(Lt.isMesh)!0===rt.wireframe?(It.setLineWidth(rt.wireframeLinewidth*Gt()),Ut.setMode(1)):Ut.setMode(4);else if(Lt.isLine){let Gn=rt.linewidth;void 0===Gn&&(Gn=1),It.setLineWidth(Gn*Gt()),Ut.setMode(Lt.isLineSegments?1:Lt.isLineLoop?2:3)}else Lt.isPoints?Ut.setMode(0):Lt.isSprite&&Ut.setMode(4);if(Lt.isInstancedMesh)Ut.renderInstances(ii,En,Lt.count);else if(qe.isInstancedBufferGeometry){const Gn=Math.min(qe.instanceCount,qe._maxInstanceCount);Ut.renderInstances(ii,En,Gn)}else Ut.render(ii,En)}},this.compile=function(de,Qe){g=_e.get(de),g.init(),y.push(g),de.traverseVisible(function(qe){qe.isLight&&qe.layers.test(Qe.layers)&&(g.pushLight(qe),qe.castShadow&&g.pushShadow(qe))}),g.setupLights(b.physicallyCorrectLights),de.traverse(function(qe){const rt=qe.material;if(rt)if(Array.isArray(rt))for(let Lt=0;Lt<rt.length;Lt++)d1(rt[Lt],de,qe);else d1(rt,de,qe)}),y.pop(),g=null};let lt=null;function rr(){Ws.stop()}function zo(){Ws.start()}const Ws=new $8;function tp(de,Qe,qe,rt){if(!1===de.visible)return;if(de.layers.test(Qe.layers))if(de.isGroup)qe=de.renderOrder;else if(de.isLOD)!0===de.autoUpdate&&de.update(Qe);else if(de.isLight)g.pushLight(de),de.castShadow&&g.pushShadow(de);else if(de.isSprite){if(!de.frustumCulled||he.intersectsSprite(de)){rt&&mt.setFromMatrixPosition(de.matrixWorld).applyMatrix4(Ge);const ee=ni.update(de),ge=de.material;ge.visible&&m.push(de,ee,ge,qe,mt.z,null)}}else if((de.isMesh||de.isLine||de.isPoints)&&(de.isSkinnedMesh&&de.skeleton.frame!==wn.render.frame&&(de.skeleton.update(),de.skeleton.frame=wn.render.frame),!de.frustumCulled||he.intersectsObject(de))){rt&&mt.setFromMatrixPosition(de.matrixWorld).applyMatrix4(Ge);const ee=ni.update(de),ge=de.material;if(Array.isArray(ge)){const Le=ee.groups;for(let tt=0,We=Le.length;tt<We;tt++){const Mt=Le[tt],Ut=ge[Mt.materialIndex];Ut&&Ut.visible&&m.push(de,ee,Ut,qe,mt.z,Mt)}}else ge.visible&&m.push(de,ee,ge,qe,mt.z,null)}const H=de.children;for(let ee=0,ge=H.length;ee<ge;ee++)tp(H[ee],Qe,qe,rt)}function Fs(de,Qe,qe,rt){const Lt=de.opaque,H=de.transmissive,ee=de.transparent;g.setupLightsView(qe),H.length>0&&function Rd(de,Qe,qe){const rt=Wt.isWebGL2;null===be&&(be=new ra(1,1,{generateMipmaps:!0,type:pt.has("EXT_color_buffer_half_float")?Wf:du,minFilter:B_,samples:rt&&!0===s?4:0})),b.getDrawingBufferSize(Ee),rt?be.setSize(Ee.x,Ee.y):be.setSize(zP(Ee.x),zP(Ee.y));const Lt=b.getRenderTarget();b.setRenderTarget(be),b.clear();const H=b.toneMapping;b.toneMapping=0,xc(de,Qe,qe),b.toneMapping=H,vt.updateMultisampleRenderTarget(be),vt.updateRenderTargetMipmap(be),b.setRenderTarget(Lt)}(Lt,Qe,qe),rt&&It.viewport(N.copy(rt)),Lt.length>0&&xc(Lt,Qe,qe),H.length>0&&xc(H,Qe,qe),ee.length>0&&xc(ee,Qe,qe),It.buffers.depth.setTest(!0),It.buffers.depth.setMask(!0),It.buffers.color.setMask(!0),It.setPolygonOffset(!1)}function xc(de,Qe,qe){const rt=!0===Qe.isScene?Qe.overrideMaterial:null;for(let Lt=0,H=de.length;Lt<H;Lt++){const ee=de[Lt],ge=ee.object,Le=ee.geometry,tt=null===rt?ee.material:rt,We=ee.group;ge.layers.test(qe.layers)&&JG(ge,Qe,qe,Le,tt,We)}}function JG(de,Qe,qe,rt,Lt,H){de.onBeforeRender(b,Qe,qe,rt,Lt,H),de.modelViewMatrix.multiplyMatrices(qe.matrixWorldInverse,de.matrixWorld),de.normalMatrix.getNormalMatrix(de.modelViewMatrix),Lt.onBeforeRender(b,Qe,qe,rt,de,H),!0===Lt.transparent&&2===Lt.side?(Lt.side=1,Lt.needsUpdate=!0,b.renderBufferDirect(qe,Qe,rt,Lt,de,H),Lt.side=0,Lt.needsUpdate=!0,b.renderBufferDirect(qe,Qe,rt,Lt,de,H),Lt.side=2):b.renderBufferDirect(qe,Qe,rt,Lt,de,H),de.onAfterRender(b,Qe,qe,rt,Lt,H)}function d1(de,Qe,qe){!0!==Qe.isScene&&(Qe=it);const rt=ft.get(de),Lt=g.state.lights,ee=Lt.state.version,ge=Kn.getParameters(de,Lt.state,g.state.shadowsArray,Qe,qe),Le=Kn.getProgramCacheKey(ge);let tt=rt.programs;rt.environment=de.isMeshStandardMaterial?Qe.environment:null,rt.fog=Qe.fog,rt.envMap=(de.isMeshStandardMaterial?Mn:Bt).get(de.envMap||rt.environment),void 0===tt&&(de.addEventListener("dispose",Pe),tt=new Map,rt.programs=tt);let We=tt.get(Le);if(void 0!==We){if(rt.currentProgram===We&&rt.lightsStateVersion===ee)return bO(de,ge),We}else ge.uniforms=Kn.getUniforms(de),de.onBuild(qe,ge,b),de.onBeforeCompile(ge,b),We=Kn.acquireProgram(ge,Le),tt.set(Le,We),rt.uniforms=ge.uniforms;const Mt=rt.uniforms;(!de.isShaderMaterial&&!de.isRawShaderMaterial||!0===de.clipping)&&(Mt.clippingPlanes=oe.uniform),bO(de,ge),rt.needsLights=function tz(de){return de.isMeshLambertMaterial||de.isMeshToonMaterial||de.isMeshPhongMaterial||de.isMeshStandardMaterial||de.isShadowMaterial||de.isShaderMaterial&&!0===de.lights}(de),rt.lightsStateVersion=ee,rt.needsLights&&(Mt.ambientLightColor.value=Lt.state.ambient,Mt.lightProbe.value=Lt.state.probe,Mt.directionalLights.value=Lt.state.directional,Mt.directionalLightShadows.value=Lt.state.directionalShadow,Mt.spotLights.value=Lt.state.spot,Mt.spotLightShadows.value=Lt.state.spotShadow,Mt.rectAreaLights.value=Lt.state.rectArea,Mt.ltc_1.value=Lt.state.rectAreaLTC1,Mt.ltc_2.value=Lt.state.rectAreaLTC2,Mt.pointLights.value=Lt.state.point,Mt.pointLightShadows.value=Lt.state.pointShadow,Mt.hemisphereLights.value=Lt.state.hemi,Mt.directionalShadowMap.value=Lt.state.directionalShadowMap,Mt.directionalShadowMatrix.value=Lt.state.directionalShadowMatrix,Mt.spotShadowMap.value=Lt.state.spotShadowMap,Mt.spotShadowMatrix.value=Lt.state.spotShadowMatrix,Mt.pointShadowMap.value=Lt.state.pointShadowMap,Mt.pointShadowMatrix.value=Lt.state.pointShadowMatrix);const Ut=We.getUniforms(),on=_F.seqWithValue(Ut.seq,Mt);return rt.currentProgram=We,rt.uniformsList=on,We}function bO(de,Qe){const qe=ft.get(de);qe.outputEncoding=Qe.outputEncoding,qe.instancing=Qe.instancing,qe.skinning=Qe.skinning,qe.morphTargets=Qe.morphTargets,qe.morphNormals=Qe.morphNormals,qe.morphColors=Qe.morphColors,qe.morphTargetsCount=Qe.morphTargetsCount,qe.numClippingPlanes=Qe.numClippingPlanes,qe.numIntersection=Qe.numClipIntersection,qe.vertexAlphas=Qe.vertexAlphas,qe.vertexTangents=Qe.vertexTangents,qe.toneMapping=Qe.toneMapping}Ws.setAnimationLoop(function mn(de){lt&&lt(de)}),typeof self<"u"&&Ws.setContext(self),this.setAnimationLoop=function(de){lt=de,pn.setAnimationLoop(de),null===de?Ws.stop():Ws.start()},pn.addEventListener("sessionstart",rr),pn.addEventListener("sessionend",zo),this.render=function(de,Qe){if(void 0===Qe||!0===Qe.isCamera){if(!0!==T){if(!0===de.autoUpdate&&de.updateMatrixWorld(),null===Qe.parent&&Qe.updateMatrixWorld(),!0===pn.enabled&&!0===pn.isPresenting&&(!0===pn.cameraAutoUpdate&&pn.updateCamera(Qe),Qe=pn.getCamera()),!0===de.isScene&&de.onBeforeRender(b,de,Qe,R),g=_e.get(de,y.length),g.init(),y.push(g),Ge.multiplyMatrices(Qe.projectionMatrix,Qe.matrixWorldInverse),he.setFromProjectionMatrix(Ge),ce=this.localClippingEnabled,me=oe.init(this.clippingPlanes,ce,Qe),m=Yi.get(de,v.length),m.init(),v.push(m),tp(de,Qe,0,b.sortObjects),m.finish(),!0===b.sortObjects&&m.sort(fe,ie),!0===me&&oe.beginShadows(),ht.render(g.state.shadowsArray,de,Qe),!0===me&&oe.endShadows(),!0===this.info.autoReset&&this.info.reset(),Zt.render(m,de),g.setupLights(b.physicallyCorrectLights),Qe.isArrayCamera){const rt=Qe.cameras;for(let Lt=0,H=rt.length;Lt<H;Lt++){const ee=rt[Lt];Fs(m,de,ee,ee.viewport)}}else Fs(m,de,Qe);null!==R&&(vt.updateMultisampleRenderTarget(R),vt.updateRenderTargetMipmap(R)),!0===de.isScene&&de.onAfterRender(b,de,Qe),Ft.resetDefaultState(),I=-1,L=null,y.pop(),g=y.length>0?y[y.length-1]:null,v.pop(),m=v.length>0?v[v.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return C},this.getRenderTarget=function(){return R},this.setRenderTargetTextures=function(de,Qe,qe){ft.get(de.texture).__webglTexture=Qe,ft.get(de.depthTexture).__webglTexture=qe;const rt=ft.get(de);rt.__hasExternalTextures=!0,rt.__hasExternalTextures&&(rt.__autoAllocateDepthBuffer=void 0===qe,rt.__autoAllocateDepthBuffer||!0===pt.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),rt.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(de,Qe){const qe=ft.get(de);qe.__webglFramebuffer=Qe,qe.__useDefaultFramebuffer=void 0===Qe},this.setRenderTarget=function(de,Qe=0,qe=0){R=de,S=Qe,C=qe;let rt=!0;if(de){const Le=ft.get(de);void 0!==Le.__useDefaultFramebuffer?(It.bindFramebuffer(36160,null),rt=!1):void 0===Le.__webglFramebuffer?vt.setupRenderTarget(de):Le.__hasExternalTextures&&vt.rebindTextures(de,ft.get(de.texture).__webglTexture,ft.get(de.depthTexture).__webglTexture)}let Lt=null,H=!1,ee=!1;if(de){const Le=de.texture;(Le.isData3DTexture||Le.isDataArrayTexture)&&(ee=!0);const tt=ft.get(de).__webglFramebuffer;de.isWebGLCubeRenderTarget?(Lt=tt[Qe],H=!0):Lt=Wt.isWebGL2&&de.samples>0&&!1===vt.useMultisampledRTT(de)?ft.get(de).__webglMultisampledFramebuffer:tt,N.copy(de.viewport),U.copy(de.scissor),k=de.scissorTest}else N.copy(ne).multiplyScalar(te).floor(),U.copy(le).multiplyScalar(te).floor(),k=Z;if(It.bindFramebuffer(36160,Lt)&&Wt.drawBuffers&&rt&&It.drawBuffers(de,Lt),It.viewport(N),It.scissor(U),It.setScissorTest(k),H){const Le=ft.get(de.texture);Ve.framebufferTexture2D(36160,36064,34069+Qe,Le.__webglTexture,qe)}else if(ee){const Le=ft.get(de.texture);Ve.framebufferTextureLayer(36160,36064,Le.__webglTexture,qe||0,Qe||0)}I=-1},this.readRenderTargetPixels=function(de,Qe,qe,rt,Lt,H,ee){if(!de||!de.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ge=ft.get(de).__webglFramebuffer;if(de.isWebGLCubeRenderTarget&&void 0!==ee&&(ge=ge[ee]),ge){It.bindFramebuffer(36160,ge);try{const Le=de.texture,tt=Le.format,We=Le.type;if(tt!==kl&&ue.convert(tt)!==Ve.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Mt=We===Wf&&(pt.has("EXT_color_buffer_half_float")||Wt.isWebGL2&&pt.has("EXT_color_buffer_float"));if(!(We===du||ue.convert(We)===Ve.getParameter(35738)||We===hh&&(Wt.isWebGL2||pt.has("OES_texture_float")||pt.has("WEBGL_color_buffer_float"))||Mt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Qe>=0&&Qe<=de.width-rt&&qe>=0&&qe<=de.height-Lt&&Ve.readPixels(Qe,qe,rt,Lt,ue.convert(tt),ue.convert(We),H)}finally{const Le=null!==R?ft.get(R).__webglFramebuffer:null;It.bindFramebuffer(36160,Le)}}},this.copyFramebufferToTexture=function(de,Qe,qe=0){const rt=Math.pow(2,-qe),Lt=Math.floor(Qe.image.width*rt),H=Math.floor(Qe.image.height*rt);vt.setTexture2D(Qe,0),Ve.copyTexSubImage2D(3553,qe,0,0,de.x,de.y,Lt,H),It.unbindTexture()},this.copyTextureToTexture=function(de,Qe,qe,rt=0){const Lt=Qe.image.width,H=Qe.image.height,ee=ue.convert(qe.format),ge=ue.convert(qe.type);vt.setTexture2D(qe,0),Ve.pixelStorei(37440,qe.flipY),Ve.pixelStorei(37441,qe.premultiplyAlpha),Ve.pixelStorei(3317,qe.unpackAlignment),Qe.isDataTexture?Ve.texSubImage2D(3553,rt,de.x,de.y,Lt,H,ee,ge,Qe.image.data):Qe.isCompressedTexture?Ve.compressedTexSubImage2D(3553,rt,de.x,de.y,Qe.mipmaps[0].width,Qe.mipmaps[0].height,ee,Qe.mipmaps[0].data):Ve.texSubImage2D(3553,rt,de.x,de.y,ee,ge,Qe.image),0===rt&&qe.generateMipmaps&&Ve.generateMipmap(3553),It.unbindTexture()},this.copyTextureToTexture3D=function(de,Qe,qe,rt,Lt=0){if(b.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const H=de.max.x-de.min.x+1,ee=de.max.y-de.min.y+1,ge=de.max.z-de.min.z+1,Le=ue.convert(rt.format),tt=ue.convert(rt.type);let We;if(rt.isData3DTexture)vt.setTexture3D(rt,0),We=32879;else{if(!rt.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");vt.setTexture2DArray(rt,0),We=35866}Ve.pixelStorei(37440,rt.flipY),Ve.pixelStorei(37441,rt.premultiplyAlpha),Ve.pixelStorei(3317,rt.unpackAlignment);const Mt=Ve.getParameter(3314),Ut=Ve.getParameter(32878),on=Ve.getParameter(3316),Vt=Ve.getParameter(3315),Jt=Ve.getParameter(32877),Cn=qe.isCompressedTexture?qe.mipmaps[0]:qe.image;Ve.pixelStorei(3314,Cn.width),Ve.pixelStorei(32878,Cn.height),Ve.pixelStorei(3316,de.min.x),Ve.pixelStorei(3315,de.min.y),Ve.pixelStorei(32877,de.min.z),qe.isDataTexture||qe.isData3DTexture?Ve.texSubImage3D(We,Lt,Qe.x,Qe.y,Qe.z,H,ee,ge,Le,tt,Cn.data):qe.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ve.compressedTexSubImage3D(We,Lt,Qe.x,Qe.y,Qe.z,H,ee,ge,Le,Cn.data)):Ve.texSubImage3D(We,Lt,Qe.x,Qe.y,Qe.z,H,ee,ge,Le,tt,Cn),Ve.pixelStorei(3314,Mt),Ve.pixelStorei(32878,Ut),Ve.pixelStorei(3316,on),Ve.pixelStorei(3315,Vt),Ve.pixelStorei(32877,Jt),0===Lt&&rt.generateMipmaps&&Ve.generateMipmap(We),It.unbindTexture()},this.initTexture=function(de){de.isCubeTexture?vt.setTextureCube(de,0):de.isData3DTexture?vt.setTexture3D(de,0):de.isDataArrayTexture?vt.setTexture2DArray(de,0):vt.setTexture2D(de,0),It.unbindTexture()},this.resetState=function(){S=0,C=0,R=null,It.reset(),Ft.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class Nhe extends Cq{}).prototype.isWebGL1Renderer=!0;class Eq extends oa{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}class gU{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=fu()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=fu()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=fu()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const jl=new Q;class Q0{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)jl.fromBufferAttribute(this,t),jl.applyMatrix4(e),this.setXYZ(t,jl.x,jl.y,jl.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)jl.fromBufferAttribute(this,t),jl.applyNormalMatrix(e),this.setXYZ(t,jl.x,jl.y,jl.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)jl.fromBufferAttribute(this,t),jl.transformDirection(e),this.setXYZ(t,jl.x,jl.y,jl.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Uo(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Q0(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const Fq=new Q,Lq=new hr,Oq=new hr,Uhe=new Q,kq=new Jn;class Nq extends aa{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Jn,this.bindMatrixInverse=new Jn}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new hr,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,r=this.geometry;Lq.fromBufferAttribute(r.attributes.skinIndex,e),Oq.fromBufferAttribute(r.attributes.skinWeight,e),Fq.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=Oq.getComponent(s);if(0!==o){const a=Lq.getComponent(s);kq.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(Uhe.copy(Fq).applyMatrix4(kq),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class vU extends oa{constructor(){super(),this.isBone=!0,this.type="Bone"}}class lA extends vd{constructor(e=null,t=1,n=1,r,s,o,a,l,h=Bo,f=Bo,m,g){super(null,o,a,l,h,f,r,s,m,g),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Bq=new Jn,Vhe=new Jn;class TF{constructor(e=[],t=[]){this.uuid=fu(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Jn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Jn;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)Bq.multiplyMatrices(e[s]?e[s].matrixWorld:Vhe,t[s]),Bq.toArray(n,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new TF(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=L8(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new lA(t,e,e,kl,hh);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new vU),this.bones.push(o),this.boneInverses.push((new Jn).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(n[r].toArray());return e}}class _c extends fh{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new sn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Vq=new Q,Gq=new Q,zq=new Jn,yU=new JP,MF=new K0;class J0 extends oa{constructor(e=new Di,t=new _c){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)Vq.fromBufferAttribute(t,r-1),Gq.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=Vq.distanceTo(Gq);e.setAttribute("lineDistance",new On(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),MF.copy(n.boundingSphere),MF.applyMatrix4(r),MF.radius+=s,!1===e.ray.intersectsSphere(MF))return;zq.copy(r).invert(),yU.copy(e.ray).applyMatrix4(zq);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,h=new Q,f=new Q,m=new Q,g=new Q,v=this.isLineSegments?2:1,y=n.index,T=n.attributes.position;if(null!==y)for(let R=Math.max(0,o.start),I=Math.min(y.count,o.start+o.count)-1;R<I;R+=v){const L=y.getX(R),N=y.getX(R+1);if(h.fromBufferAttribute(T,L),f.fromBufferAttribute(T,N),yU.distanceSqToSegment(h,f,g,m)>l)continue;g.applyMatrix4(this.matrixWorld);const k=e.ray.origin.distanceTo(g);k<e.near||k>e.far||t.push({distance:k,point:m.clone().applyMatrix4(this.matrixWorld),index:R,face:null,faceIndex:null,object:this})}else for(let R=Math.max(0,o.start),I=Math.min(T.count,o.start+o.count)-1;R<I;R+=v){if(h.fromBufferAttribute(T,R),f.fromBufferAttribute(T,R+1),yU.distanceSqToSegment(h,f,g,m)>l)continue;g.applyMatrix4(this.matrixWorld);const N=e.ray.origin.distanceTo(g);N<e.near||N>e.far||t.push({distance:N,point:m.clone().applyMatrix4(this.matrixWorld),index:R,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const Hq=new Q,Wq=new Q;class bU extends J0{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)Hq.fromBufferAttribute(t,r),Wq.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Hq.distanceTo(Wq);e.setAttribute("lineDistance",new On(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class qq extends J0{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class xU extends fh{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new sn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Zq=new Jn,TU=new JP,SF=new K0,CF=new Q;class Yq extends oa{constructor(e=new Di,t=new xU){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),SF.copy(n.boundingSphere),SF.applyMatrix4(r),SF.radius+=s,!1===e.ray.intersectsSphere(SF))return;Zq.copy(r).invert(),TU.copy(e.ray).applyMatrix4(Zq);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,h=n.index,m=n.attributes.position;if(null!==h)for(let y=Math.max(0,o.start),b=Math.min(h.count,o.start+o.count);y<b;y++){const T=h.getX(y);CF.fromBufferAttribute(m,T),Kq(CF,T,l,r,e,t,this)}else for(let y=Math.max(0,o.start),b=Math.min(m.count,o.start+o.count);y<b;y++)CF.fromBufferAttribute(m,y),Kq(CF,y,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function Kq(i,e,t,n,r,s,o){const a=TU.distanceSqToPoint(i);if(a<t){const l=new Q;TU.closestPointToPoint(i,l),l.applyMatrix4(n);const h=r.ray.origin.distanceTo(l);if(h<r.near||h>r.far)return;s.push({distance:h,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class Zf{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const s=n.length;let o;o=t||e*n[s-1];let h,a=0,l=s-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),h=n[r]-o,h<0)a=r+1;else{if(!(h>0)){l=r;break}l=r-1}if(r=l,n[r]===o)return r/(s-1);const f=n[r];return(r+(o-f)/(n[r+1]-f))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new Je:new Q);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new Q,r=[],s=[],o=[],a=new Q,l=new Jn;for(let v=0;v<=e;v++)r[v]=this.getTangentAt(v/e,new Q);s[0]=new Q,o[0]=new Q;let h=Number.MAX_VALUE;const f=Math.abs(r[0].x),m=Math.abs(r[0].y),g=Math.abs(r[0].z);f<=h&&(h=f,n.set(1,0,0)),m<=h&&(h=m,n.set(0,1,0)),g<=h&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let v=1;v<=e;v++){if(s[v]=s[v-1].clone(),o[v]=o[v-1].clone(),a.crossVectors(r[v-1],r[v]),a.length()>Number.EPSILON){a.normalize();const y=Math.acos(vo(r[v-1].dot(r[v]),-1,1));s[v].applyMatrix4(l.makeRotationAxis(a,y))}o[v].crossVectors(r[v],s[v])}if(!0===t){let v=Math.acos(vo(s[0].dot(s[e]),-1,1));v/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(v=-v);for(let y=1;y<=e;y++)s[y].applyMatrix4(l.makeRotationAxis(r[y],v*y)),o[y].crossVectors(r[y],s[y])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class wU extends Zf{constructor(e=0,t=0,n=1,r=1,s=0,o=2*Math.PI,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const n=t||new Je,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),h=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const f=Math.cos(this.aRotation),m=Math.sin(this.aRotation),g=l-this.aX,v=h-this.aY;l=g*f-v*m+this.aX,h=g*m+v*f+this.aY}return n.set(l,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}function MU(){let i=0,e=0,t=0,n=0;function r(s,o,a,l){i=s,e=a,t=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,h){r(o,a,h*(a-s),h*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,h,f,m){let g=(o-s)/h-(a-s)/(h+f)+(a-o)/f,v=(a-o)/f-(l-o)/(f+m)+(l-a)/m;g*=f,v*=f,r(o,a,g,v)},calc:function(s){const o=s*s;return i+e*s+t*o+n*(o*s)}}}const EF=new Q,SU=new MU,CU=new MU,EU=new MU;function Xq(i,e,t,n,r){const s=.5*(n-e),o=.5*(r-t),a=i*i;return(2*t-2*n+s+o)*(i*a)+(-3*t+3*n-2*s-o)*a+s*i+t}function hA(i,e,t,n){return function qhe(i,e){const t=1-i;return t*t*e}(i,e)+function Zhe(i,e){return 2*(1-i)*i*e}(i,t)+function Yhe(i,e){return i*i*e}(i,n)}function dA(i,e,t,n,r){return function Khe(i,e){const t=1-i;return t*t*t*e}(i,e)+function Xhe(i,e){const t=1-i;return 3*t*t*i*e}(i,t)+function $he(i,e){return 3*(1-i)*i*i*e}(i,n)+function Qhe(i,e){return i*i*i*e}(i,r)}class $q extends Zf{constructor(e=new Je,t=new Je,n=new Je,r=new Je){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Je){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(dA(e,r.x,s.x,o.x,a.x),dA(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class AU extends Zf{constructor(e=new Je,t=new Je){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Je){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new Je;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Qq extends Zf{constructor(e=new Je,t=new Je,n=new Je){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Je){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(hA(e,r.x,s.x,o.x),hA(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class eZ extends Zf{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Je){const n=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[0===o?o:o-1],h=r[o],f=r[o>r.length-2?r.length-1:o+1],m=r[o>r.length-3?r.length-1:o+2];return n.set(Xq(a,l.x,h.x,f.x,m.x),Xq(a,l.y,h.y,f.y,m.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push((new Je).fromArray(r))}return this}}var DU=Object.freeze({__proto__:null,ArcCurve:class Hhe extends wU{constructor(e,t,n,r,s,o){super(e,t,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class Whe extends Zf{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new Q){const n=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let h,f,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===l&&a===s-1&&(a=s-2,l=1),this.closed||a>0?h=r[(a-1)%s]:(EF.subVectors(r[0],r[1]).add(r[0]),h=EF);const m=r[a%s],g=r[(a+1)%s];if(this.closed||a+2<s?f=r[(a+2)%s]:(EF.subVectors(r[s-1],r[s-2]).add(r[s-1]),f=EF),"centripetal"===this.curveType||"chordal"===this.curveType){const v="chordal"===this.curveType?.5:.25;let y=Math.pow(h.distanceToSquared(m),v),b=Math.pow(m.distanceToSquared(g),v),T=Math.pow(g.distanceToSquared(f),v);b<1e-4&&(b=1),y<1e-4&&(y=b),T<1e-4&&(T=b),SU.initNonuniformCatmullRom(h.x,m.x,g.x,f.x,y,b,T),CU.initNonuniformCatmullRom(h.y,m.y,g.y,f.y,y,b,T),EU.initNonuniformCatmullRom(h.z,m.z,g.z,f.z,y,b,T)}else"catmullrom"===this.curveType&&(SU.initCatmullRom(h.x,m.x,g.x,f.x,this.tension),CU.initCatmullRom(h.y,m.y,g.y,f.y,this.tension),EU.initCatmullRom(h.z,m.z,g.z,f.z,this.tension));return n.set(SU.calc(l),CU.calc(l),EU.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push((new Q).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},CubicBezierCurve:$q,CubicBezierCurve3:class Jhe extends Zf{constructor(e=new Q,t=new Q,n=new Q,r=new Q){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Q){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(dA(e,r.x,s.x,o.x,a.x),dA(e,r.y,s.y,o.y,a.y),dA(e,r.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},EllipseCurve:wU,LineCurve:AU,LineCurve3:class ede extends Zf{constructor(e=new Q,t=new Q){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Q){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:Qq,QuadraticBezierCurve3:class Jq extends Zf{constructor(e=new Q,t=new Q,n=new Q){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Q){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(hA(e,r.x,s.x,o.x),hA(e,r.y,s.y,o.y),hA(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},SplineCurve:eZ});class tde extends Zf{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new AU(t,e))}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const o=r[s]-n,a=this.curves[s],l=a.getLength();return a.getPointAt(0===l?0:1-o/l,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],l=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let h=0;h<l.length;h++){const f=l[h];n&&n.equals(f)||(t.push(f),n=f)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push((new DU[r.type]).fromJSON(r))}return this}}class AF extends tde{constructor(e){super(),this.type="Path",this.currentPoint=new Je,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new AU(this.currentPoint.clone(),new Je(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const s=new Qq(this.currentPoint.clone(),new Je(e,t),new Je(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,o){const a=new $q(this.currentPoint.clone(),new Je(e,t),new Je(n,r),new Je(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new eZ(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,n,r,s,o),this}absarc(e,t,n,r,s,o){return this.absellipse(e,t,n,n,r,s,o),this}ellipse(e,t,n,r,s,o,a,l){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,n,r,s,o,a,l),this}absellipse(e,t,n,r,s,o,a,l){const h=new wU(e,t,n,r,s,o,a,l);if(this.curves.length>0){const m=h.getPoint(0);m.equals(this.currentPoint)||this.lineTo(m.x,m.y)}this.curves.push(h);const f=h.getPoint(1);return this.currentPoint.copy(f),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class ww extends AF{constructor(e){super(e),this.uuid=fu(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push((new AF).fromJSON(r))}return this}}function tZ(i,e,t,n,r){let s,o;if(r===function yde(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}(i,e,t,n)>0)for(s=e;s<t;s+=n)o=rZ(s,i[s],i[s+1],o);else for(s=t-n;s>=e;s-=n)o=rZ(s,i[s],i[s+1],o);return o&&kF(o,o.next)&&(gA(o),o=o.next),o}function K_(i,e){if(!i)return i;e||(e=i);let n,t=i;do{if(n=!1,t.steiner||!kF(t,t.next)&&0!==Gs(t.prev,t,t.next))t=t.next;else{if(gA(t),t=e=t.prev,t===t.next)break;n=!0}}while(n||t!==e);return e}function pA(i,e,t,n,r,s,o){if(!i)return;!o&&s&&function fde(i,e,t,n){let r=i;do{null===r.z&&(r.z=IU(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,function pde(i){let e,t,n,r,s,o,a,l,h=1;do{for(t=i,i=null,s=null,o=0;t;){for(o++,n=t,a=0,e=0;e<h&&(a++,n=n.nextZ,n);e++);for(l=h;a>0||l>0&&n;)0!==a&&(0===l||!n||t.z<=n.z)?(r=t,t=t.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;t=n}s.nextZ=null,h*=2}while(o>1)}(r)}(i,n,r,s);let l,h,a=i;for(;i.prev!==i.next;)if(l=i.prev,h=i.next,s?sde(i,n,r,s):rde(i))e.push(l.i/t),e.push(i.i/t),e.push(h.i/t),gA(i),i=h.next,a=h.next;else if((i=h)===a){o?1===o?pA(i=ode(K_(i),e,t),e,t,n,r,s,2):2===o&&ade(i,e,t,n,r,s):pA(K_(i),e,t,n,r,s,1);break}}function rde(i){const e=i.prev,t=i,n=i.next;if(Gs(e,t,n)>=0)return!1;let r=i.next.next;for(;r!==i.prev;){if(Mw(e.x,e.y,t.x,t.y,n.x,n.y,r.x,r.y)&&Gs(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function sde(i,e,t,n){const r=i.prev,s=i,o=i.next;if(Gs(r,s,o)>=0)return!1;const h=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,f=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,m=IU(r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,e,t,n),g=IU(h,f,e,t,n);let v=i.prevZ,y=i.nextZ;for(;v&&v.z>=m&&y&&y.z<=g;){if(v!==i.prev&&v!==i.next&&Mw(r.x,r.y,s.x,s.y,o.x,o.y,v.x,v.y)&&Gs(v.prev,v,v.next)>=0||(v=v.prevZ,y!==i.prev&&y!==i.next&&Mw(r.x,r.y,s.x,s.y,o.x,o.y,y.x,y.y)&&Gs(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;v&&v.z>=m;){if(v!==i.prev&&v!==i.next&&Mw(r.x,r.y,s.x,s.y,o.x,o.y,v.x,v.y)&&Gs(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;y&&y.z<=g;){if(y!==i.prev&&y!==i.next&&Mw(r.x,r.y,s.x,s.y,o.x,o.y,y.x,y.y)&&Gs(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function ode(i,e,t){let n=i;do{const r=n.prev,s=n.next.next;!kF(r,s)&&nZ(r,n,n.next,s)&&mA(r,s)&&mA(s,r)&&(e.push(r.i/t),e.push(n.i/t),e.push(s.i/t),gA(n),gA(n.next),n=i=s),n=n.next}while(n!==i);return K_(n)}function ade(i,e,t,n,r,s){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&gde(o,a)){let l=iZ(o,a);return o=K_(o,o.next),l=K_(l,l.next),pA(o,e,t,n,r,s),void pA(l,e,t,n,r,s)}a=a.next}o=o.next}while(o!==i)}function cde(i,e){return i.x-e.x}function ude(i,e){if(e=function hde(i,e){let t=e;const n=i.x,r=i.y;let o,s=-1/0;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const g=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(g<=n&&g>s){if(s=g,g===n){if(r===t.y)return t;if(r===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!o)return null;if(n===s)return o;const a=o,l=o.x,h=o.y;let m,f=1/0;t=o;do{n>=t.x&&t.x>=l&&n!==t.x&&Mw(r<h?n:s,r,l,h,r<h?s:n,r,t.x,t.y)&&(m=Math.abs(r-t.y)/(n-t.x),mA(t,i)&&(m<f||m===f&&(t.x>o.x||t.x===o.x&&dde(o,t)))&&(o=t,f=m)),t=t.next}while(t!==a);return o}(i,e),e){const t=iZ(e,i);K_(e,e.next),K_(t,t.next)}}function dde(i,e){return Gs(i.prev,i,e.prev)<0&&Gs(e.next,i,i.next)<0}function IU(i,e,t,n,r){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-t)*r)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function mde(i){let e=i,t=i;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==i);return t}function Mw(i,e,t,n,r,s,o,a){return(r-o)*(e-a)-(i-o)*(s-a)>=0&&(i-o)*(n-a)-(t-o)*(e-a)>=0&&(t-o)*(s-a)-(r-o)*(n-a)>=0}function gde(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function _de(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&nZ(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}(i,e)&&(mA(i,e)&&mA(e,i)&&function vde(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next}while(t!==i);return n}(i,e)&&(Gs(i.prev,i,e.prev)||Gs(i,e.prev,e))||kF(i,e)&&Gs(i.prev,i,i.next)>0&&Gs(e.prev,e,e.next)>0)}function Gs(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function kF(i,e){return i.x===e.x&&i.y===e.y}function nZ(i,e,t,n){const r=BF(Gs(i,e,t)),s=BF(Gs(i,e,n)),o=BF(Gs(t,n,i)),a=BF(Gs(t,n,e));return!!(r!==s&&o!==a||0===r&&NF(i,t,e)||0===s&&NF(i,n,e)||0===o&&NF(t,i,n)||0===a&&NF(t,e,n))}function NF(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function BF(i){return i>0?1:i<0?-1:0}function mA(i,e){return Gs(i.prev,i,i.next)<0?Gs(i,e,i.next)>=0&&Gs(i,i.prev,e)>=0:Gs(i,e,i.prev)<0||Gs(i,i.next,e)<0}function iZ(i,e){const t=new PU(i.i,i.x,i.y),n=new PU(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function rZ(i,e,t,n){const r=new PU(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function gA(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function PU(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class km{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*n}static isClockWise(e){return km.area(e)<0}static triangulateShape(e,t){const n=[],r=[],s=[];sZ(e),oZ(n,e);let o=e.length;t.forEach(sZ);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,oZ(n,t[l]);const a=function(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=tZ(i,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,h,f,m,g,v;if(n&&(s=function lde(i,e,t,n){const r=[];let s,o,a,l,h;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:i.length,h=tZ(i,a,l,n,!1),h===h.next&&(h.steiner=!0),r.push(mde(h));for(r.sort(cde),s=0;s<r.length;s++)ude(r[s],t),t=K_(t,t.next);return t}(i,e,s,t)),i.length>80*t){a=h=i[0],l=f=i[1];for(let y=t;y<r;y+=t)m=i[y],g=i[y+1],m<a&&(a=m),g<l&&(l=g),m>h&&(h=m),g>f&&(f=g);v=Math.max(h-a,f-l),v=0!==v?1/v:0}return pA(s,o,t,a,l,v),o}(n,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function sZ(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function oZ(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class _A extends Di{constructor(e=new ww([new Je(.5,.5),new Je(-.5,.5),new Je(-.5,-.5),new Je(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++)o(e[a]);function o(a){const l=[],h=void 0!==t.curveSegments?t.curveSegments:12,f=void 0!==t.steps?t.steps:1,m=void 0!==t.depth?t.depth:1;let g=void 0===t.bevelEnabled||t.bevelEnabled,v=void 0!==t.bevelThickness?t.bevelThickness:.2,y=void 0!==t.bevelSize?t.bevelSize:v-.1,b=void 0!==t.bevelOffset?t.bevelOffset:0,T=void 0!==t.bevelSegments?t.bevelSegments:3;const S=t.extrudePath,C=void 0!==t.UVGenerator?t.UVGenerator:bde;let R,L,N,U,k,I=!1;S&&(R=S.getSpacedPoints(f),I=!0,g=!1,L=S.computeFrenetFrames(f,!1),N=new Q,U=new Q,k=new Q),g||(T=0,v=0,y=0,b=0);const z=a.extractPoints(h);let K=z.shape;const te=z.holes;if(!km.isClockWise(K)){K=K.reverse();for(let ft=0,vt=te.length;ft<vt;ft++){const Bt=te[ft];km.isClockWise(Bt)&&(te[ft]=Bt.reverse())}}const ie=km.triangulateShape(K,te),ne=K;for(let ft=0,vt=te.length;ft<vt;ft++)K=K.concat(te[ft]);function le(ft,vt,Bt){return vt||console.error("THREE.ExtrudeGeometry: vec does not exist"),vt.clone().multiplyScalar(Bt).add(ft)}const Z=K.length,he=ie.length;function me(ft,vt,Bt){let Mn,dn,pi;const ni=ft.x-vt.x,Kn=ft.y-vt.y,ir=Bt.x-ft.x,Yi=Bt.y-ft.y,_e=ni*ni+Kn*Kn;if(Math.abs(ni*Yi-Kn*ir)>Number.EPSILON){const ht=Math.sqrt(_e),Zt=Math.sqrt(ir*ir+Yi*Yi),tn=vt.x-Kn/ht,gn=vt.y+ni/ht,Ft=((Bt.x-Yi/Zt-tn)*Yi-(Bt.y+ir/Zt-gn)*ir)/(ni*Yi-Kn*ir);Mn=tn+ni*Ft-ft.x,dn=gn+Kn*Ft-ft.y;const Qt=Mn*Mn+dn*dn;if(Qt<=2)return new Je(Mn,dn);pi=Math.sqrt(Qt/2)}else{let ht=!1;ni>Number.EPSILON?ir>Number.EPSILON&&(ht=!0):ni<-Number.EPSILON?ir<-Number.EPSILON&&(ht=!0):Math.sign(Kn)===Math.sign(Yi)&&(ht=!0),ht?(Mn=-Kn,dn=ni,pi=Math.sqrt(_e)):(Mn=ni,dn=Kn,pi=Math.sqrt(_e/2))}return new Je(Mn/pi,dn/pi)}const ce=[];for(let ft=0,vt=ne.length,Bt=vt-1,Mn=ft+1;ft<vt;ft++,Bt++,Mn++)Bt===vt&&(Bt=0),Mn===vt&&(Mn=0),ce[ft]=me(ne[ft],ne[Bt],ne[Mn]);const be=[];let Ge,Ee=ce.concat();for(let ft=0,vt=te.length;ft<vt;ft++){const Bt=te[ft];Ge=[];for(let Mn=0,dn=Bt.length,pi=dn-1,ni=Mn+1;Mn<dn;Mn++,pi++,ni++)pi===dn&&(pi=0),ni===dn&&(ni=0),Ge[Mn]=me(Bt[Mn],Bt[pi],Bt[ni]);be.push(Ge),Ee=Ee.concat(Ge)}for(let ft=0;ft<T;ft++){const vt=ft/T,Bt=v*Math.cos(vt*Math.PI/2),Mn=y*Math.sin(vt*Math.PI/2)+b;for(let dn=0,pi=ne.length;dn<pi;dn++){const ni=le(ne[dn],ce[dn],Mn);Ie(ni.x,ni.y,-Bt)}for(let dn=0,pi=te.length;dn<pi;dn++){const ni=te[dn];Ge=be[dn];for(let Kn=0,ir=ni.length;Kn<ir;Kn++){const Yi=le(ni[Kn],Ge[Kn],Mn);Ie(Yi.x,Yi.y,-Bt)}}}const mt=y+b;for(let ft=0;ft<Z;ft++){const vt=g?le(K[ft],Ee[ft],mt):K[ft];I?(U.copy(L.normals[0]).multiplyScalar(vt.x),N.copy(L.binormals[0]).multiplyScalar(vt.y),k.copy(R[0]).add(U).add(N),Ie(k.x,k.y,k.z)):Ie(vt.x,vt.y,0)}for(let ft=1;ft<=f;ft++)for(let vt=0;vt<Z;vt++){const Bt=g?le(K[vt],Ee[vt],mt):K[vt];I?(U.copy(L.normals[ft]).multiplyScalar(Bt.x),N.copy(L.binormals[ft]).multiplyScalar(Bt.y),k.copy(R[ft]).add(U).add(N),Ie(k.x,k.y,k.z)):Ie(Bt.x,Bt.y,m/f*ft)}for(let ft=T-1;ft>=0;ft--){const vt=ft/T,Bt=v*Math.cos(vt*Math.PI/2),Mn=y*Math.sin(vt*Math.PI/2)+b;for(let dn=0,pi=ne.length;dn<pi;dn++){const ni=le(ne[dn],ce[dn],Mn);Ie(ni.x,ni.y,m+Bt)}for(let dn=0,pi=te.length;dn<pi;dn++){const ni=te[dn];Ge=be[dn];for(let Kn=0,ir=ni.length;Kn<ir;Kn++){const Yi=le(ni[Kn],Ge[Kn],Mn);I?Ie(Yi.x,Yi.y+R[f-1].y,R[f-1].x+Bt):Ie(Yi.x,Yi.y,m+Bt)}}}function Ve(ft,vt){let Bt=ft.length;for(;--Bt>=0;){const Mn=Bt;let dn=Bt-1;dn<0&&(dn=ft.length-1);for(let pi=0,ni=f+2*T;pi<ni;pi++){const Kn=Z*pi,ir=Z*(pi+1);Wt(vt+Mn+Kn,vt+dn+Kn,vt+dn+ir,vt+Mn+ir)}}}function Ie(ft,vt,Bt){l.push(ft),l.push(vt),l.push(Bt)}function pt(ft,vt,Bt){It(ft),It(vt),It(Bt);const Mn=r.length/3,dn=C.generateTopUV(n,r,Mn-3,Mn-2,Mn-1);wn(dn[0]),wn(dn[1]),wn(dn[2])}function Wt(ft,vt,Bt,Mn){It(ft),It(vt),It(Mn),It(vt),It(Bt),It(Mn);const dn=r.length/3,pi=C.generateSideWallUV(n,r,dn-6,dn-3,dn-2,dn-1);wn(pi[0]),wn(pi[1]),wn(pi[3]),wn(pi[1]),wn(pi[2]),wn(pi[3])}function It(ft){r.push(l[3*ft+0]),r.push(l[3*ft+1]),r.push(l[3*ft+2])}function wn(ft){s.push(ft.x),s.push(ft.y)}(function it(){const ft=r.length/3;if(g){let vt=0,Bt=Z*vt;for(let Mn=0;Mn<he;Mn++){const dn=ie[Mn];pt(dn[2]+Bt,dn[1]+Bt,dn[0]+Bt)}vt=f+2*T,Bt=Z*vt;for(let Mn=0;Mn<he;Mn++){const dn=ie[Mn];pt(dn[0]+Bt,dn[1]+Bt,dn[2]+Bt)}}else{for(let vt=0;vt<he;vt++){const Bt=ie[vt];pt(Bt[2],Bt[1],Bt[0])}for(let vt=0;vt<he;vt++){const Bt=ie[vt];pt(Bt[0]+Z*f,Bt[1]+Z*f,Bt[2]+Z*f)}}n.addGroup(ft,r.length/3-ft,0)})(),function Gt(){const ft=r.length/3;let vt=0;Ve(ne,vt),vt+=ne.length;for(let Bt=0,Mn=te.length;Bt<Mn;Bt++){const dn=te[Bt];Ve(dn,vt),vt+=dn.length}n.addGroup(ft,r.length/3-ft,1)}()}this.setAttribute("position",new On(r,3)),this.setAttribute("uv",new On(s,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function xde(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++)t.shapes.push(i[n].uuid);else t.shapes.push(i.uuid);return t.options=Object.assign({},e),void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let s=0,o=e.shapes.length;s<o;s++)n.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new DU[r.type]).fromJSON(r)),new _A(n,e.options)}}const bde={generateTopUV:function(i,e,t,n,r){const a=e[3*n],l=e[3*n+1],h=e[3*r],f=e[3*r+1];return[new Je(e[3*t],e[3*t+1]),new Je(a,l),new Je(h,f)]},generateSideWallUV:function(i,e,t,n,r,s){const o=e[3*t],a=e[3*t+1],l=e[3*t+2],h=e[3*n],f=e[3*n+1],m=e[3*n+2],g=e[3*r],v=e[3*r+1],y=e[3*r+2],b=e[3*s],T=e[3*s+1],S=e[3*s+2];return Math.abs(a-f)<Math.abs(o-h)?[new Je(o,1-l),new Je(h,1-m),new Je(g,1-y),new Je(b,1-S)]:[new Je(a,1-l),new Je(f,1-m),new Je(v,1-y),new Je(T,1-S)]}};class bA extends fh{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new sn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new sn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class X_ extends bA{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Je(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return vo(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new sn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new sn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new sn(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}function mh(i,e,t){return FU(i)?new i.constructor(i.subarray(e,void 0!==t?t:i.length)):i.slice(e,t)}function eb(i,e,t){return!i||!t&&i.constructor===e?i:"number"==typeof e.BYTES_PER_ELEMENT?new e(i):Array.prototype.slice.call(i)}function FU(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function cZ(i){const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(function e(r,s){return i[r]-i[s]}),n}function LU(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,o=0;o!==n;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=i[a+l]}return r}function OU(i,e,t,n){let r=1,s=i[0];for(;void 0!==s&&void 0===s[n];)s=i[r++];if(void 0===s)return;let o=s[n];if(void 0!==o)if(Array.isArray(o))do{o=s[n],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=i[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[n],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=i[r++]}while(void 0!==s);else do{o=s[n],void 0!==o&&(e.push(s.time),t.push(o)),s=i[r++]}while(void 0!==s)}class xA{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=n+2;;){if(void 0===r){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=t[++n],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(n=2,s=a);for(let l=n-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=s,s=t[--n-1],e>=s)break t}o=n,n=0}}for(;n<o;){const a=n+o>>>1;e<t[a]?o=a:n=a+1}if(r=t[n],s=t[n-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Lde extends xA{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-n;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=n}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:o=e,l=2*n-t;break;case 2402:o=1,l=n+r[1]-r[0];break;default:o=e-1,l=t}const h=.5*(n-t),f=this.valueSize;this._weightPrev=h/(t-a),this._weightNext=h/(l-n),this._offsetPrev=s*f,this._offsetNext=o*f}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,h=l-a,f=this._offsetPrev,m=this._offsetNext,g=this._weightPrev,v=this._weightNext,y=(n-t)/(r-t),b=y*y,T=b*y,S=-g*T+2*g*b-g*y,C=(1+g)*T+(-1.5-2*g)*b+(-.5+g)*y+1,R=(-1-v)*T+(1.5+v)*b+.5*y,I=v*T-v*b;for(let L=0;L!==a;++L)s[L]=S*o[f+L]+C*o[h+L]+R*o[l+L]+I*o[m+L];return s}}class uZ extends xA{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,h=l-a,f=(n-t)/(r-t),m=1-f;for(let g=0;g!==a;++g)s[g]=o[h+g]*m+o[l+g]*f;return s}}class Ode extends xA{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Yf{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=eb(t,this.TimeBufferType),this.values=eb(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:eb(e.times,Array),values:eb(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Ode(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new uZ(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Lde(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case $E:t=this.InterpolantFactoryMethodDiscrete;break;case ZT:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return $E;case this.InterpolantFactoryMethodLinear:return ZT;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=mh(n,s,o),this.values=mh(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=n[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&FU(r))for(let a=0,l=r.length;a!==l;++a){const h=r[a];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,h),e=!1;break}}return e}optimize(){const e=mh(this.times),t=mh(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const h=e[a];if(h!==e[a+1]&&(1!==a||h!==e[0]))if(r)l=!0;else{const m=a*n,g=m-n,v=m+n;for(let y=0;y!==n;++y){const b=t[m+y];if(b!==t[g+y]||b!==t[v+y]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const m=a*n,g=o*n;for(let v=0;v!==n;++v)t[g+v]=t[m+v]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,l=o*n,h=0;h!==n;++h)t[l+h]=t[a+h];++o}return o!==e.length?(this.times=mh(e,0,o),this.values=mh(t,0,o*n)):(this.times=e,this.values=t),this}clone(){const e=mh(this.times,0),t=mh(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Yf.prototype.TimeBufferType=Float32Array,Yf.prototype.ValueBufferType=Float32Array,Yf.prototype.DefaultInterpolation=ZT;class Sw extends Yf{}Sw.prototype.ValueTypeName="bool",Sw.prototype.ValueBufferType=Array,Sw.prototype.DefaultInterpolation=$E,Sw.prototype.InterpolantFactoryMethodLinear=void 0,Sw.prototype.InterpolantFactoryMethodSmooth=void 0;class hZ extends Yf{}hZ.prototype.ValueTypeName="color";class TA extends Yf{}TA.prototype.ValueTypeName="number";class kde extends xA{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-t)/(r-t);let h=e*a;for(let f=h+a;h!==f;h+=4)sa.slerpFlat(s,0,o,h-a,o,h,l);return s}}class tb extends Yf{InterpolantFactoryMethodLinear(e){return new kde(this.times,this.values,this.getValueSize(),e)}}tb.prototype.ValueTypeName="quaternion",tb.prototype.DefaultInterpolation=ZT,tb.prototype.InterpolantFactoryMethodSmooth=void 0;class Cw extends Yf{}Cw.prototype.ValueTypeName="string",Cw.prototype.ValueBufferType=Array,Cw.prototype.DefaultInterpolation=$E,Cw.prototype.InterpolantFactoryMethodLinear=void 0,Cw.prototype.InterpolantFactoryMethodSmooth=void 0;class wA extends Yf{}wA.prototype.ValueTypeName="vector";class MA{constructor(e,t=-1,n,r=2500){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=fu(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(Bde(n[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)t.push(Yf.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],h=[];l.push((a+s-1)%s,a,(a+1)%s),h.push(0,1,0);const f=cZ(l);l=LU(l,1,f),h=LU(h,1,f),!r&&0===l[0]&&(l.push(s),h.push(h[0])),o.push(new TA(".morphTargetInfluences["+t[a].name+"]",l,h).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const h=e[a],f=h.name.match(s);if(f&&f.length>1){const m=f[1];let g=r[m];g||(r[m]=g=[]),g.push(h)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(m,g,v,y,b){if(0!==v.length){const T=[],S=[];OU(v,T,S,y),0!==T.length&&b.push(new m(g,T,S))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const h=e.hierarchy||[];for(let m=0;m<h.length;m++){const g=h[m].keys;if(g&&0!==g.length)if(g[0].morphTargets){const v={};let y;for(y=0;y<g.length;y++)if(g[y].morphTargets)for(let b=0;b<g[y].morphTargets.length;b++)v[g[y].morphTargets[b]]=-1;for(const b in v){const T=[],S=[];for(let C=0;C!==g[y].morphTargets.length;++C){const R=g[y];T.push(R.time),S.push(R.morphTarget===b?1:0)}r.push(new TA(".morphTargetInfluence["+b+"]",T,S))}l=v.length*o}else{const v=".bones["+t[m].name+"]";n(wA,v+".position",g,"pos",r),n(tb,v+".quaternion",g,"rot",r),n(wA,v+".scale",g,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let n=0,r=this.tracks.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Bde(i){if(void 0===i.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function Nde(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return TA;case"vector":case"vector2":case"vector3":case"vector4":return wA;case"color":return hZ;case"quaternion":return tb;case"bool":case"boolean":return Sw;case"string":return Cw}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}(i.type);if(void 0===i.times){const t=[],n=[];OU(i.keys,t,n,"value"),i.times=t,i.values=n}return void 0!==e.parse?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const Ew={enabled:!1,files:{},add:function(i,e){!1!==this.enabled&&(this.files[i]=e)},get:function(i){if(!1!==this.enabled)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class dZ{constructor(e,t,n){const r=this;let l,s=!1,o=0,a=0;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(f){a++,!1===s&&void 0!==r.onStart&&r.onStart(f,o,a),s=!0},this.itemEnd=function(f){o++,void 0!==r.onProgress&&r.onProgress(f,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(f){void 0!==r.onError&&r.onError(f)},this.resolveURL=function(f){return l?l(f):f},this.setURLModifier=function(f){return l=f,this},this.addHandler=function(f,m){return h.push(f,m),this},this.removeHandler=function(f){const m=h.indexOf(f);return-1!==m&&h.splice(m,2),this},this.getHandler=function(f){for(let m=0,g=h.length;m<g;m+=2){const v=h[m],y=h[m+1];if(v.global&&(v.lastIndex=0),v.test(f))return y}return null}}}const jde=new dZ;class Aw{constructor(e){this.manager=void 0!==e?e:jde,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Nm={};class Ude extends Error{constructor(e,t){super(e),this.response=t}}class xd extends Aw{constructor(e){super(e)}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Ew.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==Nm[e])return void Nm[e].push({onLoad:t,onProgress:n,onError:r});Nm[e]=[],Nm[e].push({onLoad:t,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(h=>{if(200===h.status||0===h.status){if(0===h.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===h.body||void 0===h.body.getReader)return h;const f=Nm[e],m=h.body.getReader(),g=h.headers.get("Content-Length"),v=g?parseInt(g):0,y=0!==v;let b=0;const T=new ReadableStream({start(S){!function C(){m.read().then(({done:R,value:I})=>{if(R)S.close();else{b+=I.byteLength;const L=new ProgressEvent("progress",{lengthComputable:y,loaded:b,total:v});for(let N=0,U=f.length;N<U;N++){const k=f[N];k.onProgress&&k.onProgress(L)}S.enqueue(I),C()}})}()}});return new Response(T)}throw new Ude(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(l){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(f=>(new DOMParser).parseFromString(f,a));case"json":return h.json();default:if(void 0===a)return h.text();{const m=/charset="?([^;"\s]*)"?/i.exec(a),g=m&&m[1]?m[1].toLowerCase():void 0,v=new TextDecoder(g);return h.arrayBuffer().then(y=>v.decode(y))}}}).then(h=>{Ew.add(e,h);const f=Nm[e];delete Nm[e];for(let m=0,g=f.length;m<g;m++){const v=f[m];v.onLoad&&v.onLoad(h)}}).catch(h=>{const f=Nm[e];if(void 0===f)throw this.manager.itemError(e),h;delete Nm[e];for(let m=0,g=f.length;m<g;m++){const v=f[m];v.onError&&v.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class qF extends Aw{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Ew.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=eA("img");function l(){f(),Ew.add(e,this),t&&t(this),s.manager.itemEnd(e)}function h(m){f(),r&&r(m),s.manager.itemError(e),s.manager.itemEnd(e)}function f(){a.removeEventListener("load",l,!1),a.removeEventListener("error",h,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",h,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class Vde extends Aw{constructor(e){super(e)}load(e,t,n,r){const s=new vd,o=new qF(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},n,r),s}}class Dw extends oa{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new sn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class fZ extends Dw{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(oa.DefaultUp),this.updateMatrix(),this.groundColor=new sn(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const pZ=new Jn,mZ=new Q,gZ=new Q;class kU{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Je(512,512),this.map=null,this.mapPass=null,this.matrix=new Jn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new sU,this._frameExtents=new Je(1,1),this._viewportCount=1,this._viewports=[new hr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;mZ.setFromMatrixPosition(e.matrixWorld),t.position.copy(mZ),gZ.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(gZ),t.updateMatrixWorld(),pZ.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(pZ),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Gde extends kU{constructor(){super(new Ma(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*QE*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class _Z extends Dw{constructor(e,t,n=0,r=Math.PI/3,s=0,o=1){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(oa.DefaultUp),this.updateMatrix(),this.target=new oa,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.shadow=new Gde}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const vZ=new Jn,SA=new Q,NU=new Q;class zde extends kU{constructor(){super(new Ma(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Je(4,2),this._viewportCount=6,this._viewports=[new hr(2,1,1,1),new hr(0,1,1,1),new hr(3,1,1,1),new hr(1,1,1,1),new hr(3,0,1,1),new hr(1,0,1,1)],this._cubeDirections=[new Q(1,0,0),new Q(-1,0,0),new Q(0,0,1),new Q(0,0,-1),new Q(0,1,0),new Q(0,-1,0)],this._cubeUps=[new Q(0,1,0),new Q(0,1,0),new Q(0,1,0),new Q(0,1,0),new Q(0,0,1),new Q(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),SA.setFromMatrixPosition(e.matrixWorld),n.position.copy(SA),NU.copy(n.position),NU.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(NU),n.updateMatrixWorld(),r.makeTranslation(-SA.x,-SA.y,-SA.z),vZ.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(vZ)}}class yZ extends Dw{constructor(e,t,n=0,r=1){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new zde}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Hde extends kU{constructor(){super(new pw(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class bZ extends Dw{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(oa.DefaultUp),this.updateMatrix(),this.target=new oa,this.shadow=new Hde}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class xZ extends Dw{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Bm{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class $de extends Aw{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Ew.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Ew.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}class EZ{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=AZ(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=AZ();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function AZ(){return(typeof performance>"u"?Date:performance).now()}const jU="\\[\\]\\.:\\/",tfe=new RegExp("["+jU+"]","g"),UU="[^"+jU+"]",nfe="[^"+jU.replace("\\.","")+"]",afe=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",UU)+/(WCOD+)?/.source.replace("WCOD",nfe)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",UU)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",UU)+"$"),lfe=["material","materials","bones"];class cfe{constructor(e,t,n){const r=n||Jr.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}let Jr=(()=>{class i{constructor(t,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new i.Composite(t,n,r):new i(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(tfe,"")}static parseTrackName(t){const n=afe.exec(t);if(null===n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==lfe.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(void 0===n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(n);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===n||l.uuid===n)return l;const h=r(l.children);if(h)return h}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[n++]=r[s]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,r=n.objectName,s=n.propertyName;let o=n.propertyIndex;if(t||(t=i.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let f=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let m=0;m<t.length;m++)if(t[m].name===f){f=m;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==f){if(void 0===t[f])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[f]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}h=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(h=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(h=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=cfe,i})();Jr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Jr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Jr.prototype.GetterByBindingType=[Jr.prototype._getValue_direct,Jr.prototype._getValue_array,Jr.prototype._getValue_arrayElement,Jr.prototype._getValue_toArray],Jr.prototype.SetterByBindingTypeAndVersioning=[[Jr.prototype._setValue_direct,Jr.prototype._setValue_direct_setNeedsUpdate,Jr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Jr.prototype._setValue_array,Jr.prototype._setValue_array_setNeedsUpdate,Jr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Jr.prototype._setValue_arrayElement,Jr.prototype._setValue_arrayElement_setNeedsUpdate,Jr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Jr.prototype._setValue_fromArray,Jr.prototype._setValue_fromArray_setNeedsUpdate,Jr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class YF{constructor(e,t,n=0,r=1/0){this.ray=new JP(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new qj,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return VU(e,this,n,t),n.sort(PZ),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)VU(e[r],this,n,t);return n.sort(PZ),n}}function PZ(i,e){return i.distance-e.distance}function VU(i,e,t,n){if(i.layers.test(e.layers)&&i.raycast(e,t),!0===n){const r=i.children;for(let s=0,o=r.length;s<o;s++)VU(r[s],e,t,!0)}}class GU{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(vo(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const LZ=new Q,KF=new Q;class mfe{constructor(){this.type="ShapePath",this.color=new sn,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new AF,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,o){return this.currentPath.bezierCurveTo(e,t,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function n(C){const R=[];for(let I=0,L=C.length;I<L;I++){const N=C[I],U=new ww;U.curves=N.curves,R.push(U)}return R}function r(C,R){const I=R.length;let L=!1;for(let N=I-1,U=0;U<I;N=U++){let k=R[N],z=R[U],K=z.x-k.x,te=z.y-k.y;if(Math.abs(te)>Number.EPSILON){if(te<0&&(k=R[U],K=-K,z=R[N],te=-te),C.y<k.y||C.y>z.y)continue;if(C.y===k.y){if(C.x===k.x)return!0}else{const fe=te*(C.x-k.x)-K*(C.y-k.y);if(0===fe)return!0;if(fe<0)continue;L=!L}}else{if(C.y!==k.y)continue;if(z.x<=C.x&&C.x<=k.x||k.x<=C.x&&C.x<=z.x)return!0}}return L}const s=km.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return n(o);let a,l,h;const f=[];if(1===o.length)return l=o[0],h=new ww,h.curves=l.curves,f.push(h),f;let m=!s(o[0].getPoints());m=e?!m:m;const g=[],v=[];let T,S,y=[],b=0;v[b]=void 0,y[b]=[];for(let C=0,R=o.length;C<R;C++)l=o[C],T=l.getPoints(),a=s(T),a=e?!a:a,a?(!m&&v[b]&&b++,v[b]={s:new ww,p:T},v[b].s.curves=l.curves,m&&b++,y[b]=[]):y[b].push({h:l,p:T[0]});if(!v[0])return n(o);if(v.length>1){let C=!1,R=0;for(let I=0,L=v.length;I<L;I++)g[I]=[];for(let I=0,L=v.length;I<L;I++){const N=y[I];for(let U=0;U<N.length;U++){const k=N[U];let z=!0;for(let K=0;K<v.length;K++)r(k.p,v[K].p)&&(I!==K&&R++,z?(z=!1,g[K].push(k)):C=!0);z&&g[I].push(k)}}R>0&&!1===C&&(y=g)}for(let C=0,R=v.length;C<R;C++){h=v[C].s,f.push(h),S=y[C];for(let I=0,L=S.length;I<L;I++)h.holes.push(S[I].h)}return f}}const jm=gfe();function gfe(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const h=l-127;h<-27?(n[l]=0,n[256|l]=32768,r[l]=24,r[256|l]=24):h<-14?(n[l]=1024>>-h-14,n[256|l]=1024>>-h-14|32768,r[l]=-h-1,r[256|l]=-h-1):h<=15?(n[l]=h+15<<10,n[256|l]=h+15<<10|32768,r[l]=13,r[256|l]=13):h<128?(n[l]=31744,n[256|l]=64512,r[l]=24,r[256|l]=24):(n[l]=31744,n[256|l]=64512,r[l]=13,r[256|l]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let h=l<<13,f=0;for(;0==(8388608&h);)h<<=1,f-=8388608;h&=-8388609,f+=947912704,s[l]=h|f}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}var tL=Object.freeze({__proto__:null,toHalfFloat:function _fe(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=vo(i,-65504,65504),jm.floatView[0]=i;const e=jm.uint32View[0],t=e>>23&511;return jm.baseTable[t]+((8388607&e)>>jm.shiftTable[t])},fromHalfFloat:function vfe(i){const e=i>>10;return jm.uint32View[0]=jm.mantissaTable[jm.offsetTable[e]+(1023&i)]+jm.exponentTable[e],jm.floatView[0]}});function yfe(i,e){if(1&i&&(c.TgZ(0,"div",7)(1,"div"),c._uU(2),c.qZA(),c.TgZ(3,"div"),c._uU(4,"Time to finish the game:"),c.qZA(),c.TgZ(5,"div",8),c._uU(6),c.qZA()()),2&i){const t=c.oxw(2);c.xp6(2),c.hij("Player money: ",t.getPlayerWhoWin().money," \u20ac"),c.xp6(4),c.Oqu(t.gameService.gameAmountTime)}}function bfe(i,e){if(1&i&&c._UZ(0,"app-player-properties",9),2&i){const t=c.oxw(2);c.Q6J("playerId",""!=t.gameService.playerWhoWonId?t.gameService.playerWhoWonId:t.gameService.players[t.gameService.turn].id)}}function xfe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",10),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(2);return c.KtG(r.executeAndClose())}),c._uU(1,"Yes"),c.qZA()}}function Tfe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",11),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(2);return c.KtG(r.closeDialog())}),c._uU(1,"No"),c.qZA()}}function wfe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",11),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(2);return c.KtG(r.executeAndClose())}),c._uU(1,"OK"),c.qZA()}}function Mfe(i,e){if(1&i&&(c.TgZ(0,"div")(1,"h1"),c._uU(2),c.qZA(),c.YNc(3,yfe,7,2,"div",2),c.YNc(4,bfe,1,1,"app-player-properties",3),c.TgZ(5,"div",4),c.YNc(6,xfe,2,0,"button",5),c.YNc(7,Tfe,2,0,"button",6),c.YNc(8,wfe,2,0,"button",6),c.qZA()()),2&i){const t=c.oxw();let n;c.xp6(2),c.Oqu(null!==(n=t.data.textData.text)&&void 0!==n?n:t.data.textData.title),c.xp6(1),c.Q6J("ngIf",""!=t.gameService.playerWhoWonId),c.xp6(1),c.Q6J("ngIf",""!=t.gameService.playerWhoWonId||t.data.textData.showPlayerProps),c.xp6(2),c.Q6J("ngIf",t.data.textData.goBankRupt),c.xp6(1),c.Q6J("ngIf",t.data.textData.goBankRupt),c.xp6(1),c.Q6J("ngIf",!t.data.textData.goBankRupt)}}function Sfe(i,e){1&i&&c._UZ(0,"div")}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"143"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="143");let GZ=(()=>{class i{constructor(t,n,r){this.data=t,this.dialogRef=n,this.gameService=r,this.getCardPosition$=new Bn.x,this.movedNearest=!1}ngOnInit(){}ngAfterViewInit(){}executeAndClose(){switch(this.data.eventType){case"payMoney":this.data.textData.bankTaxes?this.gameService.players[this.gameService.turn].money>=this.data.textData.property.taxesCost?this.gameService.payTaxes(this.data.textData.property):this.gameService.checkBankrupt(this.gameService.players[this.gameService.turn],this.data.textData.property.taxesCost)||this.gameService.calculateAmountDebt(this.data.textData.property.taxesCost):this.data.textData.playerRent&&!this.data.textData.amountDebt?this.gameService.players[this.gameService.turn].money>=this.gameService.amountRent?this.gameService.payRentToPlayer(this.gameService.gameTable.cards[this.gameService.players[this.gameService.turn].actualCard]):this.gameService.checkBankrupt(this.gameService.players[this.gameService.turn],this.gameService.amountRent)||this.gameService.calculateAmountDebt():this.data.textData.amountDebt&&this.gameService.players[this.gameService.turn].money>=this.data.textData.amountDebt&&"player"==this.data.textData.debtWithWho?(this.gameService.payRentToPlayer(this.gameService.gameTable.cards[this.gameService.players[this.gameService.turn].actualCard],!0),this.gameService.debtWithWho="",this.gameService.amountDebt=0,this.gameService.nextTurn()):this.data.textData.amountDebt&&(this.data.textData.playerId?this.gameService.players.find(t=>t.id==this.data.textData.playerId):this.gameService.players[this.gameService.turn]).money>=this.data.textData.amountDebt&&"bank"==this.data.textData.debtWithWho&&!this.gameService.checkBankrupt(this.data.textData.playerId?this.gameService.players.find(t=>t.id==this.data.textData.playerId):this.gameService.players[this.gameService.turn],this.data.textData.amountDebt)&&(this.data.textData.playerId?this.gameService.addingRemovingMoney("remove",this.data.textData.amountDebt,1e3,this.gameService.players.find(t=>t.id==this.data.textData.playerId)):this.gameService.addingRemovingMoney("remove",this.data.textData.amountDebt,1e3),this.gameService.debtWithWho="",this.gameService.amountDebt=0,this.gameService.nextTurn()),this.gameService.setDebt&&(this.gameService.setDebt=!1);break;case"chance":case"communityChest":this.calculateChestChance(this.data.textData);break;case"goingToPrison":this.gameService.goToPrison();break;case"exitFromPrison":!this.data.textData.shouldPay&&!this.data.textData.exitFromDice&&this.gameService.players[this.gameService.turn].prison.getOutCards--,this.data.textData.shouldPay&&this.gameService.addingRemovingMoney("remove",50,1e3),this.data.textData.dice1&&(this.gameService.players[this.gameService.turn].canDice=!1,this.gameService.getCardPosition(this.gameService.players[this.gameService.turn].actualCard+(this.data.textData.dice1+this.data.textData.dice2)));break;case"backrupt":this.gameService.players.find(t=>t.id==this.data.textData.player.id).bankrupt=!0,this.gameService.players.find(t=>t.id==this.data.textData.player.id).money=0,this.gameService.gameTable.cards.filter(t=>t.id==this.data.textData.player.id).forEach(t=>{t.owner=this.data.textData.playerToPay,this.gameService.checkCompletedSeries(t,this.data.textData.playerToPay)}),this.gameService.checkIfSomeoneWon();break;case"goBankRupt":this.gameService.goBankRupt()}this.closeDialog()}calculateChestChance(t){switch(t.action){case"move":null!=t.cardIndex&&null!=t.cardIndex?this.gameService.getCardPosition(t.cardIndex):null!=t.count&&null!=t.count&&this.gameService.getCardPosition(this.gameService.players[this.gameService.turn].actualCard+t.count);break;case"movenearest":this.gameService.gameTable.cards.forEach((o,a)=>{(o.cardType==t.groupid&&a>this.gameService.players[this.gameService.turn].actualCard&&!this.movedNearest||o.cardType==t.groupid&&this.gameService.players[this.gameService.turn].actualCard>=30&&!this.movedNearest)&&(this.gameService.getCardPosition(a),this.movedNearest=!0)});break;case"addfunds":this.gameService.addingRemovingMoney("add",t.amount,1e3);break;case"jail":"getout"==t.subaction?this.gameService.players[this.gameService.turn].prison.getOutCards++:"goto"==t.subaction&&(this.closeDialog(),this.gameService.textDialog({text:this.gameService.players[this.gameService.turn].name+" is going to prison."},"goingToPrison"));break;case"propertycharges":let n=0,r=0,s=0;this.gameService.gameTable.cards.filter(o=>o.owner==this.gameService.players[this.gameService.turn].id).forEach(o=>{o.hotelCounter?s++:o.housesCounter&&(r+=o.housesCounter)}),r&&(n+=t.houses*r),s&&(n+=t.hotels*s),this.gameService.players[this.gameService.turn].money>=n?this.gameService.addingRemovingMoney("remove",n,1e3):this.gameService.checkBankrupt(this.gameService.players[this.gameService.turn],n)||this.gameService.calculateAmountDebt(n);break;case"removefunds":this.gameService.players[this.gameService.turn].money>=t.amount?this.gameService.addingRemovingMoney("remove",t.amount,1e3):this.gameService.checkBankrupt(this.gameService.players[this.gameService.turn],t.amount)||this.gameService.calculateAmountDebt(t.amount);break;case"removefundstoplayers":this.gameService.players.filter(o=>o.id!=this.gameService.players[this.gameService.turn].id).forEach(o=>{this.gameService.players[this.gameService.turn].money>=t.amount?this.gameService.addingRemovingMoney("remove",t.amount,1e3):this.gameService.checkBankrupt(this.gameService.players[this.gameService.turn],t.amount)||this.gameService.calculateAmountDebt(t.amount),this.gameService.addingRemovingMoney("add",t.amount,1e3,o)});break;case"addfundsfromplayers":this.gameService.players.filter(o=>o.id!=this.gameService.players[this.gameService.turn].id).forEach(o=>{o.money>=t.amount?(this.gameService.addingRemovingMoney("remove",t.amount,1e3,o),this.gameService.addingRemovingMoney("add",t.amount,1e3)):this.gameService.checkBankrupt(o,t.amount)||this.gameService.calculateAmountDebt(t.amount)})}}closeDialog(){this.movedNearest=!1,this.gameService.closeDialog(this.dialogRef)}getPlayerWhoWin(){return this.gameService.players.find(t=>t.id==this.gameService.playerWhoWonId)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(lP),c.Y36(aP),c.Y36(wd))},i.\u0275cmp=c.Xpm({type:i,selectors:[["app-message-dialog"]],decls:3,vars:2,consts:[["id","messageContainer"],[4,"ngIf"],["class","winScreen",4,"ngIf"],[3,"playerId",4,"ngIf"],["fxLayoutAlign","end center",1,"finishWarning"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["mat-raised-button","",3,"click",4,"ngIf"],[1,"winScreen"],[1,"time"],[3,"playerId"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","",3,"click"]],template:function(t,n){1&t&&(c.TgZ(0,"div",0),c.YNc(1,Mfe,9,6,"div",1),c.YNc(2,Sfe,1,0,"div",1),c.qZA()),2&t&&(c.xp6(1),c.Q6J("ngIf","showDiceResult"!=n.data.eventType),c.xp6(1),c.Q6J("ngIf","showDiceResult"===n.data.eventType))},styles:["#messageContainer[_ngcontent-%COMP%]   .winScreen[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-weight:700}"]}),i})();function WU(){return(0,Zr.e)((i,e)=>{let t,n=!1;i.subscribe((0,Tr.x)(e,r=>{const s=t;t=r,n&&e.next([s,r]),n=!0}))})}var Td=se(2011),Cfe=(se(5881),se(3942));function qU(i,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new jt("invalid-argument",`Invalid options passed to function ${i}(): You cannot specify both "merge" and "mergeFields".`);return e}function zZ(){if(typeof Uint8Array>"u")throw new jt("unimplemented","Uint8Arrays are not available in this environment.")}function HZ(){if(!function N2(){return typeof atob<"u"}())throw new jt("unimplemented","Blobs are unavailable in Firestore in this environment.")}class CA{constructor(e){this._delegate=e}static fromBase64String(e){return HZ(),new CA(Bf.fromBase64String(e))}static fromUint8Array(e){return zZ(),new CA(Bf.fromUint8Array(e))}toBase64(){return HZ(),this._delegate.toBase64()}toUint8Array(){return zZ(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function ZU(i){return function Dfe(i,e){if("object"!=typeof i||null===i)return!1;const t=i;for(const n of e)if(n in t&&"function"==typeof t[n])return!0;return!1}(i,["next","error","complete"])}class Rfe{enableIndexedDbPersistence(e,t){return function RQ(i,e){c4(i=$i(i,Ds));const t=Oo(i),n=i._freezeSettings(),r=new CB;return l4(t,r,new HH(r,n.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function IQ(i){c4(i=$i(i,Ds));const e=Oo(i),t=i._freezeSettings(),n=new CB;return l4(e,n,new hQ(n,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function PQ(i){if(i._initialized&&!i._terminated)throw new jt(at.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Qo;return i._queue.enqueueAndForgetEvenWhileRestricted((0,nt.Z)(function*(){try{yield(t=(0,nt.Z)(function*(n){if(!nu.V())return Promise.resolve();const r=n+"main";yield nu.delete(r)}),function(n){return t.apply(this,arguments)})(d(i._databaseId,i._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class WZ{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ju||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Mf("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,n={}){!function MQ(i,e,t,n={}){var r;const s=(i=$i(i,uE))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==e&&Mf("Host has been set in both settings() and useEmulator(), emulator host will be used"),i._setSettings(Object.assign(Object.assign({},s),{host:`${e}:${t}`,ssl:!1})),n.mockUserToken){let o,a;if("string"==typeof n.mockUserToken)o=n.mockUserToken,a=ws.MOCK_USER;else{o=(0,Fi.Sg)(n.mockUserToken,null===(r=i._app)||void 0===r?void 0:r.options.projectId);const l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new jt(at.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new ws(l)}i._authCredentials=new A2(new _C(o,a))}}(this._delegate,e,t,n)}enableNetwork(){return function LQ(i){return function gQ(i){return i.asyncQueue.enqueue((0,nt.Z)(function*(){const e=yield YH(i),t=yield KH(i);return e.setNetworkEnabled(!0),function(n){const r=yn(n);return r.lu.delete(0),lE(r)}(t)}))}(Oo(i=$i(i,Ds)))}(this._delegate)}disableNetwork(){return function OQ(i){return function _Q(i){return i.asyncQueue.enqueue((0,nt.Z)(function*(){const e=yield YH(i),t=yield KH(i);return e.setNetworkEnabled(!1),(n=(0,nt.Z)(function*(r){const s=yn(r);s.lu.add(0),yield dT(s),s._u.set("Offline")}),function(r){return n.apply(this,arguments)})(t);var n}))}(Oo(i=$i(i,Ds)))}(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,JH("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function FQ(i){return function(e){const t=new Qo;return e.asyncQueue.enqueueAndForget((0,nt.Z)(function*(){return function J$(i,e){return uB.apply(this,arguments)}(yield PB(e),t)})),t.promise}(Oo(i=$i(i,Ds)))}(this._delegate)}onSnapshotsInSync(e){return function hJ(i,e){return function bQ(i,e){const t=new RI(e);return i.asyncQueue.enqueueAndForget((0,nt.Z)(function*(){return n=yield yT(i),r=t,yn(n).Tu.add(r),void r.next();var n,r})),()=>{t.Tc(),i.asyncQueue.enqueueAndForget((0,nt.Z)(function*(){return n=yield yT(i),r=t,void yn(n).Tu.delete(r);var n,r}))}}(Oo(i=$i(i,Ds)),kB(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new jt("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Rw(this,OB(this._delegate,e))}catch(t){throw Ul(t,"collection()","Firestore.collection()")}}doc(e){try{return new gh(this,hE(this._delegate,e))}catch(t){throw Ul(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Vl(this,function SQ(i,e){if(i=$i(i,uE),LB("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new jt(at.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ll(i,null,(t=e,new hc(Xi.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Ul(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function fJ(i,e,t){i=$i(i,Ds);const n=Object.assign(Object.assign({},iJ),t);return function(r){if(r.maxAttempts<1)throw new jt(at.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function xQ(i,e,t){const n=new Qo;return i.asyncQueue.enqueueAndForget((0,nt.Z)(function*(){const r=yield(s=i,II(s).then(o=>o.datastore));var s;new pQ(i.asyncQueue,r,t,e,n).run()})),n.promise}(Oo(i),r=>e(new dJ(i,r)),n)}(this._delegate,t=>e(new qZ(this,t)))}batch(){return Oo(this._delegate),new ZZ(new C4(this._delegate,e=>bT(this._delegate,e)))}loadBundle(e){return function kQ(i,e){const t=Oo(i=$i(i,Ds)),n=new EQ;return function TQ(i,e,t,n){const r=function(s,o){let a;return a="string"==typeof s?(new TextEncoder).encode(s):s,l=function(l,h){if(l instanceof Uint8Array)return WH(l,h);if(l instanceof ArrayBuffer)return WH(new Uint8Array(l),h);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),new dQ(l,o);var l}(t,aE(e));i.asyncQueue.enqueueAndForget((0,nt.Z)(function*(){!function uQ(i,e,t){const n=yn(i);var r;(r=(0,nt.Z)(function*(s,o,a){try{const l=yield o.getMetadata();if(yield function(g,v){const y=yn(g),b=ta(v.createTime);return y.persistence.runTransaction("hasNewerBundle","readonly",T=>y.Ds.getBundleMetadata(T,v.id)).then(T=>!!T&&T.createTime.compareTo(b)>=0)}(s.localStore,l))return yield o.close(),a._completeWith({taskState:"Success",documentsLoaded:(g=l).totalDocuments,bytesLoaded:g.totalBytes,totalDocuments:g.totalDocuments,totalBytes:g.totalBytes}),Promise.resolve(new Set);a._updateProgress(LH(l));const h=new z$(l,s.localStore,o.wt);let f=yield o.fc();for(;f;){const g=yield h.Nu(f);g&&a._updateProgress(g),f=yield o.fc()}const m=yield h.complete();return yield hm(s,m.Ou,void 0),yield function(g,v){const y=yn(g);return y.persistence.runTransaction("Save bundle","readwrite",b=>y.Ds.saveBundleMetadata(b,v))}(s.localStore,l),a._completeWith(m.progress),Promise.resolve(m.Mu)}catch(l){return Mf("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}var g}),function(s,o,a){return r.apply(this,arguments)})(n,e,t).then(r=>{n.sharedClientState.notifyBundleLoaded(r)})}(yield PB(i),r,n)}))}(t,i._databaseId,e,n),n}(this._delegate,e)}namedQuery(e){return function NQ(i,e){return function wQ(i,e){return i.asyncQueue.enqueue((0,nt.Z)(function*(){return function(t,n){const r=yn(t);return r.persistence.runTransaction("Get named query","readonly",s=>r.Ds.getNamedQuery(s,n))}(yield PI(i),e)}))}(Oo(i=$i(i,Ds)),e).then(t=>t?new ll(i,null,t.query):null)}(this._delegate,e).then(t=>t?new Vl(this,t):null)}}class nL extends GB{constructor(e){super(),this.firestore=e}convertBytes(e){return new CA(new Bf(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return gh.forKey(t,this.firestore,null)}}class qZ{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new nL(e)}get(e){const t=lb(e);return this._delegate.get(t).then(n=>new EA(this._firestore,new fm(this._firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,t.converter)))}set(e,t,n){const r=lb(e);return n?(qU("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const s=lb(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,n,...r),this}delete(e){const t=lb(e);return this._delegate.delete(t),this}}class ZZ{constructor(e){this._delegate=e}set(e,t,n){const r=lb(e);return n?(qU("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const s=lb(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,n,...r),this}delete(e){const t=lb(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class ab{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new pE(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new AA(this._firestore,n),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=ab.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let s=r.get(t);return s||(s=new ab(e,new nL(e),t),r.set(t,s)),s}}ab.INSTANCES=new WeakMap;class gh{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new nL(e)}static forPath(e,t,n){if(e.length%2!=0)throw new jt("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new gh(t,new hs(t._delegate,n,new fn(e)))}static forKey(e,t,n){return new gh(t,new hs(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new Rw(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Rw(this.firestore,OB(this._delegate,e))}catch(t){throw Ul(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,Fi.m9)(e))instanceof hs&&s4(this._delegate,e)}set(e,t){t=qU("DocumentReference.set",t);try{return t?zB(this._delegate,e,t):zB(this._delegate,e)}catch(n){throw Ul(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return 1===arguments.length?D4(this._delegate,e):D4(this._delegate,e,t,...n)}catch(r){throw Ul(r,"updateDoc()","DocumentReference.update()")}}delete(){return function cJ(i){return bT($i(i.firestore,Ds),[new Rf(i._key,As.none())])}(this._delegate)}onSnapshot(...e){const t=YZ(e),n=KZ(e,r=>new EA(this.firestore,new fm(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return R4(this._delegate,t,n)}get(e){let t;return t="cache"===e?.source?function sJ(i){i=$i(i,hs);const e=$i(i.firestore,Ds),t=Oo(e),n=new _0(e);return function vQ(i,e){const t=new Qo;return i.asyncQueue.enqueueAndForget((0,nt.Z)(function*(){return(n=(0,nt.Z)(function*(r,s,o){try{const a=yield function(l,h){const f=yn(l);return f.persistence.runTransaction("read document","readonly",m=>f.localDocuments.getDocument(m,h))}(r,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new jt(at.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=mT(a,`Failed to get document '${s} from cache`);o.reject(l)}}),function(r,s,o){return n.apply(this,arguments)})(yield PI(i),e,t);var n})),t.promise}(t,i._key).then(r=>new fm(e,n,i._key,r,new g0(null!==r&&r.hasLocalMutations,!0),i.converter))}(this._delegate):"server"===e?.source?function oJ(i){i=$i(i,hs);const e=$i(i.firestore,Ds);return XH(Oo(e),i._key,{source:"server"}).then(t=>HB(e,i,t))}(this._delegate):E4(this._delegate),t.then(n=>new EA(this.firestore,new fm(this.firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,this._delegate.converter)))}withConverter(e){return new gh(this.firestore,this._delegate.withConverter(e?ab.getInstance(this.firestore,e):null))}}function Ul(i,e,t){return i.message=i.message.replace(e,t),i}function YZ(i){for(const e of i)if("object"==typeof e&&!ZU(e))return e;return{}}function KZ(i,e){var t,n;let r;return r=ZU(i[0])?i[0]:ZU(i[1])?i[1]:"function"==typeof i[0]?{next:i[0],error:i[1],complete:i[2]}:{next:i[1],error:i[2],complete:i[3]},{next:s=>{r.next&&r.next(e(s))},error:null===(t=r.error)||void 0===t?void 0:t.bind(r),complete:null===(n=r.complete)||void 0===n?void 0:n.bind(r)}}class EA{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new gh(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return _4(this._delegate,e._delegate)}}class AA extends EA{data(e){const t=this._delegate.data(e);return function E2(i,e){i||In()}(void 0!==t),t}}class Vl{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new nL(e)}where(e,t,n){try{return new Vl(this.firestore,w_(this._delegate,function YQ(i,e,t){const n=e,r=jI("where",i);return new ZQ(r,n,t)}(e,t,n)))}catch(r){throw Ul(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Vl(this.firestore,w_(this._delegate,function XQ(i,e="asc"){const t=e,n=jI("orderBy",i);return new KQ(n,t)}(e,t)))}catch(n){throw Ul(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Vl(this.firestore,w_(this._delegate,function $Q(i){return n4("limit",i),new y4("limit",i,"F")}(e)))}catch(t){throw Ul(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Vl(this.firestore,w_(this._delegate,function QQ(i){return n4("limitToLast",i),new y4("limitToLast",i,"L")}(e)))}catch(t){throw Ul(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Vl(this.firestore,w_(this._delegate,function JQ(...i){return new b4("startAt",i,!0)}(...e)))}catch(t){throw Ul(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Vl(this.firestore,w_(this._delegate,function eJ(...i){return new b4("startAfter",i,!1)}(...e)))}catch(t){throw Ul(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Vl(this.firestore,w_(this._delegate,function tJ(...i){return new x4("endBefore",i,!1)}(...e)))}catch(t){throw Ul(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Vl(this.firestore,w_(this._delegate,function nJ(...i){return new x4("endAt",i,!0)}(...e)))}catch(t){throw Ul(t,"endAt()","Query.endAt()")}}isEqual(e){return o4(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function aJ(i){i=$i(i,ll);const e=$i(i.firestore,Ds),t=Oo(e),n=new _0(e);return function yQ(i,e){const t=new Qo;return i.asyncQueue.enqueueAndForget((0,nt.Z)(function*(){return(n=(0,nt.Z)(function*(r,s,o){try{const a=yield hn(r,s,!0),l=new NH(s,a.ji),h=l.Ku(a.documents),f=l.applyChanges(h,!1);o.resolve(f.snapshot)}catch(a){const l=mT(a,`Failed to execute query '${s} against cache`);o.reject(l)}}),function(r,s,o){return n.apply(this,arguments)})(yield PI(i),e,t);var n})),t.promise}(t,i._query).then(r=>new T_(e,n,i,r))}(this._delegate):"server"===e?.source?function lJ(i){i=$i(i,ll);const e=$i(i.firestore,Ds),t=Oo(e),n=new _0(e);return $H(t,i._query,{source:"server"}).then(r=>new T_(e,n,i,r))}(this._delegate):A4(this._delegate),t.then(n=>new YU(this.firestore,new T_(this.firestore._delegate,this._userDataWriter,this._delegate,n._snapshot)))}onSnapshot(...e){const t=YZ(e),n=KZ(e,r=>new YU(this.firestore,new T_(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return R4(this._delegate,t,n)}withConverter(e){return new Vl(this.firestore,this._delegate.withConverter(e?ab.getInstance(this.firestore,e):null))}}class Pfe{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new AA(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class YU{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Vl(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new AA(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Pfe(this._firestore,t))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new AA(this._firestore,n))})}isEqual(e){return _4(this._delegate,e._delegate)}}class Rw extends Vl{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new gh(this.firestore,e):null}doc(e){try{return new gh(this.firestore,void 0===e?hE(this._delegate):hE(this._delegate,e))}catch(t){throw Ul(t,"doc()","CollectionReference.doc()")}}add(e){return function uJ(i,e){const t=$i(i.firestore,Ds),n=hE(i),r=UI(i.converter,e);return bT(t,[kI(p0(i.firestore),"addDoc",n._key,r,null!==i.converter,{}).toMutation(n._key,As.exists(!1))]).then(()=>n)}(this._delegate,e).then(t=>new gh(this.firestore,t))}isEqual(e){return s4(this._delegate,e._delegate)}withConverter(e){return new Rw(this.firestore,this._delegate.withConverter(e?ab.getInstance(this.firestore,e):null))}}function lb(i){return $i(i,hs)}class KU{constructor(...e){this._delegate=new dm(...e)}static documentId(){return new KU(Ss.keyField().canonicalString())}isEqual(e){return(e=(0,Fi.m9)(e))instanceof dm&&this._delegate._internalPath.isEqual(e._internalPath)}}class cb{constructor(e){this._delegate=e}static serverTimestamp(){const e=function mJ(){return new NB("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new cb(e)}static delete(){const e=function pJ(){return new dE("deleteField")}();return e._methodName="FieldValue.delete",new cb(e)}static arrayUnion(...e){const t=function gJ(...i){return new VQ("arrayUnion",i)}(...e);return t._methodName="FieldValue.arrayUnion",new cb(t)}static arrayRemove(...e){const t=function _J(...i){return new GQ("arrayRemove",i)}(...e);return t._methodName="FieldValue.arrayRemove",new cb(t)}static increment(e){const t=function vJ(i){return new zQ("increment",i)}(e);return t._methodName="FieldValue.increment",new cb(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const Ffe={Firestore:WZ,GeoPoint:LI,Timestamp:mr,Blob:CA,Transaction:qZ,WriteBatch:ZZ,DocumentReference:gh,DocumentSnapshot:EA,Query:Vl,QueryDocumentSnapshot:AA,QuerySnapshot:YU,CollectionReference:Rw,FieldPath:KU,FieldValue:cb,setLogLevel:function Ife(i){!function C2(i){wf.setLogLevel(i)}(i)},CACHE_SIZE_UNLIMITED:-1};!function Ofe(i){(function Lfe(i,e){i.INTERNAL.registerComponent(new Ag.wA("firestore-compat",t=>{const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(n,r)},"PUBLIC").setServiceProps(Object.assign({},Ffe)))})(i,(e,t)=>new WZ(e,t,new Rfe)),i.registerVersion("@firebase/firestore-compat","0.1.23")}(Cfe.Z);var iL=se(5363),kfe=se(6063);class XZ extends Bn.x{constructor(e=1/0,t=1/0,n=kfe.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(n.push(e),!r&&n.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=n?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<n.length&&n.splice(0,n.length-s),!r){const o=t.now();let a=0;for(let l=1;l<n.length&&n[l]<=o;l+=2)a=l;a&&n.splice(0,a+1)}}}function $Z(i,e,t){let n,r=!1;return i&&"object"==typeof i?({bufferSize:n=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=i):n=i??1/0,(0,b6.B)({connector:()=>new XZ(n,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}function QZ(i,e){return(0,os.m)(e)?Gr(()=>i,e):Gr(()=>i)}var XU=se(9468);se(127);const JZ=new c.OlP("angularfire2.auth.use-emulator"),eY=new c.OlP("angularfire2.auth.settings"),tY=new c.OlP("angularfire2.auth.tenant-id"),nY=new c.OlP("angularfire2.auth.langugage-code"),iY=new c.OlP("angularfire2.auth.use-device-language"),rY=new c.OlP("angularfire.auth.persistence"),sY=(i,e,t,n,r,s,o,a)=>(0,Td.cc)(`${i.name}.auth`,"AngularFireAuth",i.name,()=>{const l=e.runOutsideAngular(()=>i.auth());if(t&&l.useEmulator(...t),n&&(l.tenantId=n),l.languageCode=r,s&&l.useDeviceLanguage(),o)for(const[h,f]of Object.entries(o))l.settings[h]=f;return a&&l.setPersistence(a),l},[t,n,r,s,o,a]);let oY=(()=>{class i{constructor(t,n,r,s,o,a,l,h,f,m,g,v){const y=new Bn.x,b=Tn(void 0).pipe((0,iL.Q)(o.outsideAngular),Gr(()=>s.runOutsideAngular(()=>Promise.resolve().then(se.bind(se,5881)))),(0,Sn.U)(()=>(0,Td.on)(t,s,n)),(0,Sn.U)(T=>sY(T,s,a,h,f,m,l,g)),$Z({bufferSize:1,refCount:!1}));if(ar(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Tn(null);else{b.pipe(Qa()).subscribe();const S=b.pipe(Gr(I=>I.getRedirectResult().then(L=>L,()=>null)),pr.iC,$Z({bufferSize:1,refCount:!1})),C=b.pipe(Gr(I=>new bs.y(L=>({unsubscribe:s.runOutsideAngular(()=>I.onAuthStateChanged(N=>L.next(N),N=>L.error(N),()=>L.complete()))})))),R=b.pipe(Gr(I=>new bs.y(L=>({unsubscribe:s.runOutsideAngular(()=>I.onIdTokenChanged(N=>L.next(N),N=>L.error(N),()=>L.complete()))}))));this.authState=S.pipe(QZ(C),(0,XU.R)(o.outsideAngular),(0,iL.Q)(o.insideAngular)),this.user=S.pipe(QZ(R),(0,XU.R)(o.outsideAngular),(0,iL.Q)(o.insideAngular)),this.idToken=this.user.pipe(Gr(I=>I?(0,dr.D)(I.getIdToken()):Tn(null))),this.idTokenResult=this.user.pipe(Gr(I=>I?(0,dr.D)(I.getIdTokenResult()):Tn(null))),this.credential=(0,vm.T)(S,y,this.authState.pipe(fr(I=>!I))).pipe((0,Sn.U)(I=>I?.user?I:null),(0,XU.R)(o.outsideAngular),(0,iL.Q)(o.insideAngular))}return(0,Td.pX)(this,b,s,{spy:{apply:(T,S,C)=>{(T.startsWith("signIn")||T.startsWith("createUser"))&&C.then(R=>y.next(R))}}})}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Td.Dh),c.LFG(Td.xv,8),c.LFG(c.Lbi),c.LFG(c.R0b),c.LFG(pr.HU),c.LFG(JZ,8),c.LFG(eY,8),c.LFG(tY,8),c.LFG(nY,8),c.LFG(iY,8),c.LFG(rY,8),c.LFG(cx,8))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"}),i})();function aY(i,e){return function Bfe(i,e=_E.z){return new bs.y(t=>{let n;return null!=e?e.schedule(()=>{n=i.onSnapshot({includeMetadataChanges:!0},t)}):n=i.onSnapshot({includeMetadataChanges:!0},t),()=>{n?.()}})}(i,e)}function $U(i,e){return aY(i,e).pipe((0,Sn.U)(t=>({payload:t,type:"query"})))}function rL(i,e){return $U(i,e).pipe(ma(void 0),WU(),(0,Sn.U)(([t,n])=>{const r=n.payload.docChanges(),s=r.map(o=>({type:o.type,payload:o}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(n.payload.metadata)&&n.payload.docs.forEach((o,a)=>{const l=r.find(f=>f.doc.ref.isEqual(o.ref)),h=t?.payload.docs.find(f=>f.ref.isEqual(o.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(o.metadata)||!l&&h&&JSON.stringify(h.metadata)===JSON.stringify(o.metadata)||s.push({type:"modified",payload:{oldIndex:a,newIndex:a,type:"modified",doc:o}})}),s}))}function lY(i,e,t){return rL(i,t).pipe(Eo((n,r)=>function Ufe(i,e,t){return e.forEach(n=>{t.indexOf(n.type)>-1&&(i=function Vfe(i,e){switch(e.type){case"added":if(!i[e.newIndex]||!i[e.newIndex].doc.ref.isEqual(e.doc.ref))return QU(i,e.newIndex,0,e);break;case"modified":if(null==i[e.oldIndex]||i[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=i.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return QU(i,e.newIndex,1,e)}break;case"removed":if(i[e.oldIndex]&&i[e.oldIndex].doc.ref.isEqual(e.doc.ref))return QU(i,e.oldIndex,1)}return i}(i,n))}),i}(n,r.map(s=>s.payload),e),[]),V4(),(0,Sn.U)(n=>n.map(r=>({type:r.type,payload:r}))))}function QU(i,e,t,...n){const r=i.slice();return r.splice(e,t,...n),r}function cY(i){return(!i||0===i.length)&&(i=["added","removed","modified"]),i}class uY{constructor(e,t,n){this.ref=e,this.query=t,this.afs=n}stateChanges(e){let t=rL(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,Sn.U)(n=>n.filter(r=>e.indexOf(r.type)>-1)))),t.pipe(ma(void 0),WU(),fr(([n,r])=>r.length>0||!n),(0,Sn.U)(([n,r])=>r),pr.iC)}auditTrail(e){return this.stateChanges(e).pipe(Eo((t,n)=>[...t,...n],[]))}snapshotChanges(e){const t=cY(e);return lY(this.query,t,this.afs.schedulers.outsideAngular).pipe(pr.iC)}valueChanges(e={}){return $U(this.query,this.afs.schedulers.outsideAngular).pipe((0,Sn.U)(t=>t.payload.docs.map(n=>e.idField?Object.assign(Object.assign({},n.data()),{[e.idField]:n.id}):n.data())),pr.iC)}get(e){return(0,dr.D)(this.query.get(e)).pipe(pr.iC)}add(e){return this.ref.add(e)}doc(e){return new hY(this.ref.doc(e),this.afs)}}class hY{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const n=this.ref.collection(e),{ref:r,query:s}=dY(n,t);return new uY(r,s,this.afs)}snapshotChanges(){return function jfe(i,e){return aY(i,e).pipe(ma(void 0),WU(),(0,Sn.U)(([t,n])=>n.exists?t?.exists?{payload:n,type:"modified"}:{payload:n,type:"added"}:{payload:n,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(pr.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,Sn.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,dr.D)(this.ref.get(e)).pipe(pr.iC)}}class Gfe{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?rL(this.query,this.afs.schedulers.outsideAngular).pipe((0,Sn.U)(t=>t.filter(n=>e.indexOf(n.type)>-1)),fr(t=>t.length>0),pr.iC):rL(this.query,this.afs.schedulers.outsideAngular).pipe(pr.iC)}auditTrail(e){return this.stateChanges(e).pipe(Eo((t,n)=>[...t,...n],[]))}snapshotChanges(e){const t=cY(e);return lY(this.query,t,this.afs.schedulers.outsideAngular).pipe(pr.iC)}valueChanges(e={}){return $U(this.query,this.afs.schedulers.outsideAngular).pipe((0,Sn.U)(n=>n.payload.docs.map(r=>e.idField?Object.assign({[e.idField]:r.id},r.data()):r.data())),pr.iC)}get(e){return(0,dr.D)(this.query.get(e)).pipe(pr.iC)}}const zfe=new c.OlP("angularfire2.enableFirestorePersistence"),Hfe=new c.OlP("angularfire2.firestore.persistenceSettings"),Wfe=new c.OlP("angularfire2.firestore.settings"),qfe=new c.OlP("angularfire2.firestore.use-emulator");function dY(i,e=(t=>t)){return{query:e(i),ref:i}}let Zfe=(()=>{class i{constructor(t,n,r,s,o,a,l,h,f,m,g,v,y,b,T,S,C){this.schedulers=l;const R=(0,Td.on)(t,a,n),I=f;m&&sY(R,a,g,y,b,T,v,S),[this.firestore,this.persistenceEnabled$]=(0,Td.cc)(`${R.name}.firestore`,"AngularFirestore",R.name,()=>{const L=a.runOutsideAngular(()=>R.firestore());if(s&&L.settings(s),I&&L.useEmulator(...I),r&&!ar(o)){const N=()=>{try{return(0,dr.D)(L.enablePersistence(h||void 0).then(()=>!0,()=>!1))}catch(U){return typeof console<"u"&&console.warn(U),Tn(!1)}};return[L,a.runOutsideAngular(N)]}return[L,Tn(!1)]},[s,I,r])}collection(t,n){let r;r="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:o}=dY(r,n),a=this.schedulers.ngZone.run(()=>s);return new uY(a,o,this)}collectionGroup(t,n){const r=n||(o=>o),s=this.firestore.collectionGroup(t);return new Gfe(r(s),this)}doc(t){let n;n="string"==typeof t?this.firestore.doc(t):t;const r=this.schedulers.ngZone.run(()=>n);return new hY(r,this)}createId(){return this.firestore.collection("_").doc().id}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Td.Dh),c.LFG(Td.xv,8),c.LFG(zfe,8),c.LFG(Wfe,8),c.LFG(c.Lbi),c.LFG(c.R0b),c.LFG(pr.HU),c.LFG(Hfe,8),c.LFG(qfe,8),c.LFG(oY,8),c.LFG(JZ,8),c.LFG(eY,8),c.LFG(tY,8),c.LFG(nY,8),c.LFG(iY,8),c.LFG(rY,8),c.LFG(cx,8))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"}),i})(),wd=(()=>{class i{constructor(t,n,r){this.afs=t,this.router=n,this.dialog=r,this.localSave={gameName:"",gameTable:{},players:[],turn:0,diceNumber:0,debt:{amountDebt:0,debtWithWho:"",setDebt:!1,amountRent:0},time:{begin:0,end:0,gameAmountTime:""},playerWhoWonId:"",localId:""},this.localSaves={},this.allLocalSaves=[],this.localSaveName="",this.gamePaused=!1,this.userDevice="",this.bgColors=[],this.sessionColor="",this.players=[],this.ambientLightColor="#ff8326",this.choosenMode="",this.db=O4(),this.chosenMap="monopolyMap",this.movingCamera=!1,this.beginTime=0,this.endTime=0,this.gameAmountTime="",this.gameTable={},this.gameMaps=[],this.cardsPositionCounter=0,this.playersModel={},this.pawnTypes=[],this.pawnUrls=[],this.specialPawnTypes=[],this.specialPawn="",this.startToDice=!1,this.playerWhoWonId="",this.addingPlayerMoney=!1,this.removingPlayerMoney=!1,this.playerMoneyChangeValue=0,this.getCardPosition$=new Bn.x,this.setPlayerPosition$=new Bn.x,this.openTextDialog$=new Bn.x,this.turn=0,this.amountRent=0,this.amountDebt=0,this.setDebt=!1,this.debtWithWho="",this.diceRes=[],this.setted=!1}retrieveDBData(){var t=this;return(0,nt.Z)(function*(){(yield L4(F4(t.db,"gameTables"))).forEach(l=>{t.gameMaps.push(l.id)});const r=VI(t.db,"colors","bgColors"),s=yield(yield ZB(r)).data();s&&(t.bgColors=s.colors);const o=VI(t.db,"playerModel","playerModel");t.playersModel=yield(yield ZB(o)).data(),(yield L4(F4(t.db,"pawnTypes"))).forEach(l=>{l.data().specialPawn?t.specialPawnTypes.push(l.data()):t.pawnTypes.push(l.data())}),t.pawnTypes.forEach(l=>{t.pawnUrls.push("/assets/blenderModels/pawns/"+l.value+"/scene.gltf")}),t.cameraPosition=new Q(-10,10,-10)})()}chooseSessionColor(){this.sessionColor=this.bgColors[Math.floor(Math.random()*this.bgColors.length)]}LightenDarkenColor(t,n){var r=!1;"#"==t[0]&&(t=t.slice(1),r=!0);var s=parseInt(t,16),o=(s>>16)+n;o>255?o=255:o<0&&(o=0);var a=(s>>8&255)+n;a>255?a=255:a<0&&(a=0);var l=(255&s)+n;return l>255?l=255:l<0&&(l=0),(r?"#":"")+(l|a<<8|o<<16).toString(16)}retrieveSavesFromLocal(){let t=[];localStorage.getItem("rekordLocalSave0")?t.push(JSON.parse(localStorage.getItem("rekordLocalSave0")||"{}")):t.push("new"),localStorage.getItem("rekordLocalSave1")?t.push(JSON.parse(localStorage.getItem("rekordLocalSave1")||"{}")):t.push("new"),localStorage.getItem("rekordLocalSave2")?t.push(JSON.parse(localStorage.getItem("rekordLocalSave2")||"{}")):t.push("new"),this.allLocalSaves=t}selectLocalData(t){this.localSaveName="rekordLocalSave"+t}createPlayer(t,n){const r=""!=this.specialPawn?"special":"normal",s=JSON.parse(JSON.stringify(this.playersModel));s.name=t,s.id=Kre(),s.money=1500,s.pawn.choosenPawnLabel="normal"==r?this.pawnTypes[n].name:this.specialPawnTypes.find(o=>o.value==this.specialPawn).name,s.pawn.choosenPawnValue="normal"==r?this.pawnTypes[n].value:this.specialPawnTypes.find(o=>o.value==this.specialPawn).value,s.canDice=!1,s.actualCard=0,this.players.push(s),"normal"==r?this.pawnTypes.splice(n,1):this.specialPawnTypes.splice(this.specialPawnTypes.findIndex(o=>o.name==this.specialPawn),1),this.specialPawn=""}setCameraPosition(t,n,r,s,o,a,l,h){var f=this;return(0,nt.Z)(function*(){f.movingCamera=!0;let m=a,g=a;null!=m&&null!=g&&null!=l&&(10<f.players[f.turn].actualCard&&f.players[f.turn].actualCard<20?m+=0:30<f.players[f.turn].actualCard&&f.players[f.turn].actualCard<=39&&(m-=10),20<f.players[f.turn].actualCard&&f.players[f.turn].actualCard<30?g+=0:0<=f.players[f.turn].actualCard&&f.players[f.turn].actualCard<=10&&(g-=10)),l?h&&("x"==h?(fl.fromTo(t._objRef.position,{x:t._objRef.position.x},{x:m?n+m:n,duration:1}),fl.fromTo(t._objRef.position,{y:t._objRef.position.y},{y:a?r+a:r,duration:1})):"z"==h&&(fl.fromTo(t._objRef.position,{y:t._objRef.position.y},{y:a?r+a:r,duration:1}),fl.fromTo(t._objRef.position,{z:t._objRef.position.z},{z:g?s+g:s,duration:1}))):l||(fl.fromTo(t._objRef.position,{x:t._objRef.position.x},{x:"diceRoll"==h?n:m?n+m:n,duration:o/1e3}),fl.fromTo(t._objRef.position,{y:t._objRef.position.y},{y:"diceRoll"==h?r:a?r+a/2:r,duration:o/1e3}),fl.fromTo(t._objRef.position,{z:t._objRef.position.z},{z:"diceRoll"==h?s:g?s+g:s,duration:o/1e3})),fl.fromTo(f.cameraControls._objRef.target,{x:f.cameraControls._objRef.target.x},{x:"diceRoll"==h?0:n,duration:1}),fl.fromTo(f.cameraControls._objRef.target,{y:f.cameraControls._objRef.target.y},{y:"diceRoll"==h?0:r,duration:1}),fl.fromTo(f.cameraControls._objRef.target,{z:f.cameraControls._objRef.target.z},{z:"diceRoll"==h?0:s,duration:1}),setTimeout(()=>{f.movingCamera=!1},o)})()}getCardPosition(t){this.getCardPosition$.next(t)}setPlayerPosition(t,n){let r=JSON.parse(JSON.stringify(this.players[this.turn].actualCard));this.players[this.turn].actualCard=n,this.players[this.turn].pawn.position=t,this.setPlayerPosition$.next({cardPosition:t,oldCardPosition:r})}startGame(){var t=this;return(0,nt.Z)(function*(){if("new"==t.localSaves){t.beginTime=Date.now();const n=VI(t.db,"gameTables",t.chosenMap);t.gameTable=(yield ZB(n)).data(),t.turn=Math.round(Math.random()*(t.players.length-1-0)+0),t.players[t.turn].canDice=!0}else t.gameTable=t.localSaves.gameTable,t.players=t.localSaves.players,t.turn=t.localSaves.turn,t.diceNumber=t.localSaves.diceNumber,t.amountDebt=t.localSaves.debt.amountDebt,t.amountRent=t.localSaves.amountRent,t.debtWithWho=t.localSaves.debt.debtWithWho,t.setDebt=t.localSaves.debt.setDebt,t.beginTime=t.localSaves.time.begin,t.endTime=t.localSaves.time.end,t.gameAmountTime=t.localSaves.time.gameAmountTime,t.localSaveName=t.localSaves.localId,t.localSaves.playerWhoWonId&&(t.playerWhoWonId=t.localSaves.playerWhoWonId,t.textDialog({text:t.players.find(n=>n.id==t.playerWhoWonId).name+" has won the game!"},"finishGame"));t.router.navigateByUrl("game",{skipLocationChange:!0})})()}nextTurn(){if(this.startToDice&&(this.startToDice=!1),this.turn==this.players.length-1?this.turn=0:this.turn++,this.players[this.turn].bankrupt)for(;this.players[this.turn].bankrupt;)this.turn++,this.turn==this.players.length&&(this.turn=0);this.players[this.turn]=this.players[this.turn],this.players[this.turn].canDice=!0,this.diceNumber=void 0,this.setCameraPosition(this.camera,this.players[this.turn].pawn.position[0],this.players[this.turn].pawn.position[1],this.players[this.turn].pawn.position[2],2500,5,!1)}rollTheDice(){var t=this;return(0,nt.Z)(function*(){t.players[t.turn].prison.inPrison?t.whatToDoInprison("prisonRoll"):t.startToDice=!0})()}getDiceRoll(){return[Math.round(5*Math.random()+1),Math.round(5*Math.random()+1)]}payTaxes(t){this.addingRemovingMoney("remove",t.taxesCost,1e3)}payRentToPlayer(t,n){t.owner&&t.owner!=this.players[this.turn].id&&(this.players[this.turn].money>=this.amountRent||this.players[this.turn].money>=this.amountDebt)&&(n?(this.addingRemovingMoney("remove",this.amountDebt,1e3),this.addingRemovingMoney("add",this.amountDebt,1e3,this.players.find(r=>r.id==t.owner))):(this.addingRemovingMoney("remove",this.amountRent,1e3),this.addingRemovingMoney("add",this.amountRent,1e3,this.players.find(r=>r.id==t.owner))),0!=this.amountDebt&&(this.amountDebt=0))}calculateTaxesToPay(t,n){if("property"==t.cardType){if(t.completedSeries){if(t.hotelCounter)return t.rentCosts.hotel;if(!t.housesCounter)return t.rentCosts.completedSeriesBasic;switch(t.housesCounter){case 1:return t.rentCosts.one;case 2:return t.rentCosts.two;case 3:return t.rentCosts.three;case 4:return t.rentCosts.four}}else if(!t.completedSeries)return t.rentCosts.normal}else if("station"==t.cardType)switch(this.gameTable.cards.filter(s=>s.owner==t.owner&&"station"==s.cardType).length){case 1:return t.rentCosts.one;case 2:return t.rentCosts.two;case 3:return t.rentCosts.three;case 4:return t.rentCosts.four}else if("plant"==t.cardType)switch(this.gameTable.cards.filter(s=>s.owner==t.owner&&"plant"==s.cardType).length){case 1:return 4*(n[0]+n[1]);case 2:return 10*(n[0]+n[1])}}whichPropertyAmI(t){var n=this;return(0,nt.Z)(function*(){"property"==t.cardType||"station"==t.cardType||"plant"==t.cardType?(n.openCardDialog(n.gameTable.cards[n.players[n.turn].actualCard]),n.gameTable.cards[n.players[n.turn].actualCard].owner&&n.gameTable.cards[n.players[n.turn].actualCard].owner!=n.players[n.turn].id&&!n.gameTable.cards[n.players[n.turn].actualCard].distrained&&(n.amountRent=yield n.calculateTaxesToPay(n.gameTable.cards[n.players[n.turn].actualCard],n.diceRes),n.textDialog({text:n.players[n.turn].name+" have to pay "+n.amountRent+" of taxes to "+n.players.find(r=>r.id==n.gameTable.cards[n.players[n.turn].actualCard].owner).name,property:n.gameTable.cards[n.players[n.turn].actualCard],diceRes:n.diceRes,playerRent:!0},"payMoney"))):"goToPrison"==t.cardType||3==n.players[n.turn].prison.doubleDiceCounter?n.textDialog({text:n.players[n.turn].name+" is going to prison."},"goingToPrison"):"taxes"==t.cardType?n.textDialog({text:n.players[n.turn].name+" has payed "+t.taxesCost+" of taxes.",property:t,bankTaxes:!0},"payMoney"):"chance"==t.cardType?n.getChestChance("chance"):"communityChest"==t.cardType&&n.getChestChance("communityChest")})()}addingRemovingMoney(t,n,r,s){this.playerMoneyChangeValue=n,"add"==t?(s?s.addingMoney=!0:this.players[this.turn].addingMoney=!0,null!=s?s.money+=n:this.players[this.turn].money+=n,setTimeout(()=>{s?s.addingMoney=!1:this.players[this.turn].addingMoney=!1},r)):"remove"==t&&(s?s.removingMoney=!0:this.players[this.turn].removingMoney=!0,null!=s?s.money-=n:this.players[this.turn].money-=n,setTimeout(()=>{s?s.removingMoney=!1:this.players[this.turn].removingMoney=!1},r)),setTimeout(()=>{this.addingRemovingMoneyProps()},r+500)}addingRemovingMoneyProps(){this.players.filter(t=>1==t.addingMoney).length>0&&this.players.filter(t=>1==t.addingMoney).forEach(t=>{t.addingMoney=!1}),this.players.filter(t=>1==t.removingMoney).length>0&&this.players.filter(t=>1==t.removingMoney).forEach(t=>{t.removingMoney=!1})}showPlayerProps(){this.textDialog({text:this.players[this.turn].name,showPlayerProps:!0},"showPlayerProps")}buyProperty(t){this.addingRemovingMoney("remove",t.cost,1e3),t.canBuy=!1,t.owner=this.players[this.turn].id,t.completedSeries||this.checkCompletedSeries(t,this.players[this.turn].id)}sellProperty(t){this.addingRemovingMoney("add",t.distrained?t.distrainedCost-t.distrainedCost/100*50:t.cost-t.cost/100*10,1e3),this.checkCompletedSeries(t,this.players[this.turn].id),t.canBuy=!0,t.owner=""}distrainProperty(t){t.distrained=!0,this.addingRemovingMoney("add",t.distrainedCost,1e3),this.checkCompletedSeries(t,this.players[this.turn].id)}cancelDistrainedFromProperty(t){t.distrained=!1,this.addingRemovingMoney("remove",t.distrainedCost,1e3),this.checkCompletedSeries(t,this.players[this.turn].id)}sortProperties(t){let n=[],r=[];return t.forEach(s=>{n.includes(s.district)||n.push(s.district)}),n.forEach(s=>{t.filter(o=>o.district==s).forEach(o=>{r.push(o)})}),r}checkCardColorDistrict(t){return"station"==t?"#000":"plant"==t?"#808080":t}openCardDialog(t){("property"==t.cardType||"plant"==t.cardType||"station"==t.cardType)&&(this.cardInfoRef=this.dialog.open(L6,{panelClass:"propertyInfo",hasBackdrop:!0,disableClose:!0,autoFocus:!1,data:{card:t}}))}openCompletedSeriesDialog(t){this.cardInfoRef=this.dialog.open(L6,{panelClass:"completedSeriesInfo",hasBackdrop:!0,disableClose:!0,autoFocus:!1,height:"60%",data:{cards:t,completedSeries:!0}})}openExchangeDialog(){this.cardInfoRef=this.dialog.open(O6,{panelClass:"exchangePanel",hasBackdrop:!0,autoFocus:!1,disableClose:!0,data:{}})}textDialog(t,n){this.cardInfoRef=this.dialog.open(GZ,{panelClass:"messageDialog",hasBackdrop:!0,autoFocus:!1,disableClose:!0,data:{textData:t,eventType:n}})}closeDialog(t){t.close()}goToPrison(){this.players[this.turn].prison.inPrison=!0,this.getCardPosition$.next(10),this.players[this.turn].canDice=!1}whatToDoInprison(t){if("payToExit"==t&&this.exitFromPrison(!0,!1),"freeExit"==t)this.exitFromPrison(!1,!1);else if("prisonRoll"==t){const n=this.getDiceRoll();n[0]==n[1]?this.exitFromPrison(!1,!0,n[0],n[1]):2==this.players[this.turn].prison.inPrisonTurnCounter?this.exitFromPrison(!0,!1,n[0],n[1]):(this.players[this.turn].prison.inPrisonTurnCounter++,this.players[this.turn].canDice=!1)}}exitFromPrison(t,n,r,s){t&&!n?(this.players[this.turn].money<50?this.calculateAmountDebt(50):this.textDialog({text:this.players[this.turn].name+" has payed 50 and exit from prison.",actualPlayer:this.players[this.turn],dice1:r,dice2:s,shouldPay:t,exitFromDice:n},"exitFromPrison"),this.players[this.turn].canDice=!0):n&&r&&s?this.textDialog({text:this.players[this.turn].name+" has exit from prison.",actualPlayer:this.players[this.turn],dice1:r,dice2:s,shouldPay:t,exitFromDice:n},"exitFromPrison"):!t&&!n&&(this.textDialog({text:this.players[this.turn].name+" exit from prison using free card.",actualPlayer:this.players[this.turn],shouldPay:t,exitFromDice:n},"exitFromPrison"),this.players[this.turn].canDice=!0),this.players[this.turn].prison.inPrison=!1,this.players[this.turn].prison.doubleDiceCounter=0,this.players[this.turn].prison.inPrisonTurnCounter=0}playerPassedStart(){!this.players[this.turn].prison.inPrison&&this.players[this.turn].canReceiveMoneyFromStart&&this.addingRemovingMoney("add",200,1e3)}checkCompletedSeries(t,n){const r=this.gameTable.cards.filter(o=>o.district==t.district),s=r.filter(o=>o.owner==n);r.length==s.length&&s.findIndex(o=>o.distrained)<0?(r.forEach(o=>{o.completedSeries||(o.completedSeries=!0)}),this.openCompletedSeriesDialog(r)):r.forEach(o=>{o.completedSeries&&(o.completedSeries=!1)})}getChestChance(t){"chance"==t?(this.randomChance=this.gameTable.chance[Math.round(Math.random()*this.gameTable.chance.length-1)+0],this.textDialog(this.randomChance,"chance")):(this.randomChest=this.gameTable.communitychest[Math.round(Math.random()*this.gameTable.communitychest.length-1)+0],this.textDialog(this.randomChest,"communityChest"))}checkBankrupt(t,n,r){const s=this.gameTable.cards.filter(a=>a.owner==t.id);let o=0;return t.money-n-this.amountDebt<0&&s.length<1?(this.textDialog({text:t.name+" went bankrupt",player:t,playerToPay:r},"backrupt"),!0):!!(s.length&&t.money-n<0)&&(s.forEach(a=>{a.distrained||(o+=a.distrainedCost,a.hotelCounter?o+=a.hotelCost:a.housesCounter&&(o+=a.houseCost))}),t.money-n-this.amountDebt+o<0&&(this.textDialog({text:t.name+" went bankrupt",player:t,playerToPay:r},"backrupt"),!0))}askIfShouldGoBankrupt(){this.textDialog({text:"You are going to go bankrupt. Confirm?",goBankRupt:!0},"goBankRupt")}goBankRupt(){this.players[this.turn].bankrupt=!0,this.checkIfSomeoneWon()}checkIfSomeoneWon(){var t=this;return(0,nt.Z)(function*(){1==t.players.filter(n=>!n.bankrupt).length?(t.endTime=Date.now(),t.playerWhoWonId=t.players.find(n=>!n.bankrupt).id,t.calculateGameTime(),t.textDialog({text:t.players.find(n=>!n.bankrupt).name+" has won the game!",playerWhoWonId:t.players.find(n=>!n.bankrupt).id},"finishGame")):(yield t.gameTable.cards.filter(n=>n.owner==t.players[t.turn].id).forEach(n=>{n.owner="",n.canBuy=!0,n.housesCounter>0&&(n.housesCounter=0,n.hotelCounter>0&&(n.hotelCounter=0))}),t.nextTurn())})()}calculateGameTime(){var t=Math.round(this.endTime-this.beginTime)/1e3,n=Math.round(t/3600);t%=3600;var r=Math.round(t/60);t=Math.round(t%60),this.gameAmountTime=n+" : "+r+" : "+t}calculateAmountDebt(t,n){t?t&&(this.debtWithWho="bank",this.setDebt=!0,this.amountDebt=0==this.amountDebt?t-(n??this.players[this.turn].money):this.amountDebt+(t-(n??this.players[this.turn].money))):(this.debtWithWho="player",this.setDebt=!0,this.amountDebt=0==this.amountDebt?this.amountRent-this.players[this.turn].money:this.amountDebt+(this.amountRent-this.players[this.turn].money)),"player"==this.debtWithWho?(this.textDialog({text:this.players[this.turn].name+" have to pay "+this.amountDebt+" of debts to "+this.players.find(r=>r.id==this.gameTable.cards[this.players[this.turn].actualCard].owner).name,property:this.gameTable.cards[this.players[this.turn].actualCard],amountDebt:this.amountDebt,playerRent:!0,debtWithWho:this.debtWithWho},"payMoney"),this.setDebt&&((n?this.players.find(r=>r.id==n):this.players[this.turn]).money=0)):"bank"==this.debtWithWho&&(this.textDialog({text:(n??this.players[this.turn].name)+" have to pay "+this.amountDebt+" of debts to the bank.",debtWithWho:this.debtWithWho,amountDebt:this.amountDebt,playerRent:!1,playerId:n??""},"payMoney"),this.setDebt&&((n?this.players.find(r=>r.id==n):this.players[this.turn]).money=0))}setDB(){var t=this;return(0,nt.Z)(function*(){let n=[];for(let o=0;o<40;o++)0!=o&&2!=o&&4!=o&&5!=o&&7!=o&&10!=o&&12!=o&&15!=o&&17!=o&&20!=o&&22!=o&&25!=o&&28!=o&&30!=o&&33!=o&&35!=o&&36!=o&&38!=o?n.push({canBuy:!0,cost:50,distrained:!1,distrainedCost:60,name:"",owner:"",cardType:"property",exchangeSelected:!1,completedSeries:!1,district:"",rentCosts:{normal:10,completedSeriesBasic:20,one:30,two:80,three:120,four:200,hotel:350},housesCounter:0,hotelCounter:0,houseCost:50,hotelCost:50}):7==o||22==o||36==o?n.push({canBuy:!1,distrained:!1,name:"Chance",cardType:"chance",chances:[]}):2==o||17==o||33==o?n.push({canBuy:!1,name:"Community Chest",cardType:"communityChest",chests:[]}):30==o?n.push({canBuy:!1,name:"Prison",cardType:"goToPrison"}):20==o?n.push({canBuy:!1,name:"Parking Area",cardType:"parkArea"}):4==o||38==o?n.push({canBuy:!1,name:"Taxes",cardType:"taxes",taxesCost:100}):5==o||15==o||25==o||35==o?n.push({canBuy:!0,cost:200,distrained:!1,distrainedCost:60,name:"Train Station",owner:"",cardType:"station",district:"station",exchangeSelected:!1,completedSeries:!1,rentCosts:{one:50,two:100,three:150,four:200}}):10==o?n.push({canBuy:!1,name:"Prison Area",cardType:"prison"}):12==o||28==o?n.push({canBuy:!0,cost:150,distrained:!1,distrainedCost:60,name:"",owner:"",cardType:"plant",district:"plant",exchangeSelected:!1,completedSeries:!1}):0==o&&n.push({canBuy:!1,name:"Start",cardType:"start",reward:200});n[1].district="#663300",n[3].district="#663300",n[1].name="Old Kent Road",n[3].name="Whitechapel Road",n[6].district="#0099CC",n[8].district="#0099CC",n[9].district="#0099CC",n[6].name="The Angel Islington",n[8].name="Euston Road",n[9].name="Pentonville Road",n[11].district="#FF3399",n[13].district="#FF3399",n[14].district="#FF3399",n[11].name="Pall Mall",n[13].name="Whitehall",n[14].name="Northumberland Avenue",n[16].district="#FF9933",n[18].district="#FF9933",n[19].district="#FF9933",n[16].name="Bow Street",n[18].name="Marlborough Street",n[19].name="Vine Street",n[21].district="#FF3300",n[23].district="#FF3300",n[24].district="#FF3300",n[21].name="The Strand",n[23].name="Fleet Street",n[24].name="Trafalgar Square",n[26].district="#FFFF33",n[27].district="#FFFF33",n[29].district="#FFFF33",n[26].name="Leicester Square",n[27].name="Coventry Street",n[29].name="Piccadilli",n[31].district="#339933",n[32].district="#339933",n[34].district="#339933",n[31].name="Regent Street",n[32].name="Oxford Street",n[34].name="Bond Street",n[37].district="#000066",n[39].district="#000066",n[37].name="Park Lan",n[39].name="Mayfair",n[12].name="Electric Company",n[28].name="Water Works",n[5].name="King Cross Station",n[15].name="Marylebone Station",n[25].name="Fenchurch St Station",n[35].name="Liverpool Street Station",yield CJ(VI(t.db,"gameTables","monopolyMap"),{cards:n,chance:[{title:"Advance to Go (Collect $200)",action:"move",tileid:"go",cardIndex:0},{title:"Advance to Trafalgar Square - If you pass Go, collect $200",action:"move",tileid:"trafalgarsquare",cardIndex:24},{title:"Advance to Pall Mall - If you pass Go, collect $200",action:"move",tileid:"pallmall",cardIndex:11},{title:"Advance token to nearest Utility. If unowned, you may buy it from the Bank. If owned, throw dice and pay owner a total ten times the amount thrown.",action:"movenearest",groupid:"plant",rentmultiplier:10},{title:"Advance token to the nearest Railroad and pay owner twice the rental to which he/she is otherwise entitled. If Railroad is unowned, you may buy it from the Bank.",action:"movenearest",groupid:"station",rentmultiplier:2},{title:"Bank pays you dividend of $50",action:"addfunds",amount:50},{title:"Get out of Jail Free - This card may be kept until needed, or traded/sold",action:"jail",subaction:"getout"},{title:"Go Back 3 Spaces",action:"move",count:-3},{title:"Go to Jail - Go directly to Jail - Do not pass Go, do not collect $200",action:"jail",subaction:"goto"},{title:"Make general repairs on all your property - For each house pay $25 - For each hotel $100",action:"propertycharges",houses:25,hotels:100},{title:"Pay poor tax of $15",action:"removefunds",amount:15},{title:"Take a trip to King Cross Station - If you pass Go, collect $200",action:"move",tileid:"kingcrossstation",cardIndex:5},{title:"Take a walk on the Mayfair - Advance token to Boardwalk",action:"move",tileid:"mayfair",cardIndex:39},{title:"You have been elected Chairman of the Board - Pay each player $50",action:"removefundstoplayers",amount:50},{title:"Your building loan matures - Collect $150",action:"addfunds",amount:50}],communitychest:[{title:"Advance to Go (Collect $200)",action:"move",tileid:"go",cardIndex:0},{title:"Bank error in your favor - Collect $200 ",action:"addfunds",amount:200},{title:"Doctor fee - Pay $50",action:"removefunds",amount:50},{title:"From sale of stock you get $50",action:"addfunds",amount:50},{title:"Get Out of Jail Free",action:"jail",subaction:"getout"},{title:"Go to Jail - Go directly to jail - Do not pass Go - Do not collect $200",action:"jail",subaction:"goto"},{title:"Grand Opera Night - Collect $50 from every player for opening night seats",action:"addfundsfromplayers",amount:50},{title:"Holiday Fund matures - Receive $100",action:"addfunds",amount:100},{title:"Income tax refund - Collect $20",action:"addfunds",amount:20},{title:"Life insurance matures - Collect $100",action:"addfunds",amount:100},{title:"Pay hospital fees of $100",action:"removefunds",amount:100},{title:"Pay school fees of $150",action:"removefunds",amount:150},{title:"Receive $25 consultancy fee",action:"addfunds",amount:25},{title:"You are assessed for street repairs - $40 per house - $115 per hotel",action:"propertycharges",houses:40,hotels:115},{title:"You have won second prize in a beauty contest - Collect $10",action:"addfunds",amount:10},{title:"You inherit $100",action:"addfunds",amount:100}]})})()}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Zfe),c.LFG(Do),c.LFG(cP))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Yfe=["connectionContainer"],Kfe=["inputContainer"],Xfe=["label"];function $fe(i,e){1&i&&(c.ynx(0),c.TgZ(1,"div",14),c._UZ(2,"div",15)(3,"div",16)(4,"div",17),c.qZA(),c.TgZ(5,"div",18),c._UZ(6,"div",15)(7,"div",16)(8,"div",17),c.qZA(),c.BQk())}function Qfe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"div",19),c.NdJ("cdkObserveContent",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.updateOutlineGap())}),c.Hsn(1,1),c.qZA()}if(2&i){const t=c.oxw();c.Q6J("cdkObserveContentDisabled","outline"!=t.appearance)}}function Jfe(i,e){if(1&i&&(c.ynx(0),c.Hsn(1,2),c.TgZ(2,"span"),c._uU(3),c.qZA(),c.BQk()),2&i){const t=c.oxw(2);c.xp6(3),c.Oqu(t._control.placeholder)}}function epe(i,e){1&i&&c.Hsn(0,3,["*ngSwitchCase","true"])}function tpe(i,e){1&i&&(c.TgZ(0,"span",23),c._uU(1," *"),c.qZA())}function npe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"label",20,21),c.NdJ("cdkObserveContent",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.updateOutlineGap())}),c.YNc(2,Jfe,4,1,"ng-container",12),c.YNc(3,epe,1,0,"ng-content",12),c.YNc(4,tpe,2,0,"span",22),c.qZA()}if(2&i){const t=c.oxw();c.ekj("mat-empty",t._control.empty&&!t._shouldAlwaysFloat())("mat-form-field-empty",t._control.empty&&!t._shouldAlwaysFloat())("mat-accent","accent"==t.color)("mat-warn","warn"==t.color),c.Q6J("cdkObserveContentDisabled","outline"!=t.appearance)("id",t._labelId)("ngSwitch",t._hasLabel()),c.uIk("for",t._control.id)("aria-owns",t._control.id),c.xp6(2),c.Q6J("ngSwitchCase",!1),c.xp6(1),c.Q6J("ngSwitchCase",!0),c.xp6(1),c.Q6J("ngIf",!t.hideRequiredMarker&&t._control.required&&!t._control.disabled)}}function ipe(i,e){1&i&&(c.TgZ(0,"div",24),c.Hsn(1,4),c.qZA())}function rpe(i,e){if(1&i&&(c.TgZ(0,"div",25),c._UZ(1,"span",26),c.qZA()),2&i){const t=c.oxw();c.xp6(1),c.ekj("mat-accent","accent"==t.color)("mat-warn","warn"==t.color)}}function spe(i,e){if(1&i&&(c.TgZ(0,"div"),c.Hsn(1,5),c.qZA()),2&i){const t=c.oxw();c.Q6J("@transitionMessages",t._subscriptAnimationState)}}function ope(i,e){if(1&i&&(c.TgZ(0,"div",30),c._uU(1),c.qZA()),2&i){const t=c.oxw(2);c.Q6J("id",t._hintLabelId),c.xp6(1),c.Oqu(t.hintLabel)}}function ape(i,e){if(1&i&&(c.TgZ(0,"div",27),c.YNc(1,ope,2,2,"div",28),c.Hsn(2,6),c._UZ(3,"div",29),c.Hsn(4,7),c.qZA()),2&i){const t=c.oxw();c.Q6J("@transitionMessages",t._subscriptAnimationState),c.xp6(1),c.Q6J("ngIf",t.hintLabel)}}const lpe=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],cpe=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"],upe=new c.OlP("MatError"),hpe={transitionMessages:jf("transitionMessages",[Uf("enter",Qi({opacity:1,transform:"translateY(0%)"})),ka("void => enter",[Qi({opacity:0,transform:"translateY(-5px)"}),ul("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let JU=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=c.lG2({type:i}),i})();const dpe=new c.OlP("MatHint");let sL=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=c.lG2({type:i,selectors:[["mat-label"]]}),i})(),fpe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=c.lG2({type:i,selectors:[["mat-placeholder"]]}),i})();const ppe=new c.OlP("MatPrefix"),mpe=new c.OlP("MatSuffix");let fY=0;const _pe=TE(class{constructor(i){this._elementRef=i}},"primary"),vpe=new c.OlP("MAT_FORM_FIELD_DEFAULT_OPTIONS"),mY=new c.OlP("MatFormField");let gY=(()=>{class i extends _pe{constructor(t,n,r,s,o,a,l){super(t),this._changeDetectorRef=n,this._dir=r,this._defaults=s,this._platform=o,this._ngZone=a,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new Bn.x,this._hideRequiredMarker=!1,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId="mat-hint-"+fY++,this._labelId="mat-form-field-label-"+fY++,this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==l,this.appearance=s?.appearance||"legacy",s&&(this._hideRequiredMarker=Boolean(s.hideRequiredMarker),s.color&&(this.color=this.defaultColor=s.color))}get appearance(){return this._appearance}set appearance(t){const n=this._appearance;this._appearance=t||this._defaults?.appearance||"legacy","outline"===this._appearance&&n!==t&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(t){this._hideRequiredMarker=$r(t)}_shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}_canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(t){this._hintLabel=t,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(t){t!==this._floatLabel&&(this._floatLabel=t||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(t){this._explicitFormFieldControl=t}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const t=this._control;t.controlType&&this._elementRef.nativeElement.classList.add(`mat-form-field-type-${t.controlType}`),t.stateChanges.pipe(ma(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),t.ngControl&&t.ngControl.valueChanges&&t.ngControl.valueChanges.pipe(Xr(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(Xr(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),(0,vm.T)(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe(ma(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe(ma(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe(Xr(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(t){const n=this._control?this._control.ngControl:null;return n&&n[t]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!(!this._labelChildNonStatic&&!this._labelChildStatic)}_shouldLabelFloat(){return this._canLabelFloat()&&(this._control&&this._control.shouldLabelFloat||this._shouldAlwaysFloat())}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat()&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,$I(this._label.nativeElement,"transitionend").pipe(Ns(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||"auto"}_syncDescribedByIds(){if(this._control){let t=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&t.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const n=this._hintChildren?this._hintChildren.find(s=>"start"===s.align):null,r=this._hintChildren?this._hintChildren.find(s=>"end"===s.align):null;n?t.push(n.id):this._hintLabel&&t.push(this._hintLabelId),r&&t.push(r.id)}else this._errorChildren&&t.push(...this._errorChildren.map(n=>n.id));this._control.setDescribedByIds(t)}}_validateControlChild(){}updateOutlineGap(){const t=this._label?this._label.nativeElement:null,n=this._connectionContainerRef.nativeElement,r=".mat-form-field-outline-start",s=".mat-form-field-outline-gap";if("outline"!==this.appearance||!this._platform.isBrowser)return;if(!t||!t.children.length||!t.textContent.trim()){const f=n.querySelectorAll(`${r}, ${s}`);for(let m=0;m<f.length;m++)f[m].style.width="0";return}if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let o=0,a=0;const l=n.querySelectorAll(r),h=n.querySelectorAll(s);if(this._label&&this._label.nativeElement.children.length){const f=n.getBoundingClientRect();if(0===f.width&&0===f.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const m=this._getStartEnd(f),g=t.children,v=this._getStartEnd(g[0].getBoundingClientRect());let y=0;for(let b=0;b<g.length;b++)y+=g[b].offsetWidth;o=Math.abs(v-m)-5,a=y>0?.75*y+10:0}for(let f=0;f<l.length;f++)l[f].style.width=`${o}px`;for(let f=0;f<h.length;f++)h[f].style.width=`${a}px`;this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(t){return this._dir&&"rtl"===this._dir.value?t.right:t.left}_isAttachedToDOM(){const t=this._elementRef.nativeElement;if(t.getRootNode){const n=t.getRootNode();return n&&n!==t}return document.documentElement.contains(t)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(c.sBO),c.Y36(_m,8),c.Y36(vpe,8),c.Y36(cl),c.Y36(c.R0b),c.Y36(c.QbO,8))},i.\u0275cmp=c.Xpm({type:i,selectors:[["mat-form-field"]],contentQueries:function(t,n,r){if(1&t&&(c.Suo(r,JU,5),c.Suo(r,JU,7),c.Suo(r,sL,5),c.Suo(r,sL,7),c.Suo(r,fpe,5),c.Suo(r,upe,5),c.Suo(r,dpe,5),c.Suo(r,ppe,5),c.Suo(r,mpe,5)),2&t){let s;c.iGM(s=c.CRH())&&(n._controlNonStatic=s.first),c.iGM(s=c.CRH())&&(n._controlStatic=s.first),c.iGM(s=c.CRH())&&(n._labelChildNonStatic=s.first),c.iGM(s=c.CRH())&&(n._labelChildStatic=s.first),c.iGM(s=c.CRH())&&(n._placeholderChild=s.first),c.iGM(s=c.CRH())&&(n._errorChildren=s),c.iGM(s=c.CRH())&&(n._hintChildren=s),c.iGM(s=c.CRH())&&(n._prefixChildren=s),c.iGM(s=c.CRH())&&(n._suffixChildren=s)}},viewQuery:function(t,n){if(1&t&&(c.Gf(Yfe,7),c.Gf(Kfe,5),c.Gf(Xfe,5)),2&t){let r;c.iGM(r=c.CRH())&&(n._connectionContainerRef=r.first),c.iGM(r=c.CRH())&&(n._inputContainerRef=r.first),c.iGM(r=c.CRH())&&(n._label=r.first)}},hostAttrs:[1,"mat-form-field"],hostVars:40,hostBindings:function(t,n){2&t&&c.ekj("mat-form-field-appearance-standard","standard"==n.appearance)("mat-form-field-appearance-fill","fill"==n.appearance)("mat-form-field-appearance-outline","outline"==n.appearance)("mat-form-field-appearance-legacy","legacy"==n.appearance)("mat-form-field-invalid",n._control.errorState)("mat-form-field-can-float",n._canLabelFloat())("mat-form-field-should-float",n._shouldLabelFloat())("mat-form-field-has-label",n._hasFloatingLabel())("mat-form-field-hide-placeholder",n._hideControlPlaceholder())("mat-form-field-disabled",n._control.disabled)("mat-form-field-autofilled",n._control.autofilled)("mat-focused",n._control.focused)("ng-untouched",n._shouldForward("untouched"))("ng-touched",n._shouldForward("touched"))("ng-pristine",n._shouldForward("pristine"))("ng-dirty",n._shouldForward("dirty"))("ng-valid",n._shouldForward("valid"))("ng-invalid",n._shouldForward("invalid"))("ng-pending",n._shouldForward("pending"))("_mat-animation-noopable",!n._animationsEnabled)},inputs:{color:"color",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel",floatLabel:"floatLabel"},exportAs:["matFormField"],features:[c._Bn([{provide:mY,useExisting:i}]),c.qOj],ngContentSelectors:cpe,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(t,n){1&t&&(c.F$t(lpe),c.TgZ(0,"div",0)(1,"div",1,2),c.NdJ("click",function(s){return n._control.onContainerClick&&n._control.onContainerClick(s)}),c.YNc(3,$fe,9,0,"ng-container",3),c.YNc(4,Qfe,2,1,"div",4),c.TgZ(5,"div",5,6),c.Hsn(7),c.TgZ(8,"span",7),c.YNc(9,npe,5,16,"label",8),c.qZA()(),c.YNc(10,ipe,2,0,"div",9),c.qZA(),c.YNc(11,rpe,2,4,"div",10),c.TgZ(12,"div",11),c.YNc(13,spe,2,1,"div",12),c.YNc(14,ape,5,2,"div",13),c.qZA()()),2&t&&(c.xp6(3),c.Q6J("ngIf","outline"==n.appearance),c.xp6(1),c.Q6J("ngIf",n._prefixChildren.length),c.xp6(5),c.Q6J("ngIf",n._hasFloatingLabel()),c.xp6(1),c.Q6J("ngIf",n._suffixChildren.length),c.xp6(1),c.Q6J("ngIf","outline"!=n.appearance),c.xp6(1),c.Q6J("ngSwitch",n._getDisplayedMessages()),c.xp6(1),c.Q6J("ngSwitchCase","error"),c.xp6(1),c.Q6J("ngSwitchCase","hint"))},dependencies:[qr,Wo,rp,H4],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.cdk-high-contrast-active .mat-form-field-disabled .mat-form-field-label{color:GrayText}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:none;transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field-hint-end{order:1}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-form-field-flex{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-form-field-flex{outline:dashed 3px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}','.mat-input-element{font:inherit;background:rgba(0,0,0,0);color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit;box-sizing:content-box}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element:not([type=password])::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{opacity:0}._mat-animation-noopable .mat-input-element::placeholder{transition:none}._mat-animation-noopable .mat-input-element::-moz-placeholder{transition:none}._mat-animation-noopable .mat-input-element::-webkit-input-placeholder{transition:none}._mat-animation-noopable .mat-input-element:-ms-input-placeholder{transition:none}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px)}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px;border-top-color:GrayText}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:rgba(0,0,0,0)}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick{border:3px dashed}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-form-field-disabled .mat-form-field-outline{color:GrayText}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}"],encapsulation:2,data:{animation:[hpe.transitionMessages]},changeDetection:0}),i})(),eV=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[or,Qr,t3,Qr]}),i})();const _Y=v0({passive:!0});let ype=(()=>{class i{constructor(t,n){this._platform=t,this._ngZone=n,this._monitoredElements=new Map}monitor(t){if(!this._platform.isBrowser)return Sl.E;const n=mm(t),r=this._monitoredElements.get(n);if(r)return r.subject;const s=new Bn.x,o="cdk-text-field-autofilled",a=l=>{"cdk-text-field-autofill-start"!==l.animationName||n.classList.contains(o)?"cdk-text-field-autofill-end"===l.animationName&&n.classList.contains(o)&&(n.classList.remove(o),this._ngZone.run(()=>s.next({target:l.target,isAutofilled:!1}))):(n.classList.add(o),this._ngZone.run(()=>s.next({target:l.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{n.addEventListener("animationstart",a,_Y),n.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(n,{subject:s,unlisten:()=>{n.removeEventListener("animationstart",a,_Y)}}),s}stopMonitoring(t){const n=mm(t),r=this._monitoredElements.get(n);r&&(r.unlisten(),r.subject.complete(),n.classList.remove("cdk-text-field-autofill-monitored"),n.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(n))}ngOnDestroy(){this._monitoredElements.forEach((t,n)=>this.stopMonitoring(n))}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(cl),c.LFG(c.R0b))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),vY=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({}),i})(),yY=(()=>{class i{constructor(t,n){this._renderer=t,this._elementRef=n,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,n){this._renderer.setProperty(this._elementRef.nativeElement,t,n)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.Qsj),c.Y36(c.SBq))},i.\u0275dir=c.lG2({type:i}),i})(),ub=(()=>{class i extends yY{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275dir=c.lG2({type:i,features:[c.qOj]}),i})();const _h=new c.OlP("NgValueAccessor"),xpe={provide:_h,useExisting:(0,c.Gpc)(()=>DA),multi:!0},wpe=new c.OlP("CompositionEventMode");let DA=(()=>{class i extends yY{constructor(t,n,r){super(t,n),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Tpe(){const i=je()?je().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.Qsj),c.Y36(c.SBq),c.Y36(wpe,8))},i.\u0275dir=c.lG2({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,n){1&t&&c.NdJ("input",function(s){return n._handleInput(s.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(s){return n._compositionEnd(s.target.value)})},features:[c._Bn([xpe]),c.qOj]}),i})();function Q_(i){return null==i||("string"==typeof i||Array.isArray(i))&&0===i.length}function xY(i){return null!=i&&"number"==typeof i.length}const Ua=new c.OlP("NgValidators"),J_=new c.OlP("NgAsyncValidators"),Spe=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Cpe{static min(e){return function TY(i){return e=>{if(Q_(e.value)||Q_(i))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<i?{min:{min:i,actual:e.value}}:null}}(e)}static max(e){return function wY(i){return e=>{if(Q_(e.value)||Q_(i))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>i?{max:{max:i,actual:e.value}}:null}}(e)}static required(e){return function MY(i){return Q_(i.value)?{required:!0}:null}(e)}static requiredTrue(e){return function SY(i){return!0===i.value?null:{required:!0}}(e)}static email(e){return function CY(i){return Q_(i.value)||Spe.test(i.value)?null:{email:!0}}(e)}static minLength(e){return function EY(i){return e=>Q_(e.value)||!xY(e.value)?null:e.value.length<i?{minlength:{requiredLength:i,actualLength:e.value.length}}:null}(e)}static maxLength(e){return function AY(i){return e=>xY(e.value)&&e.value.length>i?{maxlength:{requiredLength:i,actualLength:e.value.length}}:null}(e)}static pattern(e){return function DY(i){if(!i)return oL;let e,t;return"string"==typeof i?(t="","^"!==i.charAt(0)&&(t+="^"),t+=i,"$"!==i.charAt(i.length-1)&&(t+="$"),e=new RegExp(t)):(t=i.toString(),e=i),n=>{if(Q_(n.value))return null;const r=n.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}(e)}static nullValidator(e){return null}static compose(e){return OY(e)}static composeAsync(e){return kY(e)}}function oL(i){return null}function RY(i){return null!=i}function IY(i){return(0,c.QGY)(i)?(0,dr.D)(i):i}function PY(i){let e={};return i.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function FY(i,e){return e.map(t=>t(i))}function LY(i){return i.map(e=>function Epe(i){return!i.validate}(e)?e:t=>e.validate(t))}function OY(i){if(!i)return null;const e=i.filter(RY);return 0==e.length?null:function(t){return PY(FY(t,e))}}function tV(i){return null!=i?OY(LY(i)):null}function kY(i){if(!i)return null;const e=i.filter(RY);return 0==e.length?null:function(t){return y6(FY(t,e).map(IY)).pipe((0,Sn.U)(PY))}}function nV(i){return null!=i?kY(LY(i)):null}function NY(i,e){return null===i?[e]:Array.isArray(i)?[...i,e]:[i,e]}function BY(i){return i._rawValidators}function jY(i){return i._rawAsyncValidators}function iV(i){return i?Array.isArray(i)?i:[i]:[]}function aL(i,e){return Array.isArray(i)?i.includes(e):i===e}function UY(i,e){const t=iV(e);return iV(i).forEach(r=>{aL(t,r)||t.push(r)}),t}function VY(i,e){return iV(e).filter(t=>!aL(i,t))}class GY{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=tV(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=nV(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Gl extends GY{get formDirective(){return null}get path(){return null}}class Um extends GY{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let rV=(()=>{class i extends class zY{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}{constructor(t){super(t)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(Um,2))},i.\u0275dir=c.lG2({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,n){2&t&&c.ekj("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)},features:[c.qOj]}),i})();const RA="VALID",cL="INVALID",Iw="PENDING",IA="DISABLED";function lV(i){return(uL(i)?i.validators:i)||null}function WY(i){return Array.isArray(i)?tV(i):i||null}function cV(i,e){return(uL(e)?e.asyncValidators:i)||null}function qY(i){return Array.isArray(i)?nV(i):i||null}function uL(i){return null!=i&&!Array.isArray(i)&&"object"==typeof i}class KY{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=WY(this._rawValidators),this._composedAsyncValidatorFn=qY(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===RA}get invalid(){return this.status===cL}get pending(){return this.status==Iw}get disabled(){return this.status===IA}get enabled(){return this.status!==IA}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=WY(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=qY(e)}addValidators(e){this.setValidators(UY(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(UY(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(VY(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(VY(e,this._rawAsyncValidators))}hasValidator(e){return aL(this._rawValidators,e)}hasAsyncValidator(e){return aL(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Iw,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=IA,this.errors=null,this._forEachChild(n=>{n.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=RA,this._forEachChild(n=>{n.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===RA||this.status===Iw)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?IA:RA}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Iw,this._hasOwnPendingAsyncValidator=!0;const t=IY(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((n,r)=>n&&n._find(r),this)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new c.vpe,this.statusChanges=new c.vpe}_calculateStatus(){return this._allControlsDisabled()?IA:this.errors?cL:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Iw)?Iw:this._anyControlsHaveStatus(cL)?cL:RA}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){uL(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}}class uV extends KY{constructor(e,t,n){super(lV(t),cV(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){(function YY(i,e,t){i._forEachChild((n,r)=>{if(void 0===t[r])throw new c.vHH(1002,"")})})(this,0,e),Object.keys(e).forEach(n=>{(function ZY(i,e,t){const n=i.controls;if(!(e?Object.keys(n):n).length)throw new c.vHH(1e3,"");if(!n[t])throw new c.vHH(1001,"")})(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(n=>{const r=this.controls[n];r&&r.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,r)=>{n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>!!n._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,n,r)=>((n.enabled||this.disabled)&&(t[r]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((r,s)=>{n=t(n,r,s)}),n}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}function PA(i,e){hV(i,e),e.valueAccessor.writeValue(i.value),i.disabled&&e.valueAccessor.setDisabledState?.(!0),function Npe(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,"change"===i.updateOn&&XY(i,e)})}(i,e),function jpe(i,e){const t=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}(i,e),function Bpe(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,"blur"===i.updateOn&&i._pendingChange&&XY(i,e),"submit"!==i.updateOn&&i.markAsTouched()})}(i,e),function kpe(i,e){if(e.valueAccessor.setDisabledState){const t=n=>{e.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}(i,e)}function dL(i,e,t=!0){const n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),pL(i,e),i&&(e._invokeOnDestroyCallbacks(),i._registerOnCollectionChange(()=>{}))}function fL(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function hV(i,e){const t=BY(i);null!==e.validator?i.setValidators(NY(t,e.validator)):"function"==typeof t&&i.setValidators([t]);const n=jY(i);null!==e.asyncValidator?i.setAsyncValidators(NY(n,e.asyncValidator)):"function"==typeof n&&i.setAsyncValidators([n]);const r=()=>i.updateValueAndValidity();fL(e._rawValidators,r),fL(e._rawAsyncValidators,r)}function pL(i,e){let t=!1;if(null!==i){if(null!==e.validator){const r=BY(i);if(Array.isArray(r)&&r.length>0){const s=r.filter(o=>o!==e.validator);s.length!==r.length&&(t=!0,i.setValidators(s))}}if(null!==e.asyncValidator){const r=jY(i);if(Array.isArray(r)&&r.length>0){const s=r.filter(o=>o!==e.asyncValidator);s.length!==r.length&&(t=!0,i.setAsyncValidators(s))}}}const n=()=>{};return fL(e._rawValidators,n),fL(e._rawAsyncValidators,n),t}function XY(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function $Y(i,e){hV(i,e)}function JY(i,e){i._syncPendingControls(),e.forEach(t=>{const n=t.control;"submit"===n.updateOn&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}const Hpe={provide:Gl,useExisting:(0,c.Gpc)(()=>mL)},FA=(()=>Promise.resolve(null))();let mL=(()=>{class i extends Gl{constructor(t,n){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new c.vpe,this.form=new uV({},tV(t),nV(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){FA.then(()=>{const n=this._findContainer(t.path);t.control=n.registerControl(t.name,t.control),PA(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){FA.then(()=>{const n=this._findContainer(t.path);n&&n.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){FA.then(()=>{const n=this._findContainer(t.path),r=new uV({});$Y(r,t),n.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){FA.then(()=>{const n=this._findContainer(t.path);n&&n.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,n){FA.then(()=>{this.form.get(t.path).setValue(n)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,JY(this.form,this._directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(Ua,10),c.Y36(J_,10))},i.\u0275dir=c.lG2({type:i,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,n){1&t&&c.NdJ("submit",function(s){return n.onSubmit(s)})("reset",function(){return n.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[c._Bn([Hpe]),c.qOj]}),i})();function e7(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}function t7(i){return"object"==typeof i&&null!==i&&2===Object.keys(i).length&&"value"in i&&"disabled"in i}const n7=class extends KY{constructor(e=null,t,n){super(lV(t),cV(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),uL(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=t7(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){e7(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){e7(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){t7(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},Zpe={provide:Um,useExisting:(0,c.Gpc)(()=>gL)},o7=(()=>Promise.resolve(null))();let gL=(()=>{class i extends Um{constructor(t,n,r,s,o){super(),this._changeDetectorRef=o,this.control=new n7,this._registered=!1,this.update=new c.vpe,this._parent=t,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=function fV(i,e){if(!e)return null;let t,n,r;return Array.isArray(e),e.forEach(s=>{s.constructor===DA?t=s:function Gpe(i){return Object.getPrototypeOf(i.constructor)===ub}(s)?n=s:r=s}),r||n||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const n=t.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function dV(i,e){if(!i.hasOwnProperty("model"))return!1;const t=i.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){PA(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){o7.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const n=t.isDisabled.currentValue,r=0!==n&&(0,c.D6c)(n);o7.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function hL(i,e){return[...e.path,i]}(t,this._parent):[t]}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(Gl,9),c.Y36(Ua,10),c.Y36(J_,10),c.Y36(_h,10),c.Y36(c.sBO,8))},i.\u0275dir=c.lG2({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[c._Bn([Zpe]),c.qOj,c.TTD]}),i})();const Kpe={provide:_h,useExisting:(0,c.Gpc)(()=>pV),multi:!0};let pV=(()=>{class i extends ub{writeValue(t){this.setProperty("value",t??"")}registerOnChange(t){this.onChange=n=>{t(""==n?null:parseFloat(n))}}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275dir=c.lG2({type:i,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,n){1&t&&c.NdJ("input",function(s){return n.onChange(s.target.value)})("blur",function(){return n.onTouched()})},features:[c._Bn([Kpe]),c.qOj]}),i})(),a7=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({}),i})();const eme={provide:Gl,useExisting:(0,c.Gpc)(()=>_L)};let _L=(()=>{class i extends Gl{constructor(t,n){super(),this.validators=t,this.asyncValidators=n,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new c.vpe,this._setValidators(t),this._setAsyncValidators(n)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(pL(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const n=this.form.get(t.path);return PA(n,t),n.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),n}getControl(t){return this.form.get(t.path)}removeControl(t){dL(t.control||null,t,!1),function zpe(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,n){this.form.get(t.path).setValue(n)}onSubmit(t){return this.submitted=!0,JY(this.form,this.directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const n=t.control,r=this.form.get(t.path);n!==r&&(dL(n||null,t),(i=>i instanceof n7)(r)&&(PA(r,t),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const n=this.form.get(t.path);$Y(n,t),n.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const n=this.form.get(t.path);n&&function Upe(i,e){return pL(i,e)}(n,t)&&n.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){hV(this.form,this),this._oldForm&&pL(this._oldForm,this)}_checkFormPresent(){}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(Ua,10),c.Y36(J_,10))},i.\u0275dir=c.lG2({type:i,selectors:[["","formGroup",""]],hostBindings:function(t,n){1&t&&c.NdJ("submit",function(s){return n.onSubmit(s)})("reset",function(){return n.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[c._Bn([eme]),c.qOj,c.TTD]}),i})(),vme=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[a7]}),i})(),yme=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[vme]}),i})();const xme=new c.OlP("MAT_INPUT_VALUE_ACCESSOR"),Tme=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let wme=0;const Mme=gte(class{constructor(i,e,t,n){this._defaultErrorStateMatcher=i,this._parentForm=e,this._parentFormGroup=t,this.ngControl=n,this.stateChanges=new Bn.x}});let M7=(()=>{class i extends Mme{constructor(t,n,r,s,o,a,l,h,f,m){super(a,s,o,r),this._elementRef=t,this._platform=n,this._autofillMonitor=h,this._formField=m,this._uid="mat-input-"+wme++,this.focused=!1,this.stateChanges=new Bn.x,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(y=>N4().has(y)),this._iOSKeyupListener=y=>{const b=y.target;!b.value&&0===b.selectionStart&&0===b.selectionEnd&&(b.setSelectionRange(1,1),b.setSelectionRange(0,0))};const g=this._elementRef.nativeElement,v=g.nodeName.toLowerCase();this._inputValueAccessor=l||g,this._previousNativeValue=this.value,this.id=this.id,n.IOS&&f.runOutsideAngular(()=>{t.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===v,this._isTextarea="textarea"===v,this._isInFormField=!!m,this._isNativeSelect&&(this.controlType=g.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(t){this._disabled=$r(t),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(t){this._id=t||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(Cpe.required)??!1}set required(t){this._required=$r(t)}get type(){return this._type}set type(t){this._type=t||"text",this._validateType(),!this._isTextarea&&N4().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(t){t!==this.value&&(this._inputValueAccessor.value=t,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(t){this._readonly=$r(t)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(t=>{this.autofilled=t.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(t){this._elementRef.nativeElement.focus(t)}_focusChanged(t){t!==this.focused&&(this.focused=t,this.stateChanges.next())}_onInput(){}_dirtyCheckPlaceholder(){const t=this._formField,n=t&&"legacy"===t.appearance&&!t._hasLabel?.()?null:this.placeholder;if(n!==this._previousPlaceholder){const r=this._elementRef.nativeElement;this._previousPlaceholder=n,n?r.setAttribute("placeholder",n):r.removeAttribute("placeholder")}}_dirtyCheckNativeValue(){const t=this._elementRef.nativeElement.value;this._previousNativeValue!==t&&(this._previousNativeValue=t,this.stateChanges.next())}_validateType(){Tme.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let t=this._elementRef.nativeElement.validity;return t&&t.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const t=this._elementRef.nativeElement,n=t.options[0];return this.focused||t.multiple||!this.empty||!!(t.selectedIndex>-1&&n&&n.label)}return this.focused||!this.empty}setDescribedByIds(t){t.length?this._elementRef.nativeElement.setAttribute("aria-describedby",t.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const t=this._elementRef.nativeElement;return this._isNativeSelect&&(t.multiple||t.size>1)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(cl),c.Y36(Um,10),c.Y36(mL,8),c.Y36(_L,8),c.Y36(A5),c.Y36(xme,10),c.Y36(ype),c.Y36(c.R0b),c.Y36(mY,8))},i.\u0275dir=c.lG2({type:i,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:12,hostBindings:function(t,n){1&t&&c.NdJ("focus",function(){return n._focusChanged(!0)})("blur",function(){return n._focusChanged(!1)})("input",function(){return n._onInput()}),2&t&&(c.Ikx("disabled",n.disabled)("required",n.required),c.uIk("id",n.id)("data-placeholder",n.placeholder)("name",n.name||null)("readonly",n.readonly&&!n._isNativeSelect||null)("aria-invalid",n.empty&&n.required?null:n.errorState)("aria-required",n.required),c.ekj("mat-input-server",n._isServer)("mat-native-select-inline",n._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[c._Bn([{provide:JU,useExisting:i}]),c.qOj,c.TTD]}),i})(),Sme=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({providers:[A5],imports:[vY,eV,Qr,vY,eV]}),i})();function S7(i,e){return e?t=>$a(e.pipe(Ns(1),function Cme(){return(0,Zr.e)((i,e)=>{i.subscribe((0,Tr.x)(e,G4.Z))})}()),t.pipe(S7(i))):(0,Ar.z)((t,n)=>i(t,n).pipe(Ns(1),Uu(t)))}function C7(i,e=_E.z){const t=c5(i,e);return S7(()=>t)}const Eme=["mat-menu-item",""];function Ame(i,e){1&i&&(c.O4$(),c.TgZ(0,"svg",2),c._UZ(1,"polygon",3),c.qZA())}const E7=["*"];function Dme(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"div",0),c.NdJ("keydown",function(r){c.CHM(t);const s=c.oxw();return c.KtG(s._handleKeydown(r))})("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.closed.emit("click"))})("@transformMenu.start",function(r){c.CHM(t);const s=c.oxw();return c.KtG(s._onAnimationStart(r))})("@transformMenu.done",function(r){c.CHM(t);const s=c.oxw();return c.KtG(s._onAnimationDone(r))}),c.TgZ(1,"div",1),c.Hsn(2),c.qZA()()}if(2&i){const t=c.oxw();c.Q6J("id",t.panelId)("ngClass",t._classList)("@transformMenu",t._panelAnimationState),c.uIk("aria-label",t.ariaLabel||null)("aria-labelledby",t.ariaLabelledby||null)("aria-describedby",t.ariaDescribedby||null)}}const vL={transformMenu:jf("transformMenu",[Uf("void",Qi({opacity:0,transform:"scale(0.8)"})),ka("void => enter",ul("120ms cubic-bezier(0, 0, 0.2, 1)",Qi({opacity:1,transform:"scale(1)"}))),ka("* => void",ul("100ms 25ms linear",Qi({opacity:0})))]),fadeInItems:jf("fadeInItems",[Uf("showing",Qi({opacity:1})),ka("void => *",[Qi({opacity:0}),ul("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},Rme=new c.OlP("MatMenuContent"),xV=new c.OlP("MAT_MENU_PANEL"),Ime=y3(rP(class{}));let yL=(()=>{class i extends Ime{constructor(t,n,r,s,o){super(),this._elementRef=t,this._document=n,this._focusMonitor=r,this._parentMenu=s,this._changeDetectorRef=o,this.role="menuitem",this._hovered=new Bn.x,this._focused=new Bn.x,this._highlighted=!1,this._triggersSubmenu=!1,s?.addItem?.(this)}focus(t,n){this._focusMonitor&&t?this._focusMonitor.focusVia(this._getHostElement(),t,n):this._getHostElement().focus(n),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(t){this.disabled&&(t.preventDefault(),t.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){const t=this._elementRef.nativeElement.cloneNode(!0),n=t.querySelectorAll("mat-icon, .material-icons");for(let r=0;r<n.length;r++)n[r].remove();return t.textContent?.trim()||""}_setHighlighted(t){this._highlighted=t,this._changeDetectorRef?.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(Oe),c.Y36(gm),c.Y36(xV,8),c.Y36(c.sBO))},i.\u0275cmp=c.Xpm({type:i,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:10,hostBindings:function(t,n){1&t&&c.NdJ("click",function(s){return n._checkDisabled(s)})("mouseenter",function(){return n._handleMouseEnter()}),2&t&&(c.uIk("role",n.role)("tabindex",n._getTabIndex())("aria-disabled",n.disabled.toString())("disabled",n.disabled||null),c.ekj("mat-menu-item",!0)("mat-menu-item-highlighted",n._highlighted)("mat-menu-item-submenu-trigger",n._triggersSubmenu))},inputs:{disabled:"disabled",disableRipple:"disableRipple",role:"role"},exportAs:["matMenuItem"],features:[c.qOj],attrs:Eme,ngContentSelectors:E7,decls:3,vars:3,consts:[["matRipple","",1,"mat-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["class","mat-menu-submenu-icon","viewBox","0 0 5 10","focusable","false",4,"ngIf"],["viewBox","0 0 5 10","focusable","false",1,"mat-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(t,n){1&t&&(c.F$t(),c.Hsn(0),c._UZ(1,"div",0),c.YNc(2,Ame,2,0,"svg",1)),2&t&&(c.xp6(1),c.Q6J("matRippleDisabled",n.disableRipple||n.disabled)("matRippleTrigger",n._getHostElement()),c.xp6(1),c.Q6J("ngIf",n._triggersSubmenu))},dependencies:[qr,ME],encapsulation:2,changeDetection:0}),i})();const A7=new c.OlP("mat-menu-default-options",{providedIn:"root",factory:function Pme(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let Fme=0,LA=(()=>{class i{constructor(t,n,r,s){this._elementRef=t,this._ngZone=n,this._defaultOptions=r,this._changeDetectorRef=s,this._xPosition=this._defaultOptions.xPosition,this._yPosition=this._defaultOptions.yPosition,this._directDescendantItems=new c.n_E,this._tabSubscription=ei.w0.EMPTY,this._classList={},this._panelAnimationState="void",this._animationDone=new Bn.x,this.overlayPanelClass=this._defaultOptions.overlayPanelClass||"",this.backdropClass=this._defaultOptions.backdropClass,this._overlapTrigger=this._defaultOptions.overlapTrigger,this._hasBackdrop=this._defaultOptions.hasBackdrop,this.closed=new c.vpe,this.close=this.closed,this.panelId="mat-menu-panel-"+Fme++}get xPosition(){return this._xPosition}set xPosition(t){this._xPosition=t,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(t){this._yPosition=t,this.setPositionClasses()}get overlapTrigger(){return this._overlapTrigger}set overlapTrigger(t){this._overlapTrigger=$r(t)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(t){this._hasBackdrop=$r(t)}set panelClass(t){const n=this._previousPanelClass;n&&n.length&&n.split(" ").forEach(r=>{this._classList[r]=!1}),this._previousPanelClass=t,t&&t.length&&(t.split(" ").forEach(r=>{this._classList[r]=!0}),this._elementRef.nativeElement.className="")}get classList(){return this.panelClass}set classList(t){this.panelClass=t}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new nee(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._tabSubscription=this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(ma(this._directDescendantItems),Gr(t=>(0,vm.T)(...t.map(n=>n._focused)))).subscribe(t=>this._keyManager.updateActiveItem(t)),this._directDescendantItems.changes.subscribe(t=>{const n=this._keyManager;if("enter"===this._panelAnimationState&&n.activeItem?._hasFocus()){const r=t.toArray(),s=Math.max(0,Math.min(r.length-1,n.activeItemIndex||0));r[s]&&!r[s].disabled?n.setActiveItem(s):n.setNextItemActive()}})}ngOnDestroy(){this._directDescendantItems.destroy(),this._tabSubscription.unsubscribe(),this.closed.complete()}_hovered(){return this._directDescendantItems.changes.pipe(ma(this._directDescendantItems),Gr(n=>(0,vm.T)(...n.map(r=>r._hovered))))}addItem(t){}removeItem(t){}_handleKeydown(t){const n=t.keyCode,r=this._keyManager;switch(n){case 27:TT(t)||(t.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(38===n||40===n)&&r.setFocusOrigin("keyboard"),void r.onKeydown(t)}t.stopPropagation()}focusFirstItem(t="program"){this._ngZone.onStable.pipe(Ns(1)).subscribe(()=>{let n=null;if(this._directDescendantItems.length&&(n=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),!n||!n.contains(document.activeElement)){const r=this._keyManager;r.setFocusOrigin(t).setFirstItemActive(),!r.activeItem&&n&&n.focus()}})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(t){const n=Math.min(this._baseElevation+t,24),r=`${this._elevationPrefix}${n}`,s=Object.keys(this._classList).find(o=>o.startsWith(this._elevationPrefix));(!s||s===this._previousElevation)&&(this._previousElevation&&(this._classList[this._previousElevation]=!1),this._classList[r]=!0,this._previousElevation=r)}setPositionClasses(t=this.xPosition,n=this.yPosition){const r=this._classList;r["mat-menu-before"]="before"===t,r["mat-menu-after"]="after"===t,r["mat-menu-above"]="above"===n,r["mat-menu-below"]="below"===n,this._changeDetectorRef?.markForCheck()}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(t){this._animationDone.next(t),this._isAnimating=!1}_onAnimationStart(t){this._isAnimating=!0,"enter"===t.toState&&0===this._keyManager.activeItemIndex&&(t.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe(ma(this._allItems)).subscribe(t=>{this._directDescendantItems.reset(t.filter(n=>n._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(c.R0b),c.Y36(A7),c.Y36(c.sBO))},i.\u0275dir=c.lG2({type:i,contentQueries:function(t,n,r){if(1&t&&(c.Suo(r,Rme,5),c.Suo(r,yL,5),c.Suo(r,yL,4)),2&t){let s;c.iGM(s=c.CRH())&&(n.lazyContent=s.first),c.iGM(s=c.CRH())&&(n._allItems=s),c.iGM(s=c.CRH())&&(n.items=s)}},viewQuery:function(t,n){if(1&t&&c.Gf(c.Rgc,5),2&t){let r;c.iGM(r=c.CRH())&&(n.templateRef=r.first)}},inputs:{backdropClass:"backdropClass",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:"overlapTrigger",hasBackdrop:"hasBackdrop",panelClass:["class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"}}),i})(),Lme=(()=>{class i extends LA{constructor(t,n,r,s){super(t,n,r,s),this._elevationPrefix="mat-elevation-z",this._baseElevation=4}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(c.SBq),c.Y36(c.R0b),c.Y36(A7),c.Y36(c.sBO))},i.\u0275cmp=c.Xpm({type:i,selectors:[["mat-menu"]],hostVars:3,hostBindings:function(t,n){2&t&&c.uIk("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},exportAs:["matMenu"],features:[c._Bn([{provide:xV,useExisting:i}]),c.qOj],ngContentSelectors:E7,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-menu-panel",3,"id","ngClass","keydown","click"],[1,"mat-menu-content"]],template:function(t,n){1&t&&(c.F$t(),c.YNc(0,Dme,3,6,"ng-template"))},dependencies:[Ha],styles:['mat-menu{display:none}.mat-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;max-height:calc(100vh - 48px);border-radius:4px;outline:0;min-height:64px;position:relative}.mat-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-menu-panel{outline:solid 1px}.mat-menu-content:not(:empty){padding-top:8px;padding-bottom:8px}.mat-menu-item{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative}.mat-menu-item::-moz-focus-inner{border:0}.mat-menu-item[disabled]{cursor:default}[dir=rtl] .mat-menu-item{text-align:right}.mat-menu-item .mat-icon{margin-right:16px;vertical-align:middle}.mat-menu-item .mat-icon svg{vertical-align:top}[dir=rtl] .mat-menu-item .mat-icon{margin-left:16px;margin-right:0}.mat-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.cdk-high-contrast-active .mat-menu-item{margin-top:1px}.mat-menu-item-submenu-trigger{padding-right:32px}[dir=rtl] .mat-menu-item-submenu-trigger{padding-right:16px;padding-left:32px}.mat-menu-submenu-icon{position:absolute;top:50%;right:16px;transform:translateY(-50%);width:5px;height:10px;fill:currentColor}[dir=rtl] .mat-menu-submenu-icon{right:auto;left:16px;transform:translateY(-50%) scaleX(-1)}.cdk-high-contrast-active .mat-menu-submenu-icon{fill:CanvasText}button.mat-menu-item{width:100%}.mat-menu-item .mat-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}'],encapsulation:2,data:{animation:[vL.transformMenu,vL.fadeInItems]},changeDetection:0}),i})();const D7=new c.OlP("mat-menu-scroll-strategy"),kme={provide:D7,deps:[fd],useFactory:function Ome(i){return()=>i.scrollStrategies.reposition()}},R7=v0({passive:!0});let Nme=(()=>{class i{constructor(t,n,r,s,o,a,l,h,f){this._overlay=t,this._element=n,this._viewContainerRef=r,this._menuItemInstance=a,this._dir=l,this._focusMonitor=h,this._ngZone=f,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=ei.w0.EMPTY,this._hoverSubscription=ei.w0.EMPTY,this._menuCloseSubscription=ei.w0.EMPTY,this._handleTouchStart=m=>{a3(m)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new c.vpe,this.onMenuOpen=this.menuOpened,this.menuClosed=new c.vpe,this.onMenuClose=this.menuClosed,this._scrollStrategy=s,this._parentMaterialMenu=o instanceof LA?o:void 0,n.nativeElement.addEventListener("touchstart",this._handleTouchStart,R7),a&&(a._triggersSubmenu=this.triggersSubmenu())}get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(t){this.menu=t}get menu(){return this._menu}set menu(t){t!==this._menu&&(this._menu=t,this._menuCloseSubscription.unsubscribe(),t&&(this._menuCloseSubscription=t.close.subscribe(n=>{this._destroyMenu(n),("click"===n||"tab"===n)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(n)})))}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,R7),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!(!this._menuItemInstance||!this._parentMaterialMenu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){const t=this.menu;if(this._menuOpen||!t)return;const n=this._createOverlay(t),r=n.getConfig(),s=r.positionStrategy;this._setPosition(t,s),r.hasBackdrop=t.hasBackdrop??!this.triggersSubmenu(),n.attach(this._getPortal(t)),t.lazyContent&&t.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(t),t instanceof LA&&(t._startAnimation(),t._directDescendantItems.changes.pipe(Xr(t.close)).subscribe(()=>{s.withLockedPosition(!1).reapplyLastPosition(),s.withLockedPosition(!0)}))}closeMenu(){this.menu?.close.emit()}focus(t,n){this._focusMonitor&&t?this._focusMonitor.focusVia(this._element,t,n):this._element.nativeElement.focus(n)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(t){if(!this._overlayRef||!this.menuOpen)return;const n=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===t||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,n instanceof LA?(n._resetAnimation(),n.lazyContent?n._animationDone.pipe(fr(r=>"void"===r.toState),Ns(1),Xr(n.lazyContent._attached)).subscribe({next:()=>n.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),n?.lazyContent?.detach())}_initMenu(t){t.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,t.direction=this.dir,this._setMenuElevation(t),t.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(t){if(t.setElevation){let n=0,r=t.parentMenu;for(;r;)n++,r=r.parentMenu;t.setElevation(n)}}_setIsMenuOpen(t){this._menuOpen=t,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(t)}_createOverlay(t){if(!this._overlayRef){const n=this._getOverlayConfig(t);this._subscribeToPositions(t,n.positionStrategy),this._overlayRef=this._overlay.create(n),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(t){return new g3({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:t.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:t.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(t,n){t.setPositionClasses&&n.positionChanges.subscribe(r=>{const s="start"===r.connectionPair.overlayX?"after":"before",o="top"===r.connectionPair.overlayY?"below":"above";this._ngZone?this._ngZone.run(()=>t.setPositionClasses(s,o)):t.setPositionClasses(s,o)})}_setPosition(t,n){let[r,s]="before"===t.xPosition?["end","start"]:["start","end"],[o,a]="above"===t.yPosition?["bottom","top"]:["top","bottom"],[l,h]=[o,a],[f,m]=[r,s],g=0;if(this.triggersSubmenu()){if(m=r="before"===t.xPosition?"start":"end",s=f="end"===r?"start":"end",this._parentMaterialMenu){if(null==this._parentInnerPadding){const v=this._parentMaterialMenu.items.first;this._parentInnerPadding=v?v._getHostElement().offsetTop:0}g="bottom"===o?this._parentInnerPadding:-this._parentInnerPadding}}else t.overlapTrigger||(l="top"===o?"bottom":"top",h="top"===a?"bottom":"top");n.withPositions([{originX:r,originY:l,overlayX:f,overlayY:o,offsetY:g},{originX:s,originY:l,overlayX:m,overlayY:o,offsetY:g},{originX:r,originY:h,overlayX:f,overlayY:a,offsetY:-g},{originX:s,originY:h,overlayX:m,overlayY:a,offsetY:-g}])}_menuClosingActions(){const t=this._overlayRef.backdropClick(),n=this._overlayRef.detachments(),r=this._parentMaterialMenu?this._parentMaterialMenu.closed:Tn(),s=this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(fr(o=>o!==this._menuItemInstance),fr(()=>this._menuOpen)):Tn();return(0,vm.T)(t,r,s,n)}_handleMousedown(t){o3(t)||(this._openedBy=0===t.button?"mouse":void 0,this.triggersSubmenu()&&t.preventDefault())}_handleKeydown(t){const n=t.keyCode;(13===n||32===n)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===n&&"ltr"===this.dir||37===n&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(t){this.triggersSubmenu()?(t.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe(fr(t=>t===this._menuItemInstance&&!t.disabled),C7(0,u3)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof LA&&this.menu._isAnimating?this.menu._animationDone.pipe(Ns(1),C7(0,u3),Xr(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(t){return(!this._portal||this._portal.templateRef!==t.templateRef)&&(this._portal=new d3(t.templateRef,this._viewContainerRef)),this._portal}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(fd),c.Y36(c.SBq),c.Y36(c.s_b),c.Y36(D7),c.Y36(xV,8),c.Y36(yL,10),c.Y36(_m,8),c.Y36(gm),c.Y36(c.R0b))},i.\u0275dir=c.lG2({type:i,hostVars:3,hostBindings:function(t,n){1&t&&c.NdJ("click",function(s){return n._handleClick(s)})("mousedown",function(s){return n._handleMousedown(s)})("keydown",function(s){return n._handleKeydown(s)}),2&t&&c.uIk("aria-haspopup",n.menu?"menu":null)("aria-expanded",n.menuOpen||null)("aria-controls",n.menuOpen?n.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:["mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:["matMenuTriggerFor","menu"],menuData:["matMenuTriggerData","menuData"],restoreFocus:["matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"}}),i})(),Bme=(()=>{class i extends Nme{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275dir=c.lG2({type:i,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-menu-trigger"],exportAs:["matMenuTrigger"],features:[c.qOj]}),i})(),jme=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({providers:[kme],imports:[or,Qr,sP,xE,yE,Qr]}),i})();const bL={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor.a *= opacity;\n\n\n\t\t}"};class TV{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const Ume=new pw(-1,1,1,-1,0,1),wV=new Di;wV.setAttribute("position",new On([-1,3,0,-1,-1,0,3,-1,0],3)),wV.setAttribute("uv",new On([0,2,0,0,2,0],2));class MV{constructor(e){this._mesh=new aa(wV,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,Ume)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}new pw(-1,1,1,-1,0,1);const SV=new Di;SV.setAttribute("position",new On([-1,3,0,-1,-1,0,3,-1,0],3)),SV.setAttribute("uv",new On([0,2,0,0,2,0],2)),new YF,new Q,new Q,new sa,new Q(1,0,0),new Q(0,1,0),new Q(0,0,1),new tF,new Q(0,1,0),new Q(0,0,0),new Jn,new sa,new sa,new Q,new Jn,new Q(1,0,0),new Q(0,1,0),new Q(0,0,1),new Q,new Q,new Q,Symbol(),Symbol(),Symbol(),Symbol(),Symbol(),Symbol(),Symbol(),Symbol(),Symbol(),Symbol(),Symbol(),Symbol(),Symbol(),Symbol(),Symbol(),Symbol(),new Jn,new Jn,new YF,new Q,new Jn,new Jn,new Q;const AV={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new Je(.001953125,0)},cKernel:{value:[]}},vertexShader:"\n\n\t\tuniform vec2 uImageIncrement;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float cKernel[ KERNEL_SIZE_INT ];\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec2 uImageIncrement;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec2 imageCoord = vUv;\n\t\t\tvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );\n\n\t\t\tfor( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {\n\n\t\t\t\tsum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];\n\t\t\t\timageCoord += uImageIncrement;\n\n\t\t\t}\n\n\t\t\tgl_FragColor = sum;\n\n\t\t}",buildKernel:function(i){let t=2*Math.ceil(3*i)+1;t>25&&(t=25);const n=.5*(t-1),r=new Array(t);let s=0;for(let o=0;o<t;++o)r[o]=Xme(o-n,i),s+=r[o];for(let o=0;o<t;++o)r[o]/=s;return r}};function Xme(i,e){return Math.exp(-i*i/(2*e*e))}class Pw extends TV{constructor(e=1,t=25,n=4,r=256){super(),this.renderTargetX=new ra(r,r),this.renderTargetX.texture.name="BloomPass.x",this.renderTargetY=new ra(r,r),this.renderTargetY.texture.name="BloomPass.y",this.combineUniforms=cw.clone(DV.uniforms),this.combineUniforms.strength.value=e,this.materialCombine=new la({uniforms:this.combineUniforms,vertexShader:DV.vertexShader,fragmentShader:DV.fragmentShader,blending:2,transparent:!0}),void 0===AV&&console.error("THREE.BloomPass relies on ConvolutionShader");const s=AV;this.convolutionUniforms=cw.clone(s.uniforms),this.convolutionUniforms.uImageIncrement.value=Pw.blurX,this.convolutionUniforms.cKernel.value=AV.buildKernel(n),this.materialConvolution=new la({uniforms:this.convolutionUniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,defines:{KERNEL_SIZE_FLOAT:t.toFixed(1),KERNEL_SIZE_INT:t.toFixed(0)}}),this.needsSwap=!1,this.fsQuad=new MV(null)}render(e,t,n,r,s){s&&e.state.buffers.stencil.setTest(!1),this.fsQuad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=n.texture,this.convolutionUniforms.uImageIncrement.value=Pw.blurX,e.setRenderTarget(this.renderTargetX),e.clear(),this.fsQuad.render(e),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=Pw.blurY,e.setRenderTarget(this.renderTargetY),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCombine,this.combineUniforms.tDiffuse.value=this.renderTargetY.texture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(n),this.clear&&e.clear(),this.fsQuad.render(e)}}const DV={uniforms:{tDiffuse:{value:null},strength:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float strength;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = strength * texel;\n\n\t\t}"};Pw.blurX=new Je(.001953125,0),Pw.blurY=new Je(0,.001953125),new Q,new class ffe{constructor(e=new Q,t=new Q){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){LZ.subVectors(e,this.start),KF.subVectors(this.end,this.start);const n=KF.dot(KF);let s=KF.dot(LZ)/n;return t&&(s=vo(s,0,1)),s}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},new Om,new Q,new dh,new Je(256,256),new Je(.5,.5),new Om,new YF,new Je,new Q,new Q,new Q,new Jn,new Q,new GU,new Q,Math,Math,Math;class OV{constructor(e=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(let t=0;t<512;t++)this.perm[t]=this.p[255&t];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(e,t,n){return e[0]*t+e[1]*n}dot3(e,t,n,r){return e[0]*t+e[1]*n+e[2]*r}dot4(e,t,n,r,s){return e[0]*t+e[1]*n+e[2]*r+e[3]*s}noise(e,t){let n,r,s;const a=(e+t)*(.5*(Math.sqrt(3)-1)),l=Math.floor(e+a),h=Math.floor(t+a),f=(3-Math.sqrt(3))/6,m=(l+h)*f,y=e-(l-m),b=t-(h-m);let T,S;y>b?(T=1,S=0):(T=0,S=1);const C=y-T+f,R=b-S+f,I=y-1+2*f,L=b-1+2*f,N=255&l,U=255&h,z=this.perm[N+T+this.perm[U+S]]%12,K=this.perm[N+1+this.perm[U+1]]%12;let te=.5-y*y-b*b;te<0?n=0:(te*=te,n=te*te*this.dot(this.grad3[this.perm[N+this.perm[U]]%12],y,b));let fe=.5-C*C-R*R;fe<0?r=0:(fe*=fe,r=fe*fe*this.dot(this.grad3[z],C,R));let ie=.5-I*I-L*L;return ie<0?s=0:(ie*=ie,s=ie*ie*this.dot(this.grad3[K],I,L)),70*(n+r+s)}noise3d(e,t,n){let r,s,o,a;const h=.3333333333333333*(e+t+n),f=Math.floor(e+h),m=Math.floor(t+h),g=Math.floor(n+h),v=1/6,y=(f+m+g)*v,C=e-(f-y),R=t-(m-y),I=n-(g-y);let L,N,U,k,z,K;C>=R?R>=I?(L=1,N=0,U=0,k=1,z=1,K=0):C>=I?(L=1,N=0,U=0,k=1,z=0,K=1):(L=0,N=0,U=1,k=1,z=0,K=1):R<I?(L=0,N=0,U=1,k=0,z=1,K=1):C<I?(L=0,N=1,U=0,k=0,z=1,K=1):(L=0,N=1,U=0,k=1,z=1,K=0);const te=C-L+v,fe=R-N+v,ie=I-U+v,ne=C-k+2*v,le=R-z+2*v,Z=I-K+2*v,he=C-1+.5,me=R-1+.5,ce=I-1+.5,be=255&f,Ge=255&m,Ee=255&g,it=this.perm[be+L+this.perm[Ge+N+this.perm[Ee+U]]]%12,Gt=this.perm[be+k+this.perm[Ge+z+this.perm[Ee+K]]]%12,Ve=this.perm[be+1+this.perm[Ge+1+this.perm[Ee+1]]]%12;let Ie=.6-C*C-R*R-I*I;Ie<0?r=0:(Ie*=Ie,r=Ie*Ie*this.dot3(this.grad3[this.perm[be+this.perm[Ge+this.perm[Ee]]]%12],C,R,I));let pt=.6-te*te-fe*fe-ie*ie;pt<0?s=0:(pt*=pt,s=pt*pt*this.dot3(this.grad3[it],te,fe,ie));let Wt=.6-ne*ne-le*le-Z*Z;Wt<0?o=0:(Wt*=Wt,o=Wt*Wt*this.dot3(this.grad3[Gt],ne,le,Z));let It=.6-he*he-me*me-ce*ce;return It<0?a=0:(It*=It,a=It*It*this.dot3(this.grad3[Ve],he,me,ce)),32*(r+s+o+a)}noise4d(e,t,n,r){const s=this.grad4,o=this.simplex,a=this.perm,l=(Math.sqrt(5)-1)/4,h=(5-Math.sqrt(5))/20;let f,m,g,v,y;const b=(e+t+n+r)*l,T=Math.floor(e+b),S=Math.floor(t+b),C=Math.floor(n+b),R=Math.floor(r+b),I=(T+S+C+R)*h,z=e-(T-I),K=t-(S-I),te=n-(C-I),fe=r-(R-I),ce=(z>K?32:0)+(z>te?16:0)+(K>te?8:0)+(z>fe?4:0)+(K>fe?2:0)+(te>fe?1:0),be=o[ce][0]>=3?1:0,Ge=o[ce][1]>=3?1:0,Ee=o[ce][2]>=3?1:0,mt=o[ce][3]>=3?1:0,it=o[ce][0]>=2?1:0,Gt=o[ce][1]>=2?1:0,Ve=o[ce][2]>=2?1:0,Ie=o[ce][3]>=2?1:0,pt=o[ce][0]>=1?1:0,Wt=o[ce][1]>=1?1:0,It=o[ce][2]>=1?1:0,wn=o[ce][3]>=1?1:0,ft=z-be+h,vt=K-Ge+h,Bt=te-Ee+h,Mn=fe-mt+h,dn=z-it+2*h,pi=K-Gt+2*h,ni=te-Ve+2*h,Kn=fe-Ie+2*h,ir=z-pt+3*h,Yi=K-Wt+3*h,_e=te-It+3*h,oe=fe-wn+3*h,ht=z-1+4*h,Zt=K-1+4*h,tn=te-1+4*h,gn=fe-1+4*h,$n=255&T,ue=255&S,Ft=255&C,Qt=255&R,pn=a[$n+be+a[ue+Ge+a[Ft+Ee+a[Qt+mt]]]]%32,Vn=a[$n+it+a[ue+Gt+a[Ft+Ve+a[Qt+Ie]]]]%32,ki=a[$n+pt+a[ue+Wt+a[Ft+It+a[Qt+wn]]]]%32,cr=a[$n+1+a[ue+1+a[Ft+1+a[Qt+1]]]]%32;let Pe=.6-z*z-K*K-te*te-fe*fe;Pe<0?f=0:(Pe*=Pe,f=Pe*Pe*this.dot4(s[a[$n+a[ue+a[Ft+a[Qt]]]]%32],z,K,te,fe));let Yt=.6-ft*ft-vt*vt-Bt*Bt-Mn*Mn;Yt<0?m=0:(Yt*=Yt,m=Yt*Yt*this.dot4(s[pn],ft,vt,Bt,Mn));let bt=.6-dn*dn-pi*pi-ni*ni-Kn*Kn;bt<0?g=0:(bt*=bt,g=bt*bt*this.dot4(s[Vn],dn,pi,ni,Kn));let lt=.6-ir*ir-Yi*Yi-_e*_e-oe*oe;lt<0?v=0:(lt*=lt,v=lt*lt*this.dot4(s[ki],ir,Yi,_e,oe));let mn=.6-ht*ht-Zt*Zt-tn*tn-gn*gn;return mn<0?y=0:(mn*=mn,y=mn*mn*this.dot4(s[cr],ht,Zt,tn,gn)),27*(f+m+g+v+y)}}class zs extends Di{constructor(e={}){super(),this.isLightningStrike=!0,this.type="LightningStrike",this.init(zs.copyParameters(e,e)),this.createMesh()}static createRandomGenerator(){const t=[];for(let r=0;r<2053;r++)t.push(Math.random());const n={currentSeed:0,random:function(){const r=t[n.currentSeed];return n.currentSeed=(n.currentSeed+1)%2053,r},getSeed:function(){return n.currentSeed/2053},setSeed:function(r){n.currentSeed=Math.floor(2053*r)%2053}};return n}static copyParameters(e={},t={}){const n=function(r){return t===e?r:r.clone()};return e.sourceOffset=void 0!==t.sourceOffset?n(t.sourceOffset):new Q(0,100,0),e.destOffset=void 0!==t.destOffset?n(t.destOffset):new Q(0,0,0),e.timeScale=void 0!==t.timeScale?t.timeScale:1,e.roughness=void 0!==t.roughness?t.roughness:.9,e.straightness=void 0!==t.straightness?t.straightness:.7,e.up0=void 0!==t.up0?n(t.up0):new Q(0,0,1),e.up1=void 0!==t.up1?n(t.up1):new Q(0,0,1),e.radius0=void 0!==t.radius0?t.radius0:1,e.radius1=void 0!==t.radius1?t.radius1:1,e.radius0Factor=void 0!==t.radius0Factor?t.radius0Factor:.5,e.radius1Factor=void 0!==t.radius1Factor?t.radius1Factor:.2,e.minRadius=void 0!==t.minRadius?t.minRadius:.2,e.isEternal=void 0!==t.isEternal?t.isEternal:void 0===t.birthTime||void 0===t.deathTime,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.propagationTimeFactor=void 0!==t.propagationTimeFactor?t.propagationTimeFactor:.1,e.vanishingTimeFactor=void 0!==t.vanishingTimeFactor?t.vanishingTimeFactor:.9,e.subrayPeriod=void 0!==t.subrayPeriod?t.subrayPeriod:4,e.subrayDutyCycle=void 0!==t.subrayDutyCycle?t.subrayDutyCycle:.6,e.maxIterations=void 0!==t.maxIterations?t.maxIterations:9,e.isStatic=void 0!==t.isStatic&&t.isStatic,e.ramification=void 0!==t.ramification?t.ramification:5,e.maxSubrayRecursion=void 0!==t.maxSubrayRecursion?t.maxSubrayRecursion:3,e.recursionProbability=void 0!==t.recursionProbability?t.recursionProbability:.6,e.generateUVs=void 0!==t.generateUVs&&t.generateUVs,e.randomGenerator=t.randomGenerator,e.noiseSeed=t.noiseSeed,e.onDecideSubrayCreation=t.onDecideSubrayCreation,e.onSubrayCreation=t.onSubrayCreation,e}update(e){this.isStatic||(this.rayParameters.isEternal||this.rayParameters.birthTime<=e&&e<=this.rayParameters.deathTime?(this.updateMesh(e),this.state=e<this.subrays[0].endPropagationTime?zs.RAY_PROPAGATING:e>this.subrays[0].beginVanishingTime?zs.RAY_VANISHING:zs.RAY_STEADY,this.visible=!0):(this.visible=!1,this.state=e<this.rayParameters.birthTime?zs.RAY_UNBORN:zs.RAY_EXTINGUISHED))}init(e){this.rayParameters=e,this.maxIterations=void 0!==e.maxIterations?Math.floor(e.maxIterations):9,e.maxIterations=this.maxIterations,this.isStatic=void 0!==e.isStatic&&e.isStatic,e.isStatic=this.isStatic,this.ramification=void 0!==e.ramification?Math.floor(e.ramification):5,e.ramification=this.ramification,this.maxSubrayRecursion=void 0!==e.maxSubrayRecursion?Math.floor(e.maxSubrayRecursion):3,e.maxSubrayRecursion=this.maxSubrayRecursion,this.recursionProbability=void 0!==e.recursionProbability?e.recursionProbability:.6,e.recursionProbability=this.recursionProbability,this.generateUVs=void 0!==e.generateUVs&&e.generateUVs,e.generateUVs=this.generateUVs,void 0!==e.randomGenerator?(this.randomGenerator=e.randomGenerator,this.seedGenerator=e.randomGenerator,void 0!==e.noiseSeed&&this.seedGenerator.setSeed(e.noiseSeed)):(this.randomGenerator=zs.createRandomGenerator(),this.seedGenerator=Math),void 0!==e.onDecideSubrayCreation?this.onDecideSubrayCreation=e.onDecideSubrayCreation:(this.createDefaultSubrayCreationCallbacks(),void 0!==e.onSubrayCreation&&(this.onSubrayCreation=e.onSubrayCreation)),this.state=zs.RAY_INITIALIZED,this.maxSubrays=Math.ceil(1+Math.pow(this.ramification,Math.max(0,this.maxSubrayRecursion-1))),e.maxSubrays=this.maxSubrays,this.maxRaySegments=2*(1<<this.maxIterations),this.subrays=[];for(let t=0;t<this.maxSubrays;t++)this.subrays.push(this.createSubray());this.raySegments=[];for(let t=0;t<this.maxRaySegments;t++)this.raySegments.push(this.createSegment());this.time=0,this.timeFraction=0,this.currentSegmentCallback=null,this.currentCreateTriangleVertices=this.generateUVs?this.createTriangleVerticesWithUVs:this.createTriangleVerticesWithoutUVs,this.numSubrays=0,this.currentSubray=null,this.currentSegmentIndex=0,this.isInitialSegment=!1,this.subrayProbability=0,this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.vertices=null,this.uvs=null,this.indices=null,this.positionAttribute=null,this.uvsAttribute=null,this.simplexX=new OV(this.seedGenerator),this.simplexY=new OV(this.seedGenerator),this.simplexZ=new OV(this.seedGenerator),this.forwards=new Q,this.forwardsFill=new Q,this.side=new Q,this.down=new Q,this.middlePos=new Q,this.middleLinPos=new Q,this.newPos=new Q,this.vPos=new Q,this.cross1=new Q}createMesh(){const e=1<<this.maxIterations,t=3*(e+1)*this.maxSubrays,n=18*e*this.maxSubrays;this.vertices=new Float32Array(3*t),this.indices=new Uint32Array(n),this.generateUVs&&(this.uvs=new Float32Array(2*t)),this.fillMesh(0),this.setIndex(new $j(this.indices,1)),this.positionAttribute=new On(this.vertices,3),this.setAttribute("position",this.positionAttribute),this.generateUVs&&(this.uvsAttribute=new On(new Float32Array(this.uvs),2),this.setAttribute("uv",this.uvsAttribute)),this.isStatic||(this.index.usage=35048,this.positionAttribute.usage=35048,this.generateUVs&&(this.uvsAttribute.usage=35048)),this.vertices=this.positionAttribute.array,this.indices=this.index.array,this.generateUVs&&(this.uvs=this.uvsAttribute.array)}updateMesh(e){this.fillMesh(e),this.drawRange.count=this.currentIndex,this.index.needsUpdate=!0,this.positionAttribute.needsUpdate=!0,this.generateUVs&&(this.uvsAttribute.needsUpdate=!0)}fillMesh(e){const t=this;this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.fractalRay(e,function(r){const s=t.currentSubray;e<s.birthTime||(this.rayParameters.isEternal&&0==t.currentSubray.recursion?(t.createPrism(r),t.onDecideSubrayCreation(r,t)):e<s.endPropagationTime?t.timeFraction>=r.fraction0*s.propagationTimeFactor&&(t.createPrism(r),t.onDecideSubrayCreation(r,t)):e<s.beginVanishingTime?(t.createPrism(r),t.onDecideSubrayCreation(r,t)):(t.timeFraction<=s.vanishingTimeFactor+r.fraction1*(1-s.vanishingTimeFactor)&&t.createPrism(r),t.onDecideSubrayCreation(r,t)))})}addNewSubray(){return this.subrays[this.numSubrays++]}initSubray(e,t){e.pos0.copy(t.sourceOffset),e.pos1.copy(t.destOffset),e.up0.copy(t.up0),e.up1.copy(t.up1),e.radius0=t.radius0,e.radius1=t.radius1,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.timeScale=t.timeScale,e.roughness=t.roughness,e.straightness=t.straightness,e.propagationTimeFactor=t.propagationTimeFactor,e.vanishingTimeFactor=t.vanishingTimeFactor,e.maxIterations=this.maxIterations,e.seed=void 0!==t.noiseSeed?t.noiseSeed:0,e.recursion=0}fractalRay(e,t){this.time=e,this.currentSegmentCallback=t,this.numSubrays=0,this.initSubray(this.addNewSubray(),this.rayParameters);for(let n=0;n<this.numSubrays;n++){const r=this.subrays[n];this.currentSubray=r,this.randomGenerator.setSeed(r.seed),r.endPropagationTime=HP.lerp(r.birthTime,r.deathTime,r.propagationTimeFactor),r.beginVanishingTime=HP.lerp(r.deathTime,r.birthTime,1-r.vanishingTimeFactor);const s=this.randomGenerator.random;r.linPos0.set(s(),s(),s()).multiplyScalar(1e3),r.linPos1.set(s(),s(),s()).multiplyScalar(1e3),this.timeFraction=(e-r.birthTime)/(r.deathTime-r.birthTime),this.currentSegmentIndex=0,this.isInitialSegment=!0;const o=this.getNewSegment();o.iteration=0,o.pos0.copy(r.pos0),o.pos1.copy(r.pos1),o.linPos0.copy(r.linPos0),o.linPos1.copy(r.linPos1),o.up0.copy(r.up0),o.up1.copy(r.up1),o.radius0=r.radius0,o.radius1=r.radius1,o.fraction0=0,o.fraction1=1,o.positionVariationFactor=1-r.straightness,this.subrayProbability=this.ramification*Math.pow(this.recursionProbability,r.recursion)/(1<<r.maxIterations),this.fractalRayRecursive(o)}this.currentSegmentCallback=null,this.currentSubray=null}fractalRayRecursive(e){if(e.iteration>=this.currentSubray.maxIterations)return void this.currentSegmentCallback(e);this.forwards.subVectors(e.pos1,e.pos0);let t=this.forwards.length();t<1e-6&&(this.forwards.set(0,0,.01),t=this.forwards.length());const n=.5*(e.radius0+e.radius1),r=.5*(e.fraction0+e.fraction1),s=this.time*this.currentSubray.timeScale*Math.pow(2,e.iteration);this.middlePos.lerpVectors(e.pos0,e.pos1,.5),this.middleLinPos.lerpVectors(e.linPos0,e.linPos1,.5);const o=this.middleLinPos;this.newPos.set(this.simplexX.noise4d(o.x,o.y,o.z,s),this.simplexY.noise4d(o.x,o.y,o.z,s),this.simplexZ.noise4d(o.x,o.y,o.z,s)),this.newPos.multiplyScalar(e.positionVariationFactor*t),this.newPos.add(this.middlePos);const a=this.getNewSegment();a.pos0.copy(e.pos0),a.pos1.copy(this.newPos),a.linPos0.copy(e.linPos0),a.linPos1.copy(this.middleLinPos),a.up0.copy(e.up0),a.up1.copy(e.up1),a.radius0=e.radius0,a.radius1=n,a.fraction0=e.fraction0,a.fraction1=r,a.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,a.iteration=e.iteration+1;const l=this.getNewSegment();l.pos0.copy(this.newPos),l.pos1.copy(e.pos1),l.linPos0.copy(this.middleLinPos),l.linPos1.copy(e.linPos1),this.cross1.crossVectors(e.up0,this.forwards.normalize()),l.up0.crossVectors(this.forwards,this.cross1).normalize(),l.up1.copy(e.up1),l.radius0=n,l.radius1=e.radius1,l.fraction0=r,l.fraction1=e.fraction1,l.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,l.iteration=e.iteration+1,this.fractalRayRecursive(a),this.fractalRayRecursive(l)}createPrism(e){this.forwardsFill.subVectors(e.pos1,e.pos0).normalize(),this.isInitialSegment&&(this.currentCreateTriangleVertices(e.pos0,e.up0,this.forwardsFill,e.radius0,0),this.isInitialSegment=!1),this.currentCreateTriangleVertices(e.pos1,e.up0,this.forwardsFill,e.radius1,e.fraction1),this.createPrismFaces()}createTriangleVerticesWithoutUVs(e,t,n,r){this.side.crossVectors(t,n).multiplyScalar(r*zs.COS30DEG),this.down.copy(t).multiplyScalar(-r*zs.SIN30DEG);const s=this.vPos,o=this.vertices;s.copy(e).sub(this.side).add(this.down),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,s.copy(e).add(this.side).add(this.down),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,s.copy(t).multiplyScalar(r).add(e),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,this.currentVertex+=3}createTriangleVerticesWithUVs(e,t,n,r,s){this.side.crossVectors(t,n).multiplyScalar(r*zs.COS30DEG),this.down.copy(t).multiplyScalar(-r*zs.SIN30DEG);const o=this.vPos,a=this.vertices,l=this.uvs;o.copy(e).sub(this.side).add(this.down),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=0,o.copy(e).add(this.side).add(this.down),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=.5,o.copy(t).multiplyScalar(r).add(e),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=1,this.currentVertex+=3}createPrismFaces(e){const t=this.indices;e=this.currentVertex-6,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+5,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+5,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+5}createDefaultSubrayCreationCallbacks(){const e=this.randomGenerator.random;this.onDecideSubrayCreation=function(o,a){const l=a.currentSubray,h=a.rayParameters.subrayPeriod,f=a.rayParameters.subrayDutyCycle,m=a.rayParameters.isEternal&&0==l.recursion?-e()*h:HP.lerp(l.birthTime,l.endPropagationTime,o.fraction0)-e()*h,g=a.time-m,v=Math.floor(g/h),y=e()*(v+1);let T=0;if(g%h<=f*h&&(T=a.subrayProbability),l.recursion<a.maxSubrayRecursion&&a.numSubrays<a.maxSubrays&&e()<T){const S=a.addNewSubray(),C=a.randomGenerator.getSeed();S.seed=y,a.randomGenerator.setSeed(y),S.recursion=l.recursion+1,S.maxIterations=Math.max(1,l.maxIterations-1),S.linPos0.set(e(),e(),e()).multiplyScalar(1e3),S.linPos1.set(e(),e(),e()).multiplyScalar(1e3),S.up0.copy(l.up0),S.up1.copy(l.up1),S.radius0=o.radius0*a.rayParameters.radius0Factor,S.radius1=Math.min(a.rayParameters.minRadius,o.radius1*a.rayParameters.radius1Factor),S.birthTime=m+v*h,S.deathTime=S.birthTime+h*f,!a.rayParameters.isEternal&&0==l.recursion&&(S.birthTime=Math.max(S.birthTime,l.birthTime),S.deathTime=Math.min(S.deathTime,l.deathTime)),S.timeScale=2*l.timeScale,S.roughness=l.roughness,S.straightness=l.straightness,S.propagationTimeFactor=l.propagationTimeFactor,S.vanishingTimeFactor=l.vanishingTimeFactor,a.onSubrayCreation(o,l,S,a),a.randomGenerator.setSeed(C)}};const t=new Q,n=new Q,r=new Q,s=new Q;this.onSubrayCreation=function(o,a,l,h){h.subrayCylinderPosition(o,a,l,.5,.6,.2)},this.subrayConePosition=function(o,a,l,h,f,m){l.pos0.copy(o.pos0),t.subVectors(a.pos1,a.pos0),n.copy(t).normalize(),t.multiplyScalar(o.fraction0+(1-o.fraction0)*(e()*h));const g=t.length();r.crossVectors(a.up0,n);const v=2*Math.PI*e();r.multiplyScalar(Math.cos(v)),s.copy(a.up0).multiplyScalar(Math.sin(v)),l.pos1.copy(r).add(s).multiplyScalar(g*f*(m+e()*(1-m))).add(t).add(a.pos0)},this.subrayCylinderPosition=function(o,a,l,h,f,m){l.pos0.copy(o.pos0),t.subVectors(a.pos1,a.pos0),n.copy(t).normalize(),t.multiplyScalar(o.fraction0+(1-o.fraction0)*((2*e()-1)*h));const g=t.length();r.crossVectors(a.up0,n);const v=2*Math.PI*e();r.multiplyScalar(Math.cos(v)),s.copy(a.up0).multiplyScalar(Math.sin(v)),l.pos1.copy(r).add(s).multiplyScalar(g*f*(m+e()*(1-m))).add(t).add(a.pos0)}}createSubray(){return{seed:0,maxIterations:0,recursion:0,pos0:new Q,pos1:new Q,linPos0:new Q,linPos1:new Q,up0:new Q,up1:new Q,radius0:0,radius1:0,birthTime:0,deathTime:0,timeScale:0,roughness:0,straightness:0,propagationTimeFactor:0,vanishingTimeFactor:0,endPropagationTime:0,beginVanishingTime:0}}createSegment(){return{iteration:0,pos0:new Q,pos1:new Q,linPos0:new Q,linPos1:new Q,up0:new Q,up1:new Q,radius0:0,radius1:0,fraction0:0,fraction1:0,positionVariationFactor:0}}getNewSegment(){return this.raySegments[this.currentSegmentIndex++]}copy(e){return super.copy(e),this.init(zs.copyParameters({},e.rayParameters)),this}clone(){return new this.constructor(zs.copyParameters({},this.rayParameters))}}zs.RAY_INITIALIZED=0,zs.RAY_UNBORN=1,zs.RAY_PROPAGATING=2,zs.RAY_STEADY=3,zs.RAY_VANISHING=4,zs.RAY_EXTINGUISHED=5,zs.COS30DEG=Math.cos(30*Math.PI/180),zs.SIN30DEG=Math.sin(30*Math.PI/180);const Y7={type:"change"},kV={type:"start"},K7={type:"end"};class X7 extends G0{constructor(e,t){super(),void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Q,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(ue){ue.addEventListener("keydown",Yi),this._domElementKeyEvents=ue},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(Y7),n.update(),s=r.NONE},this.update=function(){const ue=new Q,Ft=(new sa).setFromUnitVectors(e.up,new Q(0,1,0)),Qt=Ft.clone().invert(),xn=new Q,pn=new sa,Vn=2*Math.PI;return function(){const cr=n.object.position;ue.copy(cr).sub(n.target),ue.applyQuaternion(Ft),a.setFromVector3(ue),n.autoRotate&&s===r.NONE&&z(function U(){return 2*Math.PI/60/60*n.autoRotateSpeed}()),n.enableDamping?(a.theta+=l.theta*n.dampingFactor,a.phi+=l.phi*n.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let Pe=n.minAzimuthAngle,Yt=n.maxAzimuthAngle;return isFinite(Pe)&&isFinite(Yt)&&(Pe<-Math.PI?Pe+=Vn:Pe>Math.PI&&(Pe-=Vn),Yt<-Math.PI?Yt+=Vn:Yt>Math.PI&&(Yt-=Vn),a.theta=Pe<=Yt?Math.max(Pe,Math.min(Yt,a.theta)):a.theta>(Pe+Yt)/2?Math.max(Pe,a.theta):Math.min(Yt,a.theta)),a.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=h,a.radius=Math.max(n.minDistance,Math.min(n.maxDistance,a.radius)),!0===n.enableDamping?n.target.addScaledVector(f,n.dampingFactor):n.target.add(f),ue.setFromSpherical(a),ue.applyQuaternion(Qt),cr.copy(n.target).add(ue),n.object.lookAt(n.target),!0===n.enableDamping?(l.theta*=1-n.dampingFactor,l.phi*=1-n.dampingFactor,f.multiplyScalar(1-n.dampingFactor)):(l.set(0,0,0),f.set(0,0,0)),h=1,!!(m||xn.distanceToSquared(n.object.position)>o||8*(1-pn.dot(n.object.quaternion))>o)&&(n.dispatchEvent(Y7),xn.copy(n.object.position),pn.copy(n.object.quaternion),m=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",ht),n.domElement.removeEventListener("pointerdown",Bt),n.domElement.removeEventListener("pointercancel",pi),n.domElement.removeEventListener("wheel",ir),n.domElement.removeEventListener("pointermove",Mn),n.domElement.removeEventListener("pointerup",dn),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",Yi)};const n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new GU,l=new GU;let h=1;const f=new Q;let m=!1;const g=new Je,v=new Je,y=new Je,b=new Je,T=new Je,S=new Je,C=new Je,R=new Je,I=new Je,L=[],N={};function k(){return Math.pow(.95,n.zoomSpeed)}function z(ue){l.theta-=ue}function K(ue){l.phi-=ue}const te=function(){const ue=new Q;return function(Qt,xn){ue.setFromMatrixColumn(xn,0),ue.multiplyScalar(-Qt),f.add(ue)}}(),fe=function(){const ue=new Q;return function(Qt,xn){!0===n.screenSpacePanning?ue.setFromMatrixColumn(xn,1):(ue.setFromMatrixColumn(xn,0),ue.crossVectors(n.object.up,ue)),ue.multiplyScalar(Qt),f.add(ue)}}(),ie=function(){const ue=new Q;return function(Qt,xn){const pn=n.domElement;if(n.object.isPerspectiveCamera){ue.copy(n.object.position).sub(n.target);let ki=ue.length();ki*=Math.tan(n.object.fov/2*Math.PI/180),te(2*Qt*ki/pn.clientHeight,n.object.matrix),fe(2*xn*ki/pn.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(te(Qt*(n.object.right-n.object.left)/n.object.zoom/pn.clientWidth,n.object.matrix),fe(xn*(n.object.top-n.object.bottom)/n.object.zoom/pn.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function ne(ue){n.object.isPerspectiveCamera?h/=ue:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*ue)),n.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function le(ue){n.object.isPerspectiveCamera?h*=ue:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/ue)),n.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Z(ue){g.set(ue.clientX,ue.clientY)}function me(ue){b.set(ue.clientX,ue.clientY)}function it(){1===L.length?g.set(L[0].pageX,L[0].pageY):g.set(.5*(L[0].pageX+L[1].pageX),.5*(L[0].pageY+L[1].pageY))}function Gt(){1===L.length?b.set(L[0].pageX,L[0].pageY):b.set(.5*(L[0].pageX+L[1].pageX),.5*(L[0].pageY+L[1].pageY))}function Ve(){const ue=L[0].pageX-L[1].pageX,Ft=L[0].pageY-L[1].pageY,Qt=Math.sqrt(ue*ue+Ft*Ft);C.set(0,Qt)}function Wt(ue){if(1==L.length)v.set(ue.pageX,ue.pageY);else{const Qt=$n(ue);v.set(.5*(ue.pageX+Qt.x),.5*(ue.pageY+Qt.y))}y.subVectors(v,g).multiplyScalar(n.rotateSpeed);const Ft=n.domElement;z(2*Math.PI*y.x/Ft.clientHeight),K(2*Math.PI*y.y/Ft.clientHeight),g.copy(v)}function It(ue){if(1===L.length)T.set(ue.pageX,ue.pageY);else{const Ft=$n(ue);T.set(.5*(ue.pageX+Ft.x),.5*(ue.pageY+Ft.y))}S.subVectors(T,b).multiplyScalar(n.panSpeed),ie(S.x,S.y),b.copy(T)}function wn(ue){const Ft=$n(ue),Qt=ue.pageX-Ft.x,xn=ue.pageY-Ft.y,pn=Math.sqrt(Qt*Qt+xn*xn);R.set(0,pn),I.set(0,Math.pow(R.y/C.y,n.zoomSpeed)),ne(I.y),C.copy(R)}function Bt(ue){!1!==n.enabled&&(0===L.length&&(n.domElement.setPointerCapture(ue.pointerId),n.domElement.addEventListener("pointermove",Mn),n.domElement.addEventListener("pointerup",dn)),function Zt(ue){L.push(ue)}(ue),"touch"===ue.pointerType?function _e(ue){switch(gn(ue),L.length){case 1:switch(n.touches.ONE){case 0:if(!1===n.enableRotate)return;it(),s=r.TOUCH_ROTATE;break;case 1:if(!1===n.enablePan)return;Gt(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(n.touches.TWO){case 2:if(!1===n.enableZoom&&!1===n.enablePan)return;(function Ie(){n.enableZoom&&Ve(),n.enablePan&&Gt()})(),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function pt(){n.enableZoom&&Ve(),n.enableRotate&&it()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(kV)}(ue):function ni(ue){let Ft;switch(ue.button){case 0:Ft=n.mouseButtons.LEFT;break;case 1:Ft=n.mouseButtons.MIDDLE;break;case 2:Ft=n.mouseButtons.RIGHT;break;default:Ft=-1}switch(Ft){case 1:if(!1===n.enableZoom)return;(function he(ue){C.set(ue.clientX,ue.clientY)})(ue),s=r.DOLLY;break;case 0:if(ue.ctrlKey||ue.metaKey||ue.shiftKey){if(!1===n.enablePan)return;me(ue),s=r.PAN}else{if(!1===n.enableRotate)return;Z(ue),s=r.ROTATE}break;case 2:if(ue.ctrlKey||ue.metaKey||ue.shiftKey){if(!1===n.enableRotate)return;Z(ue),s=r.ROTATE}else{if(!1===n.enablePan)return;me(ue),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(kV)}(ue))}function Mn(ue){!1!==n.enabled&&("touch"===ue.pointerType?function oe(ue){switch(gn(ue),s){case r.TOUCH_ROTATE:if(!1===n.enableRotate)return;Wt(ue),n.update();break;case r.TOUCH_PAN:if(!1===n.enablePan)return;It(ue),n.update();break;case r.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function ft(ue){n.enableZoom&&wn(ue),n.enablePan&&It(ue)})(ue),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function vt(ue){n.enableZoom&&wn(ue),n.enableRotate&&Wt(ue)})(ue),n.update();break;default:s=r.NONE}}(ue):function Kn(ue){switch(s){case r.ROTATE:if(!1===n.enableRotate)return;!function ce(ue){v.set(ue.clientX,ue.clientY),y.subVectors(v,g).multiplyScalar(n.rotateSpeed);const Ft=n.domElement;z(2*Math.PI*y.x/Ft.clientHeight),K(2*Math.PI*y.y/Ft.clientHeight),g.copy(v),n.update()}(ue);break;case r.DOLLY:if(!1===n.enableZoom)return;!function be(ue){R.set(ue.clientX,ue.clientY),I.subVectors(R,C),I.y>0?ne(k()):I.y<0&&le(k()),C.copy(R),n.update()}(ue);break;case r.PAN:if(!1===n.enablePan)return;!function Ge(ue){T.set(ue.clientX,ue.clientY),S.subVectors(T,b).multiplyScalar(n.panSpeed),ie(S.x,S.y),b.copy(T),n.update()}(ue)}}(ue))}function dn(ue){tn(ue),0===L.length&&(n.domElement.releasePointerCapture(ue.pointerId),n.domElement.removeEventListener("pointermove",Mn),n.domElement.removeEventListener("pointerup",dn)),n.dispatchEvent(K7),s=r.NONE}function pi(ue){tn(ue)}function ir(ue){!1===n.enabled||!1===n.enableZoom||s!==r.NONE||(ue.preventDefault(),n.dispatchEvent(kV),function Ee(ue){ue.deltaY<0?le(k()):ue.deltaY>0&&ne(k()),n.update()}(ue),n.dispatchEvent(K7))}function Yi(ue){!1===n.enabled||!1===n.enablePan||function mt(ue){let Ft=!1;switch(ue.code){case n.keys.UP:ie(0,n.keyPanSpeed),Ft=!0;break;case n.keys.BOTTOM:ie(0,-n.keyPanSpeed),Ft=!0;break;case n.keys.LEFT:ie(n.keyPanSpeed,0),Ft=!0;break;case n.keys.RIGHT:ie(-n.keyPanSpeed,0),Ft=!0}Ft&&(ue.preventDefault(),n.update())}(ue)}function ht(ue){!1!==n.enabled&&ue.preventDefault()}function tn(ue){delete N[ue.pointerId];for(let Ft=0;Ft<L.length;Ft++)if(L[Ft].pointerId==ue.pointerId)return void L.splice(Ft,1)}function gn(ue){let Ft=N[ue.pointerId];void 0===Ft&&(Ft=new Je,N[ue.pointerId]=Ft),Ft.set(ue.pageX,ue.pageY)}function $n(ue){return N[(ue.pointerId===L[0].pointerId?L[1]:L[0]).pointerId]}n.domElement.addEventListener("contextmenu",ht),n.domElement.addEventListener("pointerdown",Bt),n.domElement.addEventListener("pointercancel",pi),n.domElement.addEventListener("wheel",ir,{passive:!1}),this.update()}}class nge extends X7{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=2,this.mouseButtons.RIGHT=0,this.touches.ONE=1,this.touches.TWO=3}}class pb extends TV{constructor(e,t,n,r){super(),this.renderScene=t,this.renderCamera=n,this.selectedObjects=void 0!==r?r:[],this.visibleEdgeColor=new sn(1,1,1),this.hiddenEdgeColor=new sn(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this.resolution=void 0!==e?new Je(e.x,e.y):new Je(256,256);const s=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new ra(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new dU,this.depthMaterial.side=2,this.depthMaterial.depthPacking=3201,this.depthMaterial.blending=0,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=2,this.prepareMaskMaterial.fragmentShader=function f(m,g){return m.replace(/DEPTH_TO_VIEW_Z/g,(g.isPerspectiveCamera?"perspective":"orthographic")+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new ra(this.resolution.x,this.resolution.y),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new ra(s,o),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new ra(s,o),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new ra(Math.round(s/2),Math.round(o/2)),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new ra(s,o),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new ra(Math.round(s/2),Math.round(o/2)),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1,this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value.set(s,o),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(s/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===bL&&console.error("THREE.OutlinePass relies on CopyShader");const h=bL;this.copyUniforms=cw.clone(h.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new la({uniforms:this.copyUniforms,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,blending:0,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new sn,this.oldClearAlpha=1,this.fsQuad=new MV(null),this.tempPulseColor1=new sn,this.tempPulseColor2=new sn,this.textureMatrix=new Jn}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let n=Math.round(e/this.downSampleRatio),r=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(n,r),this.renderTargetBlurBuffer1.setSize(n,r),this.renderTargetEdgeBuffer1.setSize(n,r),this.separableBlurMaterial1.uniforms.texSize.value.set(n,r),n=Math.round(n/2),r=Math.round(r/2),this.renderTargetBlurBuffer2.setSize(n,r),this.renderTargetEdgeBuffer2.setSize(n,r),this.separableBlurMaterial2.uniforms.texSize.value.set(n,r)}changeVisibilityOfSelectedObjects(e){const t=this._visibilityCache;function n(r){r.isMesh&&(!0===e?r.visible=t.get(r):(t.set(r,r.visible),r.visible=e))}for(let r=0;r<this.selectedObjects.length;r++)this.selectedObjects[r].traverse(n)}changeVisibilityOfNonSelectedObjects(e){const t=this._visibilityCache,n=[];function r(o){o.isMesh&&n.push(o)}for(let o=0;o<this.selectedObjects.length;o++)this.selectedObjects[o].traverse(r);this.renderScene.traverse(function s(o){if(o.isMesh||o.isSprite){let a=!1;for(let l=0;l<n.length;l++)if(n[l].id===o.id){a=!0;break}if(!1===a){const l=o.visible;(!1===e||!0===t.get(o))&&(o.visible=e),t.set(o,l)}}else(o.isPoints||o.isLine)&&(!0===e?o.visible=t.get(o):(t.set(o,o.visible),o.visible=e))})}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,n,r,s){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,s&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);const a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this.renderScene.background=a,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){const l=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(l),this.tempPulseColor2.multiplyScalar(l)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=pb.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=pb.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=pb.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=pb.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(n),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=n.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new la({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new Je(.5,.5)},textureMatrix:{value:null}},vertexShader:"#include <morphtarget_pars_vertex>\n\t\t\t\t#include <skinning_pars_vertex>\n\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tuniform mat4 textureMatrix;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <morphtarget_vertex>\n\t\t\t\t\t#include <skinning_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t\tvPosition = mvPosition;\n\t\t\t\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t\t\t\t\tprojTexCoord = textureMatrix * worldPosition;\n\n\t\t\t\t}",fragmentShader:"#include <packing>\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tuniform sampler2D depthTexture;\n\t\t\t\tuniform vec2 cameraNearFar;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));\n\t\t\t\t\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );\n\t\t\t\t\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;\n\t\t\t\t\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);\n\n\t\t\t\t}"})}getEdgeDetectionMaterial(){return new la({uniforms:{maskTexture:{value:null},texSize:{value:new Je(.5,.5)},visibleEdgeColor:{value:new Q(1,1,1)},hiddenEdgeColor:{value:new Q(1,1,1)}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec3 visibleEdgeColor;\n\t\t\t\tuniform vec3 hiddenEdgeColor;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\n\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\n\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\n\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\n\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\n\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\n\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\n\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\n\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\n\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\n\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\n\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\n\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\n\t\t\t\t}"})}getSeperableBlurMaterial(e){return new la({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new Je(.5,.5)},direction:{value:new Je(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float kernelRadius;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat sigma = kernelRadius/2.0;\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, sigma);\n\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\n\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\n\t\t\t\t\tvec2 uvOffset = delta;\n\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = kernelRadius * float(i) / float(MAX_RADIUS);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, sigma);\n\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\n\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\n\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\n\t\t\t\t\t\tweightSum += (2.0 * w);\n\t\t\t\t\t\tuvOffset += delta;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\n\t\t\t\t}"})}getOverlayMaterial(){return new la({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform sampler2D edgeTexture1;\n\t\t\t\tuniform sampler2D edgeTexture2;\n\t\t\t\tuniform sampler2D patternTexture;\n\t\t\t\tuniform float edgeStrength;\n\t\t\t\tuniform float edgeGlow;\n\t\t\t\tuniform bool usePatternTexture;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\n\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\n\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\n\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\n\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\n\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\n\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\n\t\t\t\t\tif(usePatternTexture)\n\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\n\t\t\t\t\tgl_FragColor = finalColor;\n\t\t\t\t}",blending:2,depthTest:!1,depthWrite:!1,transparent:!0})}}pb.BlurDirectionX=new Je(1,0),pb.BlurDirectionY=new Je(0,1),new tF(0,0,0,"YXZ"),new Q,Math,new Q,new Je(512,512),new Jn,new Jn,new Je(512,512),new Je(0,0),new Je(1/1024,1/512),new Je(1/1024,1/512),new Je(1/1024,1/512),new Je,new Jn,new Jn,new Je,new Je,new Jn,new Jn,new Je;const J7={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new sn(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class VA extends TV{constructor(e,t,n,r){super(),this.strength=void 0!==t?t:1,this.radius=n,this.threshold=r,this.resolution=void 0!==e?new Je(e.x,e.y):new Je(256,256),this.clearColor=new sn(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);this.renderTargetBright=new ra(s,o),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let m=0;m<this.nMips;m++){const g=new ra(s,o);g.texture.name="UnrealBloomPass.h"+m,g.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(g);const v=new ra(s,o);v.texture.name="UnrealBloomPass.v"+m,v.texture.generateMipmaps=!1,this.renderTargetsVertical.push(v),s=Math.round(s/2),o=Math.round(o/2)}void 0===J7&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const a=J7;this.highPassUniforms=cw.clone(a.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new la({uniforms:this.highPassUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const l=[3,5,7,9,11];s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);for(let m=0;m<this.nMips;m++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(l[m])),this.separableBlurMaterials[m].uniforms.texSize.value=new Je(s,o),s=Math.round(s/2),o=Math.round(o/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new Q(1,1,1),new Q(1,1,1),new Q(1,1,1),new Q(1,1,1),new Q(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===bL&&console.error("THREE.UnrealBloomPass relies on CopyShader");const f=bL;this.copyUniforms=cw.clone(f.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new la({uniforms:this.copyUniforms,vertexShader:f.vertexShader,fragmentShader:f.fragmentShader,blending:2,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new sn,this.oldClearAlpha=1,this.basic=new Ta,this.fsQuad=new MV(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}setSize(e,t){let n=Math.round(e/2),r=Math.round(t/2);this.renderTargetBright.setSize(n,r);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(n,r),this.renderTargetsVertical[s].setSize(n,r),this.separableBlurMaterials[s].uniforms.texSize.value=new Je(n,r),n=Math.round(n/2),r=Math.round(r/2)}render(e,t,n,r,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=n.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let a=this.renderTargetBright;for(let l=0;l<this.nMips;l++)this.fsQuad.material=this.separableBlurMaterials[l],this.separableBlurMaterials[l].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[l].uniforms.direction.value=VA.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[l]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[l].uniforms.colorTexture.value=this.renderTargetsHorizontal[l].texture,this.separableBlurMaterials[l].uniforms.direction.value=VA.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[l]),e.clear(),this.fsQuad.render(e),a=this.renderTargetsVertical[l];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}getSeperableBlurMaterial(e){return new la({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new Je(.5,.5)},direction:{value:new Je(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(e){return new la({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}VA.BlurDirectionX=new Je(1,0),VA.BlurDirectionY=new Je(0,1);const cge=0,uge=1,hge=2,dge=3,fge=0,pge=0,mge=2,gge=0,_ge=1,vge=160,yge=161,bge=162,xge=163,Tge=0,wge=1,Mge=0,Sge=1,Cge=2,Ege=3,Age=4,Dge=5,Rge=6,Ige=7,Pge=8,Fge=9,Lge=10,Oge=11,kge=12,Nge=13,Bge=14,jge=15,Uge=16,Vge=17,Gge=18,zge=0,Hge=1,Wge=2,qge=3,Zge=4,Yge=5,Kge=6,Xge=7,$ge=8,Qge=9,Jge=10,e_e=11,t_e=0,n_e=1,i_e=2,r_e=13,s_e=14,o_e=15,a_e=128,l_e=64,c_e=32,u_e=16,h_e=0,d_e=1,f_e=2,p_e=3,m_e=4,g_e=5,__e=6,v_e=7,y_e=8,b_e=9,x_e=10,T_e=13,w_e=14,M_e=15,S_e=16,C_e=17,E_e=20,A_e=21,D_e=22,R_e=23,I_e=24,P_e=27,F_e=28,L_e=29,O_e=30,k_e=31,N_e=34,B_e=35,j_e=36,U_e=37,V_e=38,G_e=41,z_e=42,H_e=43,W_e=44,q_e=45,Z_e=48,Y_e=49,K_e=50,X_e=58,$_e=59,Q_e=62,J_e=63,eve=64,tve=65,nve=68,ive=69,rve=70,sve=71,ove=74,ave=75,lve=76,cve=77,uve=78,hve=81,dve=82,fve=83,pve=84,mve=85,gve=88,_ve=89,vve=90,yve=91,bve=92,xve=95,Tve=96,wve=97,Mve=98,Sve=99,Cve=100,Eve=101,Ave=102,Dve=103,Rve=104,Ive=105,Pve=106,Fve=107,Lve=108,Ove=109,kve=110,Nve=111,Bve=112,jve=113,Uve=114,Vve=115,Gve=116,zve=117,Hve=118,Wve=119,qve=120,Zve=121,Yve=122,Kve=123,Xve=124,$ve=125,Qve=126,Jve=127,eye=128,tye=129,nye=130,iye=131,rye=132,sye=133,oye=134,aye=135,lye=136,cye=137,uye=138,hye=139,dye=140,fye=141,pye=142,mye=143,gye=144,_ye=145,vye=146,yye=147,bye=148,xye=149,Tye=150,wye=151,Mye=152,Sye=153,Cye=154,Eye=155,Aye=156,Dye=157,Rye=158,Iye=159,Pye=160,Fye=161,Lye=162,Oye=163,kye=164,Nye=165,Bye=166,jye=167,Uye=168,Vye=169,Gye=170,zye=171,Hye=172,Wye=173,qye=174,Zye=175,Yye=176,Kye=177,Xye=178,$ye=179,Qye=180,Jye=181,e0e=182,t0e=183,n0e=184,i0e=1000156007,r0e=1000156008,s0e=1000156009,o0e=1000156010,a0e=1000156011,l0e=1000156017,c0e=1000156018,u0e=1000156019,h0e=1000156020,d0e=1000156021,f0e=1000054e3,p0e=1000054001,m0e=1000054002,g0e=1000054003,_0e=1000054004,v0e=1000054005,y0e=1000054006,b0e=1000054007,x0e=1000066e3,T0e=1000066001,w0e=1000066002,M0e=1000066003,S0e=1000066004,C0e=1000066005,E0e=1000066006,A0e=1000066007,D0e=1000066008,R0e=1000066009,I0e=1000066010,P0e=1000066011,F0e=1000066012,L0e=1000066013,O0e=100034e4,k0e=1000340001;class eK{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class GA{constructor(e,t,n,r){this._dataView=new DataView(e.buffer,e.byteOffset+t,n),this._littleEndian=r,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,e}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_skip(e){return this._offset+=e,this}_scan(e,t=0){const n=this._offset;let r=0;for(;this._dataView.getUint8(this._offset)!==t&&r<e;)r++,this._offset++;return r<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+n,r)}}const tK=new Uint8Array([0]),Va=[171,75,84,88,32,50,48,187,13,10,26,10];function nK(i){return typeof TextEncoder<"u"?(new TextEncoder).encode(i):Buffer.from(i)}function iK(i){return typeof TextDecoder<"u"?(new TextDecoder).decode(i):Buffer.from(i).toString("utf8")}function AL(i){let e=0;for(const r of i)e+=r.byteLength;const t=new Uint8Array(e);let n=0;for(const r of i)t.set(new Uint8Array(r),n),n+=r.byteLength;return t}function N0e(i){const e=new Uint8Array(i.buffer,i.byteOffset,Va.length);if(e[0]!==Va[0]||e[1]!==Va[1]||e[2]!==Va[2]||e[3]!==Va[3]||e[4]!==Va[4]||e[5]!==Va[5]||e[6]!==Va[6]||e[7]!==Va[7]||e[8]!==Va[8]||e[9]!==Va[9]||e[10]!==Va[10]||e[11]!==Va[11])throw new Error("Missing KTX 2.0 identifier.");const t=new eK,n=17*Uint32Array.BYTES_PER_ELEMENT,r=new GA(i,Va.length,n,!0);t.vkFormat=r._nextUint32(),t.typeSize=r._nextUint32(),t.pixelWidth=r._nextUint32(),t.pixelHeight=r._nextUint32(),t.pixelDepth=r._nextUint32(),t.layerCount=r._nextUint32(),t.faceCount=r._nextUint32();const s=r._nextUint32();t.supercompressionScheme=r._nextUint32();const o=r._nextUint32(),a=r._nextUint32(),l=r._nextUint32(),h=r._nextUint32(),f=r._nextUint64(),m=r._nextUint64(),g=new GA(i,Va.length+n,3*s*8,!0);for(let he=0;he<s;he++)t.levels.push({levelData:new Uint8Array(i.buffer,i.byteOffset+g._nextUint64(),g._nextUint64()),uncompressedByteLength:g._nextUint64()});const v=new GA(i,o,a,!0),y={vendorId:v._skip(4)._nextUint16(),descriptorType:v._nextUint16(),versionNumber:v._nextUint16(),descriptorBlockSize:v._nextUint16(),colorModel:v._nextUint8(),colorPrimaries:v._nextUint8(),transferFunction:v._nextUint8(),flags:v._nextUint8(),texelBlockDimension:[v._nextUint8(),v._nextUint8(),v._nextUint8(),v._nextUint8()],bytesPlane:[v._nextUint8(),v._nextUint8(),v._nextUint8(),v._nextUint8(),v._nextUint8(),v._nextUint8(),v._nextUint8(),v._nextUint8()],samples:[]},b=(y.descriptorBlockSize/4-6)/4;for(let he=0;he<b;he++){const me={bitOffset:v._nextUint16(),bitLength:v._nextUint8(),channelType:v._nextUint8(),samplePosition:[v._nextUint8(),v._nextUint8(),v._nextUint8(),v._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&me.channelType?(me.sampleLower=v._nextInt32(),me.sampleUpper=v._nextInt32()):(me.sampleLower=v._nextUint32(),me.sampleUpper=v._nextUint32()),y.samples[he]=me}t.dataFormatDescriptor.length=0,t.dataFormatDescriptor.push(y);const T=new GA(i,l,h,!0);for(;T._offset<h;){const he=T._nextUint32(),me=T._scan(he),ce=iK(me),be=T._scan(he-me.byteLength);t.keyValue[ce]=ce.match(/^ktx/i)?iK(be):be,T._offset%4&&T._skip(4-T._offset%4)}if(m<=0)return t;const S=new GA(i,f,m,!0),C=S._nextUint16(),R=S._nextUint16(),I=S._nextUint32(),L=S._nextUint32(),N=S._nextUint32(),U=S._nextUint32(),k=[];for(let he=0;he<s;he++)k.push({imageFlags:S._nextUint32(),rgbSliceByteOffset:S._nextUint32(),rgbSliceByteLength:S._nextUint32(),alphaSliceByteOffset:S._nextUint32(),alphaSliceByteLength:S._nextUint32()});const z=f+S._offset,K=z+I,te=K+L,fe=te+N,ie=new Uint8Array(i.buffer,i.byteOffset+z,I),ne=new Uint8Array(i.buffer,i.byteOffset+K,L),le=new Uint8Array(i.buffer,i.byteOffset+te,N),Z=new Uint8Array(i.buffer,i.byteOffset+fe,U);return t.globalData={endpointCount:C,selectorCount:R,imageDescs:k,endpointsData:ie,selectorsData:ne,tablesData:le,extendedData:Z},t}function UV(){return(UV=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i}).apply(this,arguments)}const B0e={keepWriter:!1};function j0e(i,e={}){e=UV({},B0e,e);let t=new ArrayBuffer(0);if(i.globalData){const C=new ArrayBuffer(20+5*i.globalData.imageDescs.length*4),R=new DataView(C);R.setUint16(0,i.globalData.endpointCount,!0),R.setUint16(2,i.globalData.selectorCount,!0),R.setUint32(4,i.globalData.endpointsData.byteLength,!0),R.setUint32(8,i.globalData.selectorsData.byteLength,!0),R.setUint32(12,i.globalData.tablesData.byteLength,!0),R.setUint32(16,i.globalData.extendedData.byteLength,!0);for(let I=0;I<i.globalData.imageDescs.length;I++){const L=i.globalData.imageDescs[I];R.setUint32(20+5*I*4+0,L.imageFlags,!0),R.setUint32(20+5*I*4+4,L.rgbSliceByteOffset,!0),R.setUint32(20+5*I*4+8,L.rgbSliceByteLength,!0),R.setUint32(20+5*I*4+12,L.alphaSliceByteOffset,!0),R.setUint32(20+5*I*4+16,L.alphaSliceByteLength,!0)}t=AL([C,i.globalData.endpointsData,i.globalData.selectorsData,i.globalData.tablesData,i.globalData.extendedData])}const n=[];let r=i.keyValue;e.keepWriter||(r=UV({},i.keyValue,{KTXwriter:"KTX-Parse v0.3.1"}));for(const C in r){const R=r[C],I=nK(C),L="string"==typeof R?nK(R):R,N=I.byteLength+1+L.byteLength+1,U=N%4?4-N%4:0;n.push(AL([new Uint32Array([N]),I,tK,L,tK,new Uint8Array(U).fill(0)]))}const s=AL(n);if(1!==i.dataFormatDescriptor.length||0!==i.dataFormatDescriptor[0].descriptorType)throw new Error("Only BASICFORMAT Data Format Descriptor output supported.");const o=i.dataFormatDescriptor[0],a=new ArrayBuffer(28+16*o.samples.length),l=new DataView(a),h=24+16*o.samples.length;if(l.setUint32(0,a.byteLength,!0),l.setUint16(4,o.vendorId,!0),l.setUint16(6,o.descriptorType,!0),l.setUint16(8,o.versionNumber,!0),l.setUint16(10,h,!0),l.setUint8(12,o.colorModel),l.setUint8(13,o.colorPrimaries),l.setUint8(14,o.transferFunction),l.setUint8(15,o.flags),!Array.isArray(o.texelBlockDimension))throw new Error("texelBlockDimension is now an array. For dimensionality `d`, set `d - 1`.");l.setUint8(16,o.texelBlockDimension[0]),l.setUint8(17,o.texelBlockDimension[1]),l.setUint8(18,o.texelBlockDimension[2]),l.setUint8(19,o.texelBlockDimension[3]);for(let C=0;C<8;C++)l.setUint8(20+C,o.bytesPlane[C]);for(let C=0;C<o.samples.length;C++){const R=o.samples[C],I=28+16*C;if(R.channelID)throw new Error("channelID has been renamed to channelType.");l.setUint16(I+0,R.bitOffset,!0),l.setUint8(I+2,R.bitLength),l.setUint8(I+3,R.channelType),l.setUint8(I+4,R.samplePosition[0]),l.setUint8(I+5,R.samplePosition[1]),l.setUint8(I+6,R.samplePosition[2]),l.setUint8(I+7,R.samplePosition[3]),64&R.channelType?(l.setInt32(I+8,R.sampleLower,!0),l.setInt32(I+12,R.sampleUpper,!0)):(l.setUint32(I+8,R.sampleLower,!0),l.setUint32(I+12,R.sampleUpper,!0))}const f=Va.length+68+3*i.levels.length*8,m=f+a.byteLength;let g=t.byteLength>0?m+s.byteLength:0;g%8&&(g+=8-g%8);const v=[],y=new DataView(new ArrayBuffer(3*i.levels.length*8));let b=(g||m+s.byteLength)+t.byteLength;for(let C=0;C<i.levels.length;C++){const R=i.levels[C];v.push(R.levelData),y.setBigUint64(24*C+0,BigInt(b),!0),y.setBigUint64(24*C+8,BigInt(R.levelData.byteLength),!0),y.setBigUint64(24*C+16,BigInt(R.uncompressedByteLength),!0),b+=R.levelData.byteLength}const T=new ArrayBuffer(68),S=new DataView(T);return S.setUint32(0,i.vkFormat,!0),S.setUint32(4,i.typeSize,!0),S.setUint32(8,i.pixelWidth,!0),S.setUint32(12,i.pixelHeight,!0),S.setUint32(16,i.pixelDepth,!0),S.setUint32(20,i.layerCount,!0),S.setUint32(24,i.faceCount,!0),S.setUint32(28,i.levels.length,!0),S.setUint32(32,i.supercompressionScheme,!0),S.setUint32(36,f,!0),S.setUint32(40,a.byteLength,!0),S.setUint32(44,m,!0),S.setUint32(48,s.byteLength,!0),S.setBigUint64(52,BigInt(t.byteLength>0?g:0),!0),S.setBigUint64(60,BigInt(t.byteLength),!0),new Uint8Array(AL([new Uint8Array(Va).buffer,T,y.buffer,a,s,g>0?new ArrayBuffer(g-(m+s.byteLength)):new ArrayBuffer(0),t,...v]))}var WV=function(i){return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))};try{URL.revokeObjectURL(WV(""))}catch{WV=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var kr=Uint8Array,Sa=Uint16Array,nv=Uint32Array,kw=new kr([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Nw=new kr([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),gK=(new kr([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),function(i,e){for(var t=new Sa(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];var r=new nv(t[30]);for(n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return[t,r]}),_K=gK(kw,2),DL=_K[1];_K[0][28]=258,DL[258]=28,gK(Nw,0);for(var HA=new Sa(32768),fs=0;fs<32768;++fs){var iv=(43690&fs)>>>1|(21845&fs)<<1;HA[fs]=((65280&(iv=(61680&(iv=(52428&iv)>>>2|(13107&iv)<<2))>>>4|(3855&iv)<<4))>>>8|(255&iv)<<8)>>>1}var mb=new kr(288);for(fs=0;fs<144;++fs)mb[fs]=8;for(fs=144;fs<256;++fs)mb[fs]=9;for(fs=256;fs<280;++fs)mb[fs]=7;for(fs=280;fs<288;++fs)mb[fs]=8;var RL=new kr(32);for(fs=0;fs<32;++fs)RL[fs]=5;var kL=new kr(0),iG=typeof TextDecoder<"u"&&new TextDecoder;try{iG.decode(kL,{stream:!0})}catch{}var Ii={toRGBA8:function(i){var e=i.width,t=i.height;if(null==i.tabs.acTL)return[Ii.toRGBA8.decodeImage(i.data,e,t,i).buffer];var n=[];null==i.frames[0].data&&(i.frames[0].data=i.data);for(var r=e*t*4,s=new Uint8Array(r),o=new Uint8Array(r),a=new Uint8Array(r),l=0;l<i.frames.length;l++){var h=i.frames[l],f=h.rect.x,m=h.rect.y,g=h.rect.width,v=h.rect.height,y=Ii.toRGBA8.decodeImage(h.data,g,v,i);if(0!=l)for(var b=0;b<r;b++)a[b]=s[b];if(0==h.blend?Ii._copyTile(y,g,v,s,e,t,f,m,0):1==h.blend&&Ii._copyTile(y,g,v,s,e,t,f,m,1),n.push(s.buffer.slice(0)),1==h.dispose)Ii._copyTile(o,g,v,s,e,t,f,m,0);else if(2==h.dispose)for(b=0;b<r;b++)s[b]=a[b]}return n}};Ii.toRGBA8.decodeImage=function(i,e,t,n){var r=e*t,s=Ii.decode._getBPP(n),o=Math.ceil(e*s/8),a=new Uint8Array(4*r),l=new Uint32Array(a.buffer),h=n.ctype,f=n.depth,m=Ii._bin.readUshort;if(6==h){var g=r<<2;if(8==f)for(var v=0;v<g;v+=4)a[v]=i[v],a[v+1]=i[v+1],a[v+2]=i[v+2],a[v+3]=i[v+3];if(16==f)for(v=0;v<g;v++)a[v]=i[v<<1]}else if(2==h){var y=n.tabs.tRNS;if(null==y){if(8==f)for(v=0;v<r;v++)l[v]=255<<24|i[2+(b=3*v)]<<16|i[b+1]<<8|i[b];if(16==f)for(v=0;v<r;v++)l[v]=255<<24|i[4+(b=6*v)]<<16|i[b+2]<<8|i[b]}else{var T=y[0],S=y[1],C=y[2];if(8==f)for(v=0;v<r;v++){var R=v<<2;l[v]=255<<24|i[2+(b=3*v)]<<16|i[b+1]<<8|i[b],i[b]==T&&i[b+1]==S&&i[b+2]==C&&(a[R+3]=0)}if(16==f)for(v=0;v<r;v++){var b;R=v<<2,l[v]=255<<24|i[4+(b=6*v)]<<16|i[b+2]<<8|i[b],m(i,b)==T&&m(i,b+2)==S&&m(i,b+4)==C&&(a[R+3]=0)}}}else if(3==h){var I=n.tabs.PLTE,L=n.tabs.tRNS,N=L?L.length:0;if(1==f)for(var U=0;U<t;U++){var k=U*o,z=U*e;for(v=0;v<e;v++)a[R=z+v<<2]=I[te=3*(K=i[k+(v>>3)]>>7-((7&v)<<0)&1)],a[R+1]=I[te+1],a[R+2]=I[te+2],a[R+3]=K<N?L[K]:255}if(2==f)for(U=0;U<t;U++)for(k=U*o,z=U*e,v=0;v<e;v++)a[R=z+v<<2]=I[te=3*(K=i[k+(v>>2)]>>6-((3&v)<<1)&3)],a[R+1]=I[te+1],a[R+2]=I[te+2],a[R+3]=K<N?L[K]:255;if(4==f)for(U=0;U<t;U++)for(k=U*o,z=U*e,v=0;v<e;v++)a[R=z+v<<2]=I[te=3*(K=i[k+(v>>1)]>>4-((1&v)<<2)&15)],a[R+1]=I[te+1],a[R+2]=I[te+2],a[R+3]=K<N?L[K]:255;if(8==f)for(v=0;v<r;v++){var K,te;a[R=v<<2]=I[te=3*(K=i[v])],a[R+1]=I[te+1],a[R+2]=I[te+2],a[R+3]=K<N?L[K]:255}}else if(4==h){if(8==f)for(v=0;v<r;v++)a[R=v<<2]=ie=i[fe=v<<1],a[R+1]=ie,a[R+2]=ie,a[R+3]=i[fe+1];if(16==f)for(v=0;v<r;v++){var fe;a[R=v<<2]=ie=i[fe=v<<2],a[R+1]=ie,a[R+2]=ie,a[R+3]=i[fe+2]}}else if(0==h)for(T=n.tabs.tRNS?n.tabs.tRNS:-1,U=0;U<t;U++){var ne=U*o,le=U*e;if(1==f)for(var Z=0;Z<e;Z++)l[le+Z]=(he=(ie=255*(i[ne+(Z>>>3)]>>>7-(7&Z)&1))==255*T?0:255)<<24|ie<<16|ie<<8|ie;else if(2==f)for(Z=0;Z<e;Z++)l[le+Z]=(he=(ie=85*(i[ne+(Z>>>2)]>>>6-((3&Z)<<1)&3))==85*T?0:255)<<24|ie<<16|ie<<8|ie;else if(4==f)for(Z=0;Z<e;Z++)l[le+Z]=(he=(ie=17*(i[ne+(Z>>>1)]>>>4-((1&Z)<<2)&15))==17*T?0:255)<<24|ie<<16|ie<<8|ie;else if(8==f)for(Z=0;Z<e;Z++)l[le+Z]=(he=(ie=i[ne+Z])==T?0:255)<<24|ie<<16|ie<<8|ie;else if(16==f)for(Z=0;Z<e;Z++){var ie=i[ne+(Z<<1)],he=m(i,ne+(Z<<1))==T?0:255;l[le+Z]=he<<24|ie<<16|ie<<8|ie}}return a},Ii.decode=function(i){for(var h,m,g,v,e=new Uint8Array(i),t=8,n=Ii._bin,r=n.readUshort,s=n.readUint,o={tabs:{},frames:[]},a=new Uint8Array(e.length),l=0,f=0,y=[137,80,78,71,13,10,26,10],b=0;b<8;b++)if(e[b]!=y[b])throw new Error("The input is not a PNG file!");for(;t<e.length;){var T=n.readUint(e,t),S=n.readASCII(e,t+=4,4);if(t+=4,"IHDR"==S)Ii.decode._IHDR(e,t,o);else if("CgBI"==S)o.tabs[S]=e.slice(t,t+4);else if("IDAT"==S){for(b=0;b<T;b++)a[l+b]=e[t+b];l+=T}else if("acTL"==S)o.tabs[S]={num_frames:s(e,t),num_plays:s(e,t+4)},h=new Uint8Array(e.length);else if("fcTL"==S){0!=f&&((C=o.frames[o.frames.length-1]).data=Ii.decode._decompress(o,h.slice(0,f),C.rect.width,C.rect.height),f=0);var R={x:s(e,t+12),y:s(e,t+16),width:s(e,t+4),height:s(e,t+8)},I=r(e,t+22);I=r(e,t+20)/(0==I?100:I);var L={rect:R,delay:Math.round(1e3*I),dispose:e[t+24],blend:e[t+25]};o.frames.push(L)}else if("fdAT"==S){for(b=0;b<T-4;b++)h[f+b]=e[t+b+4];f+=T-4}else if("pHYs"==S)o.tabs[S]=[n.readUint(e,t),n.readUint(e,t+4),e[t+8]];else if("cHRM"==S)for(o.tabs[S]=[],b=0;b<8;b++)o.tabs[S].push(n.readUint(e,t+4*b));else if("tEXt"==S||"zTXt"==S){null==o.tabs[S]&&(o.tabs[S]={});var N=n.nextZero(e,t);g=n.readASCII(e,t,N-t);var U=t+T-N-1;"tEXt"==S?m=n.readASCII(e,N+1,U):(v=Ii.decode._inflate(e.slice(N+2,N+2+U)),m=n.readUTF8(v,0,v.length)),o.tabs[S][g]=m}else if("iTXt"==S){null==o.tabs[S]&&(o.tabs[S]={}),N=0;var k=t;N=n.nextZero(e,k),g=n.readASCII(e,k,N-k);var z=e[k=N+1];N=n.nextZero(e,k+=2),n.readASCII(e,k,N-k),N=n.nextZero(e,k=N+1),n.readUTF8(e,k,N-k),U=T-((k=N+1)-t),0==z?m=n.readUTF8(e,k,U):(v=Ii.decode._inflate(e.slice(k,k+U)),m=n.readUTF8(v,0,v.length)),o.tabs[S][g]=m}else if("PLTE"==S)o.tabs[S]=n.readBytes(e,t,T);else if("hIST"==S){var K=o.tabs.PLTE.length/3;for(o.tabs[S]=[],b=0;b<K;b++)o.tabs[S].push(r(e,t+2*b))}else if("tRNS"==S)3==o.ctype?o.tabs[S]=n.readBytes(e,t,T):0==o.ctype?o.tabs[S]=r(e,t):2==o.ctype&&(o.tabs[S]=[r(e,t),r(e,t+2),r(e,t+4)]);else if("gAMA"==S)o.tabs[S]=n.readUint(e,t)/1e5;else if("sRGB"==S)o.tabs[S]=e[t];else if("bKGD"==S)0==o.ctype||4==o.ctype?o.tabs[S]=[r(e,t)]:2==o.ctype||6==o.ctype?o.tabs[S]=[r(e,t),r(e,t+2),r(e,t+4)]:3==o.ctype&&(o.tabs[S]=e[t]);else if("IEND"==S)break;n.readUint(e,t+=T),t+=4}var C;return 0!=f&&((C=o.frames[o.frames.length-1]).data=Ii.decode._decompress(o,h.slice(0,f),C.rect.width,C.rect.height)),o.data=Ii.decode._decompress(o,a,o.width,o.height),delete o.compress,delete o.interlace,delete o.filter,o},Ii.decode._decompress=function(i,e,t,n){var r=Ii.decode._getBPP(i),s=Math.ceil(t*r/8),o=new Uint8Array((s+1+i.interlace)*n);return e=i.tabs.CgBI?Ii.inflateRaw(e,o):Ii.decode._inflate(e,o),0==i.interlace?e=Ii.decode._filterZero(e,i,0,t,n):1==i.interlace&&(e=Ii.decode._readInterlace(e,i)),e},Ii.decode._inflate=function(i,e){return Ii.inflateRaw(new Uint8Array(i.buffer,2,i.length-6),e)},Ii.inflateRaw=function(){var e,t,i={H:{}};return i.H.N=function(e,t){var v,y,n=Uint8Array,r=0,s=0,o=0,a=0,l=0,h=0,f=0,m=0,g=0;if(3==e[0]&&0==e[1])return t||new n(0);var b=i.H,T=b.b,S=b.e,C=b.R,R=b.n,I=b.A,L=b.Z,N=b.m,U=null==t;for(U&&(t=new n(e.length>>>2<<5));0==r;)if(r=T(e,g,1),s=T(e,g+1,2),g+=3,0!=s){if(U&&(t=i.H.W(t,m+(1<<17))),1==s&&(v=N.J,y=N.h,h=511,f=31),2==s){o=S(e,g,5)+257,a=S(e,g+5,5)+1,l=S(e,g+10,4)+4,g+=14;for(var K=1,te=0;te<38;te+=2)N.Q[te]=0,N.Q[te+1]=0;for(te=0;te<l;te++){var fe=S(e,g+3*te,3);N.Q[1+(N.X[te]<<1)]=fe,fe>K&&(K=fe)}g+=3*l,R(N.Q,K),I(N.Q,K,N.u),v=N.w,y=N.d,g=C(N.u,(1<<K)-1,o+a,e,g,N.v);var ie=b.V(N.v,0,o,N.C);h=(1<<ie)-1;var ne=b.V(N.v,o,a,N.D);f=(1<<ne)-1,R(N.C,ie),I(N.C,ie,v),R(N.D,ne),I(N.D,ne,y)}for(;;){var le=v[L(e,g)&h];g+=15&le;var Z=le>>>4;if(Z>>>8==0)t[m++]=Z;else{if(256==Z)break;var he=m+Z-254;if(Z>264){var me=N.q[Z-257];he=m+(me>>>3)+S(e,g,7&me),g+=7&me}var ce=y[L(e,g)&f],Ge=N.c[ce>>>4],Ee=(Ge>>>4)+T(e,g+=15&ce,15&Ge);for(g+=15&Ge;m<he;)t[m]=t[m++-Ee],t[m]=t[m++-Ee],t[m]=t[m++-Ee],t[m]=t[m++-Ee];m=he}}}else{0!=(7&g)&&(g+=8-(7&g));var k=4+(g>>>3),z=e[k-4]|e[k-3]<<8;U&&(t=i.H.W(t,m+z)),t.set(new n(e.buffer,e.byteOffset+k,z),m),g=k+z<<3,m+=z}return t.length==m?t:t.slice(0,m)},i.H.W=function(e,t){var n=e.length;if(t<=n)return e;var r=new Uint8Array(n<<1);return r.set(e,0),r},i.H.R=function(e,t,n,r,s,o){for(var a=i.H.e,l=i.H.Z,h=0;h<n;){var f=e[l(r,s)&t];s+=15&f;var m=f>>>4;if(m<=15)o[h]=m,h++;else{var g=0,v=0;16==m?(v=3+a(r,s,2),s+=2,g=o[h-1]):17==m?(v=3+a(r,s,3),s+=3):18==m&&(v=11+a(r,s,7),s+=7);for(var y=h+v;h<y;)o[h]=g,h++}}return s},i.H.V=function(e,t,n,r){for(var s=0,o=0,a=r.length>>>1;o<n;){var l=e[o+t];r[o<<1]=0,r[1+(o<<1)]=l,l>s&&(s=l),o++}for(;o<a;)r[o<<1]=0,r[1+(o<<1)]=0,o++;return s},i.H.n=function(e,t){for(var s,o,a,h,n=i.H.m,r=e.length,f=n.j,l=0;l<=t;l++)f[l]=0;for(l=1;l<r;l+=2)f[e[l]]++;var m=n.K;for(s=0,f[0]=0,o=1;o<=t;o++)m[o]=s=s+f[o-1]<<1;for(a=0;a<r;a+=2)0!=(h=e[a+1])&&(e[a]=m[h],m[h]++)},i.H.A=function(e,t,n){for(var r=e.length,o=i.H.m.r,a=0;a<r;a+=2)if(0!=e[a+1])for(var h=e[a+1],f=a>>1<<4|h,m=t-h,g=e[a]<<m,v=g+(1<<m);g!=v;)n[o[g]>>>15-t]=f,g++},i.H.l=function(e,t){for(var n=i.H.m.r,r=15-t,s=0;s<e.length;s+=2)e[s]=n[e[s]<<t-e[s+1]]>>>r},i.H.M=function(e,t,n){var r=t>>>3;e[r]|=n<<=7&t,e[r+1]|=n>>>8},i.H.I=function(e,t,n){var r=t>>>3;e[r]|=n<<=7&t,e[r+1]|=n>>>8,e[r+2]|=n>>>16},i.H.e=function(e,t,n){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<n)-1},i.H.b=function(e,t,n){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<n)-1},i.H.Z=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},i.H.i=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},i.H.m=(e=Uint16Array,t=Uint32Array,{K:new e(16),j:new e(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new e(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new t(32),J:new e(512),_:[],h:new e(32),$:[],w:new e(32768),C:[],v:[],d:new e(32768),D:[],u:new e(512),Q:[],r:new e(32768),s:new t(286),Y:new t(30),a:new t(19),t:new t(15e3),k:new e(65536),g:new e(32768)}),function(){for(var e=i.H.m,n=0;n<32768;n++){var r=n;e.r[n]=((r=(4278255360&(r=(4042322160&(r=(3435973836&(r=(2863311530&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8)>>>16|r<<16)>>>17}function s(o,a,l){for(;0!=a--;)o.push(0,l)}for(n=0;n<32;n++)e.q[n]=e.S[n]<<3|e.T[n],e.c[n]=e.p[n]<<4|e.z[n];s(e._,144,8),s(e._,112,9),s(e._,24,7),s(e._,8,8),i.H.n(e._,9),i.H.A(e._,9,e.J),i.H.l(e._,9),s(e.$,32,5),i.H.n(e.$,5),i.H.A(e.$,5,e.h),i.H.l(e.$,5),s(e.Q,19,0),s(e.C,286,0),s(e.D,30,0),s(e.v,320,0)}(),i.H.N}(),Ii.decode._readInterlace=function(i,e){for(var t=e.width,n=e.height,r=Ii.decode._getBPP(e),s=r>>3,o=Math.ceil(t*r/8),a=new Uint8Array(n*o),l=0,h=[0,0,4,0,2,0,1],f=[0,4,0,2,0,1,0],m=[8,8,8,4,4,2,2],g=[8,8,4,4,2,2,1],v=0;v<7;){for(var y=m[v],b=g[v],T=0,S=0,C=h[v];C<n;)C+=y,S++;for(var R=f[v];R<t;)R+=b,T++;var I=Math.ceil(T*r/8);Ii.decode._filterZero(i,e,l,T,S);for(var L=0,N=h[v];N<n;){for(var k=f[v],z=l+L*I<<3;k<t;){if(1==r&&(a[N*o+(k>>3)]|=(i[z>>3]>>7-(7&z)&1)<<7-((7&k)<<0)),2==r&&(a[N*o+(k>>2)]|=(i[z>>3]>>6-(7&z)&3)<<6-((3&k)<<1)),4==r&&(a[N*o+(k>>1)]|=(i[z>>3]>>4-(7&z)&15)<<4-((1&k)<<2)),r>=8)for(var K=N*o+k*s,te=0;te<s;te++)a[K+te]=i[(z>>3)+te];z+=r,k+=b}L++,N+=y}T*S!=0&&(l+=S*(1+I)),v+=1}return a},Ii.decode._getBPP=function(i){return[1,null,3,1,2,null,4][i.ctype]*i.depth},Ii.decode._filterZero=function(i,e,t,n,r){var s=Ii.decode._getBPP(e),o=Math.ceil(n*s/8),a=Ii.decode._paeth;s=Math.ceil(s/8);var l,h,f=i[t],m=0;if(f>1&&(i[t]=[0,0,1][f-2]),3==f)for(m=s;m<o;m++)i[m+1]=i[m+1]+(i[m+1-s]>>>1)&255;for(var g=0;g<r;g++)if(m=0,0==(f=i[(h=(l=t+g*o)+g+1)-1]))for(;m<o;m++)i[l+m]=i[h+m];else if(1==f){for(;m<s;m++)i[l+m]=i[h+m];for(;m<o;m++)i[l+m]=i[h+m]+i[l+m-s]}else if(2==f)for(;m<o;m++)i[l+m]=i[h+m]+i[l+m-o];else if(3==f){for(;m<s;m++)i[l+m]=i[h+m]+(i[l+m-o]>>>1);for(;m<o;m++)i[l+m]=i[h+m]+(i[l+m-o]+i[l+m-s]>>>1)}else{for(;m<s;m++)i[l+m]=i[h+m]+a(0,i[l+m-o],0);for(;m<o;m++)i[l+m]=i[h+m]+a(i[l+m-s],i[l+m-o],i[l+m-s-o])}return i},Ii.decode._paeth=function(i,e,t){var n=i+e-t,r=n-i,s=n-e,o=n-t;return r*r<=s*s&&r*r<=o*o?i:s*s<=o*o?e:t},Ii.decode._IHDR=function(i,e,t){var n=Ii._bin;t.width=n.readUint(i,e),t.height=n.readUint(i,e+=4),t.depth=i[e+=4],e++,t.ctype=i[e],e++,t.compress=i[e],e++,t.filter=i[e],e++,t.interlace=i[e],e++},Ii._bin={nextZero:function(i,e){for(;0!=i[e];)e++;return e},readUshort:function(i,e){return i[e]<<8|i[e+1]},writeUshort:function(i,e,t){i[e]=t>>8&255,i[e+1]=255&t},readUint:function(i,e){return 16777216*i[e]+(i[e+1]<<16|i[e+2]<<8|i[e+3])},writeUint:function(i,e,t){i[e]=t>>24&255,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=255&t},readASCII:function(i,e,t){for(var n="",r=0;r<t;r++)n+=String.fromCharCode(i[e+r]);return n},writeASCII:function(i,e,t){for(var n=0;n<t.length;n++)i[e+n]=t.charCodeAt(n)},readBytes:function(i,e,t){for(var n=[],r=0;r<t;r++)n.push(i[e+r]);return n},pad:function(i){return i.length<2?"0"+i:i},readUTF8:function(i,e,t){for(var r,n="",s=0;s<t;s++)n+="%"+Ii._bin.pad(i[e+s].toString(16));try{r=decodeURIComponent(n)}catch{return Ii._bin.readASCII(i,e,t)}return r}},Ii._copyTile=function(i,e,t,n,r,s,o,a,l){for(var h=Math.min(e,r),f=Math.min(t,s),m=0,g=0,v=0;v<f;v++)for(var y=0;y<h;y++)if(o>=0&&a>=0?(m=v*e+y<<2,g=(a+v)*r+o+y<<2):(m=(-a+v)*e-o+y<<2,g=v*r+y<<2),0==l)n[g]=i[m],n[g+1]=i[m+1],n[g+2]=i[m+2],n[g+3]=i[m+3];else if(1==l){var T=i[m]*(b=.00392156862745098*i[m+3]),S=i[m+1]*b,C=i[m+2]*b,I=n[g]*(R=n[g+3]*(1/255)),L=n[g+1]*R,N=n[g+2]*R,U=1-b,k=b+R*U,z=0==k?0:1/k;n[g+3]=255*k,n[g+0]=(T+I*U)*z,n[g+1]=(S+L*U)*z,n[g+2]=(C+N*U)*z}else if(2==l)T=i[m],S=i[m+1],C=i[m+2],I=n[g],L=n[g+1],N=n[g+2],(b=i[m+3])==(R=n[g+3])&&T==I&&S==L&&C==N?(n[g]=0,n[g+1]=0,n[g+2]=0,n[g+3]=0):(n[g]=T,n[g+1]=S,n[g+2]=C,n[g+3]=b);else if(3==l){var b,R;if(T=i[m],S=i[m+1],C=i[m+2],I=n[g],L=n[g+1],N=n[g+2],(b=i[m+3])==(R=n[g+3])&&T==I&&S==L&&C==N)continue;if(b<220&&R>20)return!1}return!0};class ebe extends Aw{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new sbe(t)}),this.register(function(t){return new dbe(t)}),this.register(function(t){return new fbe(t)}),this.register(function(t){return new abe(t)}),this.register(function(t){return new lbe(t)}),this.register(function(t){return new cbe(t)}),this.register(function(t){return new ube(t)}),this.register(function(t){return new rbe(t)}),this.register(function(t){return new hbe(t)}),this.register(function(t){return new obe(t)}),this.register(function(t){return new nbe(t)}),this.register(function(t){return new pbe(t)})}load(e,t,n,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Bm.extractUrlBase(e),this.manager.itemStart(e);const a=function(h){r?r(h):console.error(h),s.manager.itemError(e),s.manager.itemEnd(e)},l=new xd(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(h){try{s.parse(h,o,function(f){t(f),s.manager.itemEnd(e)},a)}catch(f){a(f)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s;const o={},a={};if("string"==typeof e)s=e;else if(Bm.decodeText(new Uint8Array(e,0,4))===zK){try{o[qi.KHR_BINARY_GLTF]=new mbe(e)}catch(m){return void(r&&r(m))}s=o[qi.KHR_BINARY_GLTF].content}else s=Bm.decodeText(new Uint8Array(e));const l=JSON.parse(s);if(void 0===l.asset||l.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const h=new Abe(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});h.fileLoader.setRequestHeader(this.requestHeader);for(let f=0;f<this.pluginCallbacks.length;f++){const m=this.pluginCallbacks[f](h);a[m.name]=m,o[m.name]=!0}if(l.extensionsUsed)for(let f=0;f<l.extensionsUsed.length;++f){const m=l.extensionsUsed[f],g=l.extensionsRequired||[];switch(m){case qi.KHR_MATERIALS_UNLIT:o[m]=new ibe;break;case qi.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[m]=new vbe;break;case qi.KHR_DRACO_MESH_COMPRESSION:o[m]=new gbe(l,this.dracoLoader);break;case qi.KHR_TEXTURE_TRANSFORM:o[m]=new _be;break;case qi.KHR_MESH_QUANTIZATION:o[m]=new ybe;break;default:g.indexOf(m)>=0&&void 0===a[m]&&console.warn('THREE.GLTFLoader: Unknown extension "'+m+'".')}}h.setExtensions(o),h.setPlugins(a),h.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}}function tbe(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const qi={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class nbe{constructor(e){this.parser=e,this.name=qi.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let h;const f=new sn(16777215);void 0!==l.color&&f.fromArray(l.color);const m=void 0!==l.range?l.range:0;switch(l.type){case"directional":h=new bZ(f),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new yZ(f),h.distance=m;break;case"spot":h=new _Z(f),h.distance=m,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,h.angle=l.spot.outerConeAngle,h.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return h.position.set(0,0,0),h.decay=2,void 0!==l.intensity&&(h.intensity=l.intensity),h.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(h),t.cache.add(n,r),r}createNodeAttachment(e){const t=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return n._getNodeRef(t.cache,a,l)})}}class ibe{constructor(){this.name=qi.KHR_MATERIALS_UNLIT}getMaterialType(){return Ta}extendParams(e,t,n){const r=[];e.color=new sn(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(n.assignTexture(e,"map",s.baseColorTexture,ur))}return Promise.all(r)}}class rbe{constructor(e){this.parser=e,this.name=qi.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class sbe{constructor(e){this.parser=e,this.name=qi.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?X_:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Je(a,a)}return Promise.all(s)}}class obe{constructor(e){this.parser=e,this.name=qi.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?X_:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class abe{constructor(e){this.parser=e,this.name=qi.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?X_:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new sn(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,ur)),void 0!==o.sheenRoughnessTexture&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class lbe{constructor(e){this.parser=e,this.name=qi.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?X_:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class cbe{constructor(e){this.parser=e,this.name=qi.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?X_:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new sn(a[0],a[1],a[2]),Promise.all(s)}}class ube{constructor(e){this.parser=e,this.name=qi.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?X_:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class hbe{constructor(e){this.parser=e,this.name=qi.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?X_:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new sn(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,ur)),Promise.all(s)}}class dbe{constructor(e){this.parser=e,this.name=qi.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class fbe{constructor(e){this.parser=e,this.name=qi.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=n.textureLoader;if(a.uri){const h=n.options.manager.getHandler(a.uri);null!==h&&(l=h)}return this.detectSupport().then(function(h){if(h)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class pbe{constructor(e){this.name=qi.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([s,o.ready]).then(function(a){const l=r.byteOffset||0,h=r.byteLength||0,f=r.count,m=r.byteStride,g=new ArrayBuffer(f*m),v=new Uint8Array(a[0],l,h);return o.decodeGltfBuffer(new Uint8Array(g),f,m,v,r.mode,r.filter),g})}return null}}const zK="glTF";class mbe{constructor(e){this.name=qi.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:Bm.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==zK)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,r=new DataView(e,12);let s=0;for(;s<n;){const o=r.getUint32(s,!0);s+=4;const a=r.getUint32(s,!0);if(s+=4,1313821514===a){const l=new Uint8Array(e,12+s,o);this.content=Bm.decodeText(l)}else if(5130562===a){const l=12+s;this.body=e.slice(l,l+o)}s+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class gbe{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=qi.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},h={};for(const f in o){const m=sG[f]||f.toLowerCase();a[m]=o[f]}for(const f in e.attributes){const m=sG[f]||f.toLowerCase();if(void 0!==o[f]){const g=n.accessors[e.attributes[f]];h[m]=XA[g.componentType],l[m]=!0===g.normalized}}return t.getDependency("bufferView",s).then(function(f){return new Promise(function(m){r.decodeDracoFile(f,function(g){for(const v in g.attributes){const y=g.attributes[v],b=l[v];void 0!==b&&(y.normalized=b)}m(g)},a,h)})})}}class _be{constructor(){this.name=qi.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class rG extends bA{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),a={specular:{value:(new sn).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(l){for(const h in a)l.uniforms[h]=a[h];l.fragmentShader=l.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(l){a.specular.value=l}},specularMap:{get:function(){return a.specularMap.value},set:function(l){a.specularMap.value=l,l?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(l){a.glossiness.value=l}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(l){a.glossinessMap.value=l,l?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class vbe{constructor(){this.name=qi.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity"]}getMaterialType(){return rG}extendParams(e,t,n){const r=t.extensions[this.name];e.color=new sn(1,1,1),e.opacity=1;const s=[];if(Array.isArray(r.diffuseFactor)){const o=r.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(void 0!==r.diffuseTexture&&s.push(n.assignTexture(e,"map",r.diffuseTexture,ur)),e.emissive=new sn(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new sn(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){const o=r.specularGlossinessTexture;s.push(n.assignTexture(e,"glossinessMap",o)),s.push(n.assignTexture(e,"specularMap",o,ur))}return Promise.all(s)}createMaterial(e){const t=new rG(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=void 0===e.emissiveIntensity?1:e.emissiveIntensity,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=0,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t}}class ybe{constructor(){this.name=qi.KHR_MESH_QUANTIZATION}}class WK extends xA{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=n[s+o];return t}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=2*a,h=3*a,f=r-t,m=(n-t)/f,g=m*m,v=g*m,y=e*h,b=y-h,T=-2*v+3*g,S=v-g,C=1-T,R=S-g+m;for(let I=0;I!==a;I++)s[I]=C*o[b+I+a]+R*(o[b+I+l]*f)+T*o[y+I+a]+S*(o[y+I]*f);return s}}const bbe=new sa;class xbe extends WK{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);return bbe.fromArray(s).normalize().toArray(s),s}}const XA={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},qK={9728:Bo,9729:io,9984:1004,9985:1007,9986:1005,9987:B_},ZK={33071:Ol,33648:1002,10497:k0},YK={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},sG={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},av={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Tbe={CUBICSPLINE:void 0,LINEAR:ZT,STEP:$E};function wbe(i){return void 0===i.DefaultMaterial&&(i.DefaultMaterial=new bA({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),i.DefaultMaterial}function $A(i,e,t){for(const n in t.extensions)void 0===i[n]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function gb(i,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Sbe(i,e){if(i.updateMorphTargets(),void 0!==e.weights)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Cbe(i){const e=i.extensions&&i.extensions[qi.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+KK(e.attributes):i.indices+":"+KK(i.attributes)+":"+i.mode,t}function KK(i){let e="";const t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function aG(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class Abe{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new tbe,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};const n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1;this.textureLoader=typeof createImageBitmap>"u"||n||r&&s<98?new Vde(this.options.manager):new $de(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new xd(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};$A(s,a,r),gb(a,r),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(n[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[h,f]of o.children.entries())s(f,a.children[h])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[qi.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){n.load(Bm.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const s=t.byteOffset||0;return n.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=YK[r.type],h=XA[r.componentType],f=h.BYTES_PER_ELEMENT,g=r.byteOffset||0,v=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,y=!0===r.normalized;let b,T;if(v&&v!==f*l){const S=Math.floor(g/v),C="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+S+":"+r.count;let R=t.cache.get(C);R||(b=new h(a,S*v,r.count*v/f),R=new gU(b,v/f),t.cache.add(C,R)),T=new Q0(R,l,g%v/f,y)}else b=null===a?new h(r.count*l):new h(a,g,r.count*l),T=new Uo(b,l,y);if(void 0!==r.sparse){const I=r.sparse.values.byteOffset||0,L=new(0,XA[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*YK.SCALAR),N=new h(o[2],I,r.sparse.count*l);null!==a&&(T=new Uo(T.array.slice(),T.itemSize,T.normalized));for(let U=0,k=L.length;U<k;U++){const z=L[U];if(T.setX(z,N[U*l]),l>=2&&T.setY(z,N[U*l+1]),l>=3&&T.setZ(z,N[U*l+2]),l>=4&&T.setW(z,N[U*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return T})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,n){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const h=this.loadImageSource(t,n).then(function(f){f.flipY=!1,o.name&&(f.name=o.name);const g=(s.samplers||{})[o.sampler]||{};return f.magFilter=qK[g.magFilter]||io,f.minFilter=qK[g.minFilter]||B_,f.wrapS=ZK[g.wrapS]||k0,f.wrapT=ZK[g.wrapT]||k0,r.associations.set(f,{textures:e}),f}).catch(function(){return null});return this.textureCache[l]=h,h}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(m=>m.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",h=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(m){h=!0;const g=new Blob([m],{type:o.mimeType});return l=a.createObjectURL(g),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const f=Promise.resolve(l).then(function(m){return new Promise(function(g,v){let y=g;!0===t.isImageBitmapLoader&&(y=function(b){const T=new vd(b);T.needsUpdate=!0,g(T)}),t.load(Bm.resolveURL(m,s.path),y,void 0,v)})}).then(function(m){return!0===h&&a.revokeObjectURL(l),m.userData.mimeType=o.mimeType||function Ebe(i){return i.search(/\.jpe?g($|\?)/i)>0||0===i.search(/^data\:image\/jpeg/)?"image/jpeg":i.search(/\.webp($|\?)/i)>0||0===i.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),m}).catch(function(m){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),m});return this.sourceCache[e]=f,f}assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then(function(o){if(void 0!==n.texCoord&&0!=n.texCoord&&!("aoMap"===t&&1==n.texCoord)&&console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),s.extensions[qi.KHR_TEXTURE_TRANSFORM]){const a=void 0!==n.extensions?n.extensions[qi.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[qi.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return void 0!==r&&(o.encoding=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new xU,fh.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new _c,fh.prototype.copy.call(l,n),l.color.copy(n.color),this.cache.add(a,l)),n=l}if(r||s||o){let a="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(a+="specular-glossiness:"),r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return bA}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},l=s.extensions||{},h=[];if(l[qi.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const m=r[qi.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=m.getMaterialType(),h.push(m.extendParams(a,s,t))}else if(l[qi.KHR_MATERIALS_UNLIT]){const m=r[qi.KHR_MATERIALS_UNLIT];o=m.getMaterialType(),h.push(m.extendParams(a,s,t))}else{const m=s.pbrMetallicRoughness||{};if(a.color=new sn(1,1,1),a.opacity=1,Array.isArray(m.baseColorFactor)){const g=m.baseColorFactor;a.color.fromArray(g),a.opacity=g[3]}void 0!==m.baseColorTexture&&h.push(t.assignTexture(a,"map",m.baseColorTexture,ur)),a.metalness=void 0!==m.metallicFactor?m.metallicFactor:1,a.roughness=void 0!==m.roughnessFactor?m.roughnessFactor:1,void 0!==m.metallicRoughnessTexture&&(h.push(t.assignTexture(a,"metalnessMap",m.metallicRoughnessTexture)),h.push(t.assignTexture(a,"roughnessMap",m.metallicRoughnessTexture))),o=this._invokeOne(function(g){return g.getMaterialType&&g.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(g){return g.extendMaterialParams&&g.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=2);const f=s.alphaMode||"OPAQUE";if("BLEND"===f?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===f&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==Ta&&(h.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Je(1,1),void 0!==s.normalTexture.scale)){const m=s.normalTexture.scale;a.normalScale.set(m,m)}return void 0!==s.occlusionTexture&&o!==Ta&&(h.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==Ta&&(a.emissive=(new sn).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&o!==Ta&&h.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,ur)),Promise.all(h).then(function(){let m;return m=o===rG?r[qi.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new o(a),s.name&&(m.name=s.name),gb(m,s),t.associations.set(m,{materials:e}),s.extensions&&$A(r,m,s),m})}createUniqueName(e){const t=Jr.sanitizeNodeName(e||"");let n=t;for(let r=1;this.nodeNamesUsed[n];++r)n=t+"_"+r;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function s(a){return n[qi.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return $K(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const h=e[a],f=Cbe(h),m=r[f];if(m)o.push(m.promise);else{let g;g=h.extensions&&h.extensions[qi.KHR_DRACO_MESH_COMPRESSION]?s(h):$K(new Di,h,t),r[f]={primitive:h,promise:g},o.push(g)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,h=o.length;l<h;l++){const f=void 0===o[l].material?wbe(this.cache):this.getDependency("material",o[l].material);a.push(f)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const h=l.slice(0,l.length-1),f=l[l.length-1],m=[];for(let v=0,y=f.length;v<y;v++){const b=f[v],T=o[v];let S;const C=h[v];if(4===T.mode||5===T.mode||6===T.mode||void 0===T.mode)S=!0===s.isSkinnedMesh?new Nq(b,C):new aa(b,C),!0===S.isSkinnedMesh&&!S.geometry.attributes.skinWeight.normalized&&S.normalizeSkinWeights(),5===T.mode?S.geometry=QK(S.geometry,1):6===T.mode&&(S.geometry=QK(S.geometry,2));else if(1===T.mode)S=new bU(b,C);else if(3===T.mode)S=new J0(b,C);else if(2===T.mode)S=new qq(b,C);else{if(0!==T.mode)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+T.mode);S=new Yq(b,C)}Object.keys(S.geometry.morphAttributes).length>0&&Sbe(S,s),S.name=t.createUniqueName(s.name||"mesh_"+e),gb(S,s),T.extensions&&$A(r,S,T),t.assignFinalMaterial(S),m.push(S)}for(let v=0,y=m.length;v<y;v++)t.associations.set(m[v],{meshes:e,primitives:v});if(1===m.length)return m[0];const g=new Z_;t.associations.set(g,{meshes:e});for(let v=0,y=m.length;v<y;v++)g.add(m[v]);return g})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new Ma(HP.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new pw(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),gb(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then(function(r){return n.inverseBindMatrices=r,n})}loadAnimation(e){const n=this.json.animations[e],r=[],s=[],o=[],a=[],l=[];for(let h=0,f=n.channels.length;h<f;h++){const m=n.channels[h],g=n.samplers[m.sampler],v=m.target,b=void 0!==n.parameters?n.parameters[g.input]:g.input,T=void 0!==n.parameters?n.parameters[g.output]:g.output;r.push(this.getDependency("node",void 0!==v.node?v.node:v.id)),s.push(this.getDependency("accessor",b)),o.push(this.getDependency("accessor",T)),a.push(g),l.push(v)}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(h){const f=h[0],m=h[1],g=h[2],v=h[3],y=h[4],b=[];for(let S=0,C=f.length;S<C;S++){const R=f[S],I=m[S],L=g[S],N=v[S],U=y[S];if(void 0===R)continue;let k;switch(R.updateMatrix(),av[U.path]){case av.weights:k=TA;break;case av.rotation:k=tb;break;default:k=wA}const z=R.name?R.name:R.uuid,K=void 0!==N.interpolation?Tbe[N.interpolation]:ZT,te=[];av[U.path]===av.weights?R.traverse(function(ie){ie.morphTargetInfluences&&te.push(ie.name?ie.name:ie.uuid)}):te.push(z);let fe=L.array;if(L.normalized){const ie=aG(fe.constructor),ne=new Float32Array(fe.length);for(let le=0,Z=fe.length;le<Z;le++)ne[le]=fe[le]*ie;fe=ne}for(let ie=0,ne=te.length;ie<ne;ie++){const le=new k(te[ie]+"."+av[U.path],I.array,fe,K);"CUBICSPLINE"===N.interpolation&&(le.createInterpolant=function(he){return new(this instanceof tb?xbe:WK)(this.times,this.values,this.getValueSize()/3,he)},le.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),b.push(le)}}return new MA(n.name?n.name:"animation_"+e,void 0,b)})}createNodeMesh(e){const n=this,r=this.json.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,h=r.weights.length;l<h;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const n=this.extensions,r=this,s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"";return function(){const a=[],l=r._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(h){return r._getNodeRef(r.cameraCache,s.camera,h)})),r._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){a.push(h)}),Promise.all(a)}().then(function(a){let l;if(l=!0===s.isBone?new vU:a.length>1?new Z_:1===a.length?a[0]:new oa,l!==a[0])for(let h=0,f=a.length;h<f;h++)l.add(a[h]);if(s.name&&(l.userData.name=s.name,l.name=o),gb(l,s),s.extensions&&$A(n,l,s),void 0!==s.matrix){const h=new Jn;h.fromArray(s.matrix),l.applyMatrix4(h)}else void 0!==s.translation&&l.position.fromArray(s.translation),void 0!==s.rotation&&l.quaternion.fromArray(s.rotation),void 0!==s.scale&&l.scale.fromArray(s.scale);return r.associations.has(l)||r.associations.set(l,{}),r.associations.get(l).nodes=e,l})}loadScene(e){const t=this.json,n=this.extensions,r=this.json.scenes[e],s=this,o=new Z_;r.name&&(o.name=s.createUniqueName(r.name)),gb(o,r),r.extensions&&$A(n,o,r);const a=r.nodes||[],l=[];for(let h=0,f=a.length;h<f;h++)l.push(XK(a[h],o,t,s));return Promise.all(l).then(function(){return s.associations=(f=>{const m=new Map;for(const[g,v]of s.associations)(g instanceof fh||g instanceof vd)&&m.set(g,v);return f.traverse(g=>{const v=s.associations.get(g);null!=v&&m.set(g,v)}),m})(o),o})}}function XK(i,e,t,n){const r=t.nodes[i];return n.getDependency("node",i).then(function(s){if(void 0===r.skin)return s;let o;return n.getDependency("skin",r.skin).then(function(a){o=a;const l=[];for(let h=0,f=o.joints.length;h<f;h++)l.push(n.getDependency("node",o.joints[h]));return Promise.all(l)}).then(function(a){return s.traverse(function(l){if(!l.isMesh)return;const h=[],f=[];for(let m=0,g=a.length;m<g;m++){const v=a[m];if(v){h.push(v);const y=new Jn;void 0!==o.inverseBindMatrices&&y.fromArray(o.inverseBindMatrices.array,16*m),f.push(y)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',o.joints[m])}l.bind(new TF(h,f),l.matrixWorld)}),s})}).then(function(s){e.add(s);const o=[];if(r.children){const a=r.children;for(let l=0,h=a.length;l<h;l++)o.push(XK(a[l],s,t,n))}return Promise.all(o)})}function $K(i,e,t){const n=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){i.setAttribute(a,l)})}for(const o in n){const a=sG[o]||o.toLowerCase();a in i.attributes||r.push(s(n[o],a))}if(void 0!==e.indices&&!i.index){const o=t.getDependency("accessor",e.indices).then(function(a){i.setIndex(a)});r.push(o)}return gb(i,e),function Dbe(i,e,t){const n=e.attributes,r=new W0;if(void 0===n.POSITION)return;{const a=t.json.accessors[n.POSITION],l=a.min,h=a.max;if(void 0===l||void 0===h)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new Q(l[0],l[1],l[2]),new Q(h[0],h[1],h[2])),a.normalized){const f=aG(XA[a.componentType]);r.min.multiplyScalar(f),r.max.multiplyScalar(f)}}const s=e.targets;if(void 0!==s){const a=new Q,l=new Q;for(let h=0,f=s.length;h<f;h++){const m=s[h];if(void 0!==m.POSITION){const g=t.json.accessors[m.POSITION],v=g.min,y=g.max;if(void 0!==v&&void 0!==y){if(l.setX(Math.max(Math.abs(v[0]),Math.abs(y[0]))),l.setY(Math.max(Math.abs(v[1]),Math.abs(y[1]))),l.setZ(Math.max(Math.abs(v[2]),Math.abs(y[2]))),g.normalized){const b=aG(XA[g.componentType]);l.multiplyScalar(b)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}i.boundingBox=r;const o=new K0;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=o}(i,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function Mbe(i,e,t){let n=!1,r=!1,s=!1;for(let h=0,f=e.length;h<f;h++){const m=e[h];if(void 0!==m.POSITION&&(n=!0),void 0!==m.NORMAL&&(r=!0),void 0!==m.COLOR_0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(i);const o=[],a=[],l=[];for(let h=0,f=e.length;h<f;h++){const m=e[h];if(n){const g=void 0!==m.POSITION?t.getDependency("accessor",m.POSITION):i.attributes.position;o.push(g)}if(r){const g=void 0!==m.NORMAL?t.getDependency("accessor",m.NORMAL):i.attributes.normal;a.push(g)}if(s){const g=void 0!==m.COLOR_0?t.getDependency("accessor",m.COLOR_0):i.attributes.color;l.push(g)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(h){const m=h[1],g=h[2];return n&&(i.morphAttributes.position=h[0]),r&&(i.morphAttributes.normal=m),s&&(i.morphAttributes.color=g),i.morphTargetsRelative=!0,i})}(i,e.targets,t):i})}function QK(i,e){let t=i.getIndex();if(null===t){const o=[],a=i.getAttribute("position");if(void 0===a)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i;for(let l=0;l<a.count;l++)o.push(l);i.setIndex(o),t=i.getIndex()}const n=t.count-2,r=[];if(2===e)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=i.clone();return s.setIndex(r),s}var QA=function(){var i=0,e=document.createElement("div");function t(f){return e.appendChild(f.dom),f}function n(f){for(var m=0;m<e.children.length;m++)e.children[m].style.display=m===f?"block":"none";i=f}e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(f){f.preventDefault(),n(++i%e.children.length)},!1);var r=(performance||Date).now(),s=r,o=0,a=t(new QA.Panel("FPS","#0ff","#002")),l=t(new QA.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=t(new QA.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:e,addPanel:t,showPanel:n,begin:function(){r=(performance||Date).now()},end:function(){o++;var f=(performance||Date).now();if(l.update(f-r,200),f>=s+1e3&&(a.update(1e3*o/(f-s),100),s=f,o=0,h)){var m=performance.memory;h.update(m.usedJSHeapSize/1048576,m.jsHeapSizeLimit/1048576)}return f},update:function(){r=this.end()},domElement:e,setMode:n}};QA.Panel=function(i,e,t){var n=1/0,r=0,s=Math.round,o=s(window.devicePixelRatio||1),a=80*o,l=48*o,h=3*o,f=2*o,m=3*o,g=15*o,v=74*o,y=30*o,b=document.createElement("canvas");b.width=a,b.height=l,b.style.cssText="width:80px;height:48px";var T=b.getContext("2d");return T.font="bold "+9*o+"px Helvetica,Arial,sans-serif",T.textBaseline="top",T.fillStyle=t,T.fillRect(0,0,a,l),T.fillStyle=e,T.fillText(i,h,f),T.fillRect(m,g,v,y),T.fillStyle=t,T.globalAlpha=.9,T.fillRect(m,g,v,y),{dom:b,update:function(S,C){n=Math.min(n,S),r=Math.max(r,S),T.fillStyle=t,T.globalAlpha=1,T.fillRect(0,0,a,g),T.fillStyle=e,T.fillText(s(S)+" "+i+" ("+s(n)+"-"+s(r)+")",h,f),T.drawImage(b,m+o,g,v-o,y,m,g,v-o,y),T.fillRect(m+v-o,g,o,y),T.fillStyle=t,T.globalAlpha=.9,T.fillRect(m+v-o,g,o,s((1-S/C)*y))}}};const Rbe=QA;new Q,new Q,new Q,new Q,new Q,new sn,new tF,new Q;const Fn={decode:function(i,e){null==e&&(e={parseMN:!0,debug:!1});var t=new Uint8Array(i),n=0,s="II"==Fn._binBE.readASCII(t,n,2)?Fn._binLE:Fn._binBE;s.readUshort(t,n+=2);for(var o=s.readUint(t,n+=2),a=[];;){var l=s.readUshort(t,o),h=s.readUshort(t,o+4);if(0!=l&&(h<1||13<h)){console.log("error in TIFF");break}if(Fn._readIFD(s,t,o,a,0,e),0==(o=s.readUint(t,o+2+12*l)))break}return a},decodeImage:function(i,e,t){if(!e.data){var n=new Uint8Array(i),r=Fn._binBE.readASCII(n,0,2);if(null!=e.t256){e.isLE="II"==r,e.width=e.t256[0],e.height=e.t257[0];var a,s=e.t259?e.t259[0]:1,o=e.t266?e.t266[0]:1;e.t284&&2==e.t284[0]&&console.log("PlanarConfiguration 2 should not be used!"),7==s&&e.t258&&e.t258.length>3&&(e.t258=e.t258.slice(0,3)),a=e.t258?Math.min(32,e.t258[0])*e.t258.length:e.t277?e.t277[0]:1,1==s&&null!=e.t279&&e.t278&&32803==e.t262[0]&&(a=Math.round(8*e.t279[0]/(e.width*e.t278[0])));var l=8*Math.ceil(e.width*a/8),h=e.t273;null==h&&(h=e.t324);var f=e.t279;1==s&&1==h.length&&(f=[e.height*(l>>>3)]),null==f&&(f=e.t325);var m=new Uint8Array(e.height*(l>>>3)),g=0;if(null!=e.t322){for(var v=e.t322[0],y=e.t323[0],b=Math.floor((e.width+v-1)/v),T=Math.floor((e.height+y-1)/y),S=new Uint8Array(0|Math.ceil(v*y*a/8)),C=0;C<T;C++)for(var R=0;R<b;R++){for(var I=C*b+R,L=0;L<S.length;L++)S[L]=0;Fn.decode._decompress(e,t,n,h[I],f[I],s,S,0,o),6==s?m=S:Fn._copyTile(S,0|Math.ceil(v*a/8),y,m,0|Math.ceil(e.width*a/8),e.height,0|Math.ceil(R*v*a/8),C*y)}g=8*m.length}else{var N=e.t278?e.t278[0]:e.height;for(N=Math.min(N,e.height),I=0;I<h.length;I++)Fn.decode._decompress(e,t,n,h[I],f[I],s,m,0|Math.ceil(g/8),o),g+=l*N;g=Math.min(g,8*m.length)}e.data=new Uint8Array(m.buffer,0,0|Math.ceil(g/8))}}}};Fn.decode._decompress=function(i,e,t,n,r,s,o,a){34676==s?Fn.decode._decodeLogLuv32(i,t,n,r,o,a):console.log("Unsupported compression",s);var l=i.t258?Math.min(32,i.t258[0]):1,h=i.t277?i.t277[0]:1,f=l*h>>>3,m=i.t278?i.t278[0]:i.height,g=Math.ceil(l*h*i.width/8);if(16==l&&!i.isLE&&null==i.t33422)for(var v=0;v<m;v++)for(var y=a+v*g,b=1;b<g;b+=2){var T=o[y+b];o[y+b]=o[y+b-1],o[y+b-1]=T}if(i.t317&&2==i.t317[0])for(v=0;v<m;v++){var S=a+v*g;if(16==l)for(var C=f;C<g;C+=2){var R=(o[S+C+1]<<8|o[S+C])+(o[S+C-f+1]<<8|o[S+C-f]);o[S+C]=255&R,o[S+C+1]=R>>>8&255}else if(3==h)for(C=3;C<g;C+=3)o[S+C]=o[S+C]+o[S+C-3]&255,o[S+C+1]=o[S+C+1]+o[S+C-2]&255,o[S+C+2]=o[S+C+2]+o[S+C-1]&255;else for(C=f;C<g;C++)o[S+C]=o[S+C]+o[S+C-f]&255}},Fn.decode._decodeLogLuv32=function(i,e,t,n,r,s){for(var o=i.width,a=4*o,l=0,h=new Uint8Array(a);l<n;){for(var f=0;f<a;){var m=e[t+l];if(l++,m<128){for(var g=0;g<m;g++)h[f+g]=e[t+l+g];f+=m,l+=m}else{for(m-=126,g=0;g<m;g++)h[f+g]=e[t+l];f+=m,l++}}for(var v=0;v<o;v++)r[s+0]=h[v],r[s+1]=h[v+o],r[s+2]=h[v+2*o],r[s+4]=h[v+3*o],s+=6}},Fn.tags={},Fn._types=function(){var i=new Array(250);return i.fill(0),{basic:{main:i=i.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}(),Fn._readIFD=function(i,e,t,n,r,s){var o=i.readUshort(e,t);t+=2;var a={};s.debug&&console.log("   ".repeat(r),n.length-1,">>>----------------");for(var l=0;l<o;l++){var h=i.readUshort(e,t),f=i.readUshort(e,t+=2),m=i.readUint(e,t+=2),g=i.readUint(e,t+=4);t+=4;var v=[];if((1==f||7==f)&&(v=new Uint8Array(e.buffer,m<5?t-4:g,m)),2==f){var y=m<5?t-4:g,b=e[y],T=Math.max(0,Math.min(m-1,e.length-y));b<128||0==T?v.push(i.readASCII(e,y,T)):v=new Uint8Array(e.buffer,y,T)}if(3==f)for(var S=0;S<m;S++)v.push(i.readUshort(e,(m<3?t-4:g)+2*S));if(4==f||13==f)for(S=0;S<m;S++)v.push(i.readUint(e,(m<2?t-4:g)+4*S));if(5==f||10==f){var C=5==f?i.readUint:i.readInt;for(S=0;S<m;S++)v.push([C(e,g+8*S),C(e,g+8*S+4)])}if(8==f)for(S=0;S<m;S++)v.push(i.readShort(e,(m<3?t-4:g)+2*S));if(9==f)for(S=0;S<m;S++)v.push(i.readInt(e,(m<2?t-4:g)+4*S));if(11==f)for(S=0;S<m;S++)v.push(i.readFloat(e,g+4*S));if(12==f)for(S=0;S<m;S++)v.push(i.readDouble(e,g+8*S));if(0==m||0!=v.length){if(s.debug&&console.log("   ".repeat(r),h,f,Fn.tags[h],v),a["t"+h]=v,330==h||34665==h||34853==h||50740==h&&i.readUshort(e,i.readUint(v,0))<300||61440==h){var R=50740==h?[i.readUint(v,0)]:v,I=[];for(S=0;S<R.length;S++)Fn._readIFD(i,e,R[S],I,r+1,s);330==h&&(a.subIFD=I),34665==h&&(a.exifIFD=I[0]),34853==h&&(a.gpsiIFD=I[0]),50740==h&&(a.dngPrvt=I[0]),61440==h&&(a.fujiIFD=I[0])}if(37500==h&&s.parseMN){var L=v;if("Nikon"==i.readASCII(L,0,5))a.makerNote=Fn.decode(L.slice(10).buffer)[0];else if(i.readUshort(e,g)<300&&i.readUshort(e,g+4)<=12){var N=[];Fn._readIFD(i,e,g,N,r+1,s),a.makerNote=N[0]}}}else if(console.log(h,"unknown TIFF tag type: ",f,"num:",m),0==l)return}return n.push(a),s.debug&&console.log("   ".repeat(r),"<<<---------------"),t},Fn.toRGBA=function(i,e){const t=i.width,n=i.height,r=t*n,s=i.data;let o;switch(e){case Wf:o=new Uint16Array(4*r);break;case hh:o=new Float32Array(4*r);break;default:console.error("THREE.LogLuvLoader: Unsupported texture data type:",e)}let a=i.t262?i.t262[0]:2;const l=i.t258?Math.min(32,i.t258[0]):1;if(null==i.t262&&1==l&&(a=0),32845==a)for(let h=0;h<n;h++)for(let f=0;f<t;f++){const m=6*(h*t+f),g=4*(h*t+f);let v=s[m+1]<<8|s[m];v=Math.pow(2,(v+.5)/256-64);const y=(s[m+3]+.5)/410,b=(s[m+5]+.5)/410,T=9*y/(6*y-16*b+12),S=4*b/(6*y-16*b+12),R=T*v/S,L=(1-T-S)*v/S,N=2.69*R-1.276*v-.414*L,U=-1.022*R+1.978*v+.044*L,k=.061*R-.224*v+1.163*L;e===Wf?(o[g]=tL.toHalfFloat(Math.min(N,65504)),o[g+1]=tL.toHalfFloat(Math.min(U,65504)),o[g+2]=tL.toHalfFloat(Math.min(k,65504)),o[g+3]=tL.toHalfFloat(1)):(o[g]=N,o[g+1]=U,o[g+2]=k,o[g+3]=1)}else console.log("Unsupported Photometric interpretation: "+a);return o},Fn._binBE={nextZero:function(i,e){for(;0!=i[e];)e++;return e},readUshort:function(i,e){return i[e]<<8|i[e+1]},readShort:function(i,e){var t=Fn._binBE.ui8;return t[0]=i[e+1],t[1]=i[e+0],Fn._binBE.i16[0]},readInt:function(i,e){var t=Fn._binBE.ui8;return t[0]=i[e+3],t[1]=i[e+2],t[2]=i[e+1],t[3]=i[e+0],Fn._binBE.i32[0]},readUint:function(i,e){var t=Fn._binBE.ui8;return t[0]=i[e+3],t[1]=i[e+2],t[2]=i[e+1],t[3]=i[e+0],Fn._binBE.ui32[0]},readASCII:function(i,e,t){for(var n="",r=0;r<t;r++)n+=String.fromCharCode(i[e+r]);return n},readFloat:function(i,e){for(var t=Fn._binBE.ui8,n=0;n<4;n++)t[n]=i[e+3-n];return Fn._binBE.fl32[0]},readDouble:function(i,e){for(var t=Fn._binBE.ui8,n=0;n<8;n++)t[n]=i[e+7-n];return Fn._binBE.fl64[0]},writeUshort:function(i,e,t){i[e]=t>>8&255,i[e+1]=255&t},writeInt:function(i,e,t){var n=Fn._binBE.ui8;Fn._binBE.i32[0]=t,i[e+3]=n[0],i[e+2]=n[1],i[e+1]=n[2],i[e+0]=n[3]},writeUint:function(i,e,t){i[e]=t>>24&255,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=t>>0&255},writeASCII:function(i,e,t){for(var n=0;n<t.length;n++)i[e+n]=t.charCodeAt(n)},writeDouble:function(i,e,t){Fn._binBE.fl64[0]=t;for(var n=0;n<8;n++)i[e+n]=Fn._binBE.ui8[7-n]}},Fn._binBE.ui8=new Uint8Array(8),Fn._binBE.i16=new Int16Array(Fn._binBE.ui8.buffer),Fn._binBE.i32=new Int32Array(Fn._binBE.ui8.buffer),Fn._binBE.ui32=new Uint32Array(Fn._binBE.ui8.buffer),Fn._binBE.fl32=new Float32Array(Fn._binBE.ui8.buffer),Fn._binBE.fl64=new Float64Array(Fn._binBE.ui8.buffer),Fn._binLE={nextZero:Fn._binBE.nextZero,readUshort:function(i,e){return i[e+1]<<8|i[e]},readShort:function(i,e){var t=Fn._binBE.ui8;return t[0]=i[e+0],t[1]=i[e+1],Fn._binBE.i16[0]},readInt:function(i,e){var t=Fn._binBE.ui8;return t[0]=i[e+0],t[1]=i[e+1],t[2]=i[e+2],t[3]=i[e+3],Fn._binBE.i32[0]},readUint:function(i,e){var t=Fn._binBE.ui8;return t[0]=i[e+0],t[1]=i[e+1],t[2]=i[e+2],t[3]=i[e+3],Fn._binBE.ui32[0]},readASCII:Fn._binBE.readASCII,readFloat:function(i,e){for(var t=Fn._binBE.ui8,n=0;n<4;n++)t[n]=i[e+n];return Fn._binBE.fl32[0]},readDouble:function(i,e){for(var t=Fn._binBE.ui8,n=0;n<8;n++)t[n]=i[e+n];return Fn._binBE.fl64[0]},writeUshort:function(i,e,t){i[e]=255&t,i[e+1]=t>>8&255},writeInt:function(i,e,t){var n=Fn._binBE.ui8;Fn._binBE.i32[0]=t,i[e+0]=n[0],i[e+1]=n[1],i[e+2]=n[2],i[e+3]=n[3]},writeUint:function(i,e,t){i[e]=t>>>0&255,i[e+1]=t>>>8&255,i[e+2]=t>>>16&255,i[e+3]=t>>>24&255},writeASCII:Fn._binBE.writeASCII},Fn._copyTile=function(i,e,t,n,r,s,o,a){for(var l=Math.min(e,r-o),h=Math.min(t,s-a),f=0;f<h;f++)for(var m=(a+f)*r+o,g=f*e,v=0;v<l;v++)n[m+v]=i[g+v]},new sn;const Zbe=["rendererCanvas"];function u9(i){return!(!i||!i.set)}function ts(i,e){return u9(i)?void 0===e?i:Array.isArray(e)?(i.set(...e),i):i.copy&&e?(i.copy(e),i):void 0!==e?(i.set(e),i):i:e}function h9(i){return void 0!==i&&(i.observed||i.observers?.length>0)}class Kbe{constructor(){this.memberMap=new Map,this.children=[],this.eventListener={},this.add=(...e)=>(this.objRef&&this.objRef.add(...e),this.children.push(...e),this),this.remove=(...e)=>{this.objRef&&this.objRef.remove(...e);for(const t of e){const n=this.children.indexOf(t);n>=0&&(this.children=this.children.splice(n,1))}return this},this.applyToObject3D=e=>{if(this.memberMap.forEach((t,n)=>{const r=e[n];u9(r)?ts(r,t):e[n]=t}),this.children.forEach(t=>e.add(t)),this.objRef?.parent){const t=this.objRef?.parent;t.remove(this.objRef),t.add(e)}},this.addEventListener=(e,t)=>{let n=this.eventListener[e];n||(n=[],this.eventListener[e]=n),n.push(t),this.objRef&&this.objRef.addEventListener(e,t)},this.removeEventListener=(e,t)=>{const n=this.eventListener[e];if(!n)return;const r=n.indexOf(t);r>=0&&n.splice(r,1)}}get(e,t,n){switch(t){case"__isProxy":return!0;case"applyToObject3D":return this.applyToObject3D;case"objRef":return this.objRef;case"add":return this.add;case"remove":return this.remove;case"children":return this.objRef?this.objRef.children:this.children;default:{const r=t;let s=this.objRef?this.objRef[r]:this.memberMap.get(r);return void 0===s&&(s=e[r],void 0!==s&&this.memberMap.set(r,s)),s??e[r]}}}set(e,t,n,r){return"objRef"===t?(n&&this.applyToObject3D(n),this.objRef=n):(this.memberMap.set(t,n),this.objRef&&(this.objRef[t]=n)),!0}}function d9(i){return!0===i.__isProxy&&void 0===i.objRef}let ZL=(()=>{class i{constructor(){this.autoAddToParent=!0,this.autoDispose=!0}set objRef(t){this.applyObjRef(t)}get objRef(){return this._objRef}addToParent(){}removeFromParent(){}set threeEvents(t){this.removeEvents(),this.eventListeners=t,this.applyEvents()}get threeEvents(){return this.eventListeners}get onUpdate(){return this.updateEmitter||(this.updateEmitter=new c.vpe),this.updateEmitter}get objRef$(){return this._objRef$||(this._objRef$=new XZ(1)),this._objRef$}ngOnInit(){this.objRef||(this.objRef=this.createThreeInstance(this.args))}getType(){throw new Error("derive me")}createThreeInstance(t){return Array.isArray(t)?new(this.getType())(...t):new(this.getType())(t)}ngOnChanges(t){if(!this.objRef||d9(this.objRef)){t.objRef?.currentValue?this.objRef=t.objRef?.currentValue:this.objRef||(this.objRef=this.createThreeInstance(t.args?.currentValue));for(const n in t)this[n]=t[n].currentValue;this.emitPropertyChanges(t)}else this.emitPropertyChanges(t)}disposeObjRef(){(function Ybe(i){return!(!i||"function"!=typeof i.dispose)})(this.objRef)&&this.objRef.dispose()}ngOnDestroy(){this.removeEvents(),this.removeFromParent(),this.autoDispose&&this.disposeObjRef()}applyObjRef(t){this._objRef!==t&&(this.removeFromParent(),this._objRef=t,this.autoAddToParent&&this.addToParent(),this.emitObjRefChange())}emitObjRefChange(){this._objRef&&!d9(this._objRef)&&(this._objRef.dispatchEvent?.({type:"loaded",object:this._objRef}),this._objRef$&&this._objRef$.next(this._objRef))}emitPropertyChanges(t){this._objRef&&this._objRef.dispatchEvent?.({type:"changes",changes:t}),this.updateEmitter&&this.updateEmitter.next(t)}removeEvents(){if(this.eventListeners&&this._objRef){for(const t of Object.entries(this.eventListeners))this._objRef.removeEventListener(t[0],t[1]);this.eventListeners=void 0}}applyEvents(){if(this.eventListeners&&this._objRef)for(const t of Object.entries(this.eventListeners))this._objRef.addEventListener(t[0],t[1])}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=c.Xpm({type:i,selectors:[["th-abs-wrapper"]],inputs:{autoAddToParent:"autoAddToParent",autoDispose:"autoDispose",objRef:"objRef",args:"args",threeEvents:"threeEvents"},outputs:{onUpdate:"onUpdate",objRef$:"objRef$"},features:[c.TTD],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})(),$be=(()=>{class i extends ZL{constructor(t){super(),this.parent=t}addToParent(){this._objRef&&this._objRef.parent&&this._objRef.parent.uuid!==this.parent.objRef.uuid&&this.parent.objRef.add(this._objRef)}removeFromParent(){this._objRef?.parent?.remove(this._objRef)}applyObjRef(t){this.attachToParent(t,this._objRef),this._objRef=t,this.emitObjRefChange()}attachToParent(t,n){!this.parent.objRef||t===n&&n?.parent?.uuid===this.parent.objRef.uuid||(n&&n.parent&&n.parent.remove(n),t&&(!t.parent||t.parent&&t.parent.uuid!==this.parent.objRef.uuid)&&this.parent.objRef.add(t))}set lookAt(t){Promise.resolve().then(()=>{!this.objRef||(Array.isArray(t)?this.objRef.lookAt(...t):this.objRef.lookAt(t))})}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(i))},i.\u0275cmp=c.Xpm({type:i,selectors:[["th-abs-object"]],inputs:{lookAt:"lookAt"},features:[c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})(),Sr=(()=>{class i extends $be{constructor(t){super(t)}getType(){return oa}set id(t){this._objRef&&(this._objRef.id=t)}set uuid(t){this._objRef&&(this._objRef.uuid=t)}set name(t){this._objRef&&(this._objRef.name=t)}set type(t){this._objRef&&(this._objRef.type=t)}set children(t){this._objRef&&(this._objRef.children=t)}set up(t){this._objRef&&(this._objRef.up=ts(this._objRef.up,t))}set position(t){this._objRef&&ts(this._objRef.position,t)}set rotation(t){this._objRef&&ts(this._objRef.rotation,t)}set quaternion(t){this._objRef&&ts(this._objRef.quaternion,t)}set scale(t){this._objRef&&ts(this._objRef.scale,t)}set modelViewMatrix(t){this._objRef&&ts(this._objRef.modelViewMatrix,t)}set normalMatrix(t){this._objRef&&ts(this._objRef.normalMatrix,t)}set matrix(t){this._objRef&&(this._objRef.matrix=ts(this._objRef.matrix,t))}set matrixWorld(t){this._objRef&&(this._objRef.matrixWorld=ts(this._objRef.matrixWorld,t))}set matrixAutoUpdate(t){this._objRef&&(this._objRef.matrixAutoUpdate=t)}set matrixWorldNeedsUpdate(t){this._objRef&&(this._objRef.matrixWorldNeedsUpdate=t)}set layers(t){this._objRef&&(this._objRef.layers=ts(this._objRef.layers,t))}set visible(t){this._objRef&&(this._objRef.visible=t)}set castShadow(t){this._objRef&&(this._objRef.castShadow=t)}set receiveShadow(t){this._objRef&&(this._objRef.receiveShadow=t)}set frustumCulled(t){this._objRef&&(this._objRef.frustumCulled=t)}set renderOrder(t){this._objRef&&(this._objRef.renderOrder=t)}set animations(t){this._objRef&&(this._objRef.animations=t)}set userData(t){this._objRef&&(this._objRef.userData=t)}set customDepthMaterial(t){this._objRef&&(this._objRef.customDepthMaterial=t)}set customDistanceMaterial(t){this._objRef&&(this._objRef.customDistanceMaterial=t)}set onBeforeRender(t){this._objRef&&(this._objRef.onBeforeRender=t)}set onAfterRender(t){this._objRef&&(this._objRef.onAfterRender=t)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(i,4))},i.\u0275cmp=c.Xpm({type:i,selectors:[["th-object3D"]],inputs:{id:"id",uuid:"uuid",name:"name",type:"type",children:"children",up:"up",position:"position",rotation:"rotation",quaternion:"quaternion",scale:"scale",modelViewMatrix:"modelViewMatrix",normalMatrix:"normalMatrix",matrix:"matrix",matrixWorld:"matrixWorld",matrixAutoUpdate:"matrixAutoUpdate",matrixWorldNeedsUpdate:"matrixWorldNeedsUpdate",layers:"layers",visible:"visible",castShadow:"castShadow",receiveShadow:"receiveShadow",frustumCulled:"frustumCulled",renderOrder:"renderOrder",animations:"animations",userData:"userData",customDepthMaterial:"customDepthMaterial",customDistanceMaterial:"customDistanceMaterial",onBeforeRender:"onBeforeRender",onAfterRender:"onAfterRender"},features:[c._Bn([]),c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();var Gw=(()=>(function(i){i.mouseEnter="mouseEnter",i.mouseExit="mouseExit",i.click="click"}(Gw||(Gw={})),Gw))();let JA=(()=>{class i{constructor(){this.raycaster=new YF,this.selected=null,this.enabled=!0,this.groups=[],this.paused=!1,this.maxClickDistance=23,this.nid=i.instanceCnt++,this.onPointerMove=this.onPointerMove.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerUp=this.onPointerUp.bind(this)}ngOnDestroy(){this.disable(),this.unsubscribe()}subscribe(){if(!this.canvas)throw new Error("missing canvas");this.canvas.addEventListener("pointermove",this.onPointerMove),this.canvas.addEventListener("pointerdown",this.onPointerDown),this.canvas.addEventListener("pointerup",this.onPointerUp)}unsubscribe(){if(!this.canvas)throw new Error("missing canvas");this.canvas.removeEventListener("pointermove",this.onPointerMove),this.canvas.removeEventListener("pointerdown",this.onPointerDown),this.canvas.removeEventListener("pointerup",this.onPointerUp)}enable(){this.enabled=!0}disable(){this.enabled=!1}pause(){this.paused=!0}resume(){this.paused=!1}get isEnabled(){return this.enabled}init(t,n){this.camera=t,this.canvas=n,this.subscribe()}addEventTarget(t){this.groups.push(t)}removeEventTarget(t){const n=this.groups.indexOf(t);n>=0&&this.groups.splice(n,1)}onPointerMove(t){if(!this.isReady())return;const n=this.getFirstIntersectedGroup(t.layerX,t.layerY);if((!this.selected||this.selected!==n.target)&&(this.selected&&(this.selected.host.objRef?.dispatchEvent({type:Gw.mouseExit}),this.selected.onMouseExit(),this.selected=null),n&&n.target)){this.selected=n.target;const r={type:Gw.mouseEnter,face:n.face};this.selected.host.objRef?.dispatchEvent(r),this.selected.onMouseEnter(r)}}onPointerDown(t){this.maxClickDistance=t.width,this.pointerDownEvent=t}onPointerUp(t){const n=this.pointerDownEvent;if(this.pointerDownEvent=void 0,!this.isReady()||this.calcPointerDownUpDinstance(t,n)>this.maxClickDistance)return;const r=this.getFirstIntersectedGroup(t.layerX,t.layerY);if(r&&r.target&&r.target.host.objRef){const s={type:Gw.click,face:r.face};r.target.host.objRef.dispatchEvent(s),r.target.onClick(s)}}isReady(t){return!!(this.enabled&&(t||!this.paused)&&this.camera&&this.camera.objRef&&this.groups&&this.groups.length>0)}calcPointerDownUpDinstance(t,n){if(!n)return Number.MAX_VALUE;const r=t.layerX-n.layerX,s=t.layerY-n.layerY;return Math.sqrt(r*r+s*s)}getFirstIntersectedGroup(t,n){if(!this.camera||!this.canvas||!this.camera.objRef)return{face:null,target:null};const r=new Je(t=t/this.canvas.clientWidth*2-1,n=-n/this.canvas.clientHeight*2+1);this.raycaster.setFromCamera(r,this.camera.objRef);let o,a,s=null;for(const l of this.groups){const h=l.host.objRef;if(!h)continue;const f=this.raycaster.intersectObject(h,!0);f.length>0&&(!o||o.distance>f[0].distance)&&(o=f[0],s=o.face,a=l)}return a?{target:a,face:s}:{target:null,face:null}}}return i.instanceCnt=0,i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})(),Qbe=(()=>{class i{constructor(t,n){this.host=t,this.raycasterService=n,this.mouseEnter=new c.vpe,this.mouseExit=new c.vpe,this.click=new c.vpe,this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseExit=this.onMouseExit.bind(this),this.onClick=this.onClick.bind(this)}ngAfterViewInit(){this.subscribeEvents()}subscribeEvents(){this.raycasterService.addEventTarget(this)}unSubscribeEvents(){this.raycasterService.removeEventTarget(this)}onMouseExit(){this.mouseExit.emit({component:this.host})}onMouseEnter(t){this.mouseEnter.emit({component:this.host,face:t.face})}onClick(t){this.click.emit({component:this.host,face:t.face})}ngOnDestroy(){this.unSubscribeEvents()}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(Sr,1),c.Y36(JA))},i.\u0275dir=c.lG2({type:i,selectors:[["","onClick",""],["","onMouseEnter",""],["","onMouseExit",""]],outputs:{mouseEnter:"onMouseEnter",mouseExit:"onMouseExit",click:"onClick"}}),i})(),_b=(()=>{class i extends Sr{getType(){return dF}set matrixWorldInverse(t){this._objRef&&(this._objRef.matrixWorldInverse=ts(this._objRef.matrixWorldInverse,t))}set projectionMatrix(t){this._objRef&&(this._objRef.projectionMatrix=ts(this._objRef.projectionMatrix,t))}set projectionMatrixInverse(t){this._objRef&&(this._objRef.projectionMatrixInverse=ts(this._objRef.projectionMatrixInverse,t))}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275cmp=c.Xpm({type:i,selectors:[["th-camera"]],inputs:{matrixWorldInverse:"matrixWorldInverse",projectionMatrix:"projectionMatrix",projectionMatrixInverse:"projectionMatrixInverse"},features:[c._Bn([{provide:Sr,useExisting:(0,c.Gpc)(()=>i)}]),c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),hG=(()=>{class i extends Sr{getType(){return Eq}set type(t){this._objRef&&(this._objRef.type=t)}set fog(t){this._objRef&&(this._objRef.fog=t)}set overrideMaterial(t){this._objRef&&(this._objRef.overrideMaterial=t)}set autoUpdate(t){this._objRef&&(this._objRef.autoUpdate=t)}set background(t){this._objRef&&(this._objRef.background=ts(this._objRef.background,t))}set environment(t){this._objRef&&(this._objRef.environment=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275cmp=c.Xpm({type:i,selectors:[["th-scene"]],inputs:{type:"type",fog:"fog",overrideMaterial:"overrideMaterial",autoUpdate:"autoUpdate",background:"background",environment:"environment"},features:[c._Bn([{provide:Sr,useExisting:(0,c.Gpc)(()=>i)}]),c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})();const f9={alpha:!0,antialias:!0,preserveDrawingBuffer:!0};let zw=(()=>{class i{constructor(t){this.ngZone=t,this.clock=new EZ,this.destroyed$=new Bn.x,this.resizeEmitter=new c.vpe,this.beforeRenderEmitter=new c.vpe,this.views=[],this.beforeRender$=this.beforeRenderEmitter.pipe(Xr(this.destroyed$)),this.resize$=this.resizeEmitter.pipe(Xr(this.destroyed$))}get canvas(){return this.rendererParameters?.domElement}get renderer(){return this._renderer}ngOnDestroy(){this.resizeObserver&&this.canvas&&this.resizeObserver.unobserve(this.canvas)}initResizeObserver(){this.ngZone.runOutsideAngular(()=>{if(!this.canvas)throw new Error("missing canvas element");this.resize(),this.resizeObserver||(this.resizeObserver=new ResizeObserver(()=>{this.resize()})),this.resizeObserver.observe(this.canvas)})}initRenderer(){this._renderer||(this._renderer=new Cq({canvas:this.rendererParameters?.domElement,...f9}),Object.assign(this._renderer,{...f9,...this.rendererParameters}),this.resize())}setRenderer(t){this.rendererParameters=t,this.initRenderer(),this.initResizeObserver()}addView(t){this.views.push(t);const n=this.calcRendererSize();n&&this.adjustViewDimensions(t,n.width,n.height)}render(){this.beforeRenderEmitter.emit({engine:this,delta:this.clock.getDelta()});for(const t of this.views)this.renderView(t)}renderView(t){if(!this._renderer)return;const n=t.camera,r=t.scene;if(!(n&&r&&n.objRef&&r.objRef))return;const s=this._renderer;h9(t.onRender)&&this.ngZone.run(()=>t.onRender.emit({renderer:s,scene:r,camera:n})),this.applyRendererParametersFromView(t),t.effectComposer?t.effectComposer.render():this._renderer.render(r.objRef,n.objRef)}applyRendererParametersFromView(t){!this._renderer||(t.viewPort&&(t.viewPort instanceof hr?this._renderer.setViewport(t.viewPort):this._renderer.setViewport(t.viewPort.x,t.viewPort.y,t.viewPort.width,t.viewPort.height)),t.scissor&&(t.scissor instanceof hr?this._renderer.setScissor(t.scissor):this._renderer.setScissor(t.scissor.x,t.scissor.y,t.scissor.width,t.scissor.height)),void 0!==t.scissorTest&&this._renderer.setScissorTest(t.scissorTest),t.clearColor&&this._renderer.setClearColor(t.clearColor),void 0!==t.clearAlpha&&this._renderer.setClearAlpha(t.clearAlpha),void 0!==t.shadow&&(this._renderer.shadowMap.enabled=!0))}resize(){if(!this._renderer||!this.canvas)return!1;const{width:t,height:n}=this.calcRendererSize();this._renderer.setSize(t,n,!1);for(const r of this.views)this.adjustViewDimensions(r,t,n);return this.resizeEmitter.emit({width:t,height:n}),!0}calcRendererSize(){if(!this._renderer||!this.canvas)return;const t=window.devicePixelRatio;return{width:(this.canvas.clientWidth??0)*t,height:(this.canvas.clientHeight??0)*t}}adjustViewDimensions(t,n,r){t.viewPort||(t.camera&&t.camera.objRef.aspect&&(t.camera.objRef.aspect=n/r,t.camera.objRef.updateProjectionMatrix()),t.effectComposer?.setSize(n,r))}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(c.R0b))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})(),dG=(()=>{class i{constructor(t,n){this.engServ=t,this.raycaster=n,this.onRender=new c.vpe}set contentScene(t){t&&(this.scene=t)}set effectComposer(t){this._effectComposer=t,this.configureEffectComposerRenderTarget()}get effectComposer(){return this._effectComposer}set camera(t){this._camera=t,this.initRaycaster()}get camera(){return this._camera}set contentCamera(t){t&&(this.camera=t)}set viewPort(t){this._viewPort=t,this.configureEffectComposerRenderTarget()}get viewPort(){return this._viewPort}ngOnInit(){this.initRaycaster()}initRaycaster(){this.camera&&this.engServ.canvas&&this.raycaster.init(this.camera,this.engServ.canvas)}add(t){}remove(t){}configureEffectComposerRenderTarget(){if(this.viewPort&&this.effectComposer){let t,n;this.viewPort instanceof hr?(t=this.viewPort.z,n=this.viewPort?.width):(t=this.viewPort.width,n=this.viewPort.height),this.effectComposer.setSize(t,n)}}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(zw),c.Y36(JA))},i.\u0275cmp=c.Xpm({type:i,selectors:[["th-view"]],contentQueries:function(t,n,r){if(1&t&&(c.Suo(r,hG,5),c.Suo(r,_b,5)),2&t){let s;c.iGM(s=c.CRH())&&(n.contentScene=s.first),c.iGM(s=c.CRH())&&(n.contentCamera=s.first)}},inputs:{scene:"scene",effectComposer:"effectComposer",camera:"camera",shadow:"shadow",viewPort:"viewPort",scissor:"scissor",scissorTest:"scissorTest",clearColor:"clearColor",clearAlpha:"clearAlpha"},outputs:{onRender:"onRender"},features:[c._Bn([{provide:Sr,useExisting:(0,c.Gpc)(()=>i)},JA])],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})(),Hw=(()=>{class i{constructor(t,n){this.engineService=t,this.ngZone=n,this.active=!0,this.destroyed$=new Bn.x,this.beforeRender$=this.engineService.beforeRender$,this.engineService.resize$.pipe(Xr(this.destroyed$)).subscribe(()=>this.requestAnimationFrame())}ngOnDestroy(){this.stop(),this.destroyed$.next(),this.destroyed$.complete()}start(){this.active||(this.active=!0,this.requestAnimationFrame())}stop(){this.active=!1,void 0!==this.frameId&&(cancelAnimationFrame(this.frameId),this.frameId=void 0)}isActive(){return this.active}requestAnimationFrame(){void 0===this.frameId&&this.ngZone.runOutsideAngular(()=>this.frameId=requestAnimationFrame(()=>{this.frameId=void 0,this.engineService.render(),this.active&&this.requestAnimationFrame()}))}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(zw),c.LFG(c.R0b))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})(),fG=(()=>{class i extends dG{constructor(t,n,r){super(t,r),this.engServ=t,this.animationLoop=n,this.raycaster=r,this.nid=i.instanceCnt++,this.disableDefaultView=!1}get obj(){return this}set views(t){t.forEach(n=>this.engServ.addView(n))}set rendererCanvas(t){!t||(this._rendererCanvas=t,t.nativeElement.id+=this.nid)}get rendererCanvas(){return this._rendererCanvas}ngAfterContentChecked(){this.animationLoop.requestAnimationFrame()}ngAfterViewInit(){this.animationLoop.requestAnimationFrame()}ngOnInit(){this.applyRendererParameters(),super.ngOnInit(),this.disableDefaultView||this.engServ.addView(this)}applyRendererParameters(){if(!this.rendererCanvas)throw new Error("Missing Canvas");this.engServ.setRenderer({...this.rendererParameters,domElement:this.rendererCanvas.nativeElement})}}return i.instanceCnt=0,i.\u0275fac=function(t){return new(t||i)(c.Y36(zw),c.Y36(Hw),c.Y36((0,c.Gpc)(()=>JA)))},i.\u0275cmp=c.Xpm({type:i,selectors:[["th-canvas"]],contentQueries:function(t,n,r){if(1&t&&c.Suo(r,dG,4),2&t){let s;c.iGM(s=c.CRH())&&(n.views=s)}},viewQuery:function(t,n){if(1&t&&c.Gf(Zbe,7),2&t){let r;c.iGM(r=c.CRH())&&(n.rendererCanvas=r.first)}},inputs:{rendererParameters:"rendererParameters",disableDefaultView:"disableDefaultView"},features:[c._Bn([{provide:Sr,useExisting:(0,c.Gpc)(()=>i)},zw,Hw,(0,c.Gpc)(()=>JA),{provide:dG,useExisting:(0,c.Gpc)(()=>i)}]),c.qOj],decls:2,vars:0,consts:[["id","rendererCanvas"],["rendererCanvas",""]],template:function(t,n){1&t&&c._UZ(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{display:flex;flex:auto;line-height:0;height:100%}canvas[_ngcontent-%COMP%]{flex:auto;outline:none;width:100%;height:100%}"],changeDetection:0}),i})(),pG=(()=>{class i extends ZL{constructor(t,n){super(),this._camera=t,this.canvas=n,this.renderLoop=(0,c.f3M)(Hw)}createThreeInstance(t){t||(t=[this._camera.objRef,this.canvas?.rendererCanvas?.nativeElement]);const n=super.createThreeInstance(t);return this.patchDispatchEvent(n),this.subscribeControlUpdater(n),n}patchDispatchEvent(t){if(t.dispatchEvent){const n=this.origDispatchEventMethod=t.dispatchEvent;t.dispatchEvent=r=>{n.call(t,r),this.renderLoop.requestAnimationFrame()}}}ngOnDestroy(){super.ngOnDestroy(),this.unpatchDispatchEvent(),this.unsubscribeControlUpdater()}unpatchDispatchEvent(){this.origDispatchEventMethod&&this._objRef&&(this._objRef.dispatchEvent=this.origDispatchEventMethod)}subscribeControlUpdater(t){void 0!==t.update&&(this.beforeRenderSubscription=this.renderLoop.beforeRender$.subscribe(n=>{t.update(n.delta)}))}unsubscribeControlUpdater(){this.beforeRenderSubscription&&this.beforeRenderSubscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(Sr),c.Y36(fG))},i.\u0275cmp=c.Xpm({type:i,selectors:[["th-abs-control"]],features:[c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})(),p9=(()=>{class i extends Sr{getType(){return Dw}set type(t){this._objRef&&(this._objRef.type=t)}set color(t){this._objRef&&(this._objRef.color=ts(this._objRef.color,t))}set intensity(t){this._objRef&&(this._objRef.intensity=t)}set shadow(t){this._objRef&&(this._objRef.shadow=t)}set shadowCameraFov(t){this._objRef&&(this._objRef.shadowCameraFov=t)}set shadowCameraLeft(t){this._objRef&&(this._objRef.shadowCameraLeft=t)}set shadowCameraRight(t){this._objRef&&(this._objRef.shadowCameraRight=t)}set shadowCameraTop(t){this._objRef&&(this._objRef.shadowCameraTop=t)}set shadowCameraBottom(t){this._objRef&&(this._objRef.shadowCameraBottom=t)}set shadowCameraNear(t){this._objRef&&(this._objRef.shadowCameraNear=t)}set shadowCameraFar(t){this._objRef&&(this._objRef.shadowCameraFar=t)}set shadowBias(t){this._objRef&&(this._objRef.shadowBias=t)}set shadowMapWidth(t){this._objRef&&(this._objRef.shadowMapWidth=t)}set shadowMapHeight(t){this._objRef&&(this._objRef.shadowMapHeight=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275cmp=c.Xpm({type:i,selectors:[["th-light"]],inputs:{type:"type",color:"color",intensity:"intensity",shadow:"shadow",shadowCameraFov:"shadowCameraFov",shadowCameraLeft:"shadowCameraLeft",shadowCameraRight:"shadowCameraRight",shadowCameraTop:"shadowCameraTop",shadowCameraBottom:"shadowCameraBottom",shadowCameraNear:"shadowCameraNear",shadowCameraFar:"shadowCameraFar",shadowBias:"shadowBias",shadowMapWidth:"shadowMapWidth",shadowMapHeight:"shadowMapHeight"},features:[c._Bn([{provide:Sr,useExisting:(0,c.Gpc)(()=>i)}]),c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),m9=(()=>{class i extends p9{getType(){return xZ}set type(t){this._objRef&&(this._objRef.type=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275cmp=c.Xpm({type:i,selectors:[["th-ambientLight"]],inputs:{type:"type"},features:[c._Bn([{provide:Sr,useExisting:(0,c.Gpc)(()=>i)}]),c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),g9=(()=>{class i extends _b{getType(){return Ma}set type(t){this._objRef&&(this._objRef.type=t)}set zoom(t){this._objRef&&(this._objRef.zoom=t)}set fov(t){this._objRef&&(this._objRef.fov=t)}set aspect(t){this._objRef&&(this._objRef.aspect=t)}set near(t){this._objRef&&(this._objRef.near=t)}set far(t){this._objRef&&(this._objRef.far=t)}set focus(t){this._objRef&&(this._objRef.focus=t)}set view(t){this._objRef&&(this._objRef.view=t)}set filmGauge(t){this._objRef&&(this._objRef.filmGauge=t)}set filmOffset(t){this._objRef&&(this._objRef.filmOffset=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275cmp=c.Xpm({type:i,selectors:[["th-perspectiveCamera"]],inputs:{type:"type",zoom:"zoom",fov:"fov",aspect:"aspect",near:"near",far:"far",focus:"focus",view:"view",filmGauge:"filmGauge",filmOffset:"filmOffset"},features:[c._Bn([{provide:Sr,useExisting:(0,c.Gpc)(()=>i)},{provide:_b,useExisting:(0,c.Gpc)(()=>i)}]),c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),Jbe=(()=>{class i extends ZL{constructor(t){super(),this.parent=t}addToParent(){!this.parent.objRef||(this.parent.objRef.geometry=this.objRef,this.parent.objRef.updateMorphTargets&&this.parent.objRef.updateMorphTargets())}removeFromParent(){this._objRef&&this.parent&&this.parent.objRef&&(this.parent.objRef.geometry=void 0)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(Sr))},i.\u0275cmp=c.Xpm({type:i,selectors:[["th-abs-geometry"]],features:[c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})(),_9=(()=>{class i extends Jbe{constructor(t){super(t)}getType(){return Di}set id(t){this._objRef&&(this._objRef.id=t)}set uuid(t){this._objRef&&(this._objRef.uuid=t)}set name(t){this._objRef&&(this._objRef.name=t)}set type(t){this._objRef&&(this._objRef.type=t)}set index(t){this._objRef&&(this._objRef.index=ts(this._objRef.index,t))}set attributes(t){this._objRef&&(this._objRef.attributes=t)}set morphAttributes(t){this._objRef&&(this._objRef.morphAttributes=t)}set morphTargetsRelative(t){this._objRef&&(this._objRef.morphTargetsRelative=t)}set groups(t){this._objRef&&(this._objRef.groups=t)}set boundingBox(t){this._objRef&&(this._objRef.boundingBox=ts(this._objRef.boundingBox,t))}set boundingSphere(t){this._objRef&&(this._objRef.boundingSphere=ts(this._objRef.boundingSphere,t))}set drawRange(t){this._objRef&&(this._objRef.drawRange=t)}set userData(t){this._objRef&&(this._objRef.userData=t)}set drawcalls(t){this._objRef&&(this._objRef.drawcalls=t)}set offsets(t){this._objRef&&(this._objRef.offsets=t)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(Sr,4))},i.\u0275cmp=c.Xpm({type:i,selectors:[["th-bufferGeometry"]],inputs:{id:"id",uuid:"uuid",name:"name",type:"type",index:"index",attributes:"attributes",morphAttributes:"morphAttributes",morphTargetsRelative:"morphTargetsRelative",groups:"groups",boundingBox:"boundingBox",boundingSphere:"boundingSphere",drawRange:"drawRange",userData:"userData",drawcalls:"drawcalls",offsets:"offsets"},features:[c._Bn([]),c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),exe=(()=>{class i extends _9{getType(){return q_}set type(t){this._objRef&&(this._objRef.type=t)}set parameters(t){this._objRef&&(this._objRef.parameters=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275cmp=c.Xpm({type:i,selectors:[["th-boxGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[c._Bn([{provide:_9,useExisting:(0,c.Gpc)(()=>i)}]),c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),txe=(()=>{class i extends p9{getType(){return fZ}set type(t){this._objRef&&(this._objRef.type=t)}set position(t){this._objRef&&(this._objRef.position=ts(this._objRef.position,t))}set groundColor(t){this._objRef&&(this._objRef.groundColor=ts(this._objRef.groundColor,t))}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275cmp=c.Xpm({type:i,selectors:[["th-hemisphereLight"]],inputs:{type:"type",position:"position",groundColor:"groundColor"},features:[c._Bn([{provide:Sr,useExisting:(0,c.Gpc)(()=>i)}]),c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),nxe=(()=>{class i extends Sr{getType(){return aa}set geometry(t){this._objRef&&(this._objRef.geometry=t)}set material(t){this._objRef&&(this._objRef.material=t)}set morphTargetInfluences(t){this._objRef&&(this._objRef.morphTargetInfluences=t)}set morphTargetDictionary(t){this._objRef&&(this._objRef.morphTargetDictionary=t)}set type(t){this._objRef&&(this._objRef.type=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275cmp=c.Xpm({type:i,selectors:[["th-mesh"]],inputs:{geometry:"geometry",material:"material",morphTargetInfluences:"morphTargetInfluences",morphTargetDictionary:"morphTargetDictionary",type:"type"},features:[c._Bn([{provide:Sr,useExisting:(0,c.Gpc)(()=>i)}]),c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),ixe=(()=>{class i extends ZL{constructor(t){super(),this.parent=t}addToParent(){if(!this.parent.objRef)throw new Error("parent object doesn't hold a three js object instance");this.parent.objRef.material=this.objRef}removeFromParent(){this._objRef&&this.parent&&this.parent.objRef&&(this.parent.objRef.material=void 0)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(Sr))},i.\u0275cmp=c.Xpm({type:i,selectors:[["th-abs-material"]],features:[c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})(),v9=(()=>{class i extends ixe{constructor(t){super(t)}getType(){return fh}set alphaTest(t){this._objRef&&(this._objRef.alphaTest=t)}set alphaToCoverage(t){this._objRef&&(this._objRef.alphaToCoverage=t)}set blendDst(t){this._objRef&&(this._objRef.blendDst=t)}set blendDstAlpha(t){this._objRef&&(this._objRef.blendDstAlpha=t)}set blendEquation(t){this._objRef&&(this._objRef.blendEquation=t)}set blendEquationAlpha(t){this._objRef&&(this._objRef.blendEquationAlpha=t)}set blending(t){this._objRef&&(this._objRef.blending=t)}set blendSrc(t){this._objRef&&(this._objRef.blendSrc=t)}set blendSrcAlpha(t){this._objRef&&(this._objRef.blendSrcAlpha=t)}set clipIntersection(t){this._objRef&&(this._objRef.clipIntersection=t)}set clippingPlanes(t){this._objRef&&(this._objRef.clippingPlanes=t)}set clipShadows(t){this._objRef&&(this._objRef.clipShadows=t)}set colorWrite(t){this._objRef&&(this._objRef.colorWrite=t)}set defines(t){this._objRef&&(this._objRef.defines=t)}set depthFunc(t){this._objRef&&(this._objRef.depthFunc=t)}set depthTest(t){this._objRef&&(this._objRef.depthTest=t)}set depthWrite(t){this._objRef&&(this._objRef.depthWrite=t)}set id(t){this._objRef&&(this._objRef.id=t)}set stencilWrite(t){this._objRef&&(this._objRef.stencilWrite=t)}set stencilFunc(t){this._objRef&&(this._objRef.stencilFunc=t)}set stencilRef(t){this._objRef&&(this._objRef.stencilRef=t)}set stencilWriteMask(t){this._objRef&&(this._objRef.stencilWriteMask=t)}set stencilFuncMask(t){this._objRef&&(this._objRef.stencilFuncMask=t)}set stencilFail(t){this._objRef&&(this._objRef.stencilFail=t)}set stencilZFail(t){this._objRef&&(this._objRef.stencilZFail=t)}set stencilZPass(t){this._objRef&&(this._objRef.stencilZPass=t)}set name(t){this._objRef&&(this._objRef.name=t)}set needsUpdate(t){this._objRef&&(this._objRef.needsUpdate=t)}set opacity(t){this._objRef&&(this._objRef.opacity=t)}set polygonOffset(t){this._objRef&&(this._objRef.polygonOffset=t)}set polygonOffsetFactor(t){this._objRef&&(this._objRef.polygonOffsetFactor=t)}set polygonOffsetUnits(t){this._objRef&&(this._objRef.polygonOffsetUnits=t)}set precision(t){this._objRef&&(this._objRef.precision=t)}set premultipliedAlpha(t){this._objRef&&(this._objRef.premultipliedAlpha=t)}set dithering(t){this._objRef&&(this._objRef.dithering=t)}set side(t){this._objRef&&(this._objRef.side=t)}set shadowSide(t){this._objRef&&(this._objRef.shadowSide=t)}set toneMapped(t){this._objRef&&(this._objRef.toneMapped=t)}set transparent(t){this._objRef&&(this._objRef.transparent=t)}set type(t){this._objRef&&(this._objRef.type=t)}set uuid(t){this._objRef&&(this._objRef.uuid=t)}set vertexColors(t){this._objRef&&(this._objRef.vertexColors=t)}set visible(t){this._objRef&&(this._objRef.visible=t)}set userData(t){this._objRef&&(this._objRef.userData=t)}set version(t){this._objRef&&(this._objRef.version=t)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(Sr,4))},i.\u0275cmp=c.Xpm({type:i,selectors:[["th-material"]],inputs:{alphaTest:"alphaTest",alphaToCoverage:"alphaToCoverage",blendDst:"blendDst",blendDstAlpha:"blendDstAlpha",blendEquation:"blendEquation",blendEquationAlpha:"blendEquationAlpha",blending:"blending",blendSrc:"blendSrc",blendSrcAlpha:"blendSrcAlpha",clipIntersection:"clipIntersection",clippingPlanes:"clippingPlanes",clipShadows:"clipShadows",colorWrite:"colorWrite",defines:"defines",depthFunc:"depthFunc",depthTest:"depthTest",depthWrite:"depthWrite",id:"id",stencilWrite:"stencilWrite",stencilFunc:"stencilFunc",stencilRef:"stencilRef",stencilWriteMask:"stencilWriteMask",stencilFuncMask:"stencilFuncMask",stencilFail:"stencilFail",stencilZFail:"stencilZFail",stencilZPass:"stencilZPass",name:"name",needsUpdate:"needsUpdate",opacity:"opacity",polygonOffset:"polygonOffset",polygonOffsetFactor:"polygonOffsetFactor",polygonOffsetUnits:"polygonOffsetUnits",precision:"precision",premultipliedAlpha:"premultipliedAlpha",dithering:"dithering",side:"side",shadowSide:"shadowSide",toneMapped:"toneMapped",transparent:"transparent",type:"type",uuid:"uuid",vertexColors:"vertexColors",visible:"visible",userData:"userData",version:"version"},features:[c._Bn([]),c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),rxe=(()=>{class i extends pG{getType(){return X7}set object(t){this._objRef&&(this._objRef.object=t)}set domElement(t){this._objRef&&(this._objRef.domElement=t)}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set target(t){this._objRef&&(this._objRef.target=ts(this._objRef.target,t))}set center(t){this._objRef&&(this._objRef.center=ts(this._objRef.center,t))}set minDistance(t){this._objRef&&(this._objRef.minDistance=t)}set maxDistance(t){this._objRef&&(this._objRef.maxDistance=t)}set minZoom(t){this._objRef&&(this._objRef.minZoom=t)}set maxZoom(t){this._objRef&&(this._objRef.maxZoom=t)}set minPolarAngle(t){this._objRef&&(this._objRef.minPolarAngle=t)}set maxPolarAngle(t){this._objRef&&(this._objRef.maxPolarAngle=t)}set minAzimuthAngle(t){this._objRef&&(this._objRef.minAzimuthAngle=t)}set maxAzimuthAngle(t){this._objRef&&(this._objRef.maxAzimuthAngle=t)}set enableDamping(t){this._objRef&&(this._objRef.enableDamping=t)}set dampingFactor(t){this._objRef&&(this._objRef.dampingFactor=t)}set enableZoom(t){this._objRef&&(this._objRef.enableZoom=t)}set zoomSpeed(t){this._objRef&&(this._objRef.zoomSpeed=t)}set enableRotate(t){this._objRef&&(this._objRef.enableRotate=t)}set rotateSpeed(t){this._objRef&&(this._objRef.rotateSpeed=t)}set enablePan(t){this._objRef&&(this._objRef.enablePan=t)}set panSpeed(t){this._objRef&&(this._objRef.panSpeed=t)}set screenSpacePanning(t){this._objRef&&(this._objRef.screenSpacePanning=t)}set keyPanSpeed(t){this._objRef&&(this._objRef.keyPanSpeed=t)}set autoRotate(t){this._objRef&&(this._objRef.autoRotate=t)}set autoRotateSpeed(t){this._objRef&&(this._objRef.autoRotateSpeed=t)}set keys(t){this._objRef&&(this._objRef.keys=t)}set mouseButtons(t){this._objRef&&(this._objRef.mouseButtons=t)}set touches(t){this._objRef&&(this._objRef.touches=t)}set target0(t){this._objRef&&(this._objRef.target0=ts(this._objRef.target0,t))}set position0(t){this._objRef&&(this._objRef.position0=ts(this._objRef.position0,t))}set zoomO(t){this._objRef&&(this._objRef.zoomO=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275cmp=c.Xpm({type:i,selectors:[["th-orbitControls"]],inputs:{object:"object",domElement:"domElement",enabled:"enabled",target:"target",center:"center",minDistance:"minDistance",maxDistance:"maxDistance",minZoom:"minZoom",maxZoom:"maxZoom",minPolarAngle:"minPolarAngle",maxPolarAngle:"maxPolarAngle",minAzimuthAngle:"minAzimuthAngle",maxAzimuthAngle:"maxAzimuthAngle",enableDamping:"enableDamping",dampingFactor:"dampingFactor",enableZoom:"enableZoom",zoomSpeed:"zoomSpeed",enableRotate:"enableRotate",rotateSpeed:"rotateSpeed",enablePan:"enablePan",panSpeed:"panSpeed",screenSpacePanning:"screenSpacePanning",keyPanSpeed:"keyPanSpeed",autoRotate:"autoRotate",autoRotateSpeed:"autoRotateSpeed",keys:"keys",mouseButtons:"mouseButtons",touches:"touches",target0:"target0",position0:"position0",zoomO:"zoomO"},features:[c._Bn([{provide:pG,useExisting:(0,c.Gpc)(()=>i)}]),c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),sxe=(()=>{class i extends rxe{getType(){return nge}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275cmp=c.Xpm({type:i,selectors:[["th-mapControls"]],features:[c._Bn([{provide:pG,useExisting:(0,c.Gpc)(()=>i)}]),c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),oxe=(()=>{class i extends v9{getType(){return Ta}set type(t){this._objRef&&(this._objRef.type=t)}set color(t){this._objRef&&(this._objRef.color=ts(this._objRef.color,t))}set map(t){this._objRef&&(this._objRef.map=t)}set lightMap(t){this._objRef&&(this._objRef.lightMap=t)}set lightMapIntensity(t){this._objRef&&(this._objRef.lightMapIntensity=t)}set aoMap(t){this._objRef&&(this._objRef.aoMap=t)}set aoMapIntensity(t){this._objRef&&(this._objRef.aoMapIntensity=t)}set specularMap(t){this._objRef&&(this._objRef.specularMap=t)}set alphaMap(t){this._objRef&&(this._objRef.alphaMap=t)}set envMap(t){this._objRef&&(this._objRef.envMap=t)}set combine(t){this._objRef&&(this._objRef.combine=t)}set reflectivity(t){this._objRef&&(this._objRef.reflectivity=t)}set refractionRatio(t){this._objRef&&(this._objRef.refractionRatio=t)}set wireframe(t){this._objRef&&(this._objRef.wireframe=t)}set wireframeLinewidth(t){this._objRef&&(this._objRef.wireframeLinewidth=t)}set wireframeLinecap(t){this._objRef&&(this._objRef.wireframeLinecap=t)}set wireframeLinejoin(t){this._objRef&&(this._objRef.wireframeLinejoin=t)}set fog(t){this._objRef&&(this._objRef.fog=t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275cmp=c.Xpm({type:i,selectors:[["th-meshBasicMaterial"]],inputs:{type:"type",color:"color",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",specularMap:"specularMap",alphaMap:"alphaMap",envMap:"envMap",combine:"combine",reflectivity:"reflectivity",refractionRatio:"refractionRatio",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",fog:"fog"},features:[c._Bn([{provide:v9,useExisting:(0,c.Gpc)(()=>i)}]),c.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),i})(),y9=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({}),i})(),axe=(()=>{class i{load(...t){return(new this.clazz).loadAsync(...t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})(),lxe=(()=>{class i{constructor(t,n){this.host=t,this.zone=n,this.initialized=!1,this.animationLoop=(0,c.f3M)(Hw),this.proxy=function Xbe(){return new Proxy(new oa,new Kbe)}(),t.objRef=this.proxy}set url(t){this._url=t,this.load()}get url(){return this._url}get onLoaded(){return this.onLoaded$||(this.onLoaded$=new c.vpe),this.onLoaded$}get onProgress(){return this.onProgress$||(this.onProgress$=new c.vpe),this.onProgress$}ngOnInit(){this.initialized=!0,this.load()}load(){var t=this;return(0,nt.Z)(function*(){if(!t.initialized)return;if(void 0===t._url)throw new Error("missing url");if(!t.proxy)return;const n=t._url,r=h9(t.onProgress$)?o=>{t.zone.run(()=>{t.onProgress$?.next(o)})}:void 0,s=yield t.zone.runOutsideAngular(()=>t.service.load(n,r));t.animationLoop.requestAnimationFrame(),t.proxy.objRef=t.getRefFromResponse(s),t.host.objRef=t.proxy,t.onLoaded$&&void 0!==s&&t.zone.run(()=>t.onLoaded$?.next(s))})()}}return i.\u0275fac=function(t){c.$Z()},i.\u0275dir=c.lG2({type:i,inputs:{url:"url"},outputs:{onLoaded:"onLoaded",onProgress:"onProgress"}}),i})(),b9=(()=>{class i extends axe{constructor(){super(...arguments),this.clazz=ebe}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(i)))(n||i)}}(),i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Ww=(()=>{class i extends lxe{constructor(t,n,r){super(t,n),this.host=t,this.zone=n,this.service=r}getRefFromResponse(t){return t.scene}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(Sr,1),c.Y36(c.R0b),c.Y36(b9))},i.\u0275dir=c.lG2({type:i,selectors:[["","loadGLTF",""]],features:[c.qOj]}),i})(),cxe=(()=>{class i{constructor(t,n){this.engineService=t,this.animationLoopService=n}get beforeRender(){return this.engineService.beforeRender$}get onResize(){return this.engineService.resize$}set renderOnDemand(t){t?this.animationLoopService.stop():this.animationLoopService.start()}get renderOnDemand(){return!this.animationLoopService.isActive()}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(zw),c.Y36(Hw))},i.\u0275dir=c.lG2({type:i,selectors:[["","beforeRender",""],["","onResize",""],["","renderOnDemand",""]],inputs:{renderOnDemand:"renderOnDemand"},outputs:{beforeRender:"beforeRender",onResize:"onResize"}}),i})(),x9=(()=>{class i{constructor(t){this.engineService=t,this.stats=Rbe()}ngOnDestroy(){this.renderSubscription&&this.renderSubscription.unsubscribe()}ngOnInit(){if(!this.engineService.canvas)throw new Error("No canvas present");const t=this.engineService.canvas.parentElement;t&&(t.style.position="relative",this.stats.domElement.style.position="absolute",this.stats.showPanel(0),this.engineService.canvas.parentElement?.appendChild(this.stats.dom),this.renderSubscription=this.engineService.beforeRender$.subscribe(()=>{this.stats.update()}))}set thStats(t){this.stats.domElement.style.visibility=t?"visible":"hidden"}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(zw))},i.\u0275dir=c.lG2({type:i,selectors:[["","thStats",""]],inputs:{thStats:"thStats"}}),i})(),uxe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[y9,y9]}),i})();function hxe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"div",4)(1,"button",5),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.chooseMode("local"))}),c._uU(2,"Local"),c.qZA(),c.TgZ(3,"button",6),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.chooseMode("online"))}),c._uU(4,"Online"),c.qZA()()}2&i&&(c.xp6(3),c.Q6J("disabled",!0))}function dxe(i,e){1&i&&(c.TgZ(0,"mat-icon"),c._uU(1,"add"),c.qZA())}function fxe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"mat-form-field")(1,"mat-label"),c._uU(2,"Game Name:"),c.qZA(),c.TgZ(3,"input",18),c.NdJ("click",function(r){return r.stopPropagation()})("ngModelChange",function(r){c.CHM(t);const s=c.oxw(4);return c.KtG(s.gameService.localSave.gameName=r)}),c.qZA()()}if(2&i){const t=c.oxw(4);c.xp6(3),c.Q6J("ngModel",t.gameService.localSave.gameName)}}function pxe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",5),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(2).index,s=c.oxw(2);return c.KtG(s.gameService.selectLocalData(r))}),c._uU(1,"Continue"),c.qZA()}}function mxe(i,e){if(1&i&&(c.TgZ(0,"div",16),c.YNc(1,dxe,2,0,"mat-icon",3),c.YNc(2,fxe,4,1,"mat-form-field",3),c.YNc(3,pxe,2,0,"button",17),c.qZA()),2&i){const t=c.oxw().index,n=c.oxw(2);c.xp6(1),c.Q6J("ngIf",n.gameService.localSave.localId!="rekordLocalSave"+t),c.xp6(1),c.Q6J("ngIf",n.gameService.localSave.localId=="rekordLocalSave"+t),c.xp6(1),c.Q6J("ngIf",n.gameService.localSave.localId=="rekordLocalSave"+t)}}function gxe(i,e){if(1&i&&(c.TgZ(0,"div",19)(1,"span"),c._uU(2),c.qZA()()),2&i){const t=c.oxw().$implicit;c.xp6(2),c.Oqu(t.gameName)}}function _xe(i,e){if(1&i&&(c.TgZ(0,"button",20),c.NdJ("click",function(n){return n.stopPropagation()}),c.TgZ(1,"mat-icon"),c._uU(2,"more_vert"),c.qZA()()),2&i){c.oxw();const t=c.MAs(6);c.Q6J("matMenuTriggerFor",t)}}function vxe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"mat-card",9),c.NdJ("click",function(){const r=c.CHM(t),s=r.$implicit,o=r.index,a=c.oxw(2);return c.KtG(a.createOrUploadGame(s,o))}),c.YNc(1,mxe,4,3,"div",10),c.YNc(2,gxe,3,1,"div",11),c.TgZ(3,"div",12),c.YNc(4,_xe,3,1,"button",13),c.TgZ(5,"mat-menu",null,14)(7,"button",15),c.NdJ("click",function(){const s=c.CHM(t).$implicit,o=c.oxw(2);return c.KtG(o.deleteSaveFile(s))}),c.TgZ(8,"mat-icon"),c._uU(9,"delete"),c.qZA(),c._uU(10," Delete File"),c.qZA()()()()}if(2&i){const t=e.$implicit;c.xp6(1),c.Q6J("ngIf","new"==t),c.xp6(1),c.Q6J("ngIf","new"!=t),c.xp6(2),c.Q6J("ngIf","new"!=t)}}function yxe(i,e){if(1&i&&(c.TgZ(0,"div",7),c.YNc(1,vxe,11,3,"mat-card",8),c.qZA()),2&i){const t=c.oxw();c.xp6(1),c.Q6J("ngForOf",t.gameService.allLocalSaves)}}function bxe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"div")(1,"div",43)(2,"button",44),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(4);return c.KtG(r.changeModel("minus"))}),c.TgZ(3,"mat-icon"),c._uU(4,"chevron_left"),c.qZA()(),c.TgZ(5,"span"),c._uU(6),c.qZA(),c.TgZ(7,"button",44),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(4);return c.KtG(r.changeModel("plus"))}),c.TgZ(8,"mat-icon"),c._uU(9,"chevron_right"),c.qZA()()()()}if(2&i){const t=c.oxw().$implicit,n=c.oxw(3);c.xp6(2),c.Q6J("disabled",0==n.pawnModelCounter),c.xp6(4),c.Oqu(t.name),c.xp6(1),c.Q6J("disabled",n.pawnModelCounter>=n.filterPawns().length-1)}}function xxe(i,e){if(1&i&&(c.TgZ(0,"div",42),c.YNc(1,bxe,10,3,"div",3),c.qZA()),2&i){const t=e.index,n=c.oxw(3);c.xp6(1),c.Q6J("ngIf",t==n.pawnModelCounter)}}const Txe=function(i){return{backgroundColor:i,height:"200px",width:"200px"}},T9=function(){return[0,0,0]},w9=function(){return[75,2,.1,1e3]},wxe=function(){return[3,5,8]};function Mxe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"mat-card",30)(1,"div",31)(2,"th-canvas")(3,"th-scene",32),c._UZ(4,"th-ambientLight")(5,"th-object3D",33)(6,"th-perspectiveCamera",34),c.qZA()(),c.YNc(7,xxe,2,1,"div",35),c.qZA(),c.TgZ(8,"div",36)(9,"mat-form-field")(10,"mat-label"),c._uU(11,"Choose Your Name"),c.qZA(),c.TgZ(12,"input",37),c.NdJ("ngModelChange",function(r){c.CHM(t);const s=c.oxw(2);return c.KtG(s.playerName=r)}),c.qZA()(),c.TgZ(13,"button",38)(14,"mat-icon"),c._uU(15,"add"),c.qZA()(),c.TgZ(16,"mat-menu",null,39)(18,"mat-form-field",40)(19,"mat-label"),c._uU(20,"Special Code"),c.qZA(),c.TgZ(21,"input",41),c.NdJ("click",function(r){return r.stopPropagation()})("ngModelChange",function(r){c.CHM(t);const s=c.oxw(2);return c.KtG(s.gameService.specialPawn=r)}),c.qZA()()(),c.TgZ(22,"button",6),c.NdJ("click",function(){c.CHM(t);const r=c.oxw(2);return r.gameService.createPlayer(r.playerName,r.pawnModelCounter),c.KtG(r.createPlayer())}),c._uU(23,"Join"),c.qZA()()()}if(2&i){const t=c.MAs(17),n=c.oxw(2);c.xp6(2),c.Akn(c.VKq(12,Txe,n.gameService.sessionColor)),c.xp6(1),c.Q6J("thStats",!1),c.xp6(2),c.Q6J("url",n.gameService.pawnUrls[n.pawnModelCounter])("position",c.DdM(14,T9)),c.xp6(1),c.Q6J("args",c.DdM(15,w9))("position",c.DdM(16,wxe)),c.xp6(1),c.Q6J("ngForOf",n.filterPawns()),c.xp6(5),c.Q6J("ngModel",n.playerName),c.xp6(1),c.Q6J("matMenuTriggerFor",t),c.xp6(8),c.Q6J("ngModel",n.gameService.specialPawn),c.xp6(1),c.Q6J("disabled",n.disableJoinButton())}}const Sxe=function(i){return{backgroundColor:i,height:"150px",width:"150px"}},Cxe=function(){return[15,15,15]};function Exe(i,e){if(1&i&&(c.TgZ(0,"mat-card",45)(1,"th-canvas")(2,"th-scene",32),c._UZ(3,"th-ambientLight")(4,"th-object3D",33)(5,"th-perspectiveCamera",34),c.qZA()(),c.TgZ(6,"span"),c._uU(7),c.qZA(),c.TgZ(8,"span"),c._uU(9),c.qZA(),c.TgZ(10,"span"),c._uU(11),c.qZA()()),2&i){const t=e.$implicit,n=c.oxw(2);c.xp6(1),c.Akn(c.VKq(10,Sxe,n.gameService.sessionColor)),c.xp6(1),c.Q6J("thStats",!1),c.xp6(2),c.Q6J("url","/assets/blenderModels/pawns/"+t.pawn.choosenPawnValue+"/scene.gltf")("position",c.DdM(12,T9)),c.xp6(1),c.Q6J("args",c.DdM(13,w9))("position",c.DdM(14,Cxe)),c.xp6(2),c.Oqu(t.name),c.xp6(2),c.Oqu(t.pawn.choosenPawnLabel),c.xp6(2),c.Oqu(t.money)}}function Axe(i,e){1&i&&(c.TgZ(0,"mat-icon"),c._uU(1,"check"),c.qZA())}function Dxe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"mat-card",46),c.NdJ("click",function(){const s=c.CHM(t).$implicit,o=c.oxw(2);return c.KtG(o.gameService.chosenMap=s)}),c.TgZ(1,"span",47),c.YNc(2,Axe,2,0,"mat-icon",3),c.qZA(),c.TgZ(3,"span"),c._uU(4),c.qZA()()}if(2&i){const t=e.$implicit,n=c.oxw(2);c.xp6(2),c.Q6J("ngIf",n.gameService.chosenMap==t),c.xp6(2),c.Oqu(t)}}function Rxe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"div")(1,"div",21)(2,"div",22),c.YNc(3,Mxe,24,17,"mat-card",23),c.qZA(),c.TgZ(4,"div",24),c.YNc(5,Exe,12,15,"mat-card",25),c.qZA()(),c.TgZ(6,"div",26),c.YNc(7,Dxe,5,2,"mat-card",27),c.qZA(),c.TgZ(8,"div",28)(9,"button",29),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.gameService.startGame())}),c._uU(10,"PLAY"),c.qZA()()()}if(2&i){const t=c.oxw();c.xp6(3),c.Q6J("ngIf",t.gameService.pawnTypes.length),c.xp6(2),c.Q6J("ngForOf",t.gameService.players),c.xp6(2),c.Q6J("ngForOf",t.gameService.gameMaps),c.xp6(2),c.Q6J("disabled",t.gameService.players.length<2)}}const Ixe=function(i){return{background:i}};let Pxe=(()=>{class i{constructor(t){this.gameService=t,this.pawnModelCounter=0,this.playerName="",this.actualPawnDisplayer="",this.canAddSpecial=!1,this.specialPawnExist=!1,this.chosenSaveName="",this.url=""}ngOnInit(){}chooseMode(t){this.gameService.choosenMode=t}changeModel(t){"minus"==t?this.pawnModelCounter--:"plus"==t&&this.pawnModelCounter++}disableJoinButton(){const t=this.gameService.specialPawnTypes.findIndex(n=>n.value==this.gameService.specialPawn);return!(!this.gameService.specialPawn&&this.playerName||this.gameService.specialPawn&&this.playerName&&t>-1)}createPlayer(){this.playerName="",this.pawnModelCounter=0}filterPawns(){return this.gameService.pawnTypes.filter(t=>!t.specialPawn)}selectSaveName(t,n){}createOrUploadGame(t,n){"new"==t?(this.gameService.localSave.localId="rekordLocalSave"+n,this.gameService.localSaves=t):(this.gameService.localSaves=t,this.gameService.startGame())}deleteSaveFile(t){"new"!=t&&(localStorage.removeItem(t.localId),this.gameService.retrieveSavesFromLocal())}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(wd))},i.\u0275cmp=c.Xpm({type:i,selectors:[["app-choose-mode"]],decls:4,vars:7,consts:[["id","chooseMode"],["class","chooseModeContainer",4,"ngIf"],["id","localSaves",4,"ngIf"],[4,"ngIf"],[1,"chooseModeContainer"],["mat-raised-button","",3,"click"],["mat-raised-button","",3,"disabled","click"],["id","localSaves"],["class","localSave",3,"click",4,"ngFor","ngForOf"],[1,"localSave",3,"click"],["fxLayoutAlign","center center","class","saveContainer","fxLayout","column",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","saveContainer",4,"ngIf"],[1,"contextMenu"],["mat-icon-button","","class","deleteBtn",3,"matMenuTriggerFor","click",4,"ngIf"],["saveInfo","matMenu"],["mat-menu-item","",3,"click"],["fxLayoutAlign","center center","fxLayout","column",1,"saveContainer"],["mat-raised-button","",3,"click",4,"ngIf"],["matInput","","autocomplete","off","placeholder","Insert Here tha name of the game",3,"ngModel","click","ngModelChange"],["fxLayout","column","fxLayoutAlign","center center",1,"saveContainer"],["mat-icon-button","",1,"deleteBtn",3,"matMenuTriggerFor","click"],["id","createdPlayers","fxLayout","row","fxLayoutAlign","center space-around","fxLayout","column","fxLayoutAlign","center center"],[1,"creationContainer"],["id","createPlayer",4,"ngIf"],[1,"createdPlayersContainer"],["class","playerCard","fxLayout","column","fxLayoutAlign","center space-around",4,"ngFor","ngForOf"],["id","mapsContainer","fxLayout","row","fxLayoutAlign","center center"],["class","map","fxLayout","column","fxLayoutAlign","space-evenly center",3,"click",4,"ngFor","ngForOf"],["id","startGame","fxLayoutAlign","center center"],["mat-raised-button","",1,"startGameBtn",3,"disabled","click"],["id","createPlayer"],[1,"choosePawn"],[3,"thStats"],["loadGLTF","",3,"url","position"],[3,"args","position"],["class","pawnModel",4,"ngFor","ngForOf"],["fxLayout","column","fxLayoutAlign","center space-around"],["matInput","","autocomplete","off","placeholder","Insert Here Your Name",3,"ngModel","ngModelChange"],["id","addSpecialPawn","mat-mini-fab","","fxLayoutAlign","center center",3,"matMenuTriggerFor"],["specialPawnMenu","matMenu"],[1,"specialPawnInput"],["matInput","","autocomplete","off",3,"ngModel","click","ngModelChange"],[1,"pawnModel"],["fxLayout","row","fxLayoutAlign","space-between center",1,"pawnChange"],["mat-icon-button","",3,"disabled","click"],["fxLayout","column","fxLayoutAlign","center space-around",1,"playerCard"],["fxLayout","column","fxLayoutAlign","space-evenly center",1,"map",3,"click"],["fxLayoutAlign","center center",1,"chosenMap"]],template:function(t,n){1&t&&(c.TgZ(0,"div",0),c.YNc(1,hxe,5,1,"div",1),c.YNc(2,yxe,2,1,"div",2),c.YNc(3,Rxe,11,4,"div",3),c.qZA()),2&t&&(c.Akn(c.VKq(5,Ixe,n.gameService.sessionColor)),c.xp6(1),c.Q6J("ngIf",!n.gameService.choosenMode),c.xp6(1),c.Q6J("ngIf","local"==n.gameService.choosenMode&&!n.gameService.localSaveName),c.xp6(1),c.Q6J("ngIf",n.gameService.choosenMode&&n.gameService.localSaveName))},dependencies:[xr,qr,gY,sL,M7,CE,uP,Lme,yL,Bme,DA,rV,gL,w0,S_,IE,g9,Sr,m9,hG,fG,Ww,x9],styles:["#chooseMode[_ngcontent-%COMP%]{min-height:100vh;min-width:100vw}#chooseMode[_ngcontent-%COMP%]   .chooseModeContainer[_ngcontent-%COMP%]{height:100vh;width:100vw;display:flex;align-items:center;justify-content:center}#chooseMode[_ngcontent-%COMP%]   .chooseModeContainer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100px;height:100px}#chooseMode[_ngcontent-%COMP%]   #startGame[_ngcontent-%COMP%]{width:100%;margin-top:20px}#chooseMode[_ngcontent-%COMP%]   #startGame[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:200px;height:50px;background:#c4dfc4;font-weight:700}#chooseMode[_ngcontent-%COMP%]   #localSaves[_ngcontent-%COMP%]{height:100vh;width:100vw;display:flex;align-items:center;justify-content:space-around}#chooseMode[_ngcontent-%COMP%]   #localSaves[_ngcontent-%COMP%]   .localSave[_ngcontent-%COMP%]{height:200px;width:200px;z-index:0;position:relative;cursor:pointer}#chooseMode[_ngcontent-%COMP%]   #localSaves[_ngcontent-%COMP%]   .localSave[_ngcontent-%COMP%]   .saveContainer[_ngcontent-%COMP%]{width:100%;height:100%;pointer-events:none}#chooseMode[_ngcontent-%COMP%]   #localSaves[_ngcontent-%COMP%]   .localSave[_ngcontent-%COMP%]   .saveContainer[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%], #chooseMode[_ngcontent-%COMP%]   #localSaves[_ngcontent-%COMP%]   .localSave[_ngcontent-%COMP%]   .saveContainer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{pointer-events:all}#chooseMode[_ngcontent-%COMP%]   #localSaves[_ngcontent-%COMP%]   .localSave[_ngcontent-%COMP%]   .saveContainer[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{pointer-events:none}#chooseMode[_ngcontent-%COMP%]   #localSaves[_ngcontent-%COMP%]   .localSave[_ngcontent-%COMP%]   .deleteBtn[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px;pointer-events:all;z-index:2}#chooseMode[_ngcontent-%COMP%]   #addSpecialPawn[_ngcontent-%COMP%]{position:absolute;top:0;right:0;cursor:pointer;background:#fff;width:25px;height:25px;color:#000}#chooseMode[_ngcontent-%COMP%]   #createdPlayers[_ngcontent-%COMP%]   .creationContainer[_ngcontent-%COMP%]{margin-top:20px}#chooseMode[_ngcontent-%COMP%]   #createdPlayers[_ngcontent-%COMP%]   .createdPlayersContainer[_ngcontent-%COMP%]{margin-top:50px;display:flex;width:90vw}#chooseMode[_ngcontent-%COMP%]   #mapsContainer[_ngcontent-%COMP%]{width:100%;height:100px;margin-top:20px}#chooseMode[_ngcontent-%COMP%]   #mapsContainer[_ngcontent-%COMP%]   mat-card.map[_ngcontent-%COMP%]{height:100%;width:150px;margin-right:20px;font-family:ailerons}#chooseMode[_ngcontent-%COMP%]   #mapsContainer[_ngcontent-%COMP%]   .chosenMap[_ngcontent-%COMP%]{border:1px solid black;width:25px;height:25px}@media screen and (max-width: 600px){.chooseModeContainer[_ngcontent-%COMP%]{flex-direction:column}.chooseModeContainer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:50px}.createdPlayersContainer[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:space-between}.createdPlayersContainer[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{margin-top:10px}#localSaves[_ngcontent-%COMP%]{flex-direction:column}}@media screen and (min-width: 600px){.chooseModeContainer[_ngcontent-%COMP%]{flex-direction:row}.chooseModeContainer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:50px}#localSaves[_ngcontent-%COMP%]{flex-direction:row}#createdPlayers[_ngcontent-%COMP%]   .createdPlayersContainer[_ngcontent-%COMP%]{justify-content:center}#createdPlayers[_ngcontent-%COMP%]   .createdPlayersContainer[_ngcontent-%COMP%]   .playerCard[_ngcontent-%COMP%]:not(:first-child){margin-left:5px}}"]}),i})();class Ad{constructor(e){void 0===e&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e){void 0===e&&(e=new W);const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t){void 0===t&&(t=new W);const n=this.elements,r=e.x,s=e.y,o=e.z;return t.x=n[0]*r+n[1]*s+n[2]*o,t.y=n[3]*r+n[4]*s+n[5]*o,t.z=n[6]*r+n[7]*s+n[8]*o,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t){void 0===t&&(t=new Ad);const n=this.elements,r=e.elements,s=t.elements,o=n[0],a=n[1],l=n[2],h=n[3],f=n[4],m=n[5],g=n[6],v=n[7],y=n[8],b=r[0],T=r[1],S=r[2],C=r[3],R=r[4],I=r[5],L=r[6],N=r[7],U=r[8];return s[0]=o*b+a*C+l*L,s[1]=o*T+a*R+l*N,s[2]=o*S+a*I+l*U,s[3]=h*b+f*C+m*L,s[4]=h*T+f*R+m*N,s[5]=h*S+f*I+m*U,s[6]=g*b+v*C+y*L,s[7]=g*T+v*R+y*N,s[8]=g*S+v*I+y*U,t}scale(e,t){void 0===t&&(t=new Ad);const n=this.elements,r=t.elements;for(let s=0;3!==s;s++)r[3*s+0]=e.x*n[3*s+0],r[3*s+1]=e.y*n[3*s+1],r[3*s+2]=e.z*n[3*s+2];return t}solve(e,t){void 0===t&&(t=new W);const s=[];let o,a;for(o=0;o<12;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+4*a]=this.elements[o+3*a];s[3]=e.x,s[7]=e.y,s[11]=e.z;let l=3;const h=l;let f,g;do{if(o=h-l,0===s[o+4*o])for(a=o+1;a<h;a++)if(0!==s[o+4*a]){f=4;do{g=4-f,s[g+4*o]+=s[g+4*a]}while(--f);break}if(0!==s[o+4*o])for(a=o+1;a<h;a++){const v=s[o+4*a]/s[o+4*o];f=4;do{g=4-f,s[g+4*a]=g<=o?0:s[g+4*a]-s[g+4*o]*v}while(--f)}}while(--l);if(t.z=s[11]/s[10],t.y=(s[7]-s[6]*t.z)/s[5],t.x=(s[3]-s[2]*t.z-s[1]*t.y)/s[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw`Could not solve equation! Got x=[${t.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return t}e(e,t,n){if(void 0===n)return this.elements[t+3*e];this.elements[t+3*e]=n}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let n=0;n<9;n++)e+=this.elements[n]+",";return e}reverse(e){void 0===e&&(e=new Ad);const r=Fxe;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)r[s+6*o]=this.elements[s+3*o];r[3]=1,r[9]=0,r[15]=0,r[4]=0,r[10]=1,r[16]=0,r[5]=0,r[11]=0,r[17]=1;let a=3;const l=a;let h,m;do{if(s=l-a,0===r[s+6*s])for(o=s+1;o<l;o++)if(0!==r[s+6*o]){h=6;do{m=6-h,r[m+6*s]+=r[m+6*o]}while(--h);break}if(0!==r[s+6*s])for(o=s+1;o<l;o++){const g=r[s+6*o]/r[s+6*s];h=6;do{m=6-h,r[m+6*o]=m<=s?0:r[m+6*o]-r[m+6*s]*g}while(--h)}}while(--a);s=2;do{o=s-1;do{const g=r[s+6*o]/r[s+6*s];h=6;do{m=6-h,r[m+6*o]=r[m+6*o]-r[m+6*s]*g}while(--h)}while(o--)}while(--s);s=2;do{const g=1/r[s+6*s];h=6;do{m=6-h,r[m+6*s]=r[m+6*s]*g}while(--h)}while(s--);s=2;do{o=2;do{if(m=r[3+o+6*s],isNaN(m)||m===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(s,o,m)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const t=e.x,n=e.y,r=e.z,s=e.w,o=t+t,a=n+n,l=r+r,h=t*o,f=t*a,m=t*l,g=n*a,v=n*l,y=r*l,b=s*o,T=s*a,S=s*l,C=this.elements;return C[0]=1-(g+y),C[1]=f-S,C[2]=m+T,C[3]=f+S,C[4]=1-(h+y),C[5]=v-b,C[6]=m-T,C[7]=v+b,C[8]=1-(h+g),this}transpose(e){void 0===e&&(e=new Ad);const t=this.elements,n=e.elements;let r;return n[0]=t[0],n[4]=t[4],n[8]=t[8],r=t[1],n[1]=t[3],n[3]=r,r=t[2],n[2]=t[6],n[6]=r,r=t[5],n[5]=t[7],n[7]=r,e}}const Fxe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class W{constructor(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),this.x=e,this.y=t,this.z=n}cross(e,t){void 0===t&&(t=new W);const n=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z;return t.x=a*s-l*r,t.y=l*n-o*s,t.z=o*r-a*n,t}set(e,t,n){return this.x=e,this.y=t,this.z=n,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new W(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new W(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new Ad([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,n=this.z,r=Math.sqrt(e*e+t*t+n*n);if(r>0){const s=1/r;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return r}unit(e){void 0===e&&(e=new W);const t=this.x,n=this.y,r=this.z;let s=Math.sqrt(t*t+n*n+r*r);return s>0?(s=1/s,e.x=t*s,e.y=n*s,e.z=r*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,n=this.z;return Math.sqrt(e*e+t*t+n*n)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-t)*(s-t)+(o-n)*(o-n)+(a-r)*(a-r))}distanceSquared(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return(s-t)*(s-t)+(o-n)*(o-n)+(a-r)*(a-r)}scale(e,t){void 0===t&&(t=new W);const r=this.y,s=this.z;return t.x=e*this.x,t.y=e*r,t.z=e*s,t}vmul(e,t){return void 0===t&&(t=new W),t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,n){return void 0===n&&(n=new W),n.x=this.x+e*t.x,n.y=this.y+e*t.y,n.z=this.z+e*t.z,n}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e){return void 0===e&&(e=new W),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const n=this.length();if(n>0){const r=Lxe,s=1/n;r.set(this.x*s,this.y*s,this.z*s);const o=Oxe;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,n){const r=this.x,s=this.y,o=this.z;n.x=r+(e.x-r)*t,n.y=s+(e.y-s)*t,n.z=o+(e.z-o)*t}almostEquals(e,t){return void 0===t&&(t=1e-6),!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e){return void 0===e&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(M9),M9.almostEquals(e,t)}clone(){return new W(this.x,this.y,this.z)}}W.ZERO=new W(0,0,0),W.UNIT_X=new W(1,0,0),W.UNIT_Y=new W(0,1,0),W.UNIT_Z=new W(0,0,1);const Lxe=new W,Oxe=new W,M9=new W;class Ps{constructor(e){void 0===e&&(e={}),this.lowerBound=new W,this.upperBound=new W,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,n,r){const s=this.lowerBound,o=this.upperBound,a=n;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let l=1;l<e.length;l++){let h=e[l];a&&(a.vmult(h,S9),h=S9),h.x>o.x&&(o.x=h.x),h.x<s.x&&(s.x=h.x),h.y>o.y&&(o.y=h.y),h.y<s.y&&(s.y=h.y),h.z>o.z&&(o.z=h.z),h.z<s.z&&(s.z=h.z)}return t&&(t.vadd(s,s),t.vadd(o,o)),r&&(s.x-=r,s.y-=r,s.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new Ps).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,n=this.upperBound,r=e.lowerBound,s=e.upperBound;return(r.x<=n.x&&n.x<=s.x||t.x<=s.x&&s.x<=n.x)&&(r.y<=n.y&&n.y<=s.y||t.y<=s.y&&s.y<=n.y)&&(r.z<=n.z&&n.z<=s.z||t.z<=s.z&&s.z<=n.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,n=this.upperBound,r=e.lowerBound,s=e.upperBound;return t.x<=r.x&&n.x>=s.x&&t.y<=r.y&&n.y>=s.y&&t.z<=r.z&&n.z>=s.z}getCorners(e,t,n,r,s,o,a,l){const h=this.lowerBound,f=this.upperBound;e.copy(h),t.set(f.x,h.y,h.z),n.set(f.x,f.y,h.z),r.set(h.x,f.y,f.z),s.set(f.x,h.y,f.z),o.set(h.x,f.y,h.z),a.set(h.x,h.y,f.z),l.copy(f)}toLocalFrame(e,t){const n=C9;this.getCorners(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);for(let g=0;8!==g;g++){const v=n[g];e.pointToLocal(v,v)}return t.setFromPoints(n)}toWorldFrame(e,t){const n=C9;this.getCorners(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);for(let g=0;8!==g;g++){const v=n[g];e.pointToWorld(v,v)}return t.setFromPoints(n)}overlapsRay(e){const{direction:t,from:n}=e,r=1/t.x,s=1/t.y,o=1/t.z,a=(this.lowerBound.x-n.x)*r,l=(this.upperBound.x-n.x)*r,h=(this.lowerBound.y-n.y)*s,f=(this.upperBound.y-n.y)*s,m=(this.lowerBound.z-n.z)*o,g=(this.upperBound.z-n.z)*o,v=Math.max(Math.max(Math.min(a,l),Math.min(h,f)),Math.min(m,g)),y=Math.min(Math.min(Math.max(a,l),Math.max(h,f)),Math.max(m,g));return!(y<0||v>y)}}const S9=new W,C9=[new W,new W,new W,new W,new W,new W,new W,new W];class E9{constructor(){this.matrix=[]}get(e,t){let{index:n}=e,{index:r}=t;if(r>n){const s=r;r=n,n=s}return this.matrix[(n*(n+1)>>1)+r-1]}set(e,t,n){let{index:r}=e,{index:s}=t;if(s>r){const o=s;s=r,r=o}this.matrix[(r*(r+1)>>1)+s-1]=n?1:0}reset(){for(let e=0,t=this.matrix.length;e!==t;e++)this.matrix[e]=0}setNumObjects(e){this.matrix.length=e*(e-1)>>1}}class A9{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;return void 0===n[e]&&(n[e]=[]),n[e].includes(t)||n[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return!(void 0===n[e]||!n[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const n=this._listeners;if(void 0===n[e])return this;const r=n[e].indexOf(t);return-1!==r&&n[e].splice(r,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const n=this._listeners[e.type];if(void 0!==n){e.target=this;for(let r=0,s=n.length;r<s;r++)n[r].call(this,e)}return this}}class so{constructor(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1),this.x=e,this.y=t,this.z=n,this.w=r}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const n=Math.sin(.5*t);return this.x=e.x*n,this.y=e.y*n,this.z=e.z*n,this.w=Math.cos(.5*t),this}toAxisAngle(e){void 0===e&&(e=new W),this.normalize();const t=2*Math.acos(this.w),n=Math.sqrt(1-this.w*this.w);return n<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/n,e.y=this.y/n,e.z=this.z/n),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const n=kxe;e.tangents(n,Nxe),this.setFromAxisAngle(n,Math.PI)}else{const n=e.cross(t);this.x=n.x,this.y=n.y,this.z=n.z,this.w=Math.sqrt(e.length()**2*t.length()**2)+e.dot(t),this.normalize()}return this}mult(e,t){void 0===t&&(t=new so);const n=this.x,r=this.y,s=this.z,o=this.w,a=e.x,l=e.y,h=e.z,f=e.w;return t.x=n*f+o*a+r*h-s*l,t.y=r*f+o*l+s*a-n*h,t.z=s*f+o*h+n*l-r*a,t.w=o*f-n*a-r*l-s*h,t}inverse(e){void 0===e&&(e=new so);const t=this.x,n=this.y,r=this.z,s=this.w;this.conjugate(e);const o=1/(t*t+n*n+r*r+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e){return void 0===e&&(e=new so),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t){void 0===t&&(t=new W);const n=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z,h=this.w,f=h*n+a*s-l*r,m=h*r+l*n-o*s,g=h*s+o*r-a*n,v=-o*n-a*r-l*s;return t.x=f*h+v*-o+m*-l-g*-a,t.y=m*h+v*-a+g*-o-f*-l,t.z=g*h+v*-l+f*-a-m*-o,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t){let n,r,s;void 0===t&&(t="YZX");const o=this.x,a=this.y,l=this.z,h=this.w;if("YZX"!==t)throw new Error(`Euler order ${t} not supported yet.`);{const f=o*a+l*h;if(f>.499&&(n=2*Math.atan2(o,h),r=Math.PI/2,s=0),f<-.499&&(n=-2*Math.atan2(o,h),r=-Math.PI/2,s=0),void 0===n){const m=o*o,v=l*l;n=Math.atan2(2*a*h-2*o*l,1-a*a*2-2*v),r=Math.asin(2*f),s=Math.atan2(2*o*h-2*a*l,1-2*m-2*v)}}e.y=n,e.z=r,e.x=s}setFromEuler(e,t,n,r){void 0===r&&(r="XYZ");const s=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(n/2),l=Math.sin(e/2),h=Math.sin(t/2),f=Math.sin(n/2);return"XYZ"===r?(this.x=l*o*a+s*h*f,this.y=s*h*a-l*o*f,this.z=s*o*f+l*h*a,this.w=s*o*a-l*h*f):"YXZ"===r?(this.x=l*o*a+s*h*f,this.y=s*h*a-l*o*f,this.z=s*o*f-l*h*a,this.w=s*o*a+l*h*f):"ZXY"===r?(this.x=l*o*a-s*h*f,this.y=s*h*a+l*o*f,this.z=s*o*f+l*h*a,this.w=s*o*a-l*h*f):"ZYX"===r?(this.x=l*o*a-s*h*f,this.y=s*h*a+l*o*f,this.z=s*o*f-l*h*a,this.w=s*o*a+l*h*f):"YZX"===r?(this.x=l*o*a+s*h*f,this.y=s*h*a+l*o*f,this.z=s*o*f-l*h*a,this.w=s*o*a-l*h*f):"XZY"===r&&(this.x=l*o*a-s*h*f,this.y=s*h*a-l*o*f,this.z=s*o*f+l*h*a,this.w=s*o*a+l*h*f),this}clone(){return new so(this.x,this.y,this.z,this.w)}slerp(e,t,n){void 0===n&&(n=new so);const r=this.x,s=this.y,o=this.z,a=this.w;let g,v,y,b,T,l=e.x,h=e.y,f=e.z,m=e.w;return v=r*l+s*h+o*f+a*m,v<0&&(v=-v,l=-l,h=-h,f=-f,m=-m),1-v>1e-6?(g=Math.acos(v),y=Math.sin(g),b=Math.sin((1-t)*g)/y,T=Math.sin(t*g)/y):(b=1-t,T=t),n.x=b*r+T*l,n.y=b*s+T*h,n.z=b*o+T*f,n.w=b*a+T*m,n}integrate(e,t,n,r){void 0===r&&(r=new so);const s=e.x*n.x,o=e.y*n.y,a=e.z*n.z,l=this.x,h=this.y,f=this.z,m=this.w,g=.5*t;return r.x+=g*(s*m+o*f-a*h),r.y+=g*(o*m+a*l-s*f),r.z+=g*(a*m+s*h-o*l),r.w+=g*(-s*l-o*h-a*f),r}}const kxe=new W,Nxe=new W,Bxe={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let Nn=(()=>{class i{constructor(t){void 0===t&&(t={}),this.id=i.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(t,n){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(t,n,r,s){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}return i.idCounter=0,i.types=Bxe,i})();class lr{constructor(e){void 0===e&&(e={}),this.position=new W,this.quaternion=new so,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return lr.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return lr.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t){return void 0===t&&(t=new W),this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,n,r){return void 0===r&&(r=new W),n.vsub(e,r),t.conjugate(D9),D9.vmult(r,r),r}static pointToWorldFrame(e,t,n,r){return void 0===r&&(r=new W),t.vmult(n,r),r.vadd(e,r),r}static vectorToWorldFrame(e,t,n){return void 0===n&&(n=new W),e.vmult(t,n),n}static vectorToLocalFrame(e,t,n,r){return void 0===r&&(r=new W),t.w*=-1,t.vmult(n,r),t.w*=-1,r}}const D9=new so;class vb extends Nn{constructor(e){void 0===e&&(e={});const{vertices:t=[],faces:n=[],normals:r=[],axes:s,boundingSphereRadius:o}=e;super({type:Nn.types.CONVEXPOLYHEDRON}),this.vertices=t,this.faces=n,this.faceNormals=r,0===this.faceNormals.length&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,n=this.uniqueEdges;n.length=0;const r=new W;for(let s=0;s!==e.length;s++){const o=e[s],a=o.length;for(let l=0;l!==a;l++){t[o[l]].vsub(t[o[(l+1)%a]],r),r.normalize();let f=!1;for(let m=0;m!==n.length;m++)if(n[m].almostEquals(r)||n[m].almostEquals(r)){f=!0;break}f||n.push(r.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let r=0;r<this.faces[e].length;r++)if(!this.vertices[this.faces[e][r]])throw new Error(`Vertex ${this.faces[e][r]} not found!`);const t=this.faceNormals[e]||new W;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(`.faceNormals[${e}] = Vec3(${t.toString()}) looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.`);for(let r=0;r<this.faces[e].length;r++)console.warn(`.vertices[${this.faces[e][r]}] = Vec3(${this.vertices[this.faces[e][r]].toString()})`)}}}getFaceNormal(e,t){const n=this.faces[e];vb.computeNormal(this.vertices[n[0]],this.vertices[n[1]],this.vertices[n[2]],t)}static computeNormal(e,t,n,r){const s=new W,o=new W;t.vsub(e,o),n.vsub(t,s),s.cross(o,r),r.isZero()||r.normalize()}clipAgainstHull(e,t,n,r,s,o,a,l,h){const f=new W;let m=-1,g=-Number.MAX_VALUE;for(let y=0;y<n.faces.length;y++){f.copy(n.faceNormals[y]),s.vmult(f,f);const b=f.dot(o);b>g&&(g=b,m=y)}const v=[];for(let y=0;y<n.faces[m].length;y++){const b=n.vertices[n.faces[m][y]],T=new W;T.copy(b),s.vmult(T,T),r.vadd(T,T),v.push(T)}m>=0&&this.clipFaceAgainstHull(o,e,t,v,a,l,h)}findSeparatingAxis(e,t,n,r,s,o,a,l){const h=new W,f=new W,m=new W,g=new W,v=new W,y=new W;let b=Number.MAX_VALUE;const T=this;if(T.uniqueAxes)for(let S=0;S!==T.uniqueAxes.length;S++){n.vmult(T.uniqueAxes[S],h);const C=T.testSepAxis(h,e,t,n,r,s);if(!1===C)return!1;C<b&&(b=C,o.copy(h))}else{const S=a?a.length:T.faces.length;for(let C=0;C<S;C++){h.copy(T.faceNormals[a?a[C]:C]),n.vmult(h,h);const I=T.testSepAxis(h,e,t,n,r,s);if(!1===I)return!1;I<b&&(b=I,o.copy(h))}}if(e.uniqueAxes)for(let S=0;S!==e.uniqueAxes.length;S++){s.vmult(e.uniqueAxes[S],f);const C=T.testSepAxis(f,e,t,n,r,s);if(!1===C)return!1;C<b&&(b=C,o.copy(f))}else{const S=l?l.length:e.faces.length;for(let C=0;C<S;C++){f.copy(e.faceNormals[l?l[C]:C]),s.vmult(f,f);const I=T.testSepAxis(f,e,t,n,r,s);if(!1===I)return!1;I<b&&(b=I,o.copy(f))}}for(let S=0;S!==T.uniqueEdges.length;S++){n.vmult(T.uniqueEdges[S],g);for(let C=0;C!==e.uniqueEdges.length;C++)if(s.vmult(e.uniqueEdges[C],v),g.cross(v,y),!y.almostZero()){y.normalize();const R=T.testSepAxis(y,e,t,n,r,s);if(!1===R)return!1;R<b&&(b=R,o.copy(y))}}return r.vsub(t,m),m.dot(o)>0&&o.negate(o),!0}testSepAxis(e,t,n,r,s,o){vb.project(this,e,n,r,mG),vb.project(t,e,s,o,gG);const l=mG[0],h=mG[1],f=gG[0],m=gG[1];if(l<m||f<h)return!1;const g=l-m,v=f-h;return g<v?g:v}calculateLocalInertia(e,t){const n=new W,r=new W;this.computeLocalAABB(r,n);const s=n.x-r.x,o=n.y-r.y,a=n.z-r.z;t.x=1/12*e*(2*o*2*o+2*a*2*a),t.y=1/12*e*(2*s*2*s+2*a*2*a),t.z=1/12*e*(2*o*2*o+2*s*2*s)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,n,r,s,o,a){const l=new W,h=new W,f=new W,m=new W,g=new W,v=new W,y=new W,b=new W,T=this,C=r,R=[];let I=-1,L=Number.MAX_VALUE;for(let K=0;K<T.faces.length;K++){l.copy(T.faceNormals[K]),n.vmult(l,l);const te=l.dot(e);te<L&&(L=te,I=K)}if(I<0)return;const N=T.faces[I];N.connectedFaces=[];for(let K=0;K<T.faces.length;K++)for(let te=0;te<T.faces[K].length;te++)-1!==N.indexOf(T.faces[K][te])&&K!==I&&-1===N.connectedFaces.indexOf(K)&&N.connectedFaces.push(K);const U=N.length;for(let K=0;K<U;K++){const te=T.vertices[N[K]];te.vsub(T.vertices[N[(K+1)%U]],h),f.copy(h),n.vmult(f,f),t.vadd(f,f),m.copy(this.faceNormals[I]),n.vmult(m,m),t.vadd(m,m),f.cross(m,g),g.negate(g),v.copy(te),n.vmult(v,v),t.vadd(v,v);const ie=N.connectedFaces[K];y.copy(this.faceNormals[ie]);const ne=this.getPlaneConstantOfFace(ie);b.copy(y),n.vmult(b,b);const le=ne-b.dot(t);for(this.clipFaceAgainstPlane(C,R,b,le);C.length;)C.shift();for(;R.length;)C.push(R.shift())}y.copy(this.faceNormals[I]);const k=this.getPlaneConstantOfFace(I);b.copy(y),n.vmult(b,b);const z=k-b.dot(t);for(let K=0;K<C.length;K++){let te=b.dot(C[K])+z;if(te<=s&&(console.log(`clamped: depth=${te} to minDist=${s}`),te=s),te<=o){const fe=C[K];te<=1e-6&&a.push({point:fe,normal:b,depth:te})}}}clipFaceAgainstPlane(e,t,n,r){let s,o;const a=e.length;if(a<2)return t;let l=e[e.length-1],h=e[0];s=n.dot(l)+r;for(let f=0;f<a;f++){if(h=e[f],o=n.dot(h)+r,s<0)if(o<0){const m=new W;m.copy(h),t.push(m)}else{const m=new W;l.lerp(h,s/(s-o),m),t.push(m)}else if(o<0){const m=new W;l.lerp(h,s/(s-o),m),t.push(m),t.push(h)}l=h,s=o}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new W);const n=this.vertices,r=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)t.vmult(n[s],r[s]),e.vadd(r[s],r[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const n=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<this.vertices.length;r++){const s=n[r];s.x<e.x?e.x=s.x:s.x>t.x&&(t.x=s.x),s.y<e.y?e.y=s.y:s.y>t.y&&(t.y=s.y),s.z<e.z?e.z=s.z:s.z>t.z&&(t.z=s.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new W);const n=this.faceNormals,r=this.worldFaceNormals;for(let s=0;s!==t;s++)e.vmult(n[s],r[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let n=0;n!==t.length;n++){const r=t[n].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,n,r){const s=this.vertices;let o,a,l,h,f,m,g=new W;for(let v=0;v<s.length;v++){g.copy(s[v]),t.vmult(g,g),e.vadd(g,g);const y=g;(void 0===o||y.x<o)&&(o=y.x),(void 0===h||y.x>h)&&(h=y.x),(void 0===a||y.y<a)&&(a=y.y),(void 0===f||y.y>f)&&(f=y.y),(void 0===l||y.z<l)&&(l=y.z),(void 0===m||y.z>m)&&(m=y.z)}n.set(o,a,l),r.set(h,f,m)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e){void 0===e&&(e=new W);const t=this.vertices;for(let n=0;n<t.length;n++)e.vadd(t[n],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const n=this.vertices.length,r=this.vertices;if(t){for(let s=0;s<n;s++){const o=r[s];t.vmult(o,o)}for(let s=0;s<this.faceNormals.length;s++){const o=this.faceNormals[s];t.vmult(o,o)}}if(e)for(let s=0;s<n;s++){const o=r[s];o.vadd(e,o)}}pointIsInside(e){const t=this.vertices,n=this.faces,r=this.faceNormals,o=new W;this.getAveragePointLocal(o);for(let a=0;a<this.faces.length;a++){let l=r[a];const h=t[n[a][0]],f=new W;e.vsub(h,f);const m=l.dot(f),g=new W;o.vsub(h,g);const v=l.dot(g);if(m<0&&v>0||m>0&&v<0)return!1}return-1}static project(e,t,n,r,s){const o=e.vertices.length,a=Uxe;let l=0,h=0;const f=Vxe,m=e.vertices;f.setZero(),lr.vectorToLocalFrame(n,r,t,a),lr.pointToLocalFrame(n,r,f,f);const g=f.dot(a);h=l=m[0].dot(a);for(let v=1;v<o;v++){const y=m[v].dot(a);y>l&&(l=y),y<h&&(h=y)}if(h-=g,l-=g,h>l){const v=h;h=l,l=v}s[0]=l,s[1]=h}}const mG=[],gG=[],Uxe=(new W,new W),Vxe=new W;class qw extends Nn{constructor(e){super({type:Nn.types.BOX}),this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,n=this.halfExtents.z,r=W,s=[new r(-e,-t,-n),new r(e,-t,-n),new r(e,t,-n),new r(-e,t,-n),new r(-e,-t,n),new r(e,-t,n),new r(e,t,n),new r(-e,t,n)],a=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],l=new vb({vertices:s,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=l,l.material=this.material}calculateLocalInertia(e,t){return void 0===t&&(t=new W),qw.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,n){const r=e;n.x=1/12*t*(2*r.y*2*r.y+2*r.z*2*r.z),n.y=1/12*t*(2*r.x*2*r.x+2*r.z*2*r.z),n.z=1/12*t*(2*r.y*2*r.y+2*r.x*2*r.x)}getSideNormals(e,t){const n=e,r=this.halfExtents;if(n[0].set(r.x,0,0),n[1].set(0,r.y,0),n[2].set(0,0,r.z),n[3].set(-r.x,0,0),n[4].set(0,-r.y,0),n[5].set(0,0,-r.z),void 0!==t)for(let s=0;s!==n.length;s++)t.vmult(n[s],n[s]);return n}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,n){const r=this.halfExtents,s=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]];for(let o=0;o<s.length;o++)lv.set(s[o][0],s[o][1],s[o][2]),t.vmult(lv,lv),e.vadd(lv,lv),n(lv.x,lv.y,lv.z)}calculateWorldAABB(e,t,n,r){const s=this.halfExtents;$f[0].set(s.x,s.y,s.z),$f[1].set(-s.x,s.y,s.z),$f[2].set(-s.x,-s.y,s.z),$f[3].set(-s.x,-s.y,-s.z),$f[4].set(s.x,-s.y,-s.z),$f[5].set(s.x,s.y,-s.z),$f[6].set(-s.x,s.y,-s.z),$f[7].set(s.x,-s.y,s.z);const o=$f[0];t.vmult(o,o),e.vadd(o,o),r.copy(o),n.copy(o);for(let a=1;a<8;a++){const l=$f[a];t.vmult(l,l),e.vadd(l,l);const h=l.x,f=l.y,m=l.z;h>r.x&&(r.x=h),f>r.y&&(r.y=f),m>r.z&&(r.z=m),h<n.x&&(n.x=h),f<n.y&&(n.y=f),m<n.z&&(n.z=m)}}}const lv=new W,$f=[new W,new W,new W,new W,new W,new W,new W,new W];class Ln extends A9{constructor(e){void 0===e&&(e={}),super(),this.id=Ln.idCounter++,this.index=-1,this.world=null,this.vlambda=new W,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new W,this.previousPosition=new W,this.interpolatedPosition=new W,this.initPosition=new W,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new W,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new W,this.force=new W;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?Ln.STATIC:Ln.DYNAMIC,typeof e.type==typeof Ln.STATIC&&(this.type=e.type),this.allowSleep=!(typeof e.allowSleep<"u")||e.allowSleep,this.sleepState=Ln.AWAKE,this.sleepSpeedLimit=typeof e.sleepSpeedLimit<"u"?e.sleepSpeedLimit:.1,this.sleepTimeLimit=typeof e.sleepTimeLimit<"u"?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new W,this.quaternion=new so,this.initQuaternion=new so,this.previousQuaternion=new so,this.interpolatedQuaternion=new so,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new W,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new W,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new W,this.invInertia=new W,this.invInertiaWorld=new Ad,this.invMassSolve=0,this.invInertiaSolve=new W,this.invInertiaWorldSolve=new Ad,this.fixedRotation=typeof e.fixedRotation<"u"&&e.fixedRotation,this.angularDamping=typeof e.angularDamping<"u"?e.angularDamping:.01,this.linearFactor=new W(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new W(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new Ps,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new W,this.isTrigger=Boolean(e.isTrigger),e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=Ln.AWAKE,this.wakeUpAfterNarrowphase=!1,e===Ln.SLEEPING&&this.dispatchEvent(Ln.wakeupEvent)}sleep(){this.sleepState=Ln.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,n=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=this.sleepSpeedLimit**2;t===Ln.AWAKE&&n<r?(this.sleepState=Ln.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(Ln.sleepyEvent)):t===Ln.SLEEPY&&n>r?this.wakeUp():t===Ln.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(Ln.sleepEvent))}}updateSolveMassProperties(){this.sleepState===Ln.SLEEPING||this.type===Ln.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t){return void 0===t&&(t=new W),e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t){return void 0===t&&(t=new W),this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t){return void 0===t&&(t=new W),this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t){return void 0===t&&(t=new W),this.quaternion.vmult(e,t),t}addShape(e,t,n){const r=new W,s=new so;return t&&r.copy(t),n&&s.copy(n),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,n=e.length;let r=0;for(let s=0;s!==n;s++){const o=e[s];o.updateBoundingSphereRadius();const a=t[s].length(),l=o.boundingSphereRadius;a+l>r&&(r=a+l)}this.boundingRadius=r}updateAABB(){const e=this.shapes,t=this.shapeOffsets,n=this.shapeOrientations,r=e.length,s=Gxe,o=zxe,a=this.quaternion,l=this.aabb,h=Hxe;for(let f=0;f!==r;f++){const m=e[f];a.vmult(t[f],s),s.vadd(this.position,s),a.mult(n[f],o),m.calculateWorldAABB(s,o,h.lowerBound,h.upperBound),0===f?l.copy(h):l.extend(h)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const n=Wxe,r=qxe;n.setRotationFromQuaternion(this.quaternion),n.transpose(r),n.scale(t,n),n.mmult(r,this.invInertiaWorld)}}applyForce(e,t){if(void 0===t&&(t=new W),this.type!==Ln.DYNAMIC)return;this.sleepState===Ln.SLEEPING&&this.wakeUp();const n=Yxe;t.cross(e,n),this.force.vadd(e,this.force),this.torque.vadd(n,this.torque)}applyLocalForce(e,t){if(void 0===t&&(t=new W),this.type!==Ln.DYNAMIC)return;const n=Kxe,r=Xxe;this.vectorToWorldFrame(e,n),this.vectorToWorldFrame(t,r),this.applyForce(n,r)}applyTorque(e){this.type===Ln.DYNAMIC&&(this.sleepState===Ln.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t){if(void 0===t&&(t=new W),this.type!==Ln.DYNAMIC)return;this.sleepState===Ln.SLEEPING&&this.wakeUp();const n=t,r=$xe;r.copy(e),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);const s=Qxe;n.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,t){if(void 0===t&&(t=new W),this.type!==Ln.DYNAMIC)return;const n=Jxe,r=eTe;this.vectorToWorldFrame(e,n),this.vectorToWorldFrame(t,r),this.applyImpulse(n,r)}updateMassProperties(){const e=tTe;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,n=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),qw.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!n?1/t.x:0,t.y>0&&!n?1/t.y:0,t.z>0&&!n?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const n=new W;return e.vsub(this.position,n),this.angularVelocity.cross(n,t),this.velocity.vadd(t,t),t}integrate(e,t,n){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==Ln.DYNAMIC&&this.type!==Ln.KINEMATIC||this.sleepState===Ln.SLEEPING)return;const r=this.velocity,s=this.angularVelocity,o=this.position,a=this.force,l=this.torque,h=this.quaternion,m=this.invInertiaWorld,g=this.linearFactor,v=this.invMass*e;r.x+=a.x*v*g.x,r.y+=a.y*v*g.y,r.z+=a.z*v*g.z;const y=m.elements,b=this.angularFactor,T=l.x*b.x,S=l.y*b.y,C=l.z*b.z;s.x+=e*(y[0]*T+y[1]*S+y[2]*C),s.y+=e*(y[3]*T+y[4]*S+y[5]*C),s.z+=e*(y[6]*T+y[7]*S+y[8]*C),o.x+=r.x*e,o.y+=r.y*e,o.z+=r.z*e,h.integrate(this.angularVelocity,e,this.angularFactor,h),t&&(n?h.normalizeFast():h.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}Ln.idCounter=0,Ln.COLLIDE_EVENT_NAME="collide",Ln.DYNAMIC=1,Ln.STATIC=2,Ln.KINEMATIC=4,Ln.AWAKE=0,Ln.SLEEPY=1,Ln.SLEEPING=2,Ln.wakeupEvent={type:"wakeup"},Ln.sleepyEvent={type:"sleepy"},Ln.sleepEvent={type:"sleep"};const Gxe=new W,zxe=new so,Hxe=new Ps,Wxe=new Ad,qxe=new Ad,Yxe=(new Ad,new W),Kxe=new W,Xxe=new W,$xe=new W,Qxe=new W,Jxe=new W,eTe=new W,tTe=new W,iTe=new W;new W,new so,new W;const rTe={keys:[]},sTe=[],oTe=[];new W,new W,new W;class lTe extends class nTe{constructor(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}collisionPairs(e,t,n){throw new Error("collisionPairs not implemented for this BroadPhase class!")}needBroadphaseCollision(e,t){return!(0==(e.collisionFilterGroup&t.collisionFilterMask)||0==(t.collisionFilterGroup&e.collisionFilterMask)||(0!=(e.type&Ln.STATIC)||e.sleepState===Ln.SLEEPING)&&(0!=(t.type&Ln.STATIC)||t.sleepState===Ln.SLEEPING))}intersectionTest(e,t,n,r){this.useBoundingBoxes?this.doBoundingBoxBroadphase(e,t,n,r):this.doBoundingSphereBroadphase(e,t,n,r)}doBoundingSphereBroadphase(e,t,n,r){const s=iTe;t.position.vsub(e.position,s);const o=(e.boundingRadius+t.boundingRadius)**2;s.lengthSquared()<o&&(n.push(e),r.push(t))}doBoundingBoxBroadphase(e,t,n,r){e.aabbNeedsUpdate&&e.updateAABB(),t.aabbNeedsUpdate&&t.updateAABB(),e.aabb.overlaps(t.aabb)&&(n.push(e),r.push(t))}makePairsUnique(e,t){const n=rTe,r=sTe,s=oTe,o=e.length;for(let a=0;a!==o;a++)r[a]=e[a],s[a]=t[a];e.length=0,t.length=0;for(let a=0;a!==o;a++){const l=r[a].id,h=s[a].id,f=l<h?`${l},${h}`:`${h},${l}`;n[f]=a,n.keys.push(f)}for(let a=0;a!==n.keys.length;a++){const l=n.keys.pop(),h=n[l];e.push(r[h]),t.push(s[h]),delete n[l]}}setWorld(e){}static boundingSphereCheck(e,t){const n=new W;return e.position.vsub(t.position,n),Math.pow(e.shapes[0].boundingSphereRadius+t.shapes[0].boundingSphereRadius,2)>n.lengthSquared()}aabbQuery(e,t,n){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}}{constructor(){super()}collisionPairs(e,t,n){const r=e.bodies,s=r.length;let o,a;for(let l=0;l!==s;l++)for(let h=0;h!==l;h++)o=r[l],a=r[h],this.needBroadphaseCollision(o,a)&&this.intersectionTest(o,a,t,n)}aabbQuery(e,t,n){void 0===n&&(n=[]);for(let r=0;r<e.bodies.length;r++){const s=e.bodies[r];s.aabbNeedsUpdate&&s.updateAABB(),s.aabb.overlaps(t)&&n.push(s)}return n}}class e1{constructor(){this.rayFromWorld=new W,this.rayToWorld=new W,this.hitNormalWorld=new W,this.hitPointWorld=new W,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,n,r,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(n),this.hitPointWorld.copy(r),this.shape=s,this.body=o,this.distance=a}}let R9,I9,P9,F9,L9,O9,k9;R9=Nn.types.SPHERE,I9=Nn.types.PLANE,P9=Nn.types.BOX,F9=Nn.types.CYLINDER,L9=Nn.types.CONVEXPOLYHEDRON,O9=Nn.types.HEIGHTFIELD,k9=Nn.types.TRIMESH;class Go{get[R9](){return this._intersectSphere}get[I9](){return this._intersectPlane}get[P9](){return this._intersectBox}get[F9](){return this._intersectConvex}get[L9](){return this._intersectConvex}get[O9](){return this._intersectHeightfield}get[k9](){return this._intersectTrimesh}constructor(e,t){void 0===e&&(e=new W),void 0===t&&(t=new W),this.from=e.clone(),this.to=t.clone(),this.direction=new W,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=Go.ANY,this.result=new e1,this.hasHit=!1,this.callback=n=>{}}intersectWorld(e,t){return this.mode=t.mode||Go.ANY,this.result=t.result||new e1,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=typeof t.collisionFilterMask<"u"?t.collisionFilterMask:-1,this.collisionFilterGroup=typeof t.collisionFilterGroup<"u"?t.collisionFilterGroup:-1,this.checkCollisionResponse=!(typeof t.checkCollisionResponse<"u")||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(N9),bG.length=0,e.broadphase.aabbQuery(e,N9,bG),this.intersectBodies(bG),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const n=this.checkCollisionResponse;if(n&&!e.collisionResponse||0==(this.collisionFilterGroup&e.collisionFilterMask)||0==(e.collisionFilterGroup&this.collisionFilterMask))return;const r=cTe,s=uTe;for(let o=0,a=e.shapes.length;o<a;o++){const l=e.shapes[o];if((!n||l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(l,s,r,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let n=0,r=e.length;!this.result.shouldStop&&n<r;n++)this.intersectBody(e[n])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,n,r){if(function CTe(i,e,t){t.vsub(i,yb);const n=yb.dot(e);return e.scale(n,KL),KL.vadd(i,KL),t.distanceTo(KL)}(this.from,this.direction,n)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,t,n,r,e)}_intersectBox(e,t,n,r,s){return this._intersectConvex(e.convexPolyhedronRepresentation,t,n,r,s)}_intersectPlane(e,t,n,r,s){const o=this.from,a=this.to,l=this.direction,h=new W(0,0,1);t.vmult(h,h);const f=new W;o.vsub(n,f);const m=f.dot(h);if(a.vsub(n,f),m*f.dot(h)>0||o.distanceTo(a)<m)return;const v=h.dot(l);if(Math.abs(v)<this.precision)return;const y=new W,b=new W,T=new W;o.vsub(n,y);const S=-h.dot(y)/v;l.scale(S,b),o.vadd(b,T),this.reportIntersection(h,T,s,r,-1)}getAABB(e){const{lowerBound:t,upperBound:n}=e,r=this.to,s=this.from;t.x=Math.min(r.x,s.x),t.y=Math.min(r.y,s.y),t.z=Math.min(r.z,s.z),n.x=Math.max(r.x,s.x),n.y=Math.max(r.y,s.y),n.z=Math.max(r.z,s.z)}_intersectHeightfield(e,t,n,r,s){const o=hTe;o.from.copy(this.from),o.to.copy(this.to),lr.pointToLocalFrame(n,t,o.from,o.from),lr.pointToLocalFrame(n,t,o.to,o.to),o.updateDirection();const a=dTe;let l,h,f,m;l=h=0,f=m=e.data.length-1;const g=new Ps;o.getAABB(g),e.getIndexOfPosition(g.lowerBound.x,g.lowerBound.y,a,!0),l=Math.max(l,a[0]),h=Math.max(h,a[1]),e.getIndexOfPosition(g.upperBound.x,g.upperBound.y,a,!0),f=Math.min(f,a[0]+1),m=Math.min(m,a[1]+1);for(let v=l;v<f;v++)for(let y=h;y<m;y++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(v,y,g),g.overlapsRay(o)){if(e.getConvexTrianglePillar(v,y,!1),lr.pointToWorldFrame(n,t,e.pillarOffset,YL),this._intersectConvex(e.pillarConvex,t,YL,r,s,B9),this.result.shouldStop)return;e.getConvexTrianglePillar(v,y,!0),lr.pointToWorldFrame(n,t,e.pillarOffset,YL),this._intersectConvex(e.pillarConvex,t,YL,r,s,B9)}}}_intersectSphere(e,t,n,r,s){const o=this.from,a=this.to,h=(a.x-o.x)**2+(a.y-o.y)**2+(a.z-o.z)**2,f=2*((a.x-o.x)*(o.x-n.x)+(a.y-o.y)*(o.y-n.y)+(a.z-o.z)*(o.z-n.z)),g=f**2-4*h*((o.x-n.x)**2+(o.y-n.y)**2+(o.z-n.z)**2-e.radius**2),v=fTe,y=pTe;if(!(g<0))if(0===g)o.lerp(a,g,v),v.vsub(n,y),y.normalize(),this.reportIntersection(y,v,s,r,-1);else{const b=(-f-Math.sqrt(g))/(2*h),T=(-f+Math.sqrt(g))/(2*h);if(b>=0&&b<=1&&(o.lerp(a,b,v),v.vsub(n,y),y.normalize(),this.reportIntersection(y,v,s,r,-1)),this.result.shouldStop)return;T>=0&&T<=1&&(o.lerp(a,T,v),v.vsub(n,y),y.normalize(),this.reportIntersection(y,v,s,r,-1))}}_intersectConvex(e,t,n,r,s,o){const a=mTe,l=j9,h=o&&o.faceList||null,f=e.faces,m=e.vertices,g=e.faceNormals,v=this.direction,y=this.from,T=y.distanceTo(this.to),S=h?h.length:f.length,C=this.result;for(let R=0;!C.shouldStop&&R<S;R++){const I=h?h[R]:R,L=f[I],N=g[I],U=t,k=n;l.copy(m[L[0]]),U.vmult(l,l),l.vadd(k,l),l.vsub(y,l),U.vmult(N,a);const z=v.dot(a);if(Math.abs(z)<this.precision)continue;const K=a.dot(l)/z;if(!(K<0)){v.scale(K,bc),bc.vadd(y,bc),Dd.copy(m[L[0]]),U.vmult(Dd,Dd),k.vadd(Dd,Dd);for(let te=1;!C.shouldStop&&te<L.length-1;te++){Qf.copy(m[L[te]]),Jf.copy(m[L[te+1]]),U.vmult(Qf,Qf),U.vmult(Jf,Jf),k.vadd(Qf,Qf),k.vadd(Jf,Jf);const fe=bc.distanceTo(y);!Go.pointInTriangle(bc,Dd,Qf,Jf)&&!Go.pointInTriangle(bc,Qf,Dd,Jf)||fe>T||this.reportIntersection(a,bc,s,r,I)}}}}_intersectTrimesh(e,t,n,r,s,o){const a=vTe,l=MTe,h=STe,f=j9,m=yTe,g=bTe,v=xTe,y=wTe,b=TTe,T=e.indices,S=this.from,C=this.to,R=this.direction;h.position.copy(n),h.quaternion.copy(t),lr.vectorToLocalFrame(n,t,R,m),lr.pointToLocalFrame(n,t,S,g),lr.pointToLocalFrame(n,t,C,v),v.x*=e.scale.x,v.y*=e.scale.y,v.z*=e.scale.z,g.x*=e.scale.x,g.y*=e.scale.y,g.z*=e.scale.z,v.vsub(g,m),m.normalize();const I=g.distanceSquared(v);e.tree.rayQuery(this,h,l);for(let L=0,N=l.length;!this.result.shouldStop&&L!==N;L++){const U=l[L];e.getNormal(U,a),e.getVertex(T[3*U],Dd),Dd.vsub(g,f);const k=m.dot(a),z=a.dot(f)/k;if(z<0)continue;m.scale(z,bc),bc.vadd(g,bc),e.getVertex(T[3*U+1],Qf),e.getVertex(T[3*U+2],Jf);const K=bc.distanceSquared(g);!Go.pointInTriangle(bc,Qf,Dd,Jf)&&!Go.pointInTriangle(bc,Dd,Qf,Jf)||K>I||(lr.vectorToWorldFrame(t,a,b),lr.pointToWorldFrame(n,t,bc,y),this.reportIntersection(b,y,s,r,U))}l.length=0}reportIntersection(e,t,n,r,s){const o=this.from,a=this.to,l=o.distanceTo(t),h=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(h.hitFaceIndex=typeof s<"u"?s:-1,this.mode){case Go.ALL:this.hasHit=!0,h.set(o,a,e,t,n,r,l),h.hasHit=!0,this.callback(h);break;case Go.CLOSEST:(l<h.distance||!h.hasHit)&&(this.hasHit=!0,h.hasHit=!0,h.set(o,a,e,t,n,r,l));break;case Go.ANY:this.hasHit=!0,h.hasHit=!0,h.set(o,a,e,t,n,r,l),h.shouldStop=!0}}static pointInTriangle(e,t,n,r){r.vsub(t,yb),n.vsub(t,t1),e.vsub(t,xG);const s=yb.dot(yb),o=yb.dot(t1),a=yb.dot(xG),l=t1.dot(t1),h=t1.dot(xG);let f,m;return(f=l*a-o*h)>=0&&(m=s*h-o*a)>=0&&f+m<s*l-o*o}}Go.CLOSEST=1,Go.ANY=2,Go.ALL=4;const N9=new Ps,bG=[],t1=new W,xG=new W,cTe=new W,uTe=new so,bc=new W,Dd=new W,Qf=new W,Jf=new W;new W,new e1;const B9={faceList:[0]},YL=new W,hTe=new Go,dTe=[],fTe=new W,pTe=new W,mTe=new W,j9=(new W,new W,new W),vTe=new W,yTe=new W,bTe=new W,xTe=new W,TTe=new W,wTe=new W;new Ps;const MTe=[],STe=new lr,yb=new W,KL=new W;class U9{constructor(){this.spatial=new W,this.rotational=new W}multiplyElement(e){return e.spatial.dot(this.spatial)+e.rotational.dot(this.rotational)}multiplyVectors(e,t){return e.dot(this.spatial)+t.dot(this.rotational)}}let V9=(()=>{class i{constructor(t,n,r,s){void 0===r&&(r=-1e6),void 0===s&&(s=1e6),this.id=i.idCounter++,this.minForce=r,this.maxForce=s,this.bi=t,this.bj=n,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new U9,this.jacobianElementB=new U9,this.enabled=!0,this.multiplier=0,this.setSpookParams(1e7,4,1/60)}setSpookParams(t,n,r){const s=n,o=t,a=r;this.a=4/(a*(1+4*s)),this.b=4*s/(1+4*s),this.eps=4/(a*a*o*(1+4*s))}computeB(t,n,r){const s=this.computeGW();return-this.computeGq()*t-s*n-this.computeGiMf()*r}computeGq(){const n=this.jacobianElementB,a=this.bj.position;return this.jacobianElementA.spatial.dot(this.bi.position)+n.spatial.dot(a)}computeGW(){const n=this.jacobianElementB,r=this.bi,s=this.bj,a=s.velocity,h=s.angularVelocity;return this.jacobianElementA.multiplyVectors(r.velocity,r.angularVelocity)+n.multiplyVectors(a,h)}computeGWlambda(){const n=this.jacobianElementB,r=this.bi,s=this.bj,a=s.vlambda,h=s.wlambda;return this.jacobianElementA.multiplyVectors(r.vlambda,r.wlambda)+n.multiplyVectors(a,h)}computeGiMf(){const t=this.jacobianElementA,n=this.jacobianElementB,r=this.bi,s=this.bj,a=r.torque,l=s.force,h=s.torque,m=s.invMassSolve;return r.force.scale(r.invMassSolve,G9),l.scale(m,z9),r.invInertiaWorldSolve.vmult(a,H9),s.invInertiaWorldSolve.vmult(h,W9),t.multiplyVectors(G9,H9)+n.multiplyVectors(z9,W9)}computeGiMGt(){const t=this.jacobianElementA,n=this.jacobianElementB,r=this.bi,s=this.bj,h=s.invInertiaWorldSolve;let f=r.invMassSolve+s.invMassSolve;return r.invInertiaWorldSolve.vmult(t.rotational,XL),f+=XL.dot(t.rotational),h.vmult(n.rotational,XL),f+=XL.dot(n.rotational),f}addToWlambda(t){const n=this.jacobianElementA,r=this.jacobianElementB,s=this.bi,o=this.bj,a=ETe;s.vlambda.addScaledVector(s.invMassSolve*t,n.spatial,s.vlambda),o.vlambda.addScaledVector(o.invMassSolve*t,r.spatial,o.vlambda),s.invInertiaWorldSolve.vmult(n.rotational,a),s.wlambda.addScaledVector(t,a,s.wlambda),o.invInertiaWorldSolve.vmult(r.rotational,a),o.wlambda.addScaledVector(t,a,o.wlambda)}computeC(){return this.computeGiMGt()+this.eps}}return i.idCounter=0,i})();const G9=new W,z9=new W,H9=new W,W9=new W,XL=new W,ETe=new W;class r1 extends V9{constructor(e,t,n){void 0===n&&(n=1e6),super(e,t,0,n),this.restitution=0,this.ri=new W,this.rj=new W,this.ni=new W}computeB(e){const t=this.a,n=this.b,r=this.bi,s=this.bj,o=this.ri,a=this.rj,l=ATe,h=DTe,f=r.velocity,m=r.angularVelocity,g=s.velocity,v=s.angularVelocity,y=RTe,b=this.jacobianElementA,T=this.jacobianElementB,S=this.ni;o.cross(S,l),a.cross(S,h),S.negate(b.spatial),l.negate(b.rotational),T.spatial.copy(S),T.rotational.copy(h),y.copy(s.position),y.vadd(a,y),y.vsub(r.position,y),y.vsub(o,y);const C=S.dot(y),R=this.restitution+1;return-C*t-(R*g.dot(S)-R*f.dot(S)+v.dot(h)-m.dot(l))*n-e*this.computeGiMf()}getImpactVelocityAlongNormal(){const e=ITe,t=PTe,n=FTe,r=LTe,s=OTe;return this.bi.position.vadd(this.ri,n),this.bj.position.vadd(this.rj,r),this.bi.getVelocityAtWorldPoint(n,e),this.bj.getVelocityAtWorldPoint(r,t),e.vsub(t,s),this.ni.dot(s)}}const ATe=new W,DTe=new W,RTe=new W,ITe=new W,PTe=new W,FTe=new W,LTe=new W,OTe=new W;new W,new W,new W,new W,new W,new W,new W,new W,new W,new W;class q9 extends V9{constructor(e,t,n){super(e,t,-n,n),this.ri=new W,this.rj=new W,this.t=new W}computeB(e){const t=this.b,r=this.rj,s=ZTe,o=YTe,a=this.t;this.ri.cross(a,s),r.cross(a,o);const l=this.jacobianElementA,h=this.jacobianElementB;return a.negate(l.spatial),s.negate(l.rotational),h.spatial.copy(a),h.rotational.copy(o),-this.computeGW()*t-e*this.computeGiMf()}}const ZTe=new W,YTe=new W;let KTe=(()=>{class i{constructor(t,n,r){r=class TG{static defaults(e,t){void 0===e&&(e={});for(let n in t)n in e||(e[n]=t[n]);return e}}.defaults(r,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=i.idCounter++,this.materials=[t,n],this.friction=r.friction,this.restitution=r.restitution,this.contactEquationStiffness=r.contactEquationStiffness,this.contactEquationRelaxation=r.contactEquationRelaxation,this.frictionEquationStiffness=r.frictionEquationStiffness,this.frictionEquationRelaxation=r.frictionEquationRelaxation}}return i.idCounter=0,i})(),XTe=(()=>{class i{constructor(t){void 0===t&&(t={});let n="";"string"==typeof t&&(n=t,t={}),this.name=n,this.id=i.idCounter++,this.friction=typeof t.friction<"u"?t.friction:-1,this.restitution=typeof t.restitution<"u"?t.restitution:-1}}return i.idCounter=0,i})();new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new Go,new W,new W,new W,new W(1,0,0),new W(0,1,0),new W(0,0,1),new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new W,new Ps,new W,new Ps,new W,new W,new W,new W,new W,new W,new W,new Ps,new W,new lr,new Ps;class nMe extends class tMe{constructor(){this.equations=[]}solve(e,t){return 0}addEquation(e){e.enabled&&!e.bi.isTrigger&&!e.bj.isTrigger&&this.equations.push(e)}removeEquation(e){const t=this.equations,n=t.indexOf(e);-1!==n&&t.splice(n,1)}removeAllEquations(){this.equations.length=0}}{constructor(){super(),this.iterations=10,this.tolerance=1e-7}solve(e,t){let n=0;const r=this.iterations,s=this.tolerance*this.tolerance,o=this.equations,a=o.length,l=t.bodies,h=l.length,f=e;let m,g,v,y,b,T;if(0!==a)for(let I=0;I!==h;I++)l[I].updateSolveMassProperties();const S=rMe,C=sMe,R=iMe;S.length=a,C.length=a,R.length=a;for(let I=0;I!==a;I++){const L=o[I];R[I]=0,C[I]=L.computeB(f),S[I]=1/L.computeC()}if(0!==a){for(let N=0;N!==h;N++){const U=l[N],z=U.wlambda;U.vlambda.set(0,0,0),z.set(0,0,0)}for(n=0;n!==r;n++){y=0;for(let N=0;N!==a;N++){const U=o[N];m=C[N],g=S[N],T=R[N],b=U.computeGWlambda(),v=g*(m-b-U.eps*T),T+v<U.minForce?v=U.minForce-T:T+v>U.maxForce&&(v=U.maxForce-T),R[N]+=v,y+=v>0?v:-v,U.addToWlambda(v)}if(y*y<s)break}for(let N=0;N!==h;N++){const U=l[N],k=U.velocity,z=U.angularVelocity;U.vlambda.vmul(U.linearFactor,U.vlambda),k.vadd(U.vlambda,k),U.wlambda.vmul(U.angularFactor,U.wlambda),z.vadd(U.wlambda,z)}let I=o.length;const L=1/f;for(;I--;)o[I].multiplier=R[I]*L}return n}}const iMe=[],rMe=[],sMe=[];class pMe extends class fMe{constructor(){this.objects=[],this.type=Object}release(){const e=arguments.length;for(let t=0;t!==e;t++)this.objects.push(t<0||arguments.length<=t?void 0:arguments[t]);return this}get(){return 0===this.objects.length?this.constructObject():this.objects.pop()}constructObject(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}resize(e){const t=this.objects;for(;t.length>e;)t.pop();for(;t.length<e;)t.push(this.constructObject());return this}}{constructor(){super(...arguments),this.type=W}constructObject(){return new W}}const ps_sphereSphere=Nn.types.SPHERE,ps_spherePlane=Nn.types.SPHERE|Nn.types.PLANE,ps_boxBox=Nn.types.BOX|Nn.types.BOX,ps_sphereBox=Nn.types.SPHERE|Nn.types.BOX,ps_planeBox=Nn.types.PLANE|Nn.types.BOX,ps_convexConvex=Nn.types.CONVEXPOLYHEDRON,ps_sphereConvex=Nn.types.SPHERE|Nn.types.CONVEXPOLYHEDRON,ps_planeConvex=Nn.types.PLANE|Nn.types.CONVEXPOLYHEDRON,ps_boxConvex=Nn.types.BOX|Nn.types.CONVEXPOLYHEDRON,ps_sphereHeightfield=Nn.types.SPHERE|Nn.types.HEIGHTFIELD,ps_boxHeightfield=Nn.types.BOX|Nn.types.HEIGHTFIELD,ps_convexHeightfield=Nn.types.CONVEXPOLYHEDRON|Nn.types.HEIGHTFIELD,ps_sphereParticle=Nn.types.PARTICLE|Nn.types.SPHERE,ps_planeParticle=Nn.types.PLANE|Nn.types.PARTICLE,ps_boxParticle=Nn.types.BOX|Nn.types.PARTICLE,ps_convexParticle=Nn.types.PARTICLE|Nn.types.CONVEXPOLYHEDRON,ps_cylinderCylinder=Nn.types.CYLINDER,ps_sphereCylinder=Nn.types.SPHERE|Nn.types.CYLINDER,ps_planeCylinder=Nn.types.PLANE|Nn.types.CYLINDER,ps_boxCylinder=Nn.types.BOX|Nn.types.CYLINDER,ps_convexCylinder=Nn.types.CONVEXPOLYHEDRON|Nn.types.CYLINDER,ps_heightfieldCylinder=Nn.types.HEIGHTFIELD|Nn.types.CYLINDER,ps_particleCylinder=Nn.types.PARTICLE|Nn.types.CYLINDER,ps_sphereTrimesh=Nn.types.SPHERE|Nn.types.TRIMESH,ps_planeTrimesh=Nn.types.PLANE|Nn.types.TRIMESH;class mMe{get[ps_sphereSphere](){return this.sphereSphere}get[ps_spherePlane](){return this.spherePlane}get[ps_boxBox](){return this.boxBox}get[ps_sphereBox](){return this.sphereBox}get[ps_planeBox](){return this.planeBox}get[ps_convexConvex](){return this.convexConvex}get[ps_sphereConvex](){return this.sphereConvex}get[ps_planeConvex](){return this.planeConvex}get[ps_boxConvex](){return this.boxConvex}get[ps_sphereHeightfield](){return this.sphereHeightfield}get[ps_boxHeightfield](){return this.boxHeightfield}get[ps_convexHeightfield](){return this.convexHeightfield}get[ps_sphereParticle](){return this.sphereParticle}get[ps_planeParticle](){return this.planeParticle}get[ps_boxParticle](){return this.boxParticle}get[ps_convexParticle](){return this.convexParticle}get[ps_cylinderCylinder](){return this.convexConvex}get[ps_sphereCylinder](){return this.sphereConvex}get[ps_planeCylinder](){return this.planeConvex}get[ps_boxCylinder](){return this.boxConvex}get[ps_convexCylinder](){return this.convexConvex}get[ps_heightfieldCylinder](){return this.heightfieldCylinder}get[ps_particleCylinder](){return this.particleCylinder}get[ps_sphereTrimesh](){return this.sphereTrimesh}get[ps_planeTrimesh](){return this.planeTrimesh}constructor(e){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new pMe,this.world=e,this.currentContactMaterial=e.defaultContactMaterial,this.enableFrictionReduction=!1}createContactEquation(e,t,n,r,s,o){let a;this.contactPointPool.length?(a=this.contactPointPool.pop(),a.bi=e,a.bj=t):a=new r1(e,t),a.enabled=e.collisionResponse&&t.collisionResponse&&n.collisionResponse&&r.collisionResponse;const l=this.currentContactMaterial;a.restitution=l.restitution,a.setSpookParams(l.contactEquationStiffness,l.contactEquationRelaxation,this.world.dt);const h=n.material||e.material,f=r.material||t.material;return h&&f&&h.restitution>=0&&f.restitution>=0&&(a.restitution=h.restitution*f.restitution),a.si=s||n,a.sj=o||r,a}createFrictionEquationsFromContact(e,t){const n=e.bi,r=e.bj,a=this.world,l=this.currentContactMaterial;let h=l.friction;const f=e.si.material||n.material,m=e.sj.material||r.material;if(f&&m&&f.friction>=0&&m.friction>=0&&(h=f.friction*m.friction),h>0){const g=h*(a.frictionGravity||a.gravity).length();let v=n.invMass+r.invMass;v>0&&(v=1/v);const y=this.frictionEquationPool,b=y.length?y.pop():new q9(n,r,g*v),T=y.length?y.pop():new q9(n,r,g*v);return b.bi=T.bi=n,b.bj=T.bj=r,b.minForce=T.minForce=-g*v,b.maxForce=T.maxForce=g*v,b.ri.copy(e.ri),b.rj.copy(e.rj),T.ri.copy(e.ri),T.rj.copy(e.rj),e.ni.tangents(b.t,T.t),b.setSpookParams(l.frictionEquationStiffness,l.frictionEquationRelaxation,a.dt),T.setSpookParams(l.frictionEquationStiffness,l.frictionEquationRelaxation,a.dt),b.enabled=T.enabled=e.enabled,t.push(b,T),!0}return!1}createFrictionFromAverage(e){let t=this.result[this.result.length-1];if(!this.createFrictionEquationsFromContact(t,this.frictionResult)||1===e)return;const n=this.frictionResult[this.frictionResult.length-2],r=this.frictionResult[this.frictionResult.length-1];Tb.setZero(),Yw.setZero(),Kw.setZero();const s=t.bi;for(let a=0;a!==e;a++)t=this.result[this.result.length-1-a],t.bi!==s?(Tb.vadd(t.ni,Tb),Yw.vadd(t.ri,Yw),Kw.vadd(t.rj,Kw)):(Tb.vsub(t.ni,Tb),Yw.vadd(t.rj,Yw),Kw.vadd(t.ri,Kw));const o=1/e;Yw.scale(o,n.ri),Kw.scale(o,n.rj),r.ri.copy(n.ri),r.rj.copy(n.rj),Tb.normalize(),Tb.tangents(n.t,r.t)}getContacts(e,t,n,r,s,o,a){this.contactPointPool=s,this.frictionEquationPool=a,this.result=r,this.frictionResult=o;const l=vMe,h=yMe,f=gMe,m=_Me;for(let g=0,v=e.length;g!==v;g++){const y=e[g],b=t[g];let T=null;y.material&&b.material&&(T=n.getContactMaterial(y.material,b.material)||null);const S=y.type&Ln.KINEMATIC&&b.type&Ln.STATIC||y.type&Ln.STATIC&&b.type&Ln.KINEMATIC||y.type&Ln.KINEMATIC&&b.type&Ln.KINEMATIC;for(let C=0;C<y.shapes.length;C++){y.quaternion.mult(y.shapeOrientations[C],l),y.quaternion.vmult(y.shapeOffsets[C],f),f.vadd(y.position,f);const R=y.shapes[C];for(let I=0;I<b.shapes.length;I++){b.quaternion.mult(b.shapeOrientations[I],h),b.quaternion.vmult(b.shapeOffsets[I],m),m.vadd(b.position,m);const L=b.shapes[I];if(!(R.collisionFilterMask&L.collisionFilterGroup&&L.collisionFilterMask&R.collisionFilterGroup)||f.distanceTo(m)>R.boundingSphereRadius+L.boundingSphereRadius)continue;let N=null;R.material&&L.material&&(N=n.getContactMaterial(R.material,L.material)||null),this.currentContactMaterial=N||T||n.defaultContactMaterial;const k=this[R.type|L.type];if(k){let z=!1;z=R.type<L.type?k.call(this,R,L,f,m,l,h,y,b,R,L,S):k.call(this,L,R,m,f,h,l,b,y,R,L,S),z&&S&&(n.shapeOverlapKeeper.set(R.id,L.id),n.bodyOverlapKeeper.set(y.id,b.id))}}}}}sphereSphere(e,t,n,r,s,o,a,l,h,f,m){if(m)return n.distanceSquared(r)<(e.radius+t.radius)**2;const g=this.createContactEquation(a,l,e,t,h,f);r.vsub(n,g.ni),g.ni.normalize(),g.ri.copy(g.ni),g.rj.copy(g.ni),g.ri.scale(e.radius,g.ri),g.rj.scale(-t.radius,g.rj),g.ri.vadd(n,g.ri),g.ri.vsub(a.position,g.ri),g.rj.vadd(r,g.rj),g.rj.vsub(l.position,g.rj),this.result.push(g),this.createFrictionEquationsFromContact(g,this.frictionResult)}spherePlane(e,t,n,r,s,o,a,l,h,f,m){const g=this.createContactEquation(a,l,e,t,h,f);if(g.ni.set(0,0,1),o.vmult(g.ni,g.ni),g.ni.negate(g.ni),g.ni.normalize(),g.ni.scale(e.radius,g.ri),n.vsub(r,tO),g.ni.scale(g.ni.dot(tO),sX),tO.vsub(sX,g.rj),-tO.dot(g.ni)<=e.radius){if(m)return!0;const v=g.ri,y=g.rj;v.vadd(n,v),v.vsub(a.position,v),y.vadd(r,y),y.vsub(l.position,y),this.result.push(g),this.createFrictionEquationsFromContact(g,this.frictionResult)}}boxBox(e,t,n,r,s,o,a,l,h,f,m){return e.convexPolyhedronRepresentation.material=e.material,t.convexPolyhedronRepresentation.material=t.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t.convexPolyhedronRepresentation,n,r,s,o,a,l,e,t,m)}sphereBox(e,t,n,r,s,o,a,l,h,f,m){const g=this.v3pool,v=WMe;n.vsub(r,nO),t.getSideNormals(v,o);const y=e.radius;let b=!1;const T=ZMe,S=YMe,C=KMe;let R=null,I=0,L=0,N=0,U=null;for(let Z=0,he=v.length;Z!==he&&!1===b;Z++){const me=GMe;me.copy(v[Z]);const ce=me.length();me.normalize();const be=nO.dot(me);if(be<ce+y&&be>0){const Ge=zMe,Ee=HMe;Ge.copy(v[(Z+1)%3]),Ee.copy(v[(Z+2)%3]);const mt=Ge.length(),it=Ee.length();Ge.normalize(),Ee.normalize();const Gt=nO.dot(Ge),Ve=nO.dot(Ee);if(Gt<mt&&Gt>-mt&&Ve<it&&Ve>-it){const Ie=Math.abs(be-ce-y);if((null===U||Ie<U)&&(U=Ie,L=Gt,N=Ve,R=ce,T.copy(me),S.copy(Ge),C.copy(Ee),I++,m))return!0}}}if(I){b=!0;const Z=this.createContactEquation(a,l,e,t,h,f);T.scale(-y,Z.ri),Z.ni.copy(T),Z.ni.negate(Z.ni),T.scale(R,T),S.scale(L,S),T.vadd(S,T),C.scale(N,C),T.vadd(C,Z.rj),Z.ri.vadd(n,Z.ri),Z.ri.vsub(a.position,Z.ri),Z.rj.vadd(r,Z.rj),Z.rj.vsub(l.position,Z.rj),this.result.push(Z),this.createFrictionEquationsFromContact(Z,this.frictionResult)}let k=g.get();const z=qMe;for(let Z=0;2!==Z&&!b;Z++)for(let he=0;2!==he&&!b;he++)for(let me=0;2!==me&&!b;me++)if(k.set(0,0,0),Z?k.vadd(v[0],k):k.vsub(v[0],k),he?k.vadd(v[1],k):k.vsub(v[1],k),me?k.vadd(v[2],k):k.vsub(v[2],k),r.vadd(k,z),z.vsub(n,z),z.lengthSquared()<y*y){if(m)return!0;b=!0;const ce=this.createContactEquation(a,l,e,t,h,f);ce.ri.copy(z),ce.ri.normalize(),ce.ni.copy(ce.ri),ce.ri.scale(y,ce.ri),ce.rj.copy(k),ce.ri.vadd(n,ce.ri),ce.ri.vsub(a.position,ce.ri),ce.rj.vadd(r,ce.rj),ce.rj.vsub(l.position,ce.rj),this.result.push(ce),this.createFrictionEquationsFromContact(ce,this.frictionResult)}g.release(k),k=null;const K=g.get(),te=g.get(),fe=g.get(),ie=g.get(),ne=g.get(),le=v.length;for(let Z=0;Z!==le&&!b;Z++)for(let he=0;he!==le&&!b;he++)if(Z%3!=he%3){v[he].cross(v[Z],K),K.normalize(),v[Z].vadd(v[he],te),fe.copy(n),fe.vsub(te,fe),fe.vsub(r,fe);const me=fe.dot(K);K.scale(me,ie);let ce=0;for(;ce===Z%3||ce===he%3;)ce++;ne.copy(n),ne.vsub(ie,ne),ne.vsub(te,ne),ne.vsub(r,ne);const be=Math.abs(me),Ge=ne.length();if(be<v[ce].length()&&Ge<y){if(m)return!0;b=!0;const Ee=this.createContactEquation(a,l,e,t,h,f);te.vadd(ie,Ee.rj),Ee.rj.copy(Ee.rj),ne.negate(Ee.ni),Ee.ni.normalize(),Ee.ri.copy(Ee.rj),Ee.ri.vadd(r,Ee.ri),Ee.ri.vsub(n,Ee.ri),Ee.ri.normalize(),Ee.ri.scale(y,Ee.ri),Ee.ri.vadd(n,Ee.ri),Ee.ri.vsub(a.position,Ee.ri),Ee.rj.vadd(r,Ee.rj),Ee.rj.vsub(l.position,Ee.rj),this.result.push(Ee),this.createFrictionEquationsFromContact(Ee,this.frictionResult)}}g.release(K,te,fe,ie,ne)}planeBox(e,t,n,r,s,o,a,l,h,f,m){return t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,t.convexPolyhedronRepresentation.id=t.id,this.planeConvex(e,t.convexPolyhedronRepresentation,n,r,s,o,a,l,e,t,m)}convexConvex(e,t,n,r,s,o,a,l,h,f,m,g,v){const y=uSe;if(!(n.distanceTo(r)>e.boundingSphereRadius+t.boundingSphereRadius)&&e.findSeparatingAxis(t,n,s,r,o,y,g,v)){const b=[],T=hSe;e.clipAgainstHull(n,s,t,r,o,y,-100,100,b);let S=0;for(let C=0;C!==b.length;C++){if(m)return!0;const R=this.createContactEquation(a,l,e,t,h,f),I=R.ri,L=R.rj;y.negate(R.ni),b[C].normal.negate(T),T.scale(b[C].depth,T),b[C].point.vadd(T,I),L.copy(b[C].point),I.vsub(n,I),L.vsub(r,L),I.vadd(n,I),I.vsub(a.position,I),L.vadd(r,L),L.vsub(l.position,L),this.result.push(R),S++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(R,this.frictionResult)}this.enableFrictionReduction&&S&&this.createFrictionFromAverage(S)}}sphereConvex(e,t,n,r,s,o,a,l,h,f,m){const g=this.v3pool;n.vsub(r,XMe);const v=t.faceNormals,y=t.faces,b=t.vertices,T=e.radius;let S=!1;for(let C=0;C!==b.length;C++){const I=eSe;o.vmult(b[C],I),r.vadd(I,I);const L=JMe;if(I.vsub(n,L),L.lengthSquared()<T*T){if(m)return!0;S=!0;const N=this.createContactEquation(a,l,e,t,h,f);return N.ri.copy(L),N.ri.normalize(),N.ni.copy(N.ri),N.ri.scale(T,N.ri),I.vsub(r,N.rj),N.ri.vadd(n,N.ri),N.ri.vsub(a.position,N.ri),N.rj.vadd(r,N.rj),N.rj.vsub(l.position,N.rj),this.result.push(N),void this.createFrictionEquationsFromContact(N,this.frictionResult)}}for(let C=0,R=y.length;C!==R&&!1===S;C++){const L=y[C],N=tSe;o.vmult(v[C],N);const U=nSe;o.vmult(b[L[0]],U),U.vadd(r,U);const k=iSe;N.scale(-T,k),n.vadd(k,k);const z=rSe;k.vsub(U,z);const K=z.dot(N),te=sSe;if(n.vsub(U,te),K<0&&te.dot(N)>0){const fe=[];for(let ie=0,ne=L.length;ie!==ne;ie++){const le=g.get();o.vmult(b[L[ie]],le),r.vadd(le,le),fe.push(le)}if(VMe(fe,N,n)){if(m)return!0;S=!0;const ie=this.createContactEquation(a,l,e,t,h,f);N.scale(-T,ie.ri),N.negate(ie.ni);const ne=g.get();N.scale(-K,ne);const le=g.get();N.scale(-T,le),n.vsub(r,ie.rj),ie.rj.vadd(le,ie.rj),ie.rj.vadd(ne,ie.rj),ie.rj.vadd(r,ie.rj),ie.rj.vsub(l.position,ie.rj),ie.ri.vadd(n,ie.ri),ie.ri.vsub(a.position,ie.ri),g.release(ne),g.release(le),this.result.push(ie),this.createFrictionEquationsFromContact(ie,this.frictionResult);for(let Z=0,he=fe.length;Z!==he;Z++)g.release(fe[Z]);return}for(let ie=0;ie!==L.length;ie++){const ne=g.get(),le=g.get();o.vmult(b[L[(ie+1)%L.length]],ne),o.vmult(b[L[(ie+2)%L.length]],le),r.vadd(ne,ne),r.vadd(le,le);const Z=$Me;le.vsub(ne,Z);const he=QMe;Z.unit(he);const me=g.get(),ce=g.get();n.vsub(ne,ce);const be=ce.dot(he);he.scale(be,me),me.vadd(ne,me);const Ge=g.get();if(me.vsub(n,Ge),be>0&&be*be<Z.lengthSquared()&&Ge.lengthSquared()<T*T){if(m)return!0;const Ee=this.createContactEquation(a,l,e,t,h,f);me.vsub(r,Ee.rj),me.vsub(n,Ee.ni),Ee.ni.normalize(),Ee.ni.scale(T,Ee.ri),Ee.rj.vadd(r,Ee.rj),Ee.rj.vsub(l.position,Ee.rj),Ee.ri.vadd(n,Ee.ri),Ee.ri.vsub(a.position,Ee.ri),this.result.push(Ee),this.createFrictionEquationsFromContact(Ee,this.frictionResult);for(let mt=0,it=fe.length;mt!==it;mt++)g.release(fe[mt]);return g.release(ne),g.release(le),g.release(me),g.release(Ge),void g.release(ce)}g.release(ne),g.release(le),g.release(me),g.release(Ge),g.release(ce)}for(let ie=0,ne=fe.length;ie!==ne;ie++)g.release(fe[ie])}}}planeConvex(e,t,n,r,s,o,a,l,h,f,m){const g=oSe,v=aSe;v.set(0,0,1),s.vmult(v,v);let y=0;const b=lSe;for(let T=0;T!==t.vertices.length;T++)if(g.copy(t.vertices[T]),o.vmult(g,g),r.vadd(g,g),g.vsub(n,b),v.dot(b)<=0){if(m)return!0;const C=this.createContactEquation(a,l,e,t,h,f),R=cSe;v.scale(v.dot(b),R),g.vsub(R,R),R.vsub(n,C.ri),C.ni.copy(v),g.vsub(r,C.rj),C.ri.vadd(n,C.ri),C.ri.vsub(a.position,C.ri),C.rj.vadd(r,C.rj),C.rj.vsub(l.position,C.rj),this.result.push(C),y++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(C,this.frictionResult)}this.enableFrictionReduction&&y&&this.createFrictionFromAverage(y)}boxConvex(e,t,n,r,s,o,a,l,h,f,m){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t,n,r,s,o,a,l,e,t,m)}sphereHeightfield(e,t,n,r,s,o,a,l,h,f,m){const g=t.data,v=e.radius,y=t.elementSize,b=wSe,T=TSe;lr.pointToLocalFrame(r,o,n,T);let S=Math.floor((T.x-v)/y)-1,C=Math.ceil((T.x+v)/y)+1,R=Math.floor((T.y-v)/y)-1,I=Math.ceil((T.y+v)/y)+1;if(C<0||I<0||S>g.length||R>g[0].length)return;S<0&&(S=0),C<0&&(C=0),R<0&&(R=0),I<0&&(I=0),S>=g.length&&(S=g.length-1),C>=g.length&&(C=g.length-1),I>=g[0].length&&(I=g[0].length-1),R>=g[0].length&&(R=g[0].length-1);const L=[];if(t.getRectMinMax(S,R,C,I,L),T.z-v>L[1]||T.z+v<L[0])return;const k=this.result;for(let z=S;z<C;z++)for(let K=R;K<I;K++){const te=k.length;let fe=!1;if(t.getConvexTrianglePillar(z,K,!1),lr.pointToWorldFrame(r,o,t.pillarOffset,b),n.distanceTo(b)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(fe=this.sphereConvex(e,t.pillarConvex,n,b,s,o,a,l,e,t,m)),m&&fe||(t.getConvexTrianglePillar(z,K,!0),lr.pointToWorldFrame(r,o,t.pillarOffset,b),n.distanceTo(b)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(fe=this.sphereConvex(e,t.pillarConvex,n,b,s,o,a,l,e,t,m)),m&&fe))return!0;if(k.length-te>2)return}}boxHeightfield(e,t,n,r,s,o,a,l,h,f,m){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexHeightfield(e.convexPolyhedronRepresentation,t,n,r,s,o,a,l,e,t,m)}convexHeightfield(e,t,n,r,s,o,a,l,h,f,m){const g=t.data,v=t.elementSize,y=e.boundingSphereRadius,b=bSe,T=xSe,S=ySe;lr.pointToLocalFrame(r,o,n,S);let C=Math.floor((S.x-y)/v)-1,R=Math.ceil((S.x+y)/v)+1,I=Math.floor((S.y-y)/v)-1,L=Math.ceil((S.y+y)/v)+1;if(R<0||L<0||C>g.length||I>g[0].length)return;C<0&&(C=0),R<0&&(R=0),I<0&&(I=0),L<0&&(L=0),C>=g.length&&(C=g.length-1),R>=g.length&&(R=g.length-1),L>=g[0].length&&(L=g[0].length-1),I>=g[0].length&&(I=g[0].length-1);const N=[];if(t.getRectMinMax(C,I,R,L,N),!(S.z-y>N[1]||S.z+y<N[0]))for(let z=C;z<R;z++)for(let K=I;K<L;K++){let te=!1;if(t.getConvexTrianglePillar(z,K,!1),lr.pointToWorldFrame(r,o,t.pillarOffset,b),n.distanceTo(b)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(te=this.convexConvex(e,t.pillarConvex,n,b,s,o,a,l,null,null,m,T,null)),m&&te||(t.getConvexTrianglePillar(z,K,!0),lr.pointToWorldFrame(r,o,t.pillarOffset,b),n.distanceTo(b)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(te=this.convexConvex(e,t.pillarConvex,n,b,s,o,a,l,null,null,m,T,null)),m&&te))return!0}}sphereParticle(e,t,n,r,s,o,a,l,h,f,m){const g=mSe;if(g.set(0,0,1),r.vsub(n,g),g.lengthSquared()<=e.radius*e.radius){if(m)return!0;const y=this.createContactEquation(l,a,t,e,h,f);g.normalize(),y.rj.copy(g),y.rj.scale(e.radius,y.rj),y.ni.copy(g),y.ni.negate(y.ni),y.ri.set(0,0,0),this.result.push(y),this.createFrictionEquationsFromContact(y,this.frictionResult)}}planeParticle(e,t,n,r,s,o,a,l,h,f,m){const g=dSe;g.set(0,0,1),a.quaternion.vmult(g,g);const v=fSe;if(r.vsub(a.position,v),g.dot(v)<=0){if(m)return!0;const b=this.createContactEquation(l,a,t,e,h,f);b.ni.copy(g),b.ni.negate(b.ni),b.ri.set(0,0,0);const T=pSe;g.scale(g.dot(r),T),r.vsub(T,T),b.rj.copy(T),this.result.push(b),this.createFrictionEquationsFromContact(b,this.frictionResult)}}boxParticle(e,t,n,r,s,o,a,l,h,f,m){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexParticle(e.convexPolyhedronRepresentation,t,n,r,s,o,a,l,e,t,m)}convexParticle(e,t,n,r,s,o,a,l,h,f,m){let g=-1;const v=_Se,y=vSe;let b=null;const T=gSe;if(T.copy(r),T.vsub(n,T),s.conjugate(oX),oX.vmult(T,T),e.pointIsInside(T)){e.worldVerticesNeedsUpdate&&e.computeWorldVertices(n,s),e.worldFaceNormalsNeedsUpdate&&e.computeWorldFaceNormals(s);for(let S=0,C=e.faces.length;S!==C;S++){const I=e.worldFaceNormals[S];r.vsub(e.worldVertices[e.faces[S][0]],aX);const L=-I.dot(aX);if(null===b||Math.abs(L)<Math.abs(b)){if(m)return!0;b=L,g=S,v.copy(I)}}if(-1!==g){const S=this.createContactEquation(l,a,t,e,h,f);v.scale(b,y),y.vadd(r,y),y.vsub(n,y),S.rj.copy(y),v.negate(S.ni),S.ri.set(0,0,0);const C=S.ri,R=S.rj;C.vadd(r,C),C.vsub(l.position,C),R.vadd(n,R),R.vsub(a.position,R),this.result.push(S),this.createFrictionEquationsFromContact(S,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}}heightfieldCylinder(e,t,n,r,s,o,a,l,h,f,m){return this.convexHeightfield(t,e,r,n,o,s,l,a,h,f,m)}particleCylinder(e,t,n,r,s,o,a,l,h,f,m){return this.convexParticle(t,e,r,n,o,s,l,a,h,f,m)}sphereTrimesh(e,t,n,r,s,o,a,l,h,f,m){const g=EMe,v=AMe,y=DMe,b=RMe,T=IMe,S=PMe,C=kMe,R=CMe,I=MMe,L=NMe;lr.pointToLocalFrame(r,o,n,T);const N=e.radius;C.lowerBound.set(T.x-N,T.y-N,T.z-N),C.upperBound.set(T.x+N,T.y+N,T.z+N),t.getTrianglesInAABB(C,L);const U=SMe,k=e.radius*e.radius;for(let ie=0;ie<L.length;ie++)for(let ne=0;ne<3;ne++)if(t.getVertex(t.indices[3*L[ie]+ne],U),U.vsub(T,I),I.lengthSquared()<=k){if(R.copy(U),lr.pointToWorldFrame(r,o,R,U),U.vsub(n,I),m)return!0;let le=this.createContactEquation(a,l,e,t,h,f);le.ni.copy(I),le.ni.normalize(),le.ri.copy(le.ni),le.ri.scale(e.radius,le.ri),le.ri.vadd(n,le.ri),le.ri.vsub(a.position,le.ri),le.rj.copy(U),le.rj.vsub(l.position,le.rj),this.result.push(le),this.createFrictionEquationsFromContact(le,this.frictionResult)}for(let ie=0;ie<L.length;ie++)for(let ne=0;ne<3;ne++){t.getVertex(t.indices[3*L[ie]+ne],g),t.getVertex(t.indices[3*L[ie]+(ne+1)%3],v),v.vsub(g,y),T.vsub(v,S);const le=S.dot(y);T.vsub(g,S);let Z=S.dot(y);if(Z>0&&le<0&&(T.vsub(g,S),b.copy(y),b.normalize(),Z=S.dot(b),b.scale(Z,S),S.vadd(g,S),S.distanceTo(T)<e.radius)){if(m)return!0;const me=this.createContactEquation(a,l,e,t,h,f);S.vsub(T,me.ni),me.ni.normalize(),me.ni.scale(e.radius,me.ri),me.ri.vadd(n,me.ri),me.ri.vsub(a.position,me.ri),lr.pointToWorldFrame(r,o,S,S),S.vsub(l.position,me.rj),lr.vectorToWorldFrame(o,me.ni,me.ni),lr.vectorToWorldFrame(o,me.ri,me.ri),this.result.push(me),this.createFrictionEquationsFromContact(me,this.frictionResult)}}const z=FMe,K=LMe,te=OMe,fe=wMe;for(let ie=0,ne=L.length;ie!==ne;ie++){t.getTriangleVertices(L[ie],z,K,te),t.getNormal(L[ie],fe),T.vsub(z,S);let le=S.dot(fe);if(fe.scale(le,S),T.vsub(S,S),le=S.distanceTo(T),Go.pointInTriangle(S,z,K,te)&&le<e.radius){if(m)return!0;let Z=this.createContactEquation(a,l,e,t,h,f);S.vsub(T,Z.ni),Z.ni.normalize(),Z.ni.scale(e.radius,Z.ri),Z.ri.vadd(n,Z.ri),Z.ri.vsub(a.position,Z.ri),lr.pointToWorldFrame(r,o,S,S),S.vsub(l.position,Z.rj),lr.vectorToWorldFrame(o,Z.ni,Z.ni),lr.vectorToWorldFrame(o,Z.ri,Z.ri),this.result.push(Z),this.createFrictionEquationsFromContact(Z,this.frictionResult)}}L.length=0}planeTrimesh(e,t,n,r,s,o,a,l,h,f,m){const g=new W,v=bMe;v.set(0,0,1),s.vmult(v,v);for(let y=0;y<t.vertices.length/3;y++){t.getVertex(y,g);const b=new W;b.copy(g),lr.pointToWorldFrame(r,o,b,g);const T=xMe;if(g.vsub(n,T),v.dot(T)<=0){if(m)return!0;const C=this.createContactEquation(a,l,e,t,h,f);C.ni.copy(v);const R=TMe;v.scale(T.dot(v),R),g.vsub(R,R),C.ri.copy(R),C.ri.vsub(a.position,C.ri),C.rj.copy(g),C.rj.vsub(l.position,C.rj),this.result.push(C),this.createFrictionEquationsFromContact(C,this.frictionResult)}}}}const Tb=new W,Yw=new W,Kw=new W,gMe=new W,_Me=new W,vMe=new so,yMe=new so,bMe=new W,xMe=new W,TMe=new W,wMe=new W,MMe=new W;new W;const SMe=new W,CMe=new W,EMe=new W,AMe=new W,DMe=new W,RMe=new W,IMe=new W,PMe=new W,FMe=new W,LMe=new W,OMe=new W,kMe=new Ps,NMe=[],tO=new W,sX=new W,BMe=new W,jMe=new W,UMe=new W;function VMe(i,e,t){let n=null;const r=i.length;for(let s=0;s!==r;s++){const o=i[s],a=BMe;i[(s+1)%r].vsub(o,a);const l=jMe;a.cross(e,l);const h=UMe;t.vsub(o,h);const f=l.dot(h);if(!(null===n||f>0&&!0===n||f<=0&&!1===n))return!1;null===n&&(n=f>0)}return!0}const nO=new W,GMe=new W,zMe=new W,HMe=new W,WMe=[new W,new W,new W,new W,new W,new W],qMe=new W,ZMe=new W,YMe=new W,KMe=new W,XMe=new W,$Me=new W,QMe=new W,JMe=new W,eSe=new W,tSe=new W,nSe=new W,iSe=new W,rSe=new W,sSe=new W;new W,new W;const oSe=new W,aSe=new W,lSe=new W,cSe=new W,uSe=new W,hSe=new W,dSe=new W,fSe=new W,pSe=new W,mSe=new W,oX=new so,gSe=new W;new W;const _Se=new W,aX=new W,vSe=new W,ySe=new W,bSe=new W,xSe=[0],TSe=new W,wSe=new W;class lX{constructor(){this.current=[],this.previous=[]}getKey(e,t){if(t<e){const n=t;t=e,e=n}return e<<16|t}set(e,t){const n=this.getKey(e,t),r=this.current;let s=0;for(;n>r[s];)s++;if(n!==r[s]){for(let o=r.length-1;o>=s;o--)r[o+1]=r[o];r[s]=n}}tick(){const e=this.current;this.current=this.previous,this.previous=e,this.current.length=0}getDiff(e,t){const n=this.current,r=this.previous,s=n.length,o=r.length;let a=0;for(let l=0;l<s;l++){let h=!1;const f=n[l];for(;f>r[a];)a++;h=f===r[a],h||cX(e,f)}a=0;for(let l=0;l<o;l++){let h=!1;const f=r[l];for(;f>n[a];)a++;h=n[a]===f,h||cX(t,f)}}}function cX(i,e){i.push((4294901760&e)>>16,65535&e)}const MG=(i,e)=>i<e?`${i}-${e}`:`${e}-${i}`;class MSe{constructor(){this.data={keys:[]}}get(e,t){const n=MG(e,t);return this.data[n]}set(e,t,n){const r=MG(e,t);this.get(e,t)||this.data.keys.push(r),this.data[r]=n}delete(e,t){const n=MG(e,t),r=this.data.keys.indexOf(n);-1!==r&&this.data.keys.splice(r,1),delete this.data[n]}reset(){const e=this.data,t=e.keys;for(;t.length>0;)delete e[t.pop()]}}class SSe extends A9{constructor(e){void 0===e&&(e={}),super(),this.dt=-1,this.allowSleep=!!e.allowSleep,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=void 0!==e.quatNormalizeSkip?e.quatNormalizeSkip:0,this.quatNormalizeFast=void 0!==e.quatNormalizeFast&&e.quatNormalizeFast,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new W,e.gravity&&this.gravity.copy(e.gravity),e.frictionGravity&&(this.frictionGravity=new W,this.frictionGravity.copy(e.frictionGravity)),this.broadphase=void 0!==e.broadphase?e.broadphase:new lTe,this.bodies=[],this.hasActiveBodies=!1,this.solver=void 0!==e.solver?e.solver:new nMe,this.constraints=[],this.narrowphase=new mMe(this),this.collisionMatrix=new E9,this.collisionMatrixPrevious=new E9,this.bodyOverlapKeeper=new lX,this.shapeOverlapKeeper=new lX,this.contactmaterials=[],this.contactMaterialTable=new MSe,this.defaultMaterial=new XTe("default"),this.defaultContactMaterial=new KTe(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.accumulator=0,this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.idToBodyMap={},this.broadphase.setWorld(this)}getContactMaterial(e,t){return this.contactMaterialTable.get(e.id,t.id)}collisionMatrixTick(){const e=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=e,this.collisionMatrix.reset(),this.bodyOverlapKeeper.tick(),this.shapeOverlapKeeper.tick()}addConstraint(e){this.constraints.push(e)}removeConstraint(e){const t=this.constraints.indexOf(e);-1!==t&&this.constraints.splice(t,1)}rayTest(e,t,n){n instanceof e1?this.raycastClosest(e,t,{skipBackfaces:!0},n):this.raycastAll(e,t,{skipBackfaces:!0},n)}raycastAll(e,t,n,r){return void 0===n&&(n={}),n.mode=Go.ALL,n.from=e,n.to=t,n.callback=r,SG.intersectWorld(this,n)}raycastAny(e,t,n,r){return void 0===n&&(n={}),n.mode=Go.ANY,n.from=e,n.to=t,n.result=r,SG.intersectWorld(this,n)}raycastClosest(e,t,n,r){return void 0===n&&(n={}),n.mode=Go.CLOSEST,n.from=e,n.to=t,n.result=r,SG.intersectWorld(this,n)}addBody(e){this.bodies.includes(e)||(e.index=this.bodies.length,this.bodies.push(e),e.world=this,e.initPosition.copy(e.position),e.initVelocity.copy(e.velocity),e.timeLastSleepy=this.time,e instanceof Ln&&(e.initAngularVelocity.copy(e.angularVelocity),e.initQuaternion.copy(e.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=e,this.idToBodyMap[e.id]=e,this.dispatchEvent(this.addBodyEvent))}removeBody(e){e.world=null;const t=this.bodies.length-1,n=this.bodies,r=n.indexOf(e);if(-1!==r){n.splice(r,1);for(let s=0;s!==n.length;s++)n[s].index=s;this.collisionMatrix.setNumObjects(t),this.removeBodyEvent.body=e,delete this.idToBodyMap[e.id],this.dispatchEvent(this.removeBodyEvent)}}getBodyById(e){return this.idToBodyMap[e]}getShapeById(e){const t=this.bodies;for(let n=0;n<t.length;n++){const r=t[n].shapes;for(let s=0;s<r.length;s++){const o=r[s];if(o.id===e)return o}}return null}addContactMaterial(e){this.contactmaterials.push(e),this.contactMaterialTable.set(e.materials[0].id,e.materials[1].id,e)}removeContactMaterial(e){const t=this.contactmaterials.indexOf(e);-1!==t&&(this.contactmaterials.splice(t,1),this.contactMaterialTable.delete(e.materials[0].id,e.materials[1].id))}fixedStep(e,t){void 0===e&&(e=1/60),void 0===t&&(t=10);const n=ca.now()/1e3;this.step(e,this.lastCallTime?n-this.lastCallTime:void 0,t),this.lastCallTime=n}step(e,t,n){if(void 0===n&&(n=10),void 0===t)this.internalStep(e),this.time+=e;else{this.accumulator+=t;const r=ca.now();let s=0;for(;this.accumulator>=e&&s<n&&(this.internalStep(e),this.accumulator-=e,s++,!(ca.now()-r>1e3*e)););this.accumulator=this.accumulator%e;const o=this.accumulator/e;for(let a=0;a!==this.bodies.length;a++){const l=this.bodies[a];l.previousPosition.lerp(l.position,o,l.interpolatedPosition),l.previousQuaternion.slerp(l.quaternion,o,l.interpolatedQuaternion),l.previousQuaternion.normalize()}this.time+=t}}internalStep(e){this.dt=e;const t=this.contacts,n=RSe,r=ISe,s=this.bodies.length,o=this.bodies,a=this.solver,l=this.gravity,h=this.doProfiling,f=this.profile,m=Ln.DYNAMIC;let g=-1/0;const v=this.constraints,y=DSe;l.length();const b=l.x,T=l.y,S=l.z;let C=0;for(h&&(g=ca.now()),C=0;C!==s;C++){const ie=o[C];if(ie.type===m){const ne=ie.force,le=ie.mass;ne.x+=le*b,ne.y+=le*T,ne.z+=le*S}}for(let ie=0,ne=this.subsystems.length;ie!==ne;ie++)this.subsystems[ie].update();h&&(g=ca.now()),n.length=0,r.length=0,this.broadphase.collisionPairs(this,n,r),h&&(f.broadphase=ca.now()-g);let R=v.length;for(C=0;C!==R;C++){const ie=v[C];if(!ie.collideConnected)for(let ne=n.length-1;ne>=0;ne-=1)(ie.bodyA===n[ne]&&ie.bodyB===r[ne]||ie.bodyB===n[ne]&&ie.bodyA===r[ne])&&(n.splice(ne,1),r.splice(ne,1))}this.collisionMatrixTick(),h&&(g=ca.now());const I=ASe,L=t.length;for(C=0;C!==L;C++)I.push(t[C]);t.length=0;const N=this.frictionEquations.length;for(C=0;C!==N;C++)y.push(this.frictionEquations[C]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(n,r,this,t,I,this.frictionEquations,y),h&&(f.narrowphase=ca.now()-g),h&&(g=ca.now()),C=0;C<this.frictionEquations.length;C++)a.addEquation(this.frictionEquations[C]);const U=t.length;for(let ie=0;ie!==U;ie++){const ne=t[ie],le=ne.bi,Z=ne.bj,he=ne.si,me=ne.sj;let ce;ce=le.material&&Z.material&&this.getContactMaterial(le.material,Z.material)||this.defaultContactMaterial,le.material&&Z.material&&le.material.restitution>=0&&Z.material.restitution>=0&&(ne.restitution=le.material.restitution*Z.material.restitution),a.addEquation(ne),le.allowSleep&&le.type===Ln.DYNAMIC&&le.sleepState===Ln.SLEEPING&&Z.sleepState===Ln.AWAKE&&Z.type!==Ln.STATIC&&Z.velocity.lengthSquared()+Z.angularVelocity.lengthSquared()>=2*Z.sleepSpeedLimit**2&&(le.wakeUpAfterNarrowphase=!0),Z.allowSleep&&Z.type===Ln.DYNAMIC&&Z.sleepState===Ln.SLEEPING&&le.sleepState===Ln.AWAKE&&le.type!==Ln.STATIC&&le.velocity.lengthSquared()+le.angularVelocity.lengthSquared()>=2*le.sleepSpeedLimit**2&&(Z.wakeUpAfterNarrowphase=!0),this.collisionMatrix.set(le,Z,!0),this.collisionMatrixPrevious.get(le,Z)||(s1.body=Z,s1.contact=ne,le.dispatchEvent(s1),s1.body=le,Z.dispatchEvent(s1)),this.bodyOverlapKeeper.set(le.id,Z.id),this.shapeOverlapKeeper.set(he.id,me.id)}for(this.emitContactEvents(),h&&(f.makeContactConstraints=ca.now()-g,g=ca.now()),C=0;C!==s;C++){const ie=o[C];ie.wakeUpAfterNarrowphase&&(ie.wakeUp(),ie.wakeUpAfterNarrowphase=!1)}for(R=v.length,C=0;C!==R;C++){const ie=v[C];ie.update();for(let ne=0,le=ie.equations.length;ne!==le;ne++)a.addEquation(ie.equations[ne])}a.solve(e,this),h&&(f.solve=ca.now()-g),a.removeAllEquations();const k=Math.pow;for(C=0;C!==s;C++){const ie=o[C];if(ie.type&m){const ne=k(1-ie.linearDamping,e),le=ie.velocity;le.scale(ne,le);const Z=ie.angularVelocity;if(Z){const he=k(1-ie.angularDamping,e);Z.scale(he,Z)}}}this.dispatchEvent(ESe),h&&(g=ca.now());const K=this.stepnumber%(this.quatNormalizeSkip+1)==0,te=this.quatNormalizeFast;for(C=0;C!==s;C++)o[C].integrate(e,K,te);this.clearForces(),this.broadphase.dirty=!0,h&&(f.integrate=ca.now()-g),this.stepnumber+=1,this.dispatchEvent(CSe);let fe=!0;if(this.allowSleep)for(fe=!1,C=0;C!==s;C++){const ie=o[C];ie.sleepTick(this.time),ie.sleepState!==Ln.SLEEPING&&(fe=!0)}this.hasActiveBodies=fe}emitContactEvents(){const e=this.hasAnyEventListener("beginContact"),t=this.hasAnyEventListener("endContact");if((e||t)&&this.bodyOverlapKeeper.getDiff(Hm,Wm),e){for(let s=0,o=Hm.length;s<o;s+=2)o1.bodyA=this.getBodyById(Hm[s]),o1.bodyB=this.getBodyById(Hm[s+1]),this.dispatchEvent(o1);o1.bodyA=o1.bodyB=null}if(t){for(let s=0,o=Wm.length;s<o;s+=2)a1.bodyA=this.getBodyById(Wm[s]),a1.bodyB=this.getBodyById(Wm[s+1]),this.dispatchEvent(a1);a1.bodyA=a1.bodyB=null}Hm.length=Wm.length=0;const n=this.hasAnyEventListener("beginShapeContact"),r=this.hasAnyEventListener("endShapeContact");if((n||r)&&this.shapeOverlapKeeper.getDiff(Hm,Wm),n){for(let s=0,o=Hm.length;s<o;s+=2){const a=this.getShapeById(Hm[s]),l=this.getShapeById(Hm[s+1]);qm.shapeA=a,qm.shapeB=l,a&&(qm.bodyA=a.body),l&&(qm.bodyB=l.body),this.dispatchEvent(qm)}qm.bodyA=qm.bodyB=qm.shapeA=qm.shapeB=null}if(r){for(let s=0,o=Wm.length;s<o;s+=2){const a=this.getShapeById(Wm[s]),l=this.getShapeById(Wm[s+1]);Zm.shapeA=a,Zm.shapeB=l,a&&(Zm.bodyA=a.body),l&&(Zm.bodyB=l.body),this.dispatchEvent(Zm)}Zm.bodyA=Zm.bodyB=Zm.shapeA=Zm.shapeB=null}}clearForces(){const e=this.bodies,t=e.length;for(let n=0;n!==t;n++){const r=e[n];r.force.set(0,0,0),r.torque.set(0,0,0)}}}new Ps;const SG=new Go,ca=globalThis.performance||{};if(!ca.now){let i=Date.now();ca.timing&&ca.timing.navigationStart&&(i=ca.timing.navigationStart),ca.now=()=>Date.now()-i}new W;const CSe={type:"postStep"},ESe={type:"preStep"},s1={type:Ln.COLLIDE_EVENT_NAME,body:null,contact:null},ASe=[],DSe=[],RSe=[],ISe=[],Hm=[],Wm=[],o1={type:"beginContact",bodyA:null,bodyB:null},a1={type:"endContact",bodyA:null,bodyB:null},qm={type:"beginShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},Zm={type:"endShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null};let uX=(()=>{class i{constructor(t,n){this.gameService=t,this.dialog=n,this.world=new SSe({allowSleep:!0}),this.time=1/60,this.groundArray=[],this.diceArray=[],this.diceRes=[],this.dicesRolling=!1}initWorld(){this.world.gravity.set(0,-9.82,0),this.world.defaultContactMaterial.restitution=.3,this.createDiceCase(),this.diceArray.length&&this.diceArray.forEach(t=>{this.createDice(t.body),this.addDiceEvents(t)})}createDiceCase(){this.createGround(20,20,[11,0,11],[-Math.PI/2,0,0]),this.createGround(20,20,[11,10,1],[0,0,0]),this.createGround(20,20,[11,10,21],[0,0,0]),this.createGround(20,20,[1,10,11],[0,-Math.PI/2,0]),this.createGround(20,20,[21,10,11],[0,-Math.PI/2,0])}createGround(t,n,r,s){const o=new fw(t,n),a=new Ta({color:16777215,transparent:!0,opacity:0,wireframe:!1}),l=new aa(o,a);this.gameService.gameScene.children.push(l);const h=new Ln({mass:0,shape:new qw(new W(10,10,.1))});this.groundArray.push({mesh:l,body:h}),this.world.addBody(h),h.position.x=r[0],h.position.y=r[1],h.position.z=r[2],h.quaternion.setFromEuler(s[0],s[1],s[2])}createDice(t){this.world.addBody(t.body),this.addDiceEvents(t),this.diceRoll(t)}renderPhysicsWorld(){this.world.step(this.time),this.groundArray.forEach(t=>{t.mesh.position.copy(t.body.position),t.mesh.quaternion.copy(t.body.quaternion)}),this.renderDices()}renderDices(){this.diceArray.forEach(t=>{t.mesh&&(t.mesh.position.copy(t.body.position),t.mesh.quaternion.copy(t.body.quaternion))})}addDiceEvents(t){t.body.addEventListener("sleep",n=>{t.body.allowSleep=!1;const r=new W;n.target.quaternion.toEuler(r);const s=.1;let o=f=>Math.abs(f)<s,a=f=>Math.abs(f-.5*Math.PI)<s,l=f=>Math.abs(.5*Math.PI+f)<s;var f;o(r.z)?o(r.x)?(this.diceRes.push(1),this.showRollResults()):a(r.x)?(this.diceRes.push(4),this.showRollResults()):l(r.x)?(this.diceRes.push(3),this.showRollResults()):(f=r.x,Math.abs(Math.PI-f)<s||Math.abs(Math.PI+f)<s?(this.diceRes.push(6),this.showRollResults()):(t.body.applyImpulse(new W(.5,0,.5)),t.body.allowSleep=!0)):a(r.z)?(this.diceRes.push(5),this.showRollResults()):l(r.z)?(this.diceRes.push(2),this.showRollResults()):(t.body.applyImpulse(new W(.5,0,.5)),t.body.allowSleep=!0)})}diceRoll(t){this.dicesRolling=!0,t.body.position.x=10,t.body.position.z=10,t.body.position.y=10,t.body.velocity.setZero(),t.body.angularVelocity.setZero(),t.mesh.rotation.set(2*Math.PI*Math.random(),0,2*Math.PI*Math.random()),t.body.quaternion.copy(t.mesh.quaternion);const n=3+5*Math.random();t.body.applyImpulse(new W(n,0,n),new W(0,.2,0)),t.body.allowSleep=!0}showRollResults(){var t=this;return(0,nt.Z)(function*(){2===t.diceRes.length&&(t.openShowDiceResDialog(t.diceRes),setTimeout((0,nt.Z)(function*(){t.dialog.closeAll(),yield t.gameService.setCameraPosition(t.gameService.camera,t.gameService.players[t.gameService.turn].pawn.position[0],t.gameService.players[t.gameService.turn].pawn.position[1],t.gameService.players[t.gameService.turn].pawn.position[2],1e3,5,!1),setTimeout(()=>{t.gameService.players[t.gameService.turn].prison.inPrison?t.diceRes[0]==t.diceRes[1]?t.gameService.exitFromPrison(!1,!0,t.diceRes[0],t.diceRes[1]):2==t.gameService.players[t.gameService.turn].prison.inPrisonTurnCounter?t.gameService.exitFromPrison(!0,!1,t.diceRes[0],t.diceRes[1]):(t.gameService.players[t.gameService.turn].prison.inPrisonTurnCounter++,t.gameService.players[t.gameService.turn].canDice=!1):(t.diceRes[0]==t.diceRes[1]?(t.gameService.players[t.gameService.turn].prison.doubleDiceCounter++,t.gameService.players[t.gameService.turn].canDice=!0):(t.gameService.players[t.gameService.turn].prison.doubleDiceCounter=0,t.gameService.players[t.gameService.turn].canDice=!1),t.gameService.diceNumber=t.diceRes[0]+t.diceRes[1]+t.gameService.players[t.gameService.turn].actualCard,t.gameService.diceNumber&&t.gameService.diceNumber>t.gameService.gameTable.cards.length-1&&(t.gameService.diceNumber=t.diceRes[0]+t.diceRes[1]-(t.gameService.gameTable.cards.length-1-t.gameService.players[t.gameService.turn].actualCard)-1+0),3===t.gameService.players[t.gameService.turn].prison.doubleDiceCounter?t.gameService.whichPropertyAmI("goToPrison"):t.gameService.getCardPosition(t.gameService.diceNumber)),t.dicesRolling=!1,t.gameService.diceRes=t.diceRes,t.diceRes=[]},1100)}),2e3))})()}openShowDiceResDialog(t){this.dialog.open(this.showDiceResultDialogRef,{panelClass:"showDiceResult",hasBackdrop:!0,autoFocus:!1,disableClose:!0,data:{diceRes:t}})}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(wd),c.LFG(cP))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class PSe extends _A{constructor(e,t={}){const n=t.font;if(void 0===n)super();else{const r=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(r,t)}this.type="TextGeometry"}}class FSe extends Aw{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new xd(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){let l;try{l=JSON.parse(a)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),l=JSON.parse(a.substring(65,a.length-2))}const h=s.parse(l);t&&t(h)},n,r)}parse(e){return new LSe(e)}}class LSe{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const n=[],r=function OSe(i,e,t){const n=Array.from(i),r=e/t.resolution,s=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*r,o=[];let a=0,l=0;for(let h=0;h<n.length;h++){const f=n[h];if("\n"===f)a=0,l-=s;else{const m=kSe(f,r,a,l,t);a+=m.offsetX,o.push(m.path)}}return o}(e,t,this.data);for(let s=0,o=r.length;s<o;s++)n.push(...r[s].toShapes());return n}}function kSe(i,e,t,n,r){const s=r.glyphs[i]||r.glyphs["?"];if(!s)return void console.error('THREE.Font: character "'+i+'" does not exists in font family '+r.familyName+".");const o=new mfe;let a,l,h,f,m,g,v,y;if(s.o){const b=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let T=0,S=b.length;T<S;)switch(b[T++]){case"m":a=b[T++]*e+t,l=b[T++]*e+n,o.moveTo(a,l);break;case"l":a=b[T++]*e+t,l=b[T++]*e+n,o.lineTo(a,l);break;case"q":h=b[T++]*e+t,f=b[T++]*e+n,m=b[T++]*e+t,g=b[T++]*e+n,o.quadraticCurveTo(m,g,h,f);break;case"b":h=b[T++]*e+t,f=b[T++]*e+n,m=b[T++]*e+t,g=b[T++]*e+n,v=b[T++]*e+t,y=b[T++]*e+n,o.bezierCurveTo(m,g,v,y,h,f)}}return{offsetX:s.ha*e,path:o}}let NSe=(()=>{class i{constructor(){this.houseUrl="",this.housePosition=[]}ngOnInit(){this.houseUrl="../../../assets/blenderModels/card/house/house3.gltf",this.calculateHousePosition()}ngAfterViewInit(){}calculateHousePosition(){if(this.housePosition=JSON.parse(JSON.stringify(this.cardPosition)),this.cardIndex<=10||20<this.cardIndex&&this.cardIndex<=30)switch(this.houseIndex){case 1:this.housePosition[0]+=.5;break;case 2:this.housePosition[0]+=.15;break;case 3:this.housePosition[0]-=.15;break;case 4:this.housePosition[0]-=.5}else if(10<this.cardIndex&&this.cardIndex<=20||30<this.cardIndex&&this.cardIndex<=40)switch(this.houseIndex){case 1:this.housePosition[2]+=.5;break;case 2:this.housePosition[2]+=.15;break;case 3:this.housePosition[2]-=.15;break;case 4:this.housePosition[2]-=.5}this.housePosition[1]+=.1,this.cardIndex<=10?this.housePosition[2]+=.8:20<this.cardIndex&&this.cardIndex<=30?this.housePosition[2]-=.8:10<this.cardIndex&&this.cardIndex<=20?this.housePosition[0]-=.8:30<this.cardIndex&&this.cardIndex<=40&&(this.housePosition[0]+=.8)}test(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=c.Xpm({type:i,selectors:[["app-house"]],inputs:{card:"card",cardPosition:"cardPosition",cardRotation:"cardRotation",cardIndex:"cardIndex",houseIndex:"houseIndex"},decls:1,vars:5,consts:[["loadGLTF","",3,"url","position","rotation","receiveShadow","castShadow"]],template:function(t,n){1&t&&c._UZ(0,"th-object3D",0),2&t&&c.Q6J("url",n.houseUrl)("position",n.housePosition)("rotation",n.cardRotation)("receiveShadow",!0)("castShadow",!0)},dependencies:[Sr,Ww]}),i})(),BSe=(()=>{class i{constructor(){this.hotelUrl="",this.hotelPosition=[]}ngOnInit(){this.hotelUrl="../../../assets/blenderModels/card/hotel/hotel3.gltf",this.calculateHousePosition()}calculateHousePosition(){this.hotelPosition=JSON.parse(JSON.stringify(this.cardPosition)),this.cardIndex<=10?this.hotelPosition[2]+=.8:20<this.cardIndex&&this.cardIndex<=30?this.hotelPosition[2]-=.8:10<this.cardIndex&&this.cardIndex<=20?this.hotelPosition[0]-=.8:30<this.cardIndex&&this.cardIndex<=40&&(this.hotelPosition[0]+=.8),this.hotelPosition[1]+=.1}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=c.Xpm({type:i,selectors:[["app-hotel"]],inputs:{card:"card",cardPosition:"cardPosition",cardRotation:"cardRotation",hotelIndex:"hotelIndex",cardIndex:"cardIndex"},decls:1,vars:5,consts:[["loadGLTF","",3,"url","position","rotation","receiveShadow","castShadow"]],template:function(t,n){1&t&&c._UZ(0,"th-object3D",0),2&t&&c.Q6J("url",n.hotelUrl)("position",n.hotelPosition)("rotation",n.cardRotation)("receiveShadow",!0)("castShadow",!0)},dependencies:[Sr,Ww]}),i})();const jSe=["cardRef"],USe=["cardOutlineRef"],VSe=["carpetRef"];function GSe(i,e){if(1&i&&c._UZ(0,"app-house",8),2&i){const t=e.index,n=c.oxw(2);c.Q6J("card",n.card)("cardPosition",n.position)("cardRotation",n.rotation)("houseIndex",t+1)("cardIndex",n.cardIndex)}}const hX=function(){return[]};function zSe(i,e){if(1&i&&(c.TgZ(0,"div"),c.YNc(1,GSe,1,5,"app-house",7),c.qZA()),2&i){const t=c.oxw();c.xp6(1),c.Q6J("ngForOf",c.DdM(1,hX).constructor(t.card.housesCounter))}}function HSe(i,e){if(1&i&&c._UZ(0,"app-hotel",10),2&i){const t=c.oxw(2);c.Q6J("card",t.card)("cardPosition",t.position)("cardRotation",t.rotation)("cardIndex",t.cardIndex)}}function WSe(i,e){if(1&i&&(c.TgZ(0,"div"),c.YNc(1,HSe,1,4,"app-hotel",9),c.qZA()),2&i){const t=c.oxw();c.xp6(1),c.Q6J("ngForOf",c.DdM(1,hX).constructor(t.card.hotelCounter))}}const qSe=function(){return[2,.1,.4]},ZSe=function(i){return{color:i}};function YSe(i,e){if(1&i&&(c.TgZ(0,"th-mesh",11,12),c._UZ(2,"th-boxGeometry")(3,"th-meshBasicMaterial",13),c.qZA()),2&i){const t=c.oxw();c.Q6J("rotation",t.rotation)("position",t.carpetPosistion)("scale",c.DdM(6,qSe))("receiveShadow",!0)("castShadow",!0),c.xp6(3),c.Q6J("args",c.VKq(7,ZSe,t.gameService.checkCardColorDistrict(t.card.district)))}}function KSe(i,e){if(1&i&&c._UZ(0,"th-object3D",14),2&i){const t=c.oxw();c.Q6J("url",t.returnSpecialCardUrl(t.card.cardType))("position",t.position)("rotation",t.returnSpecialCardObjRotation())}}const XSe=function(){return[1,1,1]},$Se=function(){return[1.1,1.1,1.1]};let QSe=(()=>{class i{constructor(t,n){this.gameService=t,this.service=n,this.url="",this.position=[0,0,0],this.rotation=[0,0,0],this.carpetPosistion=[0,0,0],this.meshColor="#ffff00",this.castedShadow=!1,this.fontLoader=new FSe}ngOnInit(){var t=this;return(0,nt.Z)(function*(){t.url="/assets/blenderModels/card/definitiveCard/card.gltf",t.setCardPosition(),t.setCarpetPosition(),t.getCardPosition$=t.gameService.getCardPosition$.subscribe(n=>{n==t.cardIndex&&t.gameService.setPlayerPosition(t.position,n)})})()}ngAfterViewInit(){}setCardPosition(){(11==this.cardIndex||21==this.cardIndex||31==this.cardIndex)&&(this.gameService.cardsPositionCounter=0,this.gameService.cardsPositionCounter+=2.2),this.cardIndex<=10?(this.position=[this.gameService.cardsPositionCounter,0,0],0==this.cardIndex&&(this.position=[0,0,0])):10<this.cardIndex&&this.cardIndex<=20?(this.position=[22,0,this.gameService.cardsPositionCounter],this.rotation=[0,Math.PI/2,0]):20<this.cardIndex&&this.cardIndex<=30?this.position=[22-this.gameService.cardsPositionCounter,0,22]:30<this.cardIndex&&this.cardIndex<=40&&(this.position=[0,0,22-this.gameService.cardsPositionCounter],this.rotation=[0,Math.PI/2,0]),this.gameService.cardsPositionCounter+=2.2}loadText(){this.fontLoader.load("https://fonts.googleapis.com/css2?family=Cormorant+Garamond&family=Spline+Sans:wght@400;700&display=swap",function(n){const r=new PSe("Hello three.js!",{font:n,size:80,height:5,curveSegments:12,bevelEnabled:!0,bevelThickness:10,bevelSize:8,bevelOffset:0,bevelSegments:5});r.computeBoundingBox();const s=new Ta,o=new aa(r,s);o.position.x=0,o.position.y=5,o.position.z=0,this.scene.objRef.children.push(o)})}setCarpetPosition(){this.carpetPosistion=JSON.parse(JSON.stringify(this.position)),this.cardIndex<=10?this.carpetPosistion[2]+=.8:10<this.cardIndex&&this.cardIndex<=20?this.carpetPosistion[0]-=.8:20<this.cardIndex&&this.cardIndex<=30?this.carpetPosistion[2]-=.8:30<this.cardIndex&&this.cardIndex<=40&&(this.carpetPosistion[0]+=.8),this.carpetPosistion[1]+=.05}returnSpecialCardUrl(t){let n="";switch(t){case"start":n="/assets/blenderModels/card/definitiveCard/startFlag.gltf";break;case"prison":n="/assets/blenderModels/card/definitiveCard/prisonCage.gltf";break;case"parkArea":n="/assets/blenderModels/card/definitiveCard/parkingArea.gltf";break;case"chance":n="/assets/blenderModels/card/definitiveCard/chance.gltf";break;case"communityChest":n="/assets/blenderModels/card/definitiveCard/communityChest.gltf";break;case"goToPrison":n="/assets/blenderModels/card/definitiveCard/policeStation.gltf";break;case"taxes":n="/assets/blenderModels/card/definitiveCard/taxes.gltf"}return n}returnSpecialCardObjRotation(){return"chance"==this.card.cardType||"communityChest"==this.card.cardType||"taxes"==this.card.cardType?this.cardIndex>=20&&this.cardIndex<=30?[this.rotation[0],-Math.PI,this.rotation[2]]:this.cardIndex>=10&&this.cardIndex<=20?[this.rotation[0],-Math.PI/2,this.rotation[2]]:this.rotation:[0,0,0]}hoverCard(t){}test(){console.log(this.cardRef._objRef.position,this.cardRef)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(wd),c.Y36(b9))},i.\u0275cmp=c.Xpm({type:i,selectors:[["app-card"]],viewQuery:function(t,n){if(1&t&&(c.Gf(jSe,7),c.Gf(USe,7),c.Gf(VSe,7)),2&t){let r;c.iGM(r=c.CRH())&&(n.cardRef=r.first),c.iGM(r=c.CRH())&&(n.cardOutlineRef=r.first),c.iGM(r=c.CRH())&&(n.carpetRef=r.first)}},inputs:{card:"card",cardIndex:"cardIndex",scene:"scene"},decls:8,vars:17,consts:[["loadGLTF","",3,"url","position","rotation","receiveShadow","castShadow","name","scale","onClick","onMouseEnter","onMouseExit"],["cardRef",""],["loadGLTF","",3,"url","position","scale","name"],["cardOutlineRef",""],[4,"ngIf"],[3,"rotation","position","scale","receiveShadow","castShadow",4,"ngIf"],["loadGLTF","",3,"url","position","rotation",4,"ngIf"],[3,"card","cardPosition","cardRotation","houseIndex","cardIndex",4,"ngFor","ngForOf"],[3,"card","cardPosition","cardRotation","houseIndex","cardIndex"],[3,"card","cardPosition","cardRotation","cardIndex",4,"ngFor","ngForOf"],[3,"card","cardPosition","cardRotation","cardIndex"],[3,"rotation","position","scale","receiveShadow","castShadow"],["carpetRef",""],[3,"args"],["loadGLTF","",3,"url","position","rotation"]],template:function(t,n){1&t&&(c.TgZ(0,"th-object3D",0,1),c.NdJ("onClick",function(){return!(n.cardIndex==n.gameService.diceNumber&&n.card.canBuy||n.card.owner==n.gameService.players[n.gameService.turn].id)||"property"!=n.card.cardType&&"station"!=n.card.cardType&&"plant"!=n.card.cardType||""!=n.gameService.playerWhoWonId?"":n.gameService.openCardDialog(n.card)})("onMouseEnter",function(){return n.hoverCard("enter")})("onMouseExit",function(){return n.hoverCard("exit")}),c.qZA(),c._UZ(2,"th-object3D",2,3),c.YNc(4,zSe,2,2,"div",4),c.YNc(5,WSe,2,2,"div",4),c.YNc(6,YSe,4,9,"th-mesh",5),c.YNc(7,KSe,1,3,"th-object3D",6)),2&t&&(c.Q6J("url",n.url)("position",n.position)("rotation",n.rotation)("receiveShadow",!0)("castShadow",!0)("name","cardNumber"+n.cardIndex)("scale",c.DdM(15,XSe)),c.xp6(2),c.Q6J("url",n.url)("position",n.position)("scale",c.DdM(16,$Se))("name","cardOutline"+n.cardIndex),c.xp6(2),c.Q6J("ngIf",n.card.housesCounter&&!n.card.hotelCounter),c.xp6(1),c.Q6J("ngIf",n.card.hotelCounter&&4==n.card.housesCounter),c.xp6(1),c.Q6J("ngIf","property"==n.card.cardType||"plant"==n.card.cardType||"station"==n.card.cardType),c.xp6(1),c.Q6J("ngIf","start"==n.card.cardType||"parkArea"==n.card.cardType||"prison"==n.card.cardType||"chance"==n.card.cardType||"communityChest"==n.card.cardType||"goToPrison"==n.card.cardType||"taxes"==n.card.cardType))},dependencies:[xr,qr,Sr,nxe,oxe,exe,Ww,Qbe,NSe,BSe],styles:["#card[_ngcontent-%COMP%]{width:100px;height:100px;background-color:#ff0}"]}),i})();const JSe=["playerRef"];let eCe=(()=>{class i{constructor(t){this.gameService=t,this.gameTableSides=["x","z","x","z"]}ngOnInit(){this.setPlayerPosition(this.player.pawn.position,!0),this.setPlayerPosition$=this.gameService.setPlayerPosition$.subscribe(t=>{this.player.id==this.gameService.players[this.gameService.turn].id&&this.setPlayerPosition(t.cardPosition,!1,t.oldCardPosition)})}ngAfterViewInit(){return(0,nt.Z)(function*(){})()}ngOnDestroy(){this.setPlayerPosition$?.unsubscribe()}setPlayerPosition(t,n,r){var s=this;return(0,nt.Z)(function*(){let o=JSON.parse(JSON.stringify(s.gameService.players[s.gameService.turn].actualCard));if(n)s.playerRef._objRef.position.x=t[0],s.playerRef._objRef.position.z=t[2];else if(null!=r){let a=0,l=0;o>=30&&o<=39?l=3:o>=20&&o<=30?l=2:o>10&&o<30?l=1:o>=0&&o<=10&&(l=0),r>=30&&r<=39?a=3:r>=20&&r<=30?a=2:r>=10&&r<=20?a=1:r>=0&&r<=10&&(a=0),a===l?r<o?yield s.movePlayerGsap(t,a,r):(3===a?yield s.movePlayerGsap([0,0,0],3,r):yield s.cycleMap(a,r,3,3,[0,0,0]),a=0,yield s.cycleMap(a,r,l,l,t)):a<l?yield s.cycleMap(a,r,l,l,t):a>l&&(3===a?yield s.movePlayerGsap([0,0,0],3,r):yield s.cycleMap(a,r,3,3,[0,0,0]),a=0,yield s.cycleMap(a,r,l,l,t)),s.gameService.whichPropertyAmI(s.gameService.gameTable.cards[s.gameService.players[s.gameService.turn].actualCard])}})()}movePlayerGsap(t,n,r){var s=this;return(0,nt.Z)(function*(){"x"==s.gameTableSides[n]&&(s.gameService.setCameraPosition(s.gameService.camera,t[0],t[1],t[2],1e3,5,!0,"x"),22!=t[0]?yield fl.fromTo(s.playerRef._objRef.position,{x:s.playerRef._objRef.position.x},{x:t[0],duration:1,onUpdate:o=>{0==s.playerRef._objRef.position.x&&0==s.playerRef._objRef.position.z&&0!=r&&!s.gameService.players[s.gameService.turn].addingMoney&&!s.gameService.players[s.gameService.turn].removingMoney&&s.gameService.playerPassedStart(),(22==s.playerRef._objRef.position.x||0==s.playerRef._objRef.position.x)&&s.setPlayerRotation()}}):yield fl.fromTo(s.playerRef._objRef.position,{x:s.playerRef._objRef.position.x},{x:22,duration:1,onUpdate:o=>{(22==s.playerRef._objRef.position.x||0==s.playerRef._objRef.position.x)&&s.setPlayerRotation()}})),"z"==s.gameTableSides[n]&&(s.gameService.setCameraPosition(s.gameService.camera,t[0],t[1],t[2],1e3,5,!0,"z"),22!=t[2]?yield fl.fromTo(s.playerRef._objRef.position,{z:s.playerRef._objRef.position.z},{z:t[2],duration:1,onUpdate:o=>{0==s.playerRef._objRef.position.x&&0==s.playerRef._objRef.position.z&&0!=r&&!s.gameService.players[s.gameService.turn].addingMoney&&!s.gameService.players[s.gameService.turn].removingMoney&&s.gameService.playerPassedStart(),(22==s.playerRef._objRef.position.z||0==s.playerRef._objRef.position.z)&&s.setPlayerRotation()}}):yield fl.fromTo(s.playerRef._objRef.position,{z:s.playerRef._objRef.position.z},{z:22,duration:1,onUpdate:o=>{(22==s.playerRef._objRef.position.z||0==s.playerRef._objRef.position.z)&&s.setPlayerRotation()}}))})()}setPlayerRotation(){let t=0;this.player.actualCard>=0&&this.player.actualCard<10?t=0:this.player.actualCard>=10&&this.player.actualCard<20?t=-Math.PI/2:this.player.actualCard>=20&&this.player.actualCard<30?t=-Math.PI:this.player.actualCard>=30&&this.player.actualCard<=39&&(t=Math.PI/2),fl.fromTo(this.playerRef._objRef.rotation,{y:this.playerRef._objRef.rotation.y},{y:t,duration:1}),this.player.pawn.rotation=[0,t,0]}cycleMap(t,n,r,s,o){var a=this;return(0,nt.Z)(function*(){for(let l=t;l<=s;l++)l<r?yield a.movePlayerGsap([0==l?22:0,0,1==l?22:0],l,n):yield a.movePlayerGsap(o,l,n)})()}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(wd))},i.\u0275cmp=c.Xpm({type:i,selectors:[["app-player"]],viewQuery:function(t,n){if(1&t&&c.Gf(JSe,7),2&t){let r;c.iGM(r=c.CRH())&&(n.playerRef=r.first)}},inputs:{player:"player"},decls:2,vars:3,consts:[["loadGLTF","",3,"url","scale","rotation"],["playerRef",""]],template:function(t,n){1&t&&c._UZ(0,"th-object3D",0,1),2&t&&c.Q6J("url","/assets/blenderModels/pawns/"+n.player.pawn.choosenPawnValue+"/scene.gltf")("scale",n.player.pawn.scale)("rotation",n.player.pawn.rotation)},dependencies:[Sr,Ww]}),i})();const tCe=["diceRef"],nCe=function(){return[10,10,10]},iCe=function(){return[.5,.5,.5]};let rCe=(()=>{class i{constructor(t){this.gamePhysicsService=t,this.diceBody=new Ln({mass:10,shape:new qw(new W(.5,.5,.5)),sleepTimeLimit:.1})}ngOnInit(){this.diceMesh=this.diceRef._objRef,this.gamePhysicsService.diceArray.push({mesh:this.diceMesh,body:this.diceBody}),this.gamePhysicsService.createDice({mesh:this.diceMesh,body:this.diceBody})}ngOnDestroy(){this.gamePhysicsService.diceArray.pop()}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(uX))},i.\u0275cmp=c.Xpm({type:i,selectors:[["app-dice"]],viewQuery:function(t,n){if(1&t&&c.Gf(tCe,7),2&t){let r;c.iGM(r=c.CRH())&&(n.diceRef=r.first)}},decls:2,vars:5,consts:[["loadGLTF","",3,"url","position","scale"],["diceRef",""]],template:function(t,n){1&t&&c._UZ(0,"th-object3D",0,1),2&t&&c.Q6J("url","../../../assets/blenderModels/dice/dice.gltf")("position",c.DdM(3,nCe))("scale",c.DdM(4,iCe))},dependencies:[Sr,Ww]}),i})();const sCe=["cardInfo"],oCe=["canvas"],aCe=["scene"],lCe=["camera"],cCe=["cameraControls"],uCe=["ambientLight"],hCe=["sky"],dCe=["showDiceResultDialog"],fCe=["physicsGround"];function pCe(i,e){if(1&i&&c._UZ(0,"app-card",27),2&i){const t=e.$implicit,n=e.index;c.oxw();const r=c.MAs(4);c.Q6J("card",t)("cardIndex",n)("scene",r)}}function mCe(i,e){1&i&&c._UZ(0,"app-player",28),2&i&&c.Q6J("player",e.$implicit)}function gCe(i,e){1&i&&c._UZ(0,"app-dice")}function _Ce(i,e){1&i&&c._UZ(0,"app-dice")}const vCe=function(i){return{color:i}};function yCe(i,e){if(1&i&&(c.TgZ(0,"div",31)(1,"span",32),c._UZ(2,"span",33),c._uU(3),c.qZA()()),2&i){const t=c.oxw().$implicit,n=c.oxw();c.Q6J("@passedStartMoney",void 0),c.xp6(1),c.Q6J("ngStyle",c.VKq(4,vCe,t.addingMoney?"green":"red")),c.xp6(1),c.Q6J("innerHTML",t.addingMoney?"+":"-",c.oJD),c.xp6(1),c.hij(" ",n.gameService.playerMoneyChangeValue,"")}}const bCe=function(i){return{width:i}},xCe=function(i){return["playerCard",i]};function TCe(i,e){if(1&i&&(c.TgZ(0,"mat-card",29)(1,"span"),c._uU(2),c.qZA(),c.TgZ(3,"span"),c._uU(4),c.qZA(),c.YNc(5,yCe,4,6,"div",30),c.qZA()),2&i){const t=e.$implicit,n=c.oxw();c.Q6J("ngStyle",c.VKq(5,bCe,n.gameService.players[n.gameService.turn].id==t.id?"120%":"100%"))("ngClass",c.VKq(7,xCe,t.bankrupt?"bankrupt":"noBankrupt")),c.xp6(2),c.Oqu(t.name),c.xp6(2),c.hij("",t.money," \u20ac"),c.xp6(1),c.Q6J("ngIf",(t.addingMoney||t.removingMoney)&&!t.bankrupt)}}function wCe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",34),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.gameService.askIfShouldGoBankrupt())}),c.TgZ(1,"mat-icon"),c._uU(2,"dangerous"),c.qZA()()}if(2&i){const t=c.oxw();c.Q6J("disabled",""!=t.gameService.playerWhoWonId||t.gameService.movingCamera)("matTooltipPosition","above")}}function MCe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",35),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.gameService.showPlayerProps())}),c.TgZ(1,"mat-icon"),c._uU(2,"view_carousel"),c.qZA()()}if(2&i){const t=c.oxw();c.Q6J("disabled",!t.getActualPlayerProps().length||""!=t.gameService.playerWhoWonId||t.gameService.movingCamera)("matTooltipPosition","above")}}function SCe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",36),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.gameService.openExchangeDialog())}),c.TgZ(1,"mat-icon"),c._uU(2,"currency_exchange"),c.qZA()()}if(2&i){const t=c.oxw();c.Q6J("disabled",""!=t.gameService.playerWhoWonId||t.gameService.movingCamera)("matTooltipPosition","above")}}function CCe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",37),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.tryToGoNextTurn())}),c.TgZ(1,"mat-icon"),c._uU(2,"skip_next"),c.qZA()()}if(2&i){const t=c.oxw();c.Q6J("disabled",""!=t.gameService.playerWhoWonId||t.gameService.movingCamera)("matTooltipPosition","above")}}function ECe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",38),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.rollTheDice())}),c.TgZ(1,"mat-icon"),c._uU(2,"casino"),c.qZA()()}if(2&i){const t=c.oxw();c.Q6J("disabled",""!=t.gameService.playerWhoWonId||t.gameService.movingCamera||t.gamePhysicsService.dicesRolling)("matTooltipPosition","above")}}function ACe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",39),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.whatToDoInPrison("payToExit"))}),c.TgZ(1,"mat-icon"),c._uU(2,"payments"),c.qZA()()}if(2&i){const t=c.oxw();c.Q6J("disabled",t.gameService.players[t.gameService.turn].money<50||""!=t.gameService.playerWhoWonId||t.gameService.movingCamera)("matTooltipPosition","above")}}function DCe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"button",40),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.whatToDoInPrison("freeExit"))}),c._uU(1,"free get out"),c.qZA()}if(2&i){const t=c.oxw();c.Q6J("disabled",""!=t.gameService.playerWhoWonId||t.gameService.movingCamera)("matTooltipPosition","above")}}function RCe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"div",41)(1,"button",42),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.gameService.gamePaused=!1)}),c._uU(2,"Continue"),c.qZA(),c.TgZ(3,"button",43),c._uU(4,"Options"),c.qZA(),c.TgZ(5,"button",42),c.NdJ("click",function(){c.CHM(t);const r=c.oxw();return c.KtG(r.goBackHome())}),c._uU(6,"Home"),c.qZA()()}}function ICe(i,e){1&i&&c._UZ(0,"div",49)}function PCe(i,e){1&i&&c._UZ(0,"div",49)}function FCe(i,e){1&i&&c._UZ(0,"div",49)}function LCe(i,e){1&i&&(c.TgZ(0,"div",50),c._UZ(1,"div",49)(2,"div",49),c.qZA())}function OCe(i,e){1&i&&(c.TgZ(0,"div",50),c._UZ(1,"div",49),c.qZA())}function kCe(i,e){1&i&&(c.TgZ(0,"div",50),c._UZ(1,"div",49)(2,"div",49),c.qZA())}function NCe(i,e){1&i&&(c.TgZ(0,"div",50),c._UZ(1,"div",49)(2,"div",49)(3,"div",49),c.qZA())}function BCe(i,e){1&i&&(c.TgZ(0,"div",50),c._UZ(1,"div",49)(2,"div",49)(3,"div",49),c.qZA())}const jCe=function(i){return["dice",i]};function UCe(i,e){if(1&i&&(c.TgZ(0,"div",45)(1,"div",46),c.YNc(2,ICe,1,0,"div",47),c.YNc(3,PCe,1,0,"div",47),c.YNc(4,FCe,1,0,"div",47),c.YNc(5,LCe,3,0,"div",48),c.YNc(6,OCe,2,0,"div",48),c.YNc(7,kCe,3,0,"div",48),c.YNc(8,NCe,4,0,"div",48),c.YNc(9,BCe,4,0,"div",48),c.qZA()()),2&i){const t=e.$implicit,n=c.oxw(2);c.Q6J("ngClass",c.VKq(10,jCe,n.getDiceResClass(t)))("@showDice",void 0),c.xp6(2),c.Q6J("ngIf",t<4),c.xp6(1),c.Q6J("ngIf",t>=2&&t<=3),c.xp6(1),c.Q6J("ngIf",3==t),c.xp6(1),c.Q6J("ngIf",t>3&&t<6),c.xp6(1),c.Q6J("ngIf",5==t),c.xp6(1),c.Q6J("ngIf",t>3&&t<6),c.xp6(1),c.Q6J("ngIf",6===t),c.xp6(1),c.Q6J("ngIf",6===t)}}function VCe(i,e){if(1&i&&c.YNc(0,UCe,10,12,"div",44),2&i){const t=c.oxw();c.Q6J("ngForOf",t.gamePhysicsService.diceRes)}}const GCe=function(i){return{background:i}},zCe=function(){return[100,2,.1,1e3]};let HCe=(()=>{class i{constructor(t,n,r){this.gameService=t,this.dialog=n,this.gamePhysicsService=r,this.actualPlayerProps=[],this.textDialog="",this.cardChangedCounter=0,this.cardOutlineChangedCounter=0,this.rendererOptions={shadowMap:{},antialias:!0}}ngOnInit(){this.gameService.addingRemovingMoneyProps(),window.navigator.userAgent.includes("Android")?this.gameService.userDevice="phone_android":window.navigator.userAgent.includes("Windows")?this.gameService.userDevice="computer_windows":window.navigator.userAgent.includes("iPhone")&&(this.gameService.userDevice="prone_ios")}ngAfterViewInit(){this.gameService.camera=this.camera,this.gameService.cameraControls=this.cameraControls,this.gameService.setCameraPosition(this.camera,this.gameService.players[this.gameService.turn].pawn.position[0],this.gameService.players[this.gameService.turn].pawn.position[1],this.gameService.players[this.gameService.turn].pawn.position[2],2500,5,!1),this.activateLocalSave(),this.gameService.gameScene=this.scene._objRef,this.gamePhysicsService.initWorld(),this.gamePhysicsService.showDiceResultDialogRef=this.showDiceResultDialogRef}activateLocalSave(){setInterval(()=>{this.gameService.localSave.gameTable=this.gameService.gameTable,this.gameService.localSave.players=this.gameService.players,this.gameService.localSave.turn=this.gameService.turn,this.gameService.localSave.diceNumber=this.gameService.diceNumber,this.gameService.localSave.debt.amountDebt=this.gameService.amountDebt,this.gameService.localSave.debt.debtWithWho=this.gameService.debtWithWho,this.gameService.localSave.debt.setDebt=this.gameService.setDebt,this.gameService.localSave.playerWhoWonId=this.gameService.playerWhoWonId,this.gameService.localSave.debt.amountRent=this.gameService.amountRent,this.gameService.localSave.time.begin=this.gameService.beginTime,this.gameService.localSave.time.end=this.gameService.endTime,this.gameService.localSave.time.gameAmountTime=this.gameService.gameAmountTime,this.gameService.localSaves.gameName&&(this.gameService.localSave.gameName=this.gameService.localSaves.gameName),this.gameService.localSaves.localId&&(this.gameService.localSave.localId=this.gameService.localSaves.localId),localStorage.setItem(this.gameService.localSaveName,JSON.stringify(this.gameService.localSave))},1e4)}getActualPlayerProps(){return this.gameService.sortProperties(this.gameService.gameTable.cards.filter(t=>t.owner==this.gameService.players[this.gameService.turn].id))}resizeCanvas(t){}onBeforeRender(t){return t}tryToGoNextTurn(){0!=this.gameService.amountDebt?"player"==this.gameService.debtWithWho?this.gameService.textDialog({text:this.gameService.players[this.gameService.turn].name+" have to pay "+this.gameService.amountDebt+" of debts to "+this.gameService.players.find(t=>t.id==this.gameService.gameTable.cards[this.gameService.players[this.gameService.turn].actualCard].owner).name,property:this.gameService.gameTable.cards[this.gameService.players[this.gameService.turn].actualCard],amountDebt:this.gameService.amountDebt,playerRent:!0,debtWithWho:this.gameService.debtWithWho},"payMoney"):"bank"==this.gameService.debtWithWho&&this.gameService.textDialog({text:this.gameService.players[this.gameService.turn].name+" have to pay "+this.gameService.amountDebt+" of debts to the bank.",debtWithWho:this.gameService.debtWithWho,amountDebt:this.gameService.amountDebt,playerRent:!1,playerId:""},"payMoney"):this.gameService.nextTurn()}goBackHome(){location.reload()}changeCardColor(){new sn(this.gameService.sessionColor),this.scene.objRef.children.forEach(n=>{n.name.includes("cardNumber")&&this.cardChangedCounter<this.gameService.gameTable.cards.length?n.traverse(r=>{if(r.isMesh){const s=new Ta({color:this.gameService.LightenDarkenColor(this.gameService.sessionColor,-20)});r.material=s,this.cardChangedCounter++}}):n.name.includes("cardOutline")&&this.cardOutlineChangedCounter<this.gameService.gameTable.cards.length&&n.traverse(r=>{if(r.isMesh){const s=new Ta({color:this.gameService.LightenDarkenColor(this.gameService.sessionColor,-40),side:1});r.material=s,this.cardOutlineChangedCounter++}})})}rollTheDice(){var t=this;return(0,nt.Z)(function*(){yield t.gameService.setCameraPosition(t.gameService.camera,25,15,25,1e3,5,!1,"diceRoll"),t.gameService.startToDice&&(t.gameService.startToDice=!1),t.gameService.players[t.gameService.turn].prison.inPrison?t.whatToDoInPrison("prisonRoll"):(t.gameService.startToDice=!0,t.gamePhysicsService.diceArray.forEach(n=>{t.gamePhysicsService.diceRoll(n)}))})()}whatToDoInPrison(t){"payToExit"==t&&this.gameService.exitFromPrison(!0,!1),"freeExit"==t?this.gameService.exitFromPrison(!1,!1):"prisonRoll"==t&&(this.gameService.startToDice=!0,this.gamePhysicsService.diceArray.forEach(n=>{this.gamePhysicsService.diceRoll(n)}))}getDiceResClass(t){let n="";switch(t){case 3:n="three";break;case 4:n="four";break;case 5:n="five";break;case 6:n="six"}return n}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(wd),c.Y36(cP),c.Y36(uX))},i.\u0275cmp=c.Xpm({type:i,selectors:[["app-game"]],viewQuery:function(t,n){if(1&t&&(c.Gf(sCe,7),c.Gf(oCe,7),c.Gf(aCe,7),c.Gf(lCe,7),c.Gf(cCe,7),c.Gf(uCe,7),c.Gf(hCe,7),c.Gf(dCe,7),c.Gf(fCe,7)),2&t){let r;c.iGM(r=c.CRH())&&(n.cardInfo=r.first),c.iGM(r=c.CRH())&&(n.canvas=r.first),c.iGM(r=c.CRH())&&(n.scene=r.first),c.iGM(r=c.CRH())&&(n.camera=r.first),c.iGM(r=c.CRH())&&(n.cameraControls=r.first),c.iGM(r=c.CRH())&&(n.ambientLight=r.first),c.iGM(r=c.CRH())&&(n.sky=r.first),c.iGM(r=c.CRH())&&(n.showDiceResultDialogRef=r.first),c.iGM(r=c.CRH())&&(n.physicsGround=r.first)}},decls:32,vars:25,consts:[["id","gameContainer","fxLayout","column","fxLayoutAlign","center center"],["id","gameCanvas",3,"shadow","rendererParameters","ngStyle","onResize","onRender"],["canvas",""],[3,"thStats","autoUpdate"],["scene",""],[3,"intensity"],["ambientLight",""],[3,"card","cardIndex","scene",4,"ngFor","ngForOf"],[3,"player",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"args","position"],["camera",""],[3,"enabled"],["cameraControls",""],["id","playersContainer","fxLayout","column","fxLayoutAlign","space-around center"],["fxLayout","column","fxLayoutAlign","center center",3,"ngStyle","ngClass",4,"ngFor","ngForOf"],["id","gameButtons","fxLayout","row","fxLayoutAlign","space-around center"],["mat-raised-button","","id","openExchange","color","warn","matTooltip","Go bankrupt",3,"disabled","matTooltipPosition","click",4,"ngIf"],["mat-raised-button","","id","seeProperties","matTooltip","Properties",3,"disabled","matTooltipPosition","click",4,"ngIf"],["mat-raised-button","","id","openExchange","matTooltip","Exchange",3,"disabled","matTooltipPosition","click",4,"ngIf"],["mat-raised-button","","id","nextTurnBtn","matTooltip","Next Turn",3,"disabled","matTooltipPosition","click",4,"ngIf"],["mat-raised-button","","id","diceBtn","matTooltip","Dice",3,"disabled","matTooltipPosition","click",4,"ngIf"],["mat-raised-button","","matTooltip","Pay and exit",3,"disabled","matTooltipPosition","click",4,"ngIf"],["mat-raised-button","","matTooltip","Use free card and exit",3,"disabled","matTooltipPosition","click",4,"ngIf"],["mat-icon-button","","id","pauseBtn",3,"click"],["class","pausedGame","fxLayout","column","fxLayoutAlign","center center",4,"ngIf"],["showDiceResultDialog",""],[3,"card","cardIndex","scene"],[3,"player"],["fxLayout","column","fxLayoutAlign","center center",3,"ngStyle","ngClass"],["id","passedStart",4,"ngIf"],["id","passedStart"],[3,"ngStyle"],[3,"innerHTML"],["mat-raised-button","","id","openExchange","color","warn","matTooltip","Go bankrupt",3,"disabled","matTooltipPosition","click"],["mat-raised-button","","id","seeProperties","matTooltip","Properties",3,"disabled","matTooltipPosition","click"],["mat-raised-button","","id","openExchange","matTooltip","Exchange",3,"disabled","matTooltipPosition","click"],["mat-raised-button","","id","nextTurnBtn","matTooltip","Next Turn",3,"disabled","matTooltipPosition","click"],["mat-raised-button","","id","diceBtn","matTooltip","Dice",3,"disabled","matTooltipPosition","click"],["mat-raised-button","","matTooltip","Pay and exit",3,"disabled","matTooltipPosition","click"],["mat-raised-button","","matTooltip","Use free card and exit",3,"disabled","matTooltipPosition","click"],["fxLayout","column","fxLayoutAlign","center center",1,"pausedGame"],["mat-raised-button","",3,"click"],["mat-raised-button","","disabled","true"],["class","dice",3,"ngClass",4,"ngFor","ngForOf"],[1,"dice",3,"ngClass"],[1,"dotsContainer"],["class","dot",4,"ngIf"],["class","innerDotsContainer",4,"ngIf"],[1,"dot"],[1,"innerDotsContainer"]],template:function(t,n){1&t&&(c.TgZ(0,"div",0)(1,"th-canvas",1,2),c.NdJ("onResize",function(s){return n.resizeCanvas(s)})("onRender",function(){return n.changeCardColor(),n.gamePhysicsService.renderPhysicsWorld()}),c.TgZ(3,"th-scene",3,4),c._UZ(5,"th-ambientLight",5,6)(7,"th-hemisphereLight"),c.YNc(8,pCe,1,3,"app-card",7),c.YNc(9,mCe,1,1,"app-player",8),c.YNc(10,gCe,1,0,"app-dice",9),c.YNc(11,_Ce,1,0,"app-dice",9),c.TgZ(12,"th-perspectiveCamera",10,11),c._UZ(14,"th-mapControls",12,13),c.qZA()()(),c.TgZ(16,"div",14),c.YNc(17,TCe,6,9,"mat-card",15),c.qZA(),c.TgZ(18,"div",16),c.YNc(19,wCe,3,2,"button",17),c.YNc(20,MCe,3,2,"button",18),c.YNc(21,SCe,3,2,"button",19),c.YNc(22,CCe,3,2,"button",20),c.YNc(23,ECe,3,2,"button",21),c.YNc(24,ACe,3,2,"button",22),c.YNc(25,DCe,2,2,"button",23),c.qZA(),c.TgZ(26,"button",24),c.NdJ("click",function(){return n.gameService.gamePaused=!0}),c.TgZ(27,"mat-icon"),c._uU(28,"pause"),c.qZA()(),c.YNc(29,RCe,7,0,"div",25),c.YNc(30,VCe,1,1,"ng-template",null,26,c.W1O),c.qZA()),2&t&&(c.xp6(1),c.Q6J("shadow",!0)("rendererParameters",n.rendererOptions)("ngStyle",c.VKq(22,GCe,"radial-gradient("+n.gameService.sessionColor+","+n.gameService.LightenDarkenColor(n.gameService.sessionColor,-80)+")")),c.xp6(2),c.Q6J("thStats",!0)("autoUpdate",!0),c.xp6(2),c.Q6J("intensity",1),c.xp6(3),c.Q6J("ngForOf",n.gameService.gameTable.cards),c.xp6(1),c.Q6J("ngForOf",n.gameService.players),c.xp6(1),c.Q6J("ngIf",n.gameService.startToDice),c.xp6(1),c.Q6J("ngIf",n.gameService.startToDice),c.xp6(1),c.Q6J("args",c.DdM(24,zCe))("position",n.gameService.cameraPosition),c.xp6(2),c.Q6J("enabled",!n.gameService.movingCamera&&"local"==n.gameService.choosenMode),c.xp6(3),c.Q6J("ngForOf",n.gameService.players),c.xp6(2),c.Q6J("ngIf",!n.gameService.players[n.gameService.turn].canDice),c.xp6(1),c.Q6J("ngIf",!n.gameService.players[n.gameService.turn].canDice),c.xp6(1),c.Q6J("ngIf",!n.gameService.players[n.gameService.turn].canDice),c.xp6(1),c.Q6J("ngIf",!n.gameService.players[n.gameService.turn].canDice),c.xp6(1),c.Q6J("ngIf",n.gameService.players[n.gameService.turn].canDice),c.xp6(1),c.Q6J("ngIf",n.gameService.players[n.gameService.turn].prison.inPrison&&n.gameService.players[n.gameService.turn].canDice),c.xp6(1),c.Q6J("ngIf",n.gameService.players[n.gameService.turn].prison.inPrison&&n.gameService.players[n.gameService.turn].prison.getOutCards&&n.gameService.players[n.gameService.turn].canDice),c.xp6(4),c.Q6J("ngIf",n.gameService.gamePaused))},dependencies:[Ha,xr,qr,Wa,CE,uP,hP,w0,S_,R3,mP,IE,sxe,g9,txe,m9,hG,fG,cxe,x9,QSe,eCe,rCe],styles:['#gameContainer[_ngcontent-%COMP%], #gameContainer[_ngcontent-%COMP%]   #gameCanvas[_ngcontent-%COMP%]{width:100%;height:100%}#gameContainer[_ngcontent-%COMP%]   #playersContainer[_ngcontent-%COMP%]{position:absolute;height:100%;top:0;left:0;pointer-events:none}#gameContainer[_ngcontent-%COMP%]   #playersContainer[_ngcontent-%COMP%]   .playerCard[_ngcontent-%COMP%]{transition:all .25s ease;position:relative;pointer-events:all}#gameContainer[_ngcontent-%COMP%]   #playersContainer[_ngcontent-%COMP%]   .playerCard.bankrupt[_ngcontent-%COMP%]{background:#c73b2f;color:#fff;opacity:.7}#gameContainer[_ngcontent-%COMP%]   #playersContainer[_ngcontent-%COMP%]   .playerCard.bankrupt[_ngcontent-%COMP%]:after{content:"";position:absolute;width:50%;height:2px;background-color:#fff;transform:rotate(45deg)}#gameContainer[_ngcontent-%COMP%]   #playersContainer[_ngcontent-%COMP%]   .playerCard[_ngcontent-%COMP%]   #passedStart[_ngcontent-%COMP%]{position:absolute;opacity:1;right:-60px;top:10px;width:50px;transition:all .25s ease;font-weight:700;color:green}#gameContainer[_ngcontent-%COMP%]   #gameButtons[_ngcontent-%COMP%]{position:absolute;bottom:20px;width:100%;pointer-events:none}#gameContainer[_ngcontent-%COMP%]   #gameButtons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{pointer-events:all}#gameContainer[_ngcontent-%COMP%]   #pauseBtn[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px}#gameContainer[_ngcontent-%COMP%]   .pausedGame[_ngcontent-%COMP%]{width:100%;height:100%;background:rgba(218,217,217,.493);position:absolute;top:0;left:0;z-index:100}#gameContainer[_ngcontent-%COMP%]   .pausedGame[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:30px;width:300px;height:50px}.actualPlayerProperty[_ngcontent-%COMP%]{position:relative}.actualPlayerProperty[_ngcontent-%COMP%]   .districtColor[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:5px}'],data:{animation:[jf("passedStartMoney",[ka(":enter",[Qi({top:"-50px",opacity:0}),ul("250ms ease-in",Qi({top:"10px",opacity:1}))]),ka(":leave",[Qi({top:"10px",opacity:1}),ul("250ms ease-out",Qi({top:"-50px",opacity:0}))])]),jf("showDice",[ka(":enter",[Qi({tansform:"scale(0)",opacity:0}),ul("250ms ease-in",Qi({tansform:"scale(1)",opacity:1}))]),ka(":leave",[Qi({tansform:"scale(1)",opacity:1}),ul("250ms ease-out",Qi({tansform:"scale(0)",opacity:0}))])])]}}),i})();const WCe=function(i){return{background:i}},qCe=[{path:"home",component:(()=>{class i{constructor(t,n){this.router=t,this.gameService=n}ngOnInit(){this.gameService.retrieveSavesFromLocal()}goToChooseModeView(){this.router.navigateByUrl("mode",{skipLocationChange:!0})}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(Do),c.Y36(wd))},i.\u0275cmp=c.Xpm({type:i,selectors:[["app-home"]],decls:7,vars:4,consts:[["id","home","fxLayout","column","fxLayoutAlign","center center",3,"click"],["id","title",3,"click"],[1,"playText"],[1,"rightsSection",3,"click"]],template:function(t,n){1&t&&(c.TgZ(0,"div",0),c.NdJ("click",function(){return n.goToChooseModeView()}),c.TgZ(1,"h1",1),c.NdJ("click",function(s){return s.stopPropagation()}),c._uU(2,"Project Rekord"),c.qZA(),c.TgZ(3,"span",2),c._uU(4,"PLAY"),c.qZA(),c.TgZ(5,"span",3),c.NdJ("click",function(s){return s.stopPropagation()}),c._uU(6,"@Hoanca Robert 2022 All Rights Reserved"),c.qZA()()),2&t&&c.Akn(c.VKq(2,WCe,n.gameService.sessionColor))},dependencies:[w0,S_],styles:["#home[_ngcontent-%COMP%]{width:100%;height:100%;font-family:mova}#home[_ngcontent-%COMP%]   #title[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:100px;margin:0;pointer-events:none}#home[_ngcontent-%COMP%]   .playText[_ngcontent-%COMP%]{position:absolute;bottom:100px;width:100%;text-align:center;font-size:25px;pointer-events:none}#home[_ngcontent-%COMP%]   .rightsSection[_ngcontent-%COMP%]{position:absolute;bottom:10px;width:100%;text-align:center;font-size:15px;pointer-events:none}"]}),i})()},{path:"game",component:HCe},{path:"mode",component:Pxe}];let ZCe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[IM.forRoot(qCe),IM]}),i})(),YCe=(()=>{class i{constructor(t,n){this.router=t,this.gameService=n,this.title="monopoly"}ngOnInit(){var t=this;return(0,nt.Z)(function*(){t.router.navigateByUrl("home",{skipLocationChange:!0}),yield t.gameService.retrieveDBData(),t.gameService.chooseSessionColor()})()}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(Do),c.Y36(wd))},i.\u0275cmp=c.Xpm({type:i,selectors:[["app-root"]],decls:2,vars:0,consts:[["id","routerContainer"]],template:function(t,n){1&t&&(c.TgZ(0,"div",0),c._UZ(1,"router-outlet"),c.qZA())},dependencies:[ls],styles:["@font-face{font-family:ailerons;src:url(ailerons-regular-webfont.082045124ee35d74.woff)}@font-face{font-family:mova;src:url(Mova.79de4f1e41a156f2.ttf)}#routerContainer[_ngcontent-%COMP%]{width:100%;height:100%}"]}),i})();const dX_firebaseConfig={apiKey:"AIzaSyDiksTLURuulOYh3Vq9iIM1mkFCmYAlSKE",authDomain:"monopoly-robert.firebaseapp.com",projectId:"monopoly-robert",storageBucket:"monopoly-robert.appspot.com",messagingSenderId:"976774171273",appId:"1:976774171273:web:db4ccb4ad9258b573cd458",measurementId:"G-JC68QYHP7F"};function fX(i){return new c.vHH(3e3,!1)}function DEe(){return typeof window<"u"&&typeof window.document<"u"}function CG(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function cv(i){switch(i.length){case 0:return new SE;case 1:return i[0];default:return new N5(i)}}function pX(i,e,t,n,r=new Map,s=new Map){const o=[],a=[];let l=-1,h=null;if(n.forEach(f=>{const m=f.get("offset"),g=m==l,v=g&&h||new Map;f.forEach((y,b)=>{let T=b,S=y;if("offset"!==b)switch(T=e.normalizePropertyName(T,o),S){case"!":S=r.get(b);break;case ym:S=s.get(b);break;default:S=e.normalizeStyleValue(b,T,S,o)}v.set(T,S)}),g||a.push(v),h=v,l=m}),o.length)throw function _Ee(i){return new c.vHH(3502,!1)}();return a}function EG(i,e,t,n){switch(e){case"start":i.onStart(()=>n(t&&AG(t,"start",i)));break;case"done":i.onDone(()=>n(t&&AG(t,"done",i)));break;case"destroy":i.onDestroy(()=>n(t&&AG(t,"destroy",i)))}}function AG(i,e,t){const s=DG(i.element,i.triggerName,i.fromState,i.toState,e||i.phaseName,t.totalTime??i.totalTime,!!t.disabled),o=i._data;return null!=o&&(s._data=o),s}function DG(i,e,t,n,r="",s=0,o){return{element:i,triggerName:e,fromState:t,toState:n,phaseName:r,totalTime:s,disabled:!!o}}function vu(i,e,t){let n=i.get(e);return n||i.set(e,n=t),n}function mX(i){const e=i.indexOf(":");return[i.substring(1,e),i.slice(e+1)]}let RG=(i,e)=>!1,gX=(i,e,t)=>[],_X=null;function IG(i){const e=i.parentNode||i.host;return e===_X?null:e}(CG()||typeof Element<"u")&&(DEe()?(_X=(()=>document.documentElement)(),RG=(i,e)=>{for(;e;){if(e===i)return!0;e=IG(e)}return!1}):RG=(i,e)=>i.contains(e),gX=(i,e,t)=>{if(t)return Array.from(i.querySelectorAll(e));const n=i.querySelector(e);return n?[n]:[]});let wb=null,vX=!1;const yX=RG,bX=gX;let xX=(()=>{class i{validateStyleProperty(t){return function IEe(i){wb||(wb=function PEe(){return typeof document<"u"?document.body:null}()||{},vX=!!wb.style&&"WebkitAppearance"in wb.style);let e=!0;return wb.style&&!function REe(i){return"ebkit"==i.substring(1,6)}(i)&&(e=i in wb.style,!e&&vX&&(e="Webkit"+i.charAt(0).toUpperCase()+i.slice(1)in wb.style)),e}(t)}matchesElement(t,n){return!1}containsElement(t,n){return yX(t,n)}getParentElement(t){return IG(t)}query(t,n,r){return bX(t,n,r)}computeStyle(t,n,r){return r||""}animate(t,n,r,s,o,a=[],l){return new SE(r,s)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})(),PG=(()=>{class i{}return i.NOOP=new xX,i})();const FG="ng-enter",iO="ng-leave",rO="ng-trigger",sO=".ng-trigger",wX="ng-animating",LG=".ng-animating";function uv(i){if("number"==typeof i)return i;const e=i.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:OG(parseFloat(e[1]),e[2])}function OG(i,e){return"s"===e?1e3*i:i}function oO(i,e,t){return i.hasOwnProperty("duration")?i:function OEe(i,e,t){let r,s=0,o="";if("string"==typeof i){const a=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(fX()),{duration:0,delay:0,easing:""};r=OG(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=OG(parseFloat(l),a[4]));const h=a[5];h&&(o=h)}else r=i;if(!t){let a=!1,l=e.length;r<0&&(e.push(function KCe(){return new c.vHH(3100,!1)}()),a=!0),s<0&&(e.push(function XCe(){return new c.vHH(3101,!1)}()),a=!0),a&&e.splice(l,0,fX())}return{duration:r,delay:s,easing:o}}(i,e,t)}function l1(i,e={}){return Object.keys(i).forEach(t=>{e[t]=i[t]}),e}function MX(i){const e=new Map;return Object.keys(i).forEach(t=>{e.set(t,i[t])}),e}function hv(i,e=new Map,t){if(t)for(let[n,r]of t)e.set(n,r);for(let[n,r]of i)e.set(n,r);return e}function CX(i,e,t){return t?e+":"+t+";":""}function EX(i){let e="";for(let t=0;t<i.style.length;t++){const n=i.style.item(t);e+=CX(0,n,i.style.getPropertyValue(n))}for(const t in i.style)i.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=CX(0,jEe(t),i.style[t]));i.setAttribute("style",e)}function ep(i,e,t){i.style&&(e.forEach((n,r)=>{const s=NG(r);t&&!t.has(r)&&t.set(r,i.style[s]),i.style[s]=n}),CG()&&EX(i))}function Mb(i,e){i.style&&(e.forEach((t,n)=>{const r=NG(n);i.style[r]=""}),CG()&&EX(i))}function c1(i){return Array.isArray(i)?1==i.length?i[0]:O5(i):i}const kG=new RegExp("{{\\s*(.+?)\\s*}}","g");function AX(i){let e=[];if("string"==typeof i){let t;for(;t=kG.exec(i);)e.push(t[1]);kG.lastIndex=0}return e}function aO(i,e,t){const n=i.toString(),r=n.replace(kG,(s,o)=>{let a=e[o];return null==a&&(t.push(function QCe(i){return new c.vHH(3003,!1)}()),a=""),a.toString()});return r==n?i:r}function lO(i){const e=[];let t=i.next();for(;!t.done;)e.push(t.value),t=i.next();return e}const BEe=/-+([a-z0-9])/g;function NG(i){return i.replace(BEe,(...e)=>e[1].toUpperCase())}function jEe(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function yu(i,e,t){switch(e.type){case 7:return i.visitTrigger(e,t);case 0:return i.visitState(e,t);case 1:return i.visitTransition(e,t);case 2:return i.visitSequence(e,t);case 3:return i.visitGroup(e,t);case 4:return i.visitAnimate(e,t);case 5:return i.visitKeyframes(e,t);case 6:return i.visitStyle(e,t);case 8:return i.visitReference(e,t);case 9:return i.visitAnimateChild(e,t);case 10:return i.visitAnimateRef(e,t);case 11:return i.visitQuery(e,t);case 12:return i.visitStagger(e,t);default:throw function JCe(i){return new c.vHH(3004,!1)}()}}function DX(i,e){return window.getComputedStyle(i)[e]}function WEe(i,e){const t=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(n=>function qEe(i,e,t){if(":"==i[0]){const l=function ZEe(i,e){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function fEe(i){return new c.vHH(3016,!1)}()),"* => *"}}(i,t);if("function"==typeof l)return void e.push(l);i=l}const n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function dEe(i){return new c.vHH(3015,!1)}()),e;const r=n[1],s=n[2],o=n[3];e.push(RX(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&e.push(RX(o,r))}(n,t,e)):t.push(i),t}const dO=new Set(["true","1"]),fO=new Set(["false","0"]);function RX(i,e){const t=dO.has(i)||fO.has(i),n=dO.has(e)||fO.has(e);return(r,s)=>{let o="*"==i||i==r,a="*"==e||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?dO.has(i):fO.has(i)),!a&&n&&"boolean"==typeof s&&(a=s?dO.has(e):fO.has(e)),o&&a}}const YEe=new RegExp("s*:selfs*,?","g");function BG(i,e,t,n){return new KEe(i).build(e,t,n)}class KEe{constructor(e){this._driver=e}build(e,t,n){const r=new QEe(t);return this._resetContextStyleTimingState(r),yu(this,c1(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function tEe(){return new c.vHH(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,h=l.name;h.toString().split(/\s*,\s*/).forEach(f=>{l.name=f,s.push(this.visitState(l,t))}),l.name=h}else if(1==a.type){const l=this.visitTransition(a,t);n+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push(function nEe(){return new c.vHH(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:n,depCount:r,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){const s=new Set,o=r||{};n.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{AX(l).forEach(h=>{o.hasOwnProperty(h)||s.add(h)})})}),s.size&&(lO(s.values()),t.errors.push(function iEe(i,e){return new c.vHH(3008,!1)}()))}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=yu(this,c1(e.animation),t);return{type:1,matchers:WEe(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:Sb(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>yu(this,n,t)),options:Sb(e.options)}}visitGroup(e,t){const n=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=n;const a=yu(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:Sb(e.options)}}visitAnimate(e,t){const n=function eAe(i,e){if(i.hasOwnProperty("duration"))return i;if("number"==typeof i)return jG(oO(i,e).duration,0,"");const t=i;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=jG(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=oO(t,e);return jG(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let r,s=e.styles?e.styles:Qi({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const h={};n.easing&&(h.easing=n.easing),o=Qi(h)}t.currentTime+=n.duration+n.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===ym?n.push(a):t.errors.push(new c.vHH(3002,!1)):n.push(MX(a));let s=!1,o=null;return n.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let l of a.values())if(l.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:n,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;n&&s>0&&(s-=n.duration+n.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,l)=>{const h=t.collectedStyles.get(t.currentQuerySelector),f=h.get(l);let m=!0;f&&(s!=r&&s>=f.startTime&&r<=f.endTime&&(t.errors.push(function sEe(i,e,t,n,r){return new c.vHH(3010,!1)}()),m=!1),s=f.startTime),m&&h.set(l,{startTime:s,endTime:r}),t.options&&function NEe(i,e,t){const n=e.params||{},r=AX(i);r.length&&r.forEach(s=>{n.hasOwnProperty(s)||t.push(function $Ce(i){return new c.vHH(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function oEe(){return new c.vHH(3011,!1)}()),n;let s=0;const o=[];let a=!1,l=!1,h=0;const f=e.steps.map(S=>{const C=this._makeStyleAst(S,t);let R=null!=C.offset?C.offset:function JEe(i){if("string"==typeof i)return null;let e=null;if(Array.isArray(i))i.forEach(t=>{if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(i instanceof Map&&i.has("offset")){const t=i;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(C.styles),I=0;return null!=R&&(s++,I=C.offset=R),l=l||I<0||I>1,a=a||I<h,h=I,o.push(I),C});l&&t.errors.push(function aEe(){return new c.vHH(3012,!1)}()),a&&t.errors.push(function lEe(){return new c.vHH(3200,!1)}());const m=e.steps.length;let g=0;s>0&&s<m?t.errors.push(function cEe(){return new c.vHH(3202,!1)}()):0==s&&(g=1/(m-1));const v=m-1,y=t.currentTime,b=t.currentAnimateTimings,T=b.duration;return f.forEach((S,C)=>{const R=g>0?C==v?1:g*C:o[C],I=R*T;t.currentTime=y+b.delay+I,b.duration=I,this._validateStyleAst(S,t),S.offset=R,n.styles.push(S)}),n}visitReference(e,t){return{type:8,animation:yu(this,c1(e.animation),t),options:Sb(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Sb(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Sb(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function XEe(i){const e=!!i.split(/\s*,\s*/).find(t=>":self"==t);return e&&(i=i.replace(YEe,"")),i=i.replace(/@\*/g,sO).replace(/@\w+/g,t=>sO+"-"+t.slice(1)).replace(/:animating/g,LG),[i,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+s:s,vu(t.collectedStyles,t.currentQuerySelector,new Map);const a=yu(this,c1(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:Sb(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function uEe(){return new c.vHH(3013,!1)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:oO(e.timings,t.errors,!0);return{type:12,animation:yu(this,c1(e.animation),t),timings:n,options:null}}}class QEe{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Sb(i){return i?(i=l1(i)).params&&(i.params=function $Ee(i){return i?l1(i):null}(i.params)):i={},i}function jG(i,e,t){return{duration:i,delay:e,easing:t}}function UG(i,e,t,n,r,s,o=null,a=!1){return{type:1,element:i,keyframes:e,preStyleProps:t,postStyleProps:n,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class pO{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const iAe=new RegExp(":enter","g"),sAe=new RegExp(":leave","g");function VG(i,e,t,n,r,s=new Map,o=new Map,a,l,h=[]){return(new oAe).buildKeyframes(i,e,t,n,r,s,o,a,l,h)}class oAe{buildKeyframes(e,t,n,r,s,o,a,l,h,f=[]){h=h||new pO;const m=new GG(e,t,h,r,s,f,[]);m.options=l;const g=l.delay?uv(l.delay):0;m.currentTimeline.delayNextStep(g),m.currentTimeline.setStyles([o],null,m.errors,l),yu(this,n,m);const v=m.timelines.filter(y=>y.containsAnimation());if(v.length&&a.size){let y;for(let b=v.length-1;b>=0;b--){const T=v[b];if(T.element===t){y=T;break}}y&&!y.allowOnlyTimelineStyles()&&y.setStyles([a],null,m.errors,l)}return v.length?v.map(y=>y.buildKeyframes()):[UG(t,[],[],[],0,g,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,n){let s=t.currentTimeline.currentTime;const o=null!=n.duration?uv(n.duration):null,a=null!=n.delay?uv(n.delay):null;return 0!==o&&e.forEach(l=>{const h=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,h.duration+h.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),yu(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=mO);const o=uv(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>yu(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?uv(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),yu(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return oO(t.params?aO(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(n.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.hasCurrentStyleProperties()&&n.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(s):n.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,r=t.currentTimeline.duration,s=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?uv(r.delay):0;s&&(6===t.previousNode.type||0==n&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=mO);let o=n;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((h,f)=>{t.currentQueryIndex=f;const m=t.createSubContext(e.options,h);s&&m.delayNextStep(s),h===t.element&&(l=m.currentTimeline),yu(this,e.animation,m),m.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,m.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=n.currentStaggerTime}const f=t.currentTimeline;l&&f.delayNextStep(l);const m=f.currentTime;yu(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-m+(r.startTime-n.currentTimeline.startTime)}}const mO={};class GG{constructor(e,t,n,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=mO,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new gO(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let r=this.options;null!=n.duration&&(r.duration=uv(n.duration)),null!=n.delay&&(r.delay=uv(n.delay));const s=n.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=aO(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(r=>{n[r]=t[r]})}}return e}createSubContext(e=null,t,n){const r=t||this.element,s=new GG(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=mO,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},s=new aAe(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(iAe,"."+this._enterClassName)).replace(sAe,"."+this._leaveClassName);let h=this._driver.query(this.element,e,1!=n);0!==n&&(h=n<0?h.slice(h.length+n,h.length):h.slice(0,n)),a.push(...h)}return!s&&0==a.length&&o.push(function hEe(i){return new c.vHH(3014,!1)}()),a}}class gO{constructor(e,t,n,r){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new gO(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||ym),this._currentKeyframe.set(t,ym);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function lAe(i,e){const t=new Map;let n;return i.forEach(r=>{if("*"===r){n=n||e.keys();for(let s of n)t.set(s,ym)}else hv(r,t)}),t}(e,this._globalTimelineStyles);for(let[a,l]of o){const h=aO(l,s,n);this._pendingStyles.set(a,h),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??ym),this._updateStyle(a,h)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{const r=this._styleSummary.get(n);(!r||t.time>r.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const h=hv(a,new Map,this._backFill);h.forEach((f,m)=>{"!"===f?e.add(m):f===ym&&t.add(m)}),n||h.set("offset",l/this.duration),r.push(h)});const s=e.size?lO(e.values()):[],o=t.size?lO(t.values()):[];if(n){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return UG(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class aAe extends gO{constructor(e,t,n,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=n+t,a=t/o,l=hv(e[0]);l.set("offset",0),s.push(l);const h=hv(e[0]);h.set("offset",FX(a)),s.push(h);const f=e.length-1;for(let m=1;m<=f;m++){let g=hv(e[m]);const v=g.get("offset");g.set("offset",FX((t+v*n)/o)),s.push(g)}n=o,t=0,r="",e=s}return UG(this.element,e,this.preStyleProps,this.postStyleProps,n,t,r,!0)}}function FX(i,e=3){const t=Math.pow(10,e-1);return Math.round(i*t)/t}class zG{}const cAe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class uAe extends zG{normalizePropertyName(e,t){return NG(e)}normalizeStyleValue(e,t,n,r){let s="";const o=n.toString().trim();if(cAe.has(t)&&0!==n&&"0"!==n)if("number"==typeof n)s="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function eEe(i,e){return new c.vHH(3005,!1)}())}return o+s}}function LX(i,e,t,n,r,s,o,a,l,h,f,m,g){return{type:0,element:i,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:n,toStyles:o,timelines:a,queriedElements:l,preStyleProps:h,postStyleProps:f,totalTime:m,errors:g}}const HG={};class OX{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,r){return function hAe(i,e,t,n,r){return i.some(s=>s(e,t,n,r))}(this.ast.matchers,e,t,n,r)}buildStyles(e,t,n){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,n):new Map}build(e,t,n,r,s,o,a,l,h,f){const m=[],g=this.ast.options&&this.ast.options.params||HG,y=this.buildStyles(n,a&&a.params||HG,m),b=l&&l.params||HG,T=this.buildStyles(r,b,m),S=new Set,C=new Map,R=new Map,I="void"===r,L={params:dAe(b,g),delay:this.ast.options?.delay},N=f?[]:VG(e,t,this.ast.animation,s,o,y,T,L,h,m);let U=0;if(N.forEach(z=>{U=Math.max(z.duration+z.delay,U)}),m.length)return LX(t,this._triggerName,n,r,I,y,T,[],[],C,R,U,m);N.forEach(z=>{const K=z.element,te=vu(C,K,new Set);z.preStyleProps.forEach(ie=>te.add(ie));const fe=vu(R,K,new Set);z.postStyleProps.forEach(ie=>fe.add(ie)),K!==t&&S.add(K)});const k=lO(S.values());return LX(t,this._triggerName,n,r,I,y,T,N,k,C,R,U)}}function dAe(i,e){const t=l1(e);for(const n in i)i.hasOwnProperty(n)&&null!=i[n]&&(t[n]=i[n]);return t}class fAe{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n=new Map,r=l1(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=aO(o,r,t));const l=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,l,o,t),n.set(l,o)})}),n}}class mAe{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new fAe(r.style,r.options&&r.options.params||{},n))}),kX(this.states,"true","1"),kX(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new OX(e,r,this.states))}),this.fallbackTransition=function gAe(i,e,t){return new OX(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,r){return this.transitionFactories.find(o=>o.match(e,t,n,r))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function kX(i,e,t){i.has(e)?i.has(t)||i.set(t,i.get(e)):i.has(t)&&i.set(e,i.get(t))}const _Ae=new pO;class vAe{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const n=[],s=BG(this._driver,t,n,[]);if(n.length)throw function vEe(i){return new c.vHH(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,n){const r=e.element,s=pX(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const r=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=VG(this._driver,t,s,FG,iO,new Map,new Map,n,_Ae,r),o.forEach(f=>{const m=vu(a,f.element,new Map);f.postStyleProps.forEach(g=>m.set(g,null))})):(r.push(function yEe(){return new c.vHH(3300,!1)}()),o=[]),r.length)throw function bEe(i){return new c.vHH(3504,!1)}();a.forEach((f,m)=>{f.forEach((g,v)=>{f.set(v,this._driver.computeStyle(m,v,ym))})});const h=cv(o.map(f=>{const m=a.get(f.element);return this._buildPlayer(f,new Map,m)}));return this._playersById.set(e,h),h.onDestroy(()=>this.destroy(e)),this.players.push(h),h}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function xEe(i){return new c.vHH(3301,!1)}();return t}listen(e,t,n,r){const s=DG(t,"","","");return EG(this._getPlayer(e),n,s,r),()=>{}}command(e,t,n,r){if("register"==n)return void this.register(e,r[0]);if("create"==n)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const NX="ng-animate-queued",WG="ng-animate-disabled",wAe=[],BX={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},MAe={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Th="__ng_removed";class qG{constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function AAe(i){return i??null}(n?e.value:e),n){const s=l1(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(r=>{null==n[r]&&(n[r]=t[r])})}}}const u1="void",ZG=new qG(u1);class SAe{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,wh(t,this._hostClassName)}listen(e,t,n,r){if(!this._triggers.has(t))throw function TEe(i,e){return new c.vHH(3302,!1)}();if(null==n||0==n.length)throw function wEe(i){return new c.vHH(3303,!1)}();if(!function DAe(i){return"start"==i||"done"==i}(n))throw function MEe(i,e){return new c.vHH(3400,!1)}();const s=vu(this._elementListeners,e,[]),o={name:t,phase:n,callback:r};s.push(o);const a=vu(this._engine.statesByElement,e,new Map);return a.has(t)||(wh(e,rO),wh(e,rO+"-"+t),a.set(t,ZG)),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function SEe(i){return new c.vHH(3401,!1)}();return t}trigger(e,t,n,r=!0){const s=this._getTrigger(t),o=new YG(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(wh(e,rO),wh(e,rO+"-"+t),this._engine.statesByElement.set(e,a=new Map));let l=a.get(t);const h=new qG(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&l&&h.absorbOptions(l.options),a.set(t,h),l||(l=ZG),h.value!==u1&&l.value===h.value){if(!function PAe(i,e){const t=Object.keys(i),n=Object.keys(e);if(t.length!=n.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||i[s]!==e[s])return!1}return!0}(l.params,h.params)){const b=[],T=s.matchStyles(l.value,l.params,b),S=s.matchStyles(h.value,h.params,b);b.length?this._engine.reportError(b):this._engine.afterFlush(()=>{Mb(e,T),ep(e,S)})}return}const g=vu(this._engine.playersByElement,e,[]);g.forEach(b=>{b.namespaceId==this.id&&b.triggerName==t&&b.queued&&b.destroy()});let v=s.matchTransition(l.value,h.value,e,h.params),y=!1;if(!v){if(!r)return;v=s.fallbackTransition,y=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:v,fromState:l,toState:h,player:o,isFallbackTransition:y}),y||(wh(e,NX),o.onStart(()=>{Xw(e,NX)})),o.onDone(()=>{let b=this.players.indexOf(o);b>=0&&this.players.splice(b,1);const T=this._engine.playersByElement.get(e);if(T){let S=T.indexOf(o);S>=0&&T.splice(S,1)}}),this.players.push(o),g.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,sO,!0);n.forEach(r=>{if(r[Th])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,n,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((l,h)=>{if(o.set(h,l.value),this._triggers.has(h)){const f=this.trigger(e,h,u1,r);f&&a.push(f)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),n&&cv(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers.get(o).fallbackTransition,h=n.get(o)||ZG,f=new qG(u1),m=new YG(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:h,toState:f,player:m,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(n.totalAnimations){const s=n.players.length?n.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(n.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)n.markElementAsRemoved(this.id,e,!1,t);else{const s=e[Th];(!s||s===BX)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){wh(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const s=n.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==n.triggerName){const l=DG(s,n.triggerName,n.fromState.value,n.toState.value);l._data=e,EG(n.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(n)}),this._queue=[],t.sort((n,r)=>{const s=n.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(n=>n.element===e)||t,t}}class CAe{constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new SAe(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,r=this.namespacesByHostElement;if(n.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const l=r.get(a);if(l){const h=n.indexOf(l);n.splice(h+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||n.unshift(e)}else n.push(e);return r.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n)for(let r of n.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,n,r){if(_O(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,n,r),!0}return!1}insertNode(e,t,n,r){if(!_O(t))return;const s=t[Th];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),wh(e,WG)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Xw(e,WG))}removeNode(e,t,n,r){if(_O(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,n,r,s){this.collectedLeaveElements.push(t),t[Th]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,n,r,s){return _O(t)?this._fetchNamespace(e).listen(t,n,r,s):()=>{}}_buildInstruction(e,t,n,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,sO,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,LG,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return cv(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[Th];if(t&&t.setForRemoval){if(e[Th]=BX,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(WG)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)wh(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?cv(t).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(e){throw function CEe(i){return new c.vHH(3402,!1)}()}_flushAnimations(e,t){const n=new pO,r=[],s=new Map,o=[],a=new Map,l=new Map,h=new Map,f=new Set;this.disabledNodes.forEach(Z=>{f.add(Z);const he=this.driver.query(Z,".ng-animate-queued",!0);for(let me=0;me<he.length;me++)f.add(he[me])});const m=this.bodyNode,g=Array.from(this.statesByElement.keys()),v=VX(g,this.collectedEnterElements),y=new Map;let b=0;v.forEach((Z,he)=>{const me=FG+b++;y.set(he,me),Z.forEach(ce=>wh(ce,me))});const T=[],S=new Set,C=new Set;for(let Z=0;Z<this.collectedLeaveElements.length;Z++){const he=this.collectedLeaveElements[Z],me=he[Th];me&&me.setForRemoval&&(T.push(he),S.add(he),me.hasAnimation?this.driver.query(he,".ng-star-inserted",!0).forEach(ce=>S.add(ce)):C.add(he))}const R=new Map,I=VX(g,Array.from(S));I.forEach((Z,he)=>{const me=iO+b++;R.set(he,me),Z.forEach(ce=>wh(ce,me))}),e.push(()=>{v.forEach((Z,he)=>{const me=y.get(he);Z.forEach(ce=>Xw(ce,me))}),I.forEach((Z,he)=>{const me=R.get(he);Z.forEach(ce=>Xw(ce,me))}),T.forEach(Z=>{this.processLeaveNode(Z)})});const L=[],N=[];for(let Z=this._namespaceList.length-1;Z>=0;Z--)this._namespaceList[Z].drainQueuedTransitions(t).forEach(me=>{const ce=me.player,be=me.element;if(L.push(ce),this.collectedEnterElements.length){const Ie=be[Th];if(Ie&&Ie.setForMove){if(Ie.previousTriggersValues&&Ie.previousTriggersValues.has(me.triggerName)){const pt=Ie.previousTriggersValues.get(me.triggerName),Wt=this.statesByElement.get(me.element);if(Wt&&Wt.has(me.triggerName)){const It=Wt.get(me.triggerName);It.value=pt,Wt.set(me.triggerName,It)}}return void ce.destroy()}}const Ge=!m||!this.driver.containsElement(m,be),Ee=R.get(be),mt=y.get(be),it=this._buildInstruction(me,n,mt,Ee,Ge);if(it.errors&&it.errors.length)return void N.push(it);if(Ge)return ce.onStart(()=>Mb(be,it.fromStyles)),ce.onDestroy(()=>ep(be,it.toStyles)),void r.push(ce);if(me.isFallbackTransition)return ce.onStart(()=>Mb(be,it.fromStyles)),ce.onDestroy(()=>ep(be,it.toStyles)),void r.push(ce);const Gt=[];it.timelines.forEach(Ie=>{Ie.stretchStartingKeyframe=!0,this.disabledNodes.has(Ie.element)||Gt.push(Ie)}),it.timelines=Gt,n.append(be,it.timelines),o.push({instruction:it,player:ce,element:be}),it.queriedElements.forEach(Ie=>vu(a,Ie,[]).push(ce)),it.preStyleProps.forEach((Ie,pt)=>{if(Ie.size){let Wt=l.get(pt);Wt||l.set(pt,Wt=new Set),Ie.forEach((It,wn)=>Wt.add(wn))}}),it.postStyleProps.forEach((Ie,pt)=>{let Wt=h.get(pt);Wt||h.set(pt,Wt=new Set),Ie.forEach((It,wn)=>Wt.add(wn))})});if(N.length){const Z=[];N.forEach(he=>{Z.push(function EEe(i,e){return new c.vHH(3505,!1)}())}),L.forEach(he=>he.destroy()),this.reportError(Z)}const U=new Map,k=new Map;o.forEach(Z=>{const he=Z.element;n.has(he)&&(k.set(he,he),this._beforeAnimationBuild(Z.player.namespaceId,Z.instruction,U))}),r.forEach(Z=>{const he=Z.element;this._getPreviousPlayers(he,!1,Z.namespaceId,Z.triggerName,null).forEach(ce=>{vu(U,he,[]).push(ce),ce.destroy()})});const z=T.filter(Z=>zX(Z,l,h)),K=new Map;UX(K,this.driver,C,h,ym).forEach(Z=>{zX(Z,l,h)&&z.push(Z)});const fe=new Map;v.forEach((Z,he)=>{UX(fe,this.driver,new Set(Z),l,"!")}),z.forEach(Z=>{const he=K.get(Z),me=fe.get(Z);K.set(Z,new Map([...Array.from(he?.entries()??[]),...Array.from(me?.entries()??[])]))});const ie=[],ne=[],le={};o.forEach(Z=>{const{element:he,player:me,instruction:ce}=Z;if(n.has(he)){if(f.has(he))return me.onDestroy(()=>ep(he,ce.toStyles)),me.disabled=!0,me.overrideTotalTime(ce.totalTime),void r.push(me);let be=le;if(k.size>1){let Ee=he;const mt=[];for(;Ee=Ee.parentNode;){const it=k.get(Ee);if(it){be=it;break}mt.push(Ee)}mt.forEach(it=>k.set(it,be))}const Ge=this._buildAnimation(me.namespaceId,ce,U,s,fe,K);if(me.setRealPlayer(Ge),be===le)ie.push(me);else{const Ee=this.playersByElement.get(be);Ee&&Ee.length&&(me.parentPlayer=cv(Ee)),r.push(me)}}else Mb(he,ce.fromStyles),me.onDestroy(()=>ep(he,ce.toStyles)),ne.push(me),f.has(he)&&r.push(me)}),ne.forEach(Z=>{const he=s.get(Z.element);if(he&&he.length){const me=cv(he);Z.setRealPlayer(me)}}),r.forEach(Z=>{Z.parentPlayer?Z.syncPlayerEvents(Z.parentPlayer):Z.destroy()});for(let Z=0;Z<T.length;Z++){const he=T[Z],me=he[Th];if(Xw(he,iO),me&&me.hasAnimation)continue;let ce=[];if(a.size){let Ge=a.get(he);Ge&&Ge.length&&ce.push(...Ge);let Ee=this.driver.query(he,LG,!0);for(let mt=0;mt<Ee.length;mt++){let it=a.get(Ee[mt]);it&&it.length&&ce.push(...it)}}const be=ce.filter(Ge=>!Ge.destroyed);be.length?RAe(this,he,be):this.processLeaveNode(he)}return T.length=0,ie.forEach(Z=>{this.players.push(Z),Z.onDone(()=>{Z.destroy();const he=this.players.indexOf(Z);this.players.splice(he,1)}),Z.play()}),ie}elementContainsData(e,t){let n=!1;const r=t[Th];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==u1;a.forEach(h=>{h.queued||!l&&h.triggerName!=r||o.push(h)})}}return(n||r)&&(o=o.filter(a=>!(n&&n!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,n){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const h=l.element,f=h!==s,m=vu(n,h,[]);this._getPreviousPlayers(h,f,o,a,t.toState).forEach(v=>{const y=v.getRealPlayer();y.beforeDestroy&&y.beforeDestroy(),v.destroy(),m.push(v)})}Mb(s,t.fromStyles)}_buildAnimation(e,t,n,r,s,o){const a=t.triggerName,l=t.element,h=[],f=new Set,m=new Set,g=t.timelines.map(y=>{const b=y.element;f.add(b);const T=b[Th];if(T&&T.removedBeforeQueried)return new SE(y.duration,y.delay);const S=b!==l,C=function IAe(i){const e=[];return GX(i,e),e}((n.get(b)||wAe).map(U=>U.getRealPlayer())).filter(U=>!!U.element&&U.element===b),R=s.get(b),I=o.get(b),L=pX(0,this._normalizer,0,y.keyframes,R,I),N=this._buildPlayer(y,L,C);if(y.subTimeline&&r&&m.add(b),S){const U=new YG(e,a,b);U.setRealPlayer(N),h.push(U)}return N});h.forEach(y=>{vu(this.playersByQueriedElement,y.element,[]).push(y),y.onDone(()=>function EAe(i,e,t){let n=i.get(e);if(n){if(n.length){const r=n.indexOf(t);n.splice(r,1)}0==n.length&&i.delete(e)}return n}(this.playersByQueriedElement,y.element,y))}),f.forEach(y=>wh(y,wX));const v=cv(g);return v.onDestroy(()=>{f.forEach(y=>Xw(y,wX)),ep(l,t.toStyles)}),m.forEach(y=>{vu(r,y,[]).push(v)}),v}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new SE(e.duration,e.delay)}}class YG{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new SE,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(r=>EG(e,n,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){vu(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function _O(i){return i&&1===i.nodeType}function jX(i,e){const t=i.style.display;return i.style.display=e??"none",t}function UX(i,e,t,n,r){const s=[];t.forEach(l=>s.push(jX(l)));const o=[];n.forEach((l,h)=>{const f=new Map;l.forEach(m=>{const g=e.computeStyle(h,m,r);f.set(m,g),(!g||0==g.length)&&(h[Th]=MAe,o.push(h))}),i.set(h,f)});let a=0;return t.forEach(l=>jX(l,s[a++])),o}function VX(i,e){const t=new Map;if(i.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const h=a.parentNode;return l=t.has(h)?h:r.has(h)?1:o(h),s.set(a,l),l}return e.forEach(a=>{const l=o(a);1!==l&&t.get(l).push(a)}),t}function wh(i,e){i.classList?.add(e)}function Xw(i,e){i.classList?.remove(e)}function RAe(i,e,t){cv(t).onDone(()=>i.processLeaveNode(e))}function GX(i,e){for(let t=0;t<i.length;t++){const n=i[t];n instanceof N5?GX(n.players,e):e.push(n)}}function zX(i,e,t){const n=t.get(i);if(!n)return!1;let r=e.get(i);return r?n.forEach(s=>r.add(s)):e.set(i,n),t.delete(i),!0}class vO{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new CAe(e,t,n),this._timelineEngine=new vAe(e,t,n),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,n,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],f=BG(this._driver,s,l,[]);if(l.length)throw function gEe(i,e){return new c.vHH(3404,!1)}();a=function pAe(i,e,t){return new mAe(i,e,t)}(r,f,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}onRemove(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,r){if("@"==n.charAt(0)){const[s,o]=mX(n);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}listen(e,t,n,r,s){if("@"==n.charAt(0)){const[o,a]=mX(n);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,n,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let LAe=(()=>{class i{constructor(t,n,r){this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;let s=i.initialStylesByElement.get(t);s||i.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&ep(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(ep(this._element,this._initialStyles),this._endStyles&&(ep(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(Mb(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Mb(this._element,this._endStyles),this._endStyles=null),ep(this._element,this._initialStyles),this._state=3)}}return i.initialStylesByElement=new WeakMap,i})();function KG(i){let e=null;return i.forEach((t,n)=>{(function OAe(i){return"display"===i||"position"===i})(n)&&(e=e||new Map,e.set(n,t))}),e}class HX{constructor(e,t,n,r){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,r)=>{"offset"!==r&&e.set(r,this._finished?n:DX(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class kAe{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return yX(e,t)}getParentElement(e){return IG(e)}query(e,t,n){return bX(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,r,s,o=[]){const l={duration:n,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const h=new Map,f=o.filter(v=>v instanceof HX);(function UEe(i,e){return 0===i||0===e})(n,r)&&f.forEach(v=>{v.currentSnapshot.forEach((y,b)=>h.set(b,y))});let m=function kEe(i){return i.length?i[0]instanceof Map?i:i.map(e=>MX(e)):[]}(t).map(v=>hv(v));m=function VEe(i,e,t){if(t.size&&e.length){let n=e[0],r=[];if(t.forEach((s,o)=>{n.has(o)||r.push(o),n.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,DX(i,a)))}}return e}(e,m,h);const g=function FAe(i,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=KG(e[0]),e.length>1&&(n=KG(e[e.length-1]))):e instanceof Map&&(t=KG(e)),t||n?new LAe(i,t,n):null}(e,m);return new HX(e,m,l,g)}}let NAe=(()=>{class i extends F5{constructor(t,n){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(n.body,{id:"0",encapsulation:c.ifc.None,styles:[],data:{animation:[]}})}build(t){const n=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?O5(t):t;return WX(this._renderer,null,n,"register",[r]),new BAe(n,this._renderer)}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(c.FYo),c.LFG(Oe))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})();class BAe extends class Mte{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new jAe(this._id,e,t||{},this._renderer)}}class jAe{constructor(e,t,n,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return WX(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function WX(i,e,t,n,r){return i.setProperty(e,`@@${t}:${n}`,r)}const qX="@.disabled";let UAe=(()=>{class i{constructor(t,n,r){this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,n){const s=this.delegate.createRenderer(t,n);if(!(t&&n&&n.data&&n.data.animation)){let f=this._rendererCache.get(s);return f||(f=new ZX("",s,this.engine),this._rendererCache.set(s,f)),f}const o=n.id,a=n.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=f=>{Array.isArray(f)?f.forEach(l):this.engine.registerTrigger(o,a,t,f.name,f)};return n.data.animation.forEach(l),new VAe(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,r){t>=0&&t<this._microtaskId?this._zone.run(()=>n(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(c.FYo),c.LFG(vO),c.LFG(c.R0b))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})();class ZX{constructor(e,t,n){this.namespaceId=e,this.delegate=t,this.engine=n,this.destroyNode=this.delegate.destroyNode?r=>t.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,r=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,r){this.delegate.setStyle(e,t,n,r)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==qX?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class VAe extends ZX{constructor(e,t,n,r){super(t,n,r),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==qX?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const r=function GAe(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function zAe(i){const e=i.indexOf(".");return[i.substring(0,e),i.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(e,t,n)}}let HAe=(()=>{class i extends vO{constructor(t,n,r,s){super(t.body,n,r)}ngOnDestroy(){this.flush()}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(Oe),c.LFG(PG),c.LFG(zG),c.LFG(c.z2F))},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac}),i})();const YX=[{provide:F5,useClass:NAe},{provide:zG,useFactory:function WAe(){return new uAe}},{provide:vO,useClass:HAe},{provide:c.FYo,useFactory:function qAe(i,e,t){return new UAe(i,e,t)},deps:[vs,vO,c.R0b]}],XG=[{provide:PG,useFactory:()=>new kAe},{provide:c.QbO,useValue:"BrowserAnimations"},...YX],KX=[{provide:PG,useClass:xX},{provide:c.QbO,useValue:"NoopAnimations"},...YX];let ZAe=(()=>{class i{static withConfig(t){return{ngModule:i,providers:t.disableAnimations?KX:XG}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({providers:XG,imports:[zd]}),i})(),i$=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[S3]}),i})(),mDe=(()=>{class i{constructor(t,n){ar(n)&&!t&&console.warn("Warning: Flex Layout loaded on the server without FlexLayoutServerModule")}static withConfig(t,n=[]){return{ngModule:i,providers:t.serverLoaded?[{provide:pd,useValue:{...C3,...t}},{provide:E3,useValue:n,multi:!0},{provide:ET,useValue:!0}]:[{provide:pd,useValue:{...C3,...t}},{provide:E3,useValue:n,multi:!0}]}}}return i.\u0275fac=function(t){return new(t||i)(c.LFG(ET),c.LFG(c.Lbi))},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[d6,v6,i$,d6,v6,i$]}),i})();const bDe={provide:new c.OlP("mat-select-scroll-strategy"),deps:[fd],useFactory:function yDe(i){return()=>i.scrollStrategies.reposition()}};let xDe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({providers:[bDe],imports:[or,xE,P5,Qr,yE,eV,P5,Qr]}),i})(),$G=(()=>{class i{constructor(){this.changes=new Bn.x,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(t,n,r)=>{if(0==r||0==n)return`0 of ${r}`;const s=t*n;return`${s+1} \u2013 ${s<(r=Math.max(r,0))?Math.min(s+n,r):s+n} of ${r}`}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const CDe={provide:$G,deps:[[new c.FiY,new c.tp0,$G]],useFactory:function SDe(i){return i||new $G}};let EDe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({providers:[CDe],imports:[or,j5,xDe,z5,Qr]}),i})(),a$=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({}),i})(),VDe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[sP,Qr,t3,a$,Qr,a$]}),i})(),QDe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i}),i.\u0275inj=c.cJS({imports:[or,Qr,Qr]}),i})();function JDe(i,e){1&i&&(c.TgZ(0,"span",5)(1,"mat-icon",6),c._uU(2,"check"),c.qZA()())}const eRe=function(i){return{background:i}};function tRe(i,e){if(1&i){const t=c.EpF();c.TgZ(0,"mat-card",2),c.NdJ("click",function(){const s=c.CHM(t).$implicit,o=c.oxw();return c.KtG(o.selectProperty(s))}),c._UZ(1,"span",3),c.YNc(2,JDe,3,0,"span",4),c.qZA()}if(2&i){const t=e.$implicit,n=c.oxw();c.s9C("matTooltip",t.name),c.Q6J("matTooltipPosition","above"),c.xp6(1),c.Q6J("ngStyle",c.VKq(4,eRe,n.gameService.checkCardColorDistrict(t.district))),c.xp6(1),c.Q6J("ngIf",t.exchangeSelected)}}let u$=(()=>{class i{constructor(t){this.gameService=t,this.playerId="",this.imInExchange=!1}ngOnInit(){}getPlayerProps(){return this.gameService.sortProperties(this.gameService.gameTable.cards.filter(t=>t.owner==this.playerId))}selectProperty(t){this.imInExchange?t.exchangeSelected=!t.exchangeSelected:""==this.gameService.playerWhoWonId&&this.gameService.openCardDialog(t)}}return i.\u0275fac=function(t){return new(t||i)(c.Y36(wd))},i.\u0275cmp=c.Xpm({type:i,selectors:[["app-player-properties"]],inputs:{playerId:"playerId",imInExchange:"imInExchange"},decls:2,vars:1,consts:[["fxLayout","row",1,"propertiesContainer"],["class","property",3,"matTooltipPosition","matTooltip","click",4,"ngFor","ngForOf"],[1,"property",3,"matTooltipPosition","matTooltip","click"],[1,"propDistrict",3,"ngStyle"],["class","chosenProperty","fxLayoutAlign","center center",4,"ngIf"],["fxLayoutAlign","center center",1,"chosenProperty"],["fxLayoutAlign","center center"]],template:function(t,n){1&t&&(c.TgZ(0,"div",0),c.YNc(1,tRe,3,6,"mat-card",1),c.qZA()),2&t&&(c.xp6(1),c.Q6J("ngForOf",n.getPlayerProps()))},dependencies:[xr,qr,Wa,uP,hP,w0,S_,mP,IE],styles:[".propertiesContainer[_ngcontent-%COMP%]{flex-wrap:wrap;width:250px;padding:10px}.propertiesContainer[_ngcontent-%COMP%]   .property[_ngcontent-%COMP%]{width:10px;height:15px;position:relative;margin-left:10px;margin-top:10px;cursor:pointer}.propertiesContainer[_ngcontent-%COMP%]   .property[_ngcontent-%COMP%]   .propDistrict[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:15px;width:100%;border-radius:5px 5px 0 0}.propertiesContainer[_ngcontent-%COMP%]   .chosenProperty[_ngcontent-%COMP%]{width:15px;height:15px;position:absolute;top:-5px;left:-5px;border-radius:50%;background:#97e997}.propertiesContainer[_ngcontent-%COMP%]   .chosenProperty[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px}"]}),i})(),nRe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=c.oAB({type:i,bootstrap:[YCe]}),i.\u0275inj=c.cJS({imports:[zd,ZCe,Td.hO.initializeApp(dX_firebaseConfig),SJ(()=>O4()),ZAe,Sme,j5,Hte,jme,z5,yme,kte,mDe,cre,VDe,EDe,uxe,QDe]}),i})();c.B6R(O6,function(){return[xr,qr,gY,sL,M7,CE,hP,DA,pV,rV,gL,w0,S_,IE,u$]},[]),c.B6R(GZ,function(){return[qr,CE,S_,u$]},[]),(0,c.G48)(),Gd().bootstrapModule(nRe).catch(i=>console.error(i))},5867:(kn,At,se)=>{se.d(At,{C6:()=>$.getApps,KN:()=>$.registerVersion,Mq:()=>$.getApp});var $=se(9681);(0,$.registerVersion)("firebase","9.9.3","app")},127:(kn,At,se)=>{se.d(At,{Z:()=>$.Z});var $=se(3942);$.Z.registerVersion("firebase","9.9.3","app-compat")},5881:(kn,At,se)=>{se.r(At);var $=se(5861),c=se(3942),J=se(6457),je=se(2090),Tt=(se(9681),se(1877),se(4859));function Oe(){return window}function Me(){return(Me=(0,$.Z)(function*(Re,Se,ye){var gt;const{BuildInfo:Xt}=Oe();(0,J.aq)(Se.sessionId,"AuthEvent did not contain a session ID");const St=yield et(Se.sessionId),rn={};return(0,J.ar)()?rn.ibi=Xt.packageName:(0,J.as)()?rn.apn=Xt.packageName:(0,J.at)(Re,"operation-not-supported-in-this-environment"),Xt.displayName&&(rn.appDisplayName=Xt.displayName),rn.sessionId=St,(0,J.au)(Re,ye,Se.type,void 0,null!==(gt=Se.eventId)&&void 0!==gt?gt:void 0,rn)})).apply(this,arguments)}function Kt(){return(Kt=(0,$.Z)(function*(Re){const{BuildInfo:Se}=Oe(),ye={};(0,J.ar)()?ye.iosBundleId=Se.packageName:(0,J.as)()?ye.androidPackageName=Se.packageName:(0,J.at)(Re,"operation-not-supported-in-this-environment"),yield(0,J.av)(Re,ye)})).apply(this,arguments)}function Pn(){return(Pn=(0,$.Z)(function*(Re,Se,ye){const{cordova:gt}=Oe();let Xt=()=>{};try{yield new Promise((St,rn)=>{let Zn=null;function xi(){var bi;St();const ji=null===(bi=gt.plugins.browsertab)||void 0===bi?void 0:bi.close;"function"==typeof ji&&ji(),"function"==typeof ye?.close&&ye.close()}function Er(){Zn||(Zn=window.setTimeout(()=>{rn((0,J.aw)(Re,"redirect-cancelled-by-user"))},2e3))}function tr(){"visible"===document?.visibilityState&&Er()}Se.addPassiveListener(xi),document.addEventListener("resume",Er,!1),(0,J.as)()&&document.addEventListener("visibilitychange",tr,!1),Xt=()=>{Se.removePassiveListener(xi),document.removeEventListener("resume",Er,!1),document.removeEventListener("visibilitychange",tr,!1),Zn&&window.clearTimeout(Zn)}})}finally{Xt()}})).apply(this,arguments)}function et(Re){return vn.apply(this,arguments)}function vn(){return(vn=(0,$.Z)(function*(Re){const Se=_n(Re),ye=yield crypto.subtle.digest("SHA-256",Se);return Array.from(new Uint8Array(ye)).map(Xt=>Xt.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function _n(Re){if((0,J.aq)(/[0-9a-zA-Z]+/.test(Re),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(Re);const Se=new ArrayBuffer(Re.length),ye=new Uint8Array(Se);for(let gt=0;gt<Re.length;gt++)ye[gt]=Re.charCodeAt(gt);return ye}class Dt extends J.aA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(Se=>{this.resolveInialized=Se})}addPassiveListener(Se){this.passiveListeners.add(Se)}removePassiveListener(Se){this.passiveListeners.delete(Se)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(Se){return this.resolveInialized(),this.passiveListeners.forEach(ye=>ye(Se)),super.onEvent(Se)}initialized(){var Se=this;return(0,$.Z)(function*(){yield Se.initPromise})()}}function ze(Re){return ot.apply(this,arguments)}function ot(){return(ot=(0,$.Z)(function*(Re){const Se=yield He()._get(Ze(Re));return Se&&(yield He()._remove(Ze(Re))),Se})).apply(this,arguments)}function ke(){const Re=[],Se="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let ye=0;ye<20;ye++){const gt=Math.floor(Math.random()*Se.length);Re.push(Se.charAt(gt))}return Re.join("")}function He(){return(0,J.ay)(J.b)}function Ze(Re){return(0,J.az)("authEvent",Re.config.apiKey,Re.name)}function zt(Re){if(!Re?.includes("?"))return{};const[Se,...ye]=Re.split("?");return(0,je.zd)(ye.join("?"))}function nn(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,J.aw)("no-auth-event")}}function Mi(){var Re;return(null===(Re=self?.location)||void 0===Re?void 0:Re.protocol)||null}function gr(Re=(0,je.z$)()){return!("file:"!==Mi()&&"ionic:"!==Mi()&&"capacitor:"!==Mi()||!Re.toLowerCase().match(/iphone|ipad|ipod|android/))}function ha(){try{const Re=self.localStorage,Se=J.aI();if(Re)return Re.setItem(Se,"1"),Re.removeItem(Se),!function gl(Re=(0,je.z$)()){return function oo(){return(0,je.w1)()&&11===document?.documentMode}()||function Cr(Re=(0,je.z$)()){return/Edge\/\d+/.test(Re)}(Re)}()||(0,je.hl)()}catch{return Ca()&&(0,je.hl)()}return!1}function Ca(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Br(){return(function Vi(){return"http:"===Mi()||"https:"===Mi()}()||(0,je.ru)()||gr())&&!function za(){return(0,je.b$)()||(0,je.UG)()}()&&ha()&&!Ca()}function _l(){return gr()&&typeof document<"u"}function ao(){return(ao=(0,$.Z)(function*(){return!!_l()&&new Promise(Re=>{const Se=setTimeout(()=>{Re(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(Se),Re(!0)})})})).apply(this,arguments)}const Li={LOCAL:"local",NONE:"none",SESSION:"session"},ms=J.ax,To="persistence";function vr(Re){return Os.apply(this,arguments)}function Os(){return(Os=(0,$.Z)(function*(Re){yield Re._initializationPromise;const Se=Ai(),ye=J.az(To,Re.config.apiKey,Re.name);Se&&Se.setItem(ye,Re._getPersistence())})).apply(this,arguments)}function Ai(){var Re;try{return(null===(Re=function _r(){return typeof window<"u"?window:null}())||void 0===Re?void 0:Re.sessionStorage)||null}catch{return null}}const un=J.ax;class Dn{constructor(){this.browserResolver=J.ay(J.k),this.cordovaResolver=J.ay(class Ni{constructor(){this._redirectPersistence=J.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=J.aB,this._overrideRedirectResult=J.aC}_initialize(Se){var ye=this;return(0,$.Z)(function*(){const gt=Se._key();let Xt=ye.eventManagers.get(gt);return Xt||(Xt=new Dt(Se),ye.eventManagers.set(gt,Xt),ye.attachCallbackListeners(Se,Xt)),Xt})()}_openPopup(Se){(0,J.at)(Se,"operation-not-supported-in-this-environment")}_openRedirect(Se,ye,gt,Xt){var St=this;return(0,$.Z)(function*(){!function dt(Re){var Se,ye,gt,Xt,St,rn,Zn,xi,Er,tr;const bi=Oe();(0,J.ax)("function"==typeof(null===(Se=bi?.universalLinks)||void 0===Se?void 0:Se.subscribe),Re,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,J.ax)(typeof(null===(ye=bi?.BuildInfo)||void 0===ye?void 0:ye.packageName)<"u",Re,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,J.ax)("function"==typeof(null===(St=null===(Xt=null===(gt=bi?.cordova)||void 0===gt?void 0:gt.plugins)||void 0===Xt?void 0:Xt.browsertab)||void 0===St?void 0:St.openUrl),Re,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,J.ax)("function"==typeof(null===(xi=null===(Zn=null===(rn=bi?.cordova)||void 0===rn?void 0:rn.plugins)||void 0===Zn?void 0:Zn.browsertab)||void 0===xi?void 0:xi.isAvailable),Re,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,J.ax)("function"==typeof(null===(tr=null===(Er=bi?.cordova)||void 0===Er?void 0:Er.InAppBrowser)||void 0===tr?void 0:tr.open),Re,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(Se);const rn=yield St._initialize(Se);yield rn.initialized(),rn.resetRedirect(),(0,J.aD)(),yield St._originValidation(Se);const Zn=function wt(Re,Se,ye=null){return{type:Se,eventId:ye,urlResponse:null,sessionId:ke(),postBody:null,tenantId:Re.tenantId,error:(0,J.aw)(Re,"no-auth-event")}}(Se,gt,Xt);yield function an(Re,Se){return He()._set(Ze(Re),Se)}(Se,Zn);const xi=yield function Te(Re,Se,ye){return Me.apply(this,arguments)}(Se,Zn,ye),Er=yield function Ot(Re){const{cordova:Se}=Oe();return new Promise(ye=>{Se.plugins.browsertab.isAvailable(gt=>{let Xt=null;gt?Se.plugins.browsertab.openUrl(Re):Xt=Se.InAppBrowser.open(Re,(0,J.ap)()?"_blank":"_system","location=yes"),ye(Xt)})})}(xi);return function yt(Re,Se,ye){return Pn.apply(this,arguments)}(Se,rn,Er)})()}_isIframeWebStorageSupported(Se,ye){throw new Error("Method not implemented.")}_originValidation(Se){const ye=Se._key();return this.originValidationPromises[ye]||(this.originValidationPromises[ye]=function Ne(Re){return Kt.apply(this,arguments)}(Se)),this.originValidationPromises[ye]}attachCallbackListeners(Se,ye){const{universalLinks:gt,handleOpenURL:Xt,BuildInfo:St}=Oe(),rn=setTimeout((0,$.Z)(function*(){yield ze(Se),ye.onEvent(nn())}),500),Zn=function(){var tr=(0,$.Z)(function*(bi){clearTimeout(rn);const ji=yield ze(Se);let Hl=null;ji&&bi?.url&&(Hl=function _t(Re,Se){var ye,gt;const Xt=function Xe(Re){const Se=zt(Re),ye=Se.link?decodeURIComponent(Se.link):void 0,gt=zt(ye).link,Xt=Se.deep_link_id?decodeURIComponent(Se.deep_link_id):void 0;return zt(Xt).link||Xt||gt||ye||Re}(Se);if(Xt.includes("/__/auth/callback")){const St=zt(Xt),rn=St.firebaseError?function ut(Re){try{return JSON.parse(Re)}catch{return null}}(decodeURIComponent(St.firebaseError)):null,Zn=null===(gt=null===(ye=rn?.code)||void 0===ye?void 0:ye.split("auth/"))||void 0===gt?void 0:gt[1],xi=Zn?(0,J.aw)(Zn):null;return xi?{type:Re.type,eventId:Re.eventId,tenantId:Re.tenantId,error:xi,urlResponse:null,sessionId:null,postBody:null}:{type:Re.type,eventId:Re.eventId,tenantId:Re.tenantId,sessionId:Re.sessionId,urlResponse:Xt,postBody:null}}return null}(ji,bi.url)),ye.onEvent(Hl||nn())});return function(ji){return tr.apply(this,arguments)}}();typeof gt<"u"&&"function"==typeof gt.subscribe&&gt.subscribe(null,Zn);const xi=Xt,Er=`${St.packageName.toLowerCase()}://`;Oe().handleOpenURL=function(){var tr=(0,$.Z)(function*(bi){if(bi.toLowerCase().startsWith(Er)&&Zn({url:bi}),"function"==typeof xi)try{xi(bi)}catch(ji){console.error(ji)}});return function(bi){return tr.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=J.a,this._completeRedirectFn=J.aB,this._overrideRedirectResult=J.aC}_initialize(Se){var ye=this;return(0,$.Z)(function*(){return yield ye.selectUnderlyingResolver(),ye.assertedUnderlyingResolver._initialize(Se)})()}_openPopup(Se,ye,gt,Xt){var St=this;return(0,$.Z)(function*(){return yield St.selectUnderlyingResolver(),St.assertedUnderlyingResolver._openPopup(Se,ye,gt,Xt)})()}_openRedirect(Se,ye,gt,Xt){var St=this;return(0,$.Z)(function*(){return yield St.selectUnderlyingResolver(),St.assertedUnderlyingResolver._openRedirect(Se,ye,gt,Xt)})()}_isIframeWebStorageSupported(Se,ye){this.assertedUnderlyingResolver._isIframeWebStorageSupported(Se,ye)}_originValidation(Se){return this.assertedUnderlyingResolver._originValidation(Se)}get _shouldInitProactively(){return _l()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return un(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var Se=this;return(0,$.Z)(function*(){if(Se.underlyingResolver)return;const ye=yield function Un(){return ao.apply(this,arguments)}();Se.underlyingResolver=ye?Se.cordovaResolver:Se.browserResolver})()}}function Ea(Re){return Re.unwrap()}function li(Re){return yr(Re)}function yr(Re){const{_tokenResponse:Se}=Re instanceof je.ZR?Re.customData:Re;if(!Se)return null;if(!(Re instanceof je.ZR)&&"temporaryProof"in Se&&"phoneNumber"in Se)return J.P.credentialFromResult(Re);const ye=Se.providerId;if(!ye||ye===J.o.PASSWORD)return null;let gt;switch(ye){case J.o.GOOGLE:gt=J.Q;break;case J.o.FACEBOOK:gt=J.N;break;case J.o.GITHUB:gt=J.T;break;case J.o.TWITTER:gt=J.W;break;default:const{oauthIdToken:Xt,oauthAccessToken:St,oauthTokenSecret:rn,pendingToken:Zn,nonce:xi}=Se;return St||rn||Xt||Zn?Zn?ye.startsWith("saml.")?J.aL._create(ye,Zn):J.J._fromParams({providerId:ye,signInMethod:ye,pendingToken:Zn,idToken:Xt,accessToken:St}):new J.U(ye).credential({idToken:Xt,accessToken:St,rawNonce:xi}):null}return Re instanceof je.ZR?gt.credentialFromError(Re):gt.credentialFromResult(Re)}function br(Re,Se){return Se.catch(ye=>{throw ye instanceof je.ZR&&function lo(Re,Se){var ye,gt;const Xt=null===(ye=Se.customData)||void 0===ye?void 0:ye._tokenResponse;if("auth/multi-factor-auth-required"===(null===(gt=Se)||void 0===gt?void 0:gt.code))Se.resolver=new xe(Re,J.an(Re,Se));else if(Xt){const St=yr(Se),rn=Se;St&&(rn.credential=St,rn.tenantId=Xt.tenantId||void 0,rn.email=Xt.email||void 0,rn.phoneNumber=Xt.phoneNumber||void 0)}}(Re,ye),ye}).then(ye=>{const Xt=ye.user;return{operationType:ye.operationType,credential:li(ye),additionalUserInfo:J.al(ye),user:we.getOrCreate(Xt)}})}function Hi(Re,Se){return rs.apply(this,arguments)}function rs(){return(rs=(0,$.Z)(function*(Re,Se){const ye=yield Se;return{verificationId:ye.verificationId,confirm:gt=>br(Re,ye.confirm(gt))}})).apply(this,arguments)}class xe{constructor(Se,ye){this.resolver=ye,this.auth=function gs(Re){return Re.wrapped()}(Se)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(Se){return br(Ea(this.auth),this.resolver.resolveSignIn(Se))}}class we{constructor(Se){this._delegate=Se,this.multiFactor=J.ao(Se)}static getOrCreate(Se){return we.USER_MAP.has(Se)||we.USER_MAP.set(Se,new we(Se)),we.USER_MAP.get(Se)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(Se){return this._delegate.getIdTokenResult(Se)}getIdToken(Se){return this._delegate.getIdToken(Se)}linkAndRetrieveDataWithCredential(Se){return this.linkWithCredential(Se)}linkWithCredential(Se){var ye=this;return(0,$.Z)(function*(){return br(ye.auth,J.Z(ye._delegate,Se))})()}linkWithPhoneNumber(Se,ye){var gt=this;return(0,$.Z)(function*(){return Hi(gt.auth,J.l(gt._delegate,Se,ye))})()}linkWithPopup(Se){var ye=this;return(0,$.Z)(function*(){return br(ye.auth,J.d(ye._delegate,Se,Dn))})()}linkWithRedirect(Se){var ye=this;return(0,$.Z)(function*(){return yield vr(J.aE(ye.auth)),J.g(ye._delegate,Se,Dn)})()}reauthenticateAndRetrieveDataWithCredential(Se){return this.reauthenticateWithCredential(Se)}reauthenticateWithCredential(Se){var ye=this;return(0,$.Z)(function*(){return br(ye.auth,J._(ye._delegate,Se))})()}reauthenticateWithPhoneNumber(Se,ye){return Hi(this.auth,J.r(this._delegate,Se,ye))}reauthenticateWithPopup(Se){return br(this.auth,J.e(this._delegate,Se,Dn))}reauthenticateWithRedirect(Se){var ye=this;return(0,$.Z)(function*(){return yield vr(J.aE(ye.auth)),J.h(ye._delegate,Se,Dn)})()}sendEmailVerification(Se){return J.ab(this._delegate,Se)}unlink(Se){var ye=this;return(0,$.Z)(function*(){return yield J.ak(ye._delegate,Se),ye})()}updateEmail(Se){return J.ag(this._delegate,Se)}updatePassword(Se){return J.ah(this._delegate,Se)}updatePhoneNumber(Se){return J.u(this._delegate,Se)}updateProfile(Se){return J.af(this._delegate,Se)}verifyBeforeUpdateEmail(Se,ye){return J.ac(this._delegate,Se,ye)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}we.USER_MAP=new WeakMap;const ve=J.ax;let Ae=(()=>{class Re{constructor(ye,gt){if(this.app=ye,gt.isInitialized())return this._delegate=gt.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:Xt}=ye.options;ve(Xt,"invalid-api-key",{appName:ye.name}),ve(Xt,"invalid-api-key",{appName:ye.name});const St=typeof window<"u"?Dn:void 0;this._delegate=gt.initialize({options:{persistence:Ct(Xt,ye.name),popupRedirectResolver:St}}),this._delegate._updateErrorMap(J.B),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?we.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(ye){this._delegate.languageCode=ye}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(ye){this._delegate.tenantId=ye}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(ye,gt){J.G(this._delegate,ye,gt)}applyActionCode(ye){return J.a2(this._delegate,ye)}checkActionCode(ye){return J.a3(this._delegate,ye)}confirmPasswordReset(ye,gt){return J.a1(this._delegate,ye,gt)}createUserWithEmailAndPassword(ye,gt){var Xt=this;return(0,$.Z)(function*(){return br(Xt._delegate,J.a5(Xt._delegate,ye,gt))})()}fetchProvidersForEmail(ye){return this.fetchSignInMethodsForEmail(ye)}fetchSignInMethodsForEmail(ye){return J.aa(this._delegate,ye)}isSignInWithEmailLink(ye){return J.a8(this._delegate,ye)}getRedirectResult(){var ye=this;return(0,$.Z)(function*(){ve(Br(),ye._delegate,"operation-not-supported-in-this-environment");const gt=yield J.j(ye._delegate,Dn);return gt?br(ye._delegate,Promise.resolve(gt)):{credential:null,user:null}})()}addFrameworkForLogging(ye){!function er(Re,Se){(0,J.aE)(Re)._logFramework(Se)}(this._delegate,ye)}onAuthStateChanged(ye,gt,Xt){const{next:St,error:rn,complete:Zn}=Ce(ye,gt,Xt);return this._delegate.onAuthStateChanged(St,rn,Zn)}onIdTokenChanged(ye,gt,Xt){const{next:St,error:rn,complete:Zn}=Ce(ye,gt,Xt);return this._delegate.onIdTokenChanged(St,rn,Zn)}sendSignInLinkToEmail(ye,gt){return J.a7(this._delegate,ye,gt)}sendPasswordResetEmail(ye,gt){return J.a0(this._delegate,ye,gt||void 0)}setPersistence(ye){var gt=this;return(0,$.Z)(function*(){let Xt;switch(function Ls(Re,Se){ms(Object.values(Li).includes(Se),Re,"invalid-persistence-type"),(0,je.b$)()?ms(Se!==Li.SESSION,Re,"unsupported-persistence-type"):(0,je.UG)()?ms(Se===Li.NONE,Re,"unsupported-persistence-type"):Ca()?ms(Se===Li.NONE||Se===Li.LOCAL&&(0,je.hl)(),Re,"unsupported-persistence-type"):ms(Se===Li.NONE||ha(),Re,"unsupported-persistence-type")}(gt._delegate,ye),ye){case Li.SESSION:Xt=J.a;break;case Li.LOCAL:Xt=(yield J.ay(J.i)._isAvailable())?J.i:J.b;break;case Li.NONE:Xt=J.L;break;default:return J.at("argument-error",{appName:gt._delegate.name})}return gt._delegate.setPersistence(Xt)})()}signInAndRetrieveDataWithCredential(ye){return this.signInWithCredential(ye)}signInAnonymously(){return br(this._delegate,J.X(this._delegate))}signInWithCredential(ye){return br(this._delegate,J.Y(this._delegate,ye))}signInWithCustomToken(ye){return br(this._delegate,J.$(this._delegate,ye))}signInWithEmailAndPassword(ye,gt){return br(this._delegate,J.a6(this._delegate,ye,gt))}signInWithEmailLink(ye,gt){return br(this._delegate,J.a9(this._delegate,ye,gt))}signInWithPhoneNumber(ye,gt){return Hi(this._delegate,J.s(this._delegate,ye,gt))}signInWithPopup(ye){var gt=this;return(0,$.Z)(function*(){return ve(Br(),gt._delegate,"operation-not-supported-in-this-environment"),br(gt._delegate,J.c(gt._delegate,ye,Dn))})()}signInWithRedirect(ye){var gt=this;return(0,$.Z)(function*(){return ve(Br(),gt._delegate,"operation-not-supported-in-this-environment"),yield vr(gt._delegate),J.f(gt._delegate,ye,Dn)})()}updateCurrentUser(ye){return this._delegate.updateCurrentUser(ye)}verifyPasswordResetCode(ye){return J.a4(this._delegate,ye)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return Re.Persistence=Li,Re})();function Ce(Re,Se,ye){let gt=Re;"function"!=typeof Re&&({next:gt,error:Se,complete:ye}=Re);const Xt=gt;return{next:rn=>Xt(rn&&we.getOrCreate(rn)),error:Se,complete:ye}}function Ct(Re,Se){const ye=function zl(Re,Se){const ye=Ai();if(!ye)return[];const gt=J.az(To,Re,Se);switch(ye.getItem(gt)){case Li.NONE:return[J.L];case Li.LOCAL:return[J.i,J.a];case Li.SESSION:return[J.a];default:return[]}}(Re,Se);if(typeof self<"u"&&!ye.includes(J.i)&&ye.push(J.i),typeof window<"u")for(const gt of[J.b,J.a])ye.includes(gt)||ye.push(gt);return ye.includes(J.L)||ye.push(J.L),ye}class $t{constructor(){this.providerId="phone",this._delegate=new J.P(Ea(c.Z.auth()))}static credential(Se,ye){return J.P.credential(Se,ye)}verifyPhoneNumber(Se,ye){return this._delegate.verifyPhoneNumber(Se,ye)}unwrap(){return this._delegate}}$t.PHONE_SIGN_IN_METHOD=J.P.PHONE_SIGN_IN_METHOD,$t.PROVIDER_ID=J.P.PROVIDER_ID;const Qn=J.ax;class Gi{constructor(Se,ye,gt=c.Z.app()){var Xt;Qn(null===(Xt=gt.options)||void 0===Xt?void 0:Xt.apiKey,"invalid-api-key",{appName:gt.name}),this._delegate=new J.R(Se,ye,gt.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function _s(Re){Re.INTERNAL.registerComponent(new Tt.wA("auth-compat",Se=>{const ye=Se.getProvider("app-compat").getImmediate(),gt=Se.getProvider("auth");return new Ae(ye,gt)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:J.A.EMAIL_SIGNIN,PASSWORD_RESET:J.A.PASSWORD_RESET,RECOVER_EMAIL:J.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:J.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:J.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:J.A.VERIFY_EMAIL}},EmailAuthProvider:J.M,FacebookAuthProvider:J.N,GithubAuthProvider:J.T,GoogleAuthProvider:J.Q,OAuthProvider:J.U,SAMLAuthProvider:J.V,PhoneAuthProvider:$t,PhoneMultiFactorGenerator:J.m,RecaptchaVerifier:Gi,TwitterAuthProvider:J.W,Auth:Ae,AuthCredential:J.H,Error:je.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),Re.registerVersion("@firebase/auth-compat","0.2.18")}(c.Z)},9751:(kn,At,se)=>{se.d(At,{y:()=>Oe});var $=se(930),c=se(727),J=se(8822),je=se(9635),Ke=se(2416),st=se(576),Tt=se(2806);let Oe=(()=>{class Ne{constructor(Ot){Ot&&(this._subscribe=Ot)}lift(Ot){const yt=new Ne;return yt.source=this,yt.operator=Ot,yt}subscribe(Ot,yt,Pn){const dt=function Me(Ne){return Ne&&Ne instanceof $.Lv||function Te(Ne){return Ne&&(0,st.m)(Ne.next)&&(0,st.m)(Ne.error)&&(0,st.m)(Ne.complete)}(Ne)&&(0,c.Nn)(Ne)}(Ot)?Ot:new $.Hp(Ot,yt,Pn);return(0,Tt.x)(()=>{const{operator:et,source:vn}=this;dt.add(et?et.call(dt,vn):vn?this._subscribe(dt):this._trySubscribe(dt))}),dt}_trySubscribe(Ot){try{return this._subscribe(Ot)}catch(yt){Ot.error(yt)}}forEach(Ot,yt){return new(yt=ct(yt))((Pn,dt)=>{const et=new $.Hp({next:vn=>{try{Ot(vn)}catch(_n){dt(_n),et.unsubscribe()}},error:dt,complete:Pn});this.subscribe(et)})}_subscribe(Ot){var yt;return null===(yt=this.source)||void 0===yt?void 0:yt.subscribe(Ot)}[J.L](){return this}pipe(...Ot){return(0,je.U)(Ot)(this)}toPromise(Ot){return new(Ot=ct(Ot))((yt,Pn)=>{let dt;this.subscribe(et=>dt=et,et=>Pn(et),()=>yt(dt))})}}return Ne.create=Kt=>new Ne(Kt),Ne})();function ct(Ne){var Kt;return null!==(Kt=Ne??Ke.v.Promise)&&void 0!==Kt?Kt:Promise}},7579:(kn,At,se)=>{se.d(At,{x:()=>Tt});var $=se(9751),c=se(727);const je=(0,se(3888).d)(ct=>function(){ct(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ke=se(8737),st=se(2806);let Tt=(()=>{class ct extends $.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Me){const Ne=new Oe(this,this);return Ne.operator=Me,Ne}_throwIfClosed(){if(this.closed)throw new je}next(Me){(0,st.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Ne of this.currentObservers)Ne.next(Me)}})}error(Me){(0,st.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Me;const{observers:Ne}=this;for(;Ne.length;)Ne.shift().error(Me)}})}complete(){(0,st.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Me}=this;for(;Me.length;)Me.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Me;return(null===(Me=this.observers)||void 0===Me?void 0:Me.length)>0}_trySubscribe(Me){return this._throwIfClosed(),super._trySubscribe(Me)}_subscribe(Me){return this._throwIfClosed(),this._checkFinalizedStatuses(Me),this._innerSubscribe(Me)}_innerSubscribe(Me){const{hasError:Ne,isStopped:Kt,observers:Ot}=this;return Ne||Kt?c.Lc:(this.currentObservers=null,Ot.push(Me),new c.w0(()=>{this.currentObservers=null,(0,Ke.P)(Ot,Me)}))}_checkFinalizedStatuses(Me){const{hasError:Ne,thrownError:Kt,isStopped:Ot}=this;Ne?Me.error(Kt):Ot&&Me.complete()}asObservable(){const Me=new $.y;return Me.source=this,Me}}return ct.create=(Te,Me)=>new Oe(Te,Me),ct})();class Oe extends Tt{constructor(Te,Me){super(),this.destination=Te,this.source=Me}next(Te){var Me,Ne;null===(Ne=null===(Me=this.destination)||void 0===Me?void 0:Me.next)||void 0===Ne||Ne.call(Me,Te)}error(Te){var Me,Ne;null===(Ne=null===(Me=this.destination)||void 0===Me?void 0:Me.error)||void 0===Ne||Ne.call(Me,Te)}complete(){var Te,Me;null===(Me=null===(Te=this.destination)||void 0===Te?void 0:Te.complete)||void 0===Me||Me.call(Te)}_subscribe(Te){var Me,Ne;return null!==(Ne=null===(Me=this.source)||void 0===Me?void 0:Me.subscribe(Te))&&void 0!==Ne?Ne:c.Lc}}},930:(kn,At,se)=>{se.d(At,{Hp:()=>Pn,Lv:()=>Ne});var $=se(576),c=se(727),J=se(2416),je=se(7849),Ke=se(5032);const st=ct("C",void 0,void 0);function ct(Nt,Dt,wt){return{kind:Nt,value:Dt,error:wt}}var Te=se(3410),Me=se(2806);class Ne extends c.w0{constructor(Dt){super(),this.isStopped=!1,Dt?(this.destination=Dt,(0,c.Nn)(Dt)&&Dt.add(this)):this.destination=_n}static create(Dt,wt,an){return new Pn(Dt,wt,an)}next(Dt){this.isStopped?vn(function Oe(Nt){return ct("N",Nt,void 0)}(Dt),this):this._next(Dt)}error(Dt){this.isStopped?vn(function Tt(Nt){return ct("E",void 0,Nt)}(Dt),this):(this.isStopped=!0,this._error(Dt))}complete(){this.isStopped?vn(st,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Dt){this.destination.next(Dt)}_error(Dt){try{this.destination.error(Dt)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Kt=Function.prototype.bind;function Ot(Nt,Dt){return Kt.call(Nt,Dt)}class yt{constructor(Dt){this.partialObserver=Dt}next(Dt){const{partialObserver:wt}=this;if(wt.next)try{wt.next(Dt)}catch(an){dt(an)}}error(Dt){const{partialObserver:wt}=this;if(wt.error)try{wt.error(Dt)}catch(an){dt(an)}else dt(Dt)}complete(){const{partialObserver:Dt}=this;if(Dt.complete)try{Dt.complete()}catch(wt){dt(wt)}}}class Pn extends Ne{constructor(Dt,wt,an){let ze;if(super(),(0,$.m)(Dt)||!Dt)ze={next:Dt??void 0,error:wt??void 0,complete:an??void 0};else{let ot;this&&J.v.useDeprecatedNextContext?(ot=Object.create(Dt),ot.unsubscribe=()=>this.unsubscribe(),ze={next:Dt.next&&Ot(Dt.next,ot),error:Dt.error&&Ot(Dt.error,ot),complete:Dt.complete&&Ot(Dt.complete,ot)}):ze=Dt}this.destination=new yt(ze)}}function dt(Nt){J.v.useDeprecatedSynchronousErrorHandling?(0,Me.O)(Nt):(0,je.h)(Nt)}function vn(Nt,Dt){const{onStoppedNotification:wt}=J.v;wt&&Te.z.setTimeout(()=>wt(Nt,Dt))}const _n={closed:!0,next:Ke.Z,error:function et(Nt){throw Nt},complete:Ke.Z}},727:(kn,At,se)=>{se.d(At,{Lc:()=>st,w0:()=>Ke,Nn:()=>Tt});var $=se(576);const J=(0,se(3888).d)(ct=>function(Me){ct(this),this.message=Me?`${Me.length} errors occurred during unsubscription:\n${Me.map((Ne,Kt)=>`${Kt+1}) ${Ne.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Me});var je=se(8737);class Ke{constructor(Te){this.initialTeardown=Te,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Te;if(!this.closed){this.closed=!0;const{_parentage:Me}=this;if(Me)if(this._parentage=null,Array.isArray(Me))for(const Ot of Me)Ot.remove(this);else Me.remove(this);const{initialTeardown:Ne}=this;if((0,$.m)(Ne))try{Ne()}catch(Ot){Te=Ot instanceof J?Ot.errors:[Ot]}const{_finalizers:Kt}=this;if(Kt){this._finalizers=null;for(const Ot of Kt)try{Oe(Ot)}catch(yt){Te=Te??[],yt instanceof J?Te=[...Te,...yt.errors]:Te.push(yt)}}if(Te)throw new J(Te)}}add(Te){var Me;if(Te&&Te!==this)if(this.closed)Oe(Te);else{if(Te instanceof Ke){if(Te.closed||Te._hasParent(this))return;Te._addParent(this)}(this._finalizers=null!==(Me=this._finalizers)&&void 0!==Me?Me:[]).push(Te)}}_hasParent(Te){const{_parentage:Me}=this;return Me===Te||Array.isArray(Me)&&Me.includes(Te)}_addParent(Te){const{_parentage:Me}=this;this._parentage=Array.isArray(Me)?(Me.push(Te),Me):Me?[Me,Te]:Te}_removeParent(Te){const{_parentage:Me}=this;Me===Te?this._parentage=null:Array.isArray(Me)&&(0,je.P)(Me,Te)}remove(Te){const{_finalizers:Me}=this;Me&&(0,je.P)(Me,Te),Te instanceof Ke&&Te._removeParent(this)}}Ke.EMPTY=(()=>{const ct=new Ke;return ct.closed=!0,ct})();const st=Ke.EMPTY;function Tt(ct){return ct instanceof Ke||ct&&"closed"in ct&&(0,$.m)(ct.remove)&&(0,$.m)(ct.add)&&(0,$.m)(ct.unsubscribe)}function Oe(ct){(0,$.m)(ct)?ct():ct.unsubscribe()}},2416:(kn,At,se)=>{se.d(At,{v:()=>$});const $={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(kn,At,se)=>{se.d(At,{E:()=>c});const c=new(se(9751).y)(Ke=>Ke.complete())},8996:(kn,At,se)=>{se.d(At,{D:()=>Dt});var $=se(8421),c=se(5363),J=se(9468),st=se(9751),Oe=se(2202),ct=se(576),Te=se(9672);function Ne(wt,an){if(!wt)throw new Error("Iterable cannot be null");return new st.y(ze=>{(0,Te.f)(ze,an,()=>{const ot=wt[Symbol.asyncIterator]();(0,Te.f)(ze,an,()=>{ot.next().then(_t=>{_t.done?ze.complete():ze.next(_t.value)})},0,!0)})})}var Kt=se(3670),Ot=se(8239),yt=se(1144),Pn=se(6495),dt=se(2206),et=se(4532),vn=se(3260);function Dt(wt,an){return an?function Nt(wt,an){if(null!=wt){if((0,Kt.c)(wt))return function je(wt,an){return(0,$.Xf)(wt).pipe((0,J.R)(an),(0,c.Q)(an))}(wt,an);if((0,yt.z)(wt))return function Tt(wt,an){return new st.y(ze=>{let ot=0;return an.schedule(function(){ot===wt.length?ze.complete():(ze.next(wt[ot++]),ze.closed||this.schedule())})})}(wt,an);if((0,Ot.t)(wt))return function Ke(wt,an){return(0,$.Xf)(wt).pipe((0,J.R)(an),(0,c.Q)(an))}(wt,an);if((0,dt.D)(wt))return Ne(wt,an);if((0,Pn.T)(wt))return function Me(wt,an){return new st.y(ze=>{let ot;return(0,Te.f)(ze,an,()=>{ot=wt[Oe.h](),(0,Te.f)(ze,an,()=>{let _t,ke;try{({value:_t,done:ke}=ot.next())}catch(He){return void ze.error(He)}ke?ze.complete():ze.next(_t)},0,!0)}),()=>(0,ct.m)(ot?.return)&&ot.return()})}(wt,an);if((0,vn.L)(wt))return function _n(wt,an){return Ne((0,vn.Q)(wt),an)}(wt,an)}throw(0,et.z)(wt)}(wt,an):(0,$.Xf)(wt)}},8421:(kn,At,se)=>{se.d(At,{Xf:()=>Kt});var $=se(655),c=se(1144),J=se(8239),je=se(9751),Ke=se(3670),st=se(2206),Tt=se(4532),Oe=se(6495),ct=se(3260),Te=se(576),Me=se(7849),Ne=se(8822);function Kt(Nt){if(Nt instanceof je.y)return Nt;if(null!=Nt){if((0,Ke.c)(Nt))return function Ot(Nt){return new je.y(Dt=>{const wt=Nt[Ne.L]();if((0,Te.m)(wt.subscribe))return wt.subscribe(Dt);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Nt);if((0,c.z)(Nt))return function yt(Nt){return new je.y(Dt=>{for(let wt=0;wt<Nt.length&&!Dt.closed;wt++)Dt.next(Nt[wt]);Dt.complete()})}(Nt);if((0,J.t)(Nt))return function Pn(Nt){return new je.y(Dt=>{Nt.then(wt=>{Dt.closed||(Dt.next(wt),Dt.complete())},wt=>Dt.error(wt)).then(null,Me.h)})}(Nt);if((0,st.D)(Nt))return et(Nt);if((0,Oe.T)(Nt))return function dt(Nt){return new je.y(Dt=>{for(const wt of Nt)if(Dt.next(wt),Dt.closed)return;Dt.complete()})}(Nt);if((0,ct.L)(Nt))return function vn(Nt){return et((0,ct.Q)(Nt))}(Nt)}throw(0,Tt.z)(Nt)}function et(Nt){return new je.y(Dt=>{(function _n(Nt,Dt){var wt,an,ze,ot;return(0,$.mG)(this,void 0,void 0,function*(){try{for(wt=(0,$.KL)(Nt);!(an=yield wt.next()).done;)if(Dt.next(an.value),Dt.closed)return}catch(_t){ze={error:_t}}finally{try{an&&!an.done&&(ot=wt.return)&&(yield ot.call(wt))}finally{if(ze)throw ze.error}}Dt.complete()})})(Nt,Dt).catch(wt=>Dt.error(wt))})}},6451:(kn,At,se)=>{se.d(At,{T:()=>st});var $=se(8189),c=se(8421),J=se(515),je=se(3269),Ke=se(8996);function st(...Tt){const Oe=(0,je.yG)(Tt),ct=(0,je._6)(Tt,1/0),Te=Tt;return Te.length?1===Te.length?(0,c.Xf)(Te[0]):(0,$.J)(ct)((0,Ke.D)(Te,Oe)):J.E}},5403:(kn,At,se)=>{se.d(At,{x:()=>c});var $=se(930);function c(je,Ke,st,Tt,Oe){return new J(je,Ke,st,Tt,Oe)}class J extends $.Lv{constructor(Ke,st,Tt,Oe,ct,Te){super(Ke),this.onFinalize=ct,this.shouldUnsubscribe=Te,this._next=st?function(Me){try{st(Me)}catch(Ne){Ke.error(Ne)}}:super._next,this._error=Oe?function(Me){try{Oe(Me)}catch(Ne){Ke.error(Ne)}finally{this.unsubscribe()}}:super._error,this._complete=Tt?function(){try{Tt()}catch(Me){Ke.error(Me)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Ke;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:st}=this;super.unsubscribe(),!st&&(null===(Ke=this.onFinalize)||void 0===Ke||Ke.call(this))}}}},4004:(kn,At,se)=>{se.d(At,{U:()=>J});var $=se(4482),c=se(5403);function J(je,Ke){return(0,$.e)((st,Tt)=>{let Oe=0;st.subscribe((0,c.x)(Tt,ct=>{Tt.next(je.call(Ke,ct,Oe++))}))})}},8189:(kn,At,se)=>{se.d(At,{J:()=>J});var $=se(5577),c=se(4671);function J(je=1/0){return(0,$.z)(c.y,je)}},5577:(kn,At,se)=>{se.d(At,{z:()=>Oe});var $=se(4004),c=se(8421),J=se(4482),je=se(9672),Ke=se(5403),Tt=se(576);function Oe(ct,Te,Me=1/0){return(0,Tt.m)(Te)?Oe((Ne,Kt)=>(0,$.U)((Ot,yt)=>Te(Ne,Ot,Kt,yt))((0,c.Xf)(ct(Ne,Kt))),Me):("number"==typeof Te&&(Me=Te),(0,J.e)((Ne,Kt)=>function st(ct,Te,Me,Ne,Kt,Ot,yt,Pn){const dt=[];let et=0,vn=0,_n=!1;const Nt=()=>{_n&&!dt.length&&!et&&Te.complete()},Dt=an=>et<Ne?wt(an):dt.push(an),wt=an=>{Ot&&Te.next(an),et++;let ze=!1;(0,c.Xf)(Me(an,vn++)).subscribe((0,Ke.x)(Te,ot=>{Kt?.(ot),Ot?Dt(ot):Te.next(ot)},()=>{ze=!0},void 0,()=>{if(ze)try{for(et--;dt.length&&et<Ne;){const ot=dt.shift();yt?(0,je.f)(Te,yt,()=>wt(ot)):wt(ot)}Nt()}catch(ot){Te.error(ot)}}))};return ct.subscribe((0,Ke.x)(Te,Dt,()=>{_n=!0,Nt()})),()=>{Pn?.()}}(Ne,Kt,ct,Me)))}},5363:(kn,At,se)=>{se.d(At,{Q:()=>je});var $=se(9672),c=se(4482),J=se(5403);function je(Ke,st=0){return(0,c.e)((Tt,Oe)=>{Tt.subscribe((0,J.x)(Oe,ct=>(0,$.f)(Oe,Ke,()=>Oe.next(ct),st),()=>(0,$.f)(Oe,Ke,()=>Oe.complete(),st),ct=>(0,$.f)(Oe,Ke,()=>Oe.error(ct),st)))})}},3099:(kn,At,se)=>{se.d(At,{B:()=>Ke});var $=se(8421),c=se(7579),J=se(930),je=se(4482);function Ke(Tt={}){const{connector:Oe=(()=>new c.x),resetOnError:ct=!0,resetOnComplete:Te=!0,resetOnRefCountZero:Me=!0}=Tt;return Ne=>{let Kt,Ot,yt,Pn=0,dt=!1,et=!1;const vn=()=>{Ot?.unsubscribe(),Ot=void 0},_n=()=>{vn(),Kt=yt=void 0,dt=et=!1},Nt=()=>{const Dt=Kt;_n(),Dt?.unsubscribe()};return(0,je.e)((Dt,wt)=>{Pn++,!et&&!dt&&vn();const an=yt=yt??Oe();wt.add(()=>{Pn--,0===Pn&&!et&&!dt&&(Ot=st(Nt,Me))}),an.subscribe(wt),!Kt&&Pn>0&&(Kt=new J.Hp({next:ze=>an.next(ze),error:ze=>{et=!0,vn(),Ot=st(_n,ct,ze),an.error(ze)},complete:()=>{dt=!0,vn(),Ot=st(_n,Te),an.complete()}}),(0,$.Xf)(Dt).subscribe(Kt))})(Ne)}}function st(Tt,Oe,...ct){if(!0===Oe)return void Tt();if(!1===Oe)return;const Te=new J.Hp({next:()=>{Te.unsubscribe(),Tt()}});return Oe(...ct).subscribe(Te)}},9468:(kn,At,se)=>{se.d(At,{R:()=>c});var $=se(4482);function c(J,je=0){return(0,$.e)((Ke,st)=>{st.add(J.schedule(()=>Ke.subscribe(st),je))})}},8505:(kn,At,se)=>{se.d(At,{b:()=>Ke});var $=se(576),c=se(4482),J=se(5403),je=se(4671);function Ke(st,Tt,Oe){const ct=(0,$.m)(st)||Tt||Oe?{next:st,error:Tt,complete:Oe}:st;return ct?(0,c.e)((Te,Me)=>{var Ne;null===(Ne=ct.subscribe)||void 0===Ne||Ne.call(ct);let Kt=!0;Te.subscribe((0,J.x)(Me,Ot=>{var yt;null===(yt=ct.next)||void 0===yt||yt.call(ct,Ot),Me.next(Ot)},()=>{var Ot;Kt=!1,null===(Ot=ct.complete)||void 0===Ot||Ot.call(ct),Me.complete()},Ot=>{var yt;Kt=!1,null===(yt=ct.error)||void 0===yt||yt.call(ct,Ot),Me.error(Ot)},()=>{var Ot,yt;Kt&&(null===(Ot=ct.unsubscribe)||void 0===Ot||Ot.call(ct)),null===(yt=ct.finalize)||void 0===yt||yt.call(ct)}))}):je.y}},4408:(kn,At,se)=>{se.d(At,{o:()=>Ke});var $=se(727);class c extends $.w0{constructor(Tt,Oe){super()}schedule(Tt,Oe=0){return this}}const J={setInterval(st,Tt,...Oe){const{delegate:ct}=J;return ct?.setInterval?ct.setInterval(st,Tt,...Oe):setInterval(st,Tt,...Oe)},clearInterval(st){const{delegate:Tt}=J;return(Tt?.clearInterval||clearInterval)(st)},delegate:void 0};var je=se(8737);class Ke extends c{constructor(Tt,Oe){super(Tt,Oe),this.scheduler=Tt,this.work=Oe,this.pending=!1}schedule(Tt,Oe=0){if(this.closed)return this;this.state=Tt;const ct=this.id,Te=this.scheduler;return null!=ct&&(this.id=this.recycleAsyncId(Te,ct,Oe)),this.pending=!0,this.delay=Oe,this.id=this.id||this.requestAsyncId(Te,this.id,Oe),this}requestAsyncId(Tt,Oe,ct=0){return J.setInterval(Tt.flush.bind(Tt,this),ct)}recycleAsyncId(Tt,Oe,ct=0){if(null!=ct&&this.delay===ct&&!1===this.pending)return Oe;J.clearInterval(Oe)}execute(Tt,Oe){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const ct=this._execute(Tt,Oe);if(ct)return ct;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(Tt,Oe){let Te,ct=!1;try{this.work(Tt)}catch(Me){ct=!0,Te=Me||new Error("Scheduled action threw falsy error")}if(ct)return this.unsubscribe(),Te}unsubscribe(){if(!this.closed){const{id:Tt,scheduler:Oe}=this,{actions:ct}=Oe;this.work=this.state=this.scheduler=null,this.pending=!1,(0,je.P)(ct,this),null!=Tt&&(this.id=this.recycleAsyncId(Oe,Tt,null)),this.delay=null,super.unsubscribe()}}}},7565:(kn,At,se)=>{se.d(At,{v:()=>J});var $=se(6063);class c{constructor(Ke,st=c.now){this.schedulerActionCtor=Ke,this.now=st}schedule(Ke,st=0,Tt){return new this.schedulerActionCtor(this,Ke).schedule(Tt,st)}}c.now=$.l.now;class J extends c{constructor(Ke,st=c.now){super(Ke,st),this.actions=[],this._active=!1,this._scheduled=void 0}flush(Ke){const{actions:st}=this;if(this._active)return void st.push(Ke);let Tt;this._active=!0;do{if(Tt=Ke.execute(Ke.state,Ke.delay))break}while(Ke=st.shift());if(this._active=!1,Tt){for(;Ke=st.shift();)Ke.unsubscribe();throw Tt}}}},4986:(kn,At,se)=>{se.d(At,{P:()=>je,z:()=>J});var $=se(4408);const J=new(se(7565).v)($.o),je=J},6063:(kn,At,se)=>{se.d(At,{l:()=>$});const $={now:()=>($.delegate||Date).now(),delegate:void 0}},3410:(kn,At,se)=>{se.d(At,{z:()=>$});const $={setTimeout(c,J,...je){const{delegate:Ke}=$;return Ke?.setTimeout?Ke.setTimeout(c,J,...je):setTimeout(c,J,...je)},clearTimeout(c){const{delegate:J}=$;return(J?.clearTimeout||clearTimeout)(c)},delegate:void 0}},2202:(kn,At,se)=>{se.d(At,{h:()=>c});const c=function $(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(kn,At,se)=>{se.d(At,{L:()=>$});const $="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(kn,At,se)=>{se.d(At,{_6:()=>st,jO:()=>je,yG:()=>Ke});var $=se(576),c=se(3532);function J(Tt){return Tt[Tt.length-1]}function je(Tt){return(0,$.m)(J(Tt))?Tt.pop():void 0}function Ke(Tt){return(0,c.K)(J(Tt))?Tt.pop():void 0}function st(Tt,Oe){return"number"==typeof J(Tt)?Tt.pop():Oe}},8737:(kn,At,se)=>{function $(c,J){if(c){const je=c.indexOf(J);0<=je&&c.splice(je,1)}}se.d(At,{P:()=>$})},3888:(kn,At,se)=>{function $(c){const je=c(Ke=>{Error.call(Ke),Ke.stack=(new Error).stack});return je.prototype=Object.create(Error.prototype),je.prototype.constructor=je,je}se.d(At,{d:()=>$})},2806:(kn,At,se)=>{se.d(At,{O:()=>je,x:()=>J});var $=se(2416);let c=null;function J(Ke){if($.v.useDeprecatedSynchronousErrorHandling){const st=!c;if(st&&(c={errorThrown:!1,error:null}),Ke(),st){const{errorThrown:Tt,error:Oe}=c;if(c=null,Tt)throw Oe}}else Ke()}function je(Ke){$.v.useDeprecatedSynchronousErrorHandling&&c&&(c.errorThrown=!0,c.error=Ke)}},9672:(kn,At,se)=>{function $(c,J,je,Ke=0,st=!1){const Tt=J.schedule(function(){je(),st?c.add(this.schedule(null,Ke)):this.unsubscribe()},Ke);if(c.add(Tt),!st)return Tt}se.d(At,{f:()=>$})},4671:(kn,At,se)=>{function $(c){return c}se.d(At,{y:()=>$})},1144:(kn,At,se)=>{se.d(At,{z:()=>$});const $=c=>c&&"number"==typeof c.length&&"function"!=typeof c},2206:(kn,At,se)=>{se.d(At,{D:()=>c});var $=se(576);function c(J){return Symbol.asyncIterator&&(0,$.m)(J?.[Symbol.asyncIterator])}},576:(kn,At,se)=>{function $(c){return"function"==typeof c}se.d(At,{m:()=>$})},3670:(kn,At,se)=>{se.d(At,{c:()=>J});var $=se(8822),c=se(576);function J(je){return(0,c.m)(je[$.L])}},6495:(kn,At,se)=>{se.d(At,{T:()=>J});var $=se(2202),c=se(576);function J(je){return(0,c.m)(je?.[$.h])}},8239:(kn,At,se)=>{se.d(At,{t:()=>c});var $=se(576);function c(J){return(0,$.m)(J?.then)}},3260:(kn,At,se)=>{se.d(At,{L:()=>je,Q:()=>J});var $=se(655),c=se(576);function J(Ke){return(0,$.FC)(this,arguments,function*(){const Tt=Ke.getReader();try{for(;;){const{value:Oe,done:ct}=yield(0,$.qq)(Tt.read());if(ct)return yield(0,$.qq)(void 0);yield yield(0,$.qq)(Oe)}}finally{Tt.releaseLock()}})}function je(Ke){return(0,c.m)(Ke?.getReader)}},3532:(kn,At,se)=>{se.d(At,{K:()=>c});var $=se(576);function c(J){return J&&(0,$.m)(J.schedule)}},4482:(kn,At,se)=>{se.d(At,{A:()=>c,e:()=>J});var $=se(576);function c(je){return(0,$.m)(je?.lift)}function J(je){return Ke=>{if(c(Ke))return Ke.lift(function(st){try{return je(st,this)}catch(Tt){this.error(Tt)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(kn,At,se)=>{function $(){}se.d(At,{Z:()=>$})},9635:(kn,At,se)=>{se.d(At,{U:()=>J,z:()=>c});var $=se(4671);function c(...je){return J(je)}function J(je){return 0===je.length?$.y:1===je.length?je[0]:function(st){return je.reduce((Tt,Oe)=>Oe(Tt),st)}}},7849:(kn,At,se)=>{se.d(At,{h:()=>J});var $=se(2416),c=se(3410);function J(je){c.z.setTimeout(()=>{const{onUnhandledError:Ke}=$.v;if(!Ke)throw je;Ke(je)})}},4532:(kn,At,se)=>{function $(c){return new TypeError(`You provided ${null!==c&&"object"==typeof c?"an invalid object":`'${c}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}se.d(At,{z:()=>$})},655:(kn,At,se)=>{function je(ke,He){var Ze={};for(var ut in ke)Object.prototype.hasOwnProperty.call(ke,ut)&&He.indexOf(ut)<0&&(Ze[ut]=ke[ut]);if(null!=ke&&"function"==typeof Object.getOwnPropertySymbols){var Xe=0;for(ut=Object.getOwnPropertySymbols(ke);Xe<ut.length;Xe++)He.indexOf(ut[Xe])<0&&Object.prototype.propertyIsEnumerable.call(ke,ut[Xe])&&(Ze[ut[Xe]]=ke[ut[Xe]])}return Ze}function Oe(ke,He,Ze,ut){return new(Ze||(Ze=Promise))(function(zt,zn){function Ni(er){try{nn(ut.next(er))}catch(Nr){zn(Nr)}}function Ci(er){try{nn(ut.throw(er))}catch(Nr){zn(Nr)}}function nn(er){er.done?zt(er.value):function Xe(zt){return zt instanceof Ze?zt:new Ze(function(zn){zn(zt)})}(er.value).then(Ni,Ci)}nn((ut=ut.apply(ke,He||[])).next())})}function dt(ke){return this instanceof dt?(this.v=ke,this):new dt(ke)}function et(ke,He,Ze){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Xe,ut=Ze.apply(ke,He||[]),zt=[];return Xe={},zn("next"),zn("throw"),zn("return"),Xe[Symbol.asyncIterator]=function(){return this},Xe;function zn(sr){ut[sr]&&(Xe[sr]=function(Ui){return new Promise(function(Mi,Vi){zt.push([sr,Ui,Mi,Vi])>1||Ni(sr,Ui)})})}function Ni(sr,Ui){try{!function Ci(sr){sr.value instanceof dt?Promise.resolve(sr.value.v).then(nn,er):Nr(zt[0][2],sr)}(ut[sr](Ui))}catch(Mi){Nr(zt[0][3],Mi)}}function nn(sr){Ni("next",sr)}function er(sr){Ni("throw",sr)}function Nr(sr,Ui){sr(Ui),zt.shift(),zt.length&&Ni(zt[0][0],zt[0][1])}}function _n(ke){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ze,He=ke[Symbol.asyncIterator];return He?He.call(ke):(ke=function Ne(ke){var He="function"==typeof Symbol&&Symbol.iterator,Ze=He&&ke[He],ut=0;if(Ze)return Ze.call(ke);if(ke&&"number"==typeof ke.length)return{next:function(){return ke&&ut>=ke.length&&(ke=void 0),{value:ke&&ke[ut++],done:!ke}}};throw new TypeError(He?"Object is not iterable.":"Symbol.iterator is not defined.")}(ke),Ze={},ut("next"),ut("throw"),ut("return"),Ze[Symbol.asyncIterator]=function(){return this},Ze);function ut(zt){Ze[zt]=ke[zt]&&function(zn){return new Promise(function(Ni,Ci){!function Xe(zt,zn,Ni,Ci){Promise.resolve(Ci).then(function(nn){zt({value:nn,done:Ni})},zn)}(Ni,Ci,(zn=ke[zt](zn)).done,zn.value)})}}}se.d(At,{FC:()=>et,KL:()=>_n,_T:()=>je,mG:()=>Oe,qq:()=>dt})},4650:(kn,At,se)=>{se.d(At,{$8M:()=>Vc,$Z:()=>Q1,AFp:()=>QR,ALo:()=>t_,AaK:()=>Oe,Akn:()=>cc,B6R:()=>Ae,BQk:()=>py,CHM:()=>Du,CRH:()=>em,CZH:()=>nT,CqO:()=>Vp,D6c:()=>Lo,DdM:()=>MC,EJc:()=>c_,EiD:()=>m1,EpF:()=>my,F$t:()=>va,F4k:()=>PD,FYo:()=>M1,FiY:()=>Fe,G48:()=>gN,Gf:()=>OR,GfV:()=>vM,Gpc:()=>Me,Hsn:()=>US,Ikx:()=>Ix,JOm:()=>Zu,JVY:()=>Nb,KtG:()=>Rc,L6k:()=>Bb,LAX:()=>aM,LFG:()=>Yr,LSH:()=>Gb,Lbi:()=>eI,Lck:()=>N2,MAs:()=>RS,MMx:()=>sd,NdJ:()=>kS,O4$:()=>zd,OlP:()=>ei,Oqu:()=>Ex,PXZ:()=>hI,Q6J:()=>IS,QGY:()=>OS,QP$:()=>rm,QbO:()=>tI,Qsj:()=>kO,R0b:()=>Ll,RDi:()=>ef,Rgc:()=>uc,SBq:()=>uf,Sil:()=>Oa,Suo:()=>FC,TTD:()=>Aa,TgZ:()=>Ug,Udp:()=>by,VKq:()=>SC,W1O:()=>OC,WFA:()=>NS,X6Q:()=>mN,XFs:()=>Un,Xpm:()=>ve,Xts:()=>zv,Y36:()=>df,YKP:()=>ol,YNc:()=>ID,Yjl:()=>_s,Yz7:()=>Ui,ZZ4:()=>aT,_Bn:()=>xC,_UZ:()=>FS,_Vd:()=>Ip,_c5:()=>CN,_uU:()=>XS,aQg:()=>lT,c2e:()=>nN,cJS:()=>Vi,cg1:()=>Px,d8E:()=>aC,dDg:()=>aI,dqk:()=>un,eBb:()=>oM,eFA:()=>Lf,ekj:()=>ed,eoX:()=>lI,f3M:()=>$d,g9A:()=>WC,h0i:()=>iu,hGG:()=>sE,hij:()=>wy,iGM:()=>LR,ifc:()=>Ai,ip1:()=>zC,kL8:()=>Dy,kcU:()=>fp,lG2:()=>Bi,lcZ:()=>AC,lqb:()=>Rp,lri:()=>sI,mCW:()=>Be,n5z:()=>vp,n_E:()=>Wx,oAB:()=>$t,oJD:()=>g1,oxw:()=>Vg,pB0:()=>lM,q3G:()=>ls,q4F:()=>qv,qLn:()=>Cg,qOj:()=>dx,qZA:()=>hy,qzn:()=>qu,rWj:()=>oI,s9C:()=>zp,sBO:()=>lm,sIi:()=>$h,s_b:()=>hc,soG:()=>ud,tb:()=>qC,tp0:()=>Rt,uIk:()=>mx,vHH:()=>yt,vpe:()=>eh,wAp:()=>Yn,xp6:()=>vk,ynx:()=>fy,z2F:()=>n0,z3N:()=>$c,zSh:()=>Dp,zs3:()=>Rg});var $=se(7579),c=se(727),J=se(9751),je=se(6451),Ke=se(3099);function st(u){for(let d in u)if(u[d]===st)return d;throw Error("Could not find renamed property on target object.")}function Tt(u,d){for(const p in d)d.hasOwnProperty(p)&&!u.hasOwnProperty(p)&&(u[p]=d[p])}function Oe(u){if("string"==typeof u)return u;if(Array.isArray(u))return"["+u.map(Oe).join(", ")+"]";if(null==u)return""+u;if(u.overriddenName)return`${u.overriddenName}`;if(u.name)return`${u.name}`;const d=u.toString();if(null==d)return""+d;const p=d.indexOf("\n");return-1===p?d:d.substring(0,p)}function ct(u,d){return null==u||""===u?null===d?"":d:null==d||""===d?u:u+" "+d}const Te=st({__forward_ref__:st});function Me(u){return u.__forward_ref__=Me,u.toString=function(){return Oe(this())},u}function Ne(u){return Kt(u)?u():u}function Kt(u){return"function"==typeof u&&u.hasOwnProperty(Te)&&u.__forward_ref__===Me}class yt extends Error{constructor(d,p){super(function Pn(u,d){return`NG0${Math.abs(u)}${d?": "+d.trim():""}`}(d,p)),this.code=d}}function dt(u){return"string"==typeof u?u:null==u?"":String(u)}function Dt(u,d){throw new yt(-201,!1)}function Ci(u,d){null==u&&function nn(u,d,p,_){throw new Error(`ASSERTION ERROR: ${u}`+(null==_?"":` [Expected=> ${p} ${_} ${d} <=Actual]`))}(d,u,null,"!=")}function Ui(u){return{token:u.token,providedIn:u.providedIn||null,factory:u.factory,value:void 0}}function Vi(u){return{providers:u.providers||[],imports:u.imports||[]}}function gr(u){return za(u,ha)||za(u,Br)}function za(u,d){return u.hasOwnProperty(d)?u[d]:null}function gl(u){return u&&(u.hasOwnProperty(Ca)||u.hasOwnProperty(_l))?u[Ca]:null}const ha=st({\u0275prov:st}),Ca=st({\u0275inj:st}),Br=st({ngInjectableDef:st}),_l=st({ngInjectorDef:st});var Un=(()=>((Un=Un||{})[Un.Default=0]="Default",Un[Un.Host=1]="Host",Un[Un.Self=2]="Self",Un[Un.SkipSelf=4]="SkipSelf",Un[Un.Optional=8]="Optional",Un))();let ao;function Li(u){const d=ao;return ao=u,d}function ms(u,d,p){const _=gr(u);return _&&"root"==_.providedIn?void 0===_.value?_.value=_.factory():_.value:p&Un.Optional?null:void 0!==d?d:void Dt(Oe(u))}function Ls(u){return{toString:u}.toString()}var vr=(()=>((vr=vr||{})[vr.OnPush=0]="OnPush",vr[vr.Default=1]="Default",vr))(),Ai=(()=>{return(u=Ai||(Ai={}))[u.Emulated=0]="Emulated",u[u.None=2]="None",u[u.ShadowDom=3]="ShadowDom",Ai;var u})();const un=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),gs={},li=[],lo=st({\u0275cmp:st}),yr=st({\u0275dir:st}),br=st({\u0275pipe:st}),Hi=st({\u0275mod:st}),rs=st({\u0275fac:st}),xe=st({__NG_ELEMENT_ID__:st});let we=0;function ve(u){return Ls(()=>{const p=!0===u.standalone,_={},x={type:u.type,providersResolver:null,decls:u.decls,vars:u.vars,factory:null,template:u.template||null,consts:u.consts||null,ngContentSelectors:u.ngContentSelectors,hostBindings:u.hostBindings||null,hostVars:u.hostVars||0,hostAttrs:u.hostAttrs||null,contentQueries:u.contentQueries||null,declaredInputs:_,inputs:null,outputs:null,exportAs:u.exportAs||null,onPush:u.changeDetection===vr.OnPush,directiveDefs:null,pipeDefs:null,standalone:p,dependencies:p&&u.dependencies||null,getStandaloneInjector:null,selectors:u.selectors||li,viewQuery:u.viewQuery||null,features:u.features||null,data:u.data||{},encapsulation:u.encapsulation||Ai.Emulated,id:"c"+we++,styles:u.styles||li,_:null,setInput:null,schemas:u.schemas||null,tView:null},w=u.dependencies,D=u.features;return x.inputs=Gi(u.inputs,_),x.outputs=Gi(u.outputs),D&&D.forEach(F=>F(x)),x.directiveDefs=w?()=>("function"==typeof w?w():w).map(Ce).filter(Ct):null,x.pipeDefs=w?()=>("function"==typeof w?w():w).map(ye).filter(Ct):null,x})}function Ae(u,d,p){const _=u.\u0275cmp;_.directiveDefs=()=>("function"==typeof d?d():d).map(Ce),_.pipeDefs=()=>("function"==typeof p?p():p).map(ye)}function Ce(u){return Re(u)||Se(u)}function Ct(u){return null!==u}function $t(u){return Ls(()=>({type:u.type,bootstrap:u.bootstrap||li,declarations:u.declarations||li,imports:u.imports||li,exports:u.exports||li,transitiveCompileScopes:null,schemas:u.schemas||null,id:u.id||null}))}function Gi(u,d){if(null==u)return gs;const p={};for(const _ in u)if(u.hasOwnProperty(_)){let x=u[_],w=x;Array.isArray(x)&&(w=x[1],x=x[0]),p[x]=_,d&&(d[x]=w)}return p}const Bi=ve;function _s(u){return{type:u.type,name:u.name,factory:null,pure:!1!==u.pure,standalone:!0===u.standalone,onDestroy:u.type.prototype.ngOnDestroy||null}}function Re(u){return u[lo]||null}function Se(u){return u[yr]||null}function ye(u){return u[br]||null}function gt(u,d){const p=u[Hi]||null;if(!p&&!0===d)throw new Error(`Type ${Oe(u)} does not have '\u0275mod' property.`);return p}function Zs(u){return Array.isArray(u)&&"object"==typeof u[1]}function qr(u){return Array.isArray(u)&&!0===u[1]}function Sc(u){return 0!=(8&u.flags)}function Ld(u){return 2==(2&u.flags)}function Cc(u){return 1==(1&u.flags)}function Wo(u){return null!==u.template}function rp(u){return 0!=(256&u[2])}function Su(u,d){return u.hasOwnProperty(rs)?u[rs]:null}class Ch{constructor(d,p,_){this.previousValue=d,this.currentValue=p,this.firstChange=_}isFirstChange(){return this.firstChange}}function Aa(){return Zl}function Zl(u){return u.type.prototype.ngOnChanges&&(u.setInput=mv),Cu}function Cu(){const u=kd(this),d=u?.current;if(d){const p=u.previous;if(p===gs)u.previous=d;else for(let _ in d)p[_]=d[_];u.current=null,this.ngOnChanges(d)}}function mv(u,d,p,_){const x=kd(u)||function ap(u,d){return u[op]=d}(u,{previous:gs,current:null}),w=x.current||(x.current={}),D=x.previous,F=this.declaredInputs[p],B=D[F];w[F]=new Ch(B&&B.currentValue,d,D===gs),u[_]=d}Aa.ngInherit=!0;const op="__ngSimpleChanges__";function kd(u){return u[op]||null}function ar(u){for(;Array.isArray(u);)u=u[0];return u}function Bd(u,d){return ar(d[u])}function qo(u,d){return ar(d[u.index])}function Xl(u,d){return u.data[d]}function Za(u,d){return u[d]}function co(u,d){const p=d[u];return Zs(p)?p:p[0]}function Dc(u){return 4==(4&u[2])}function $l(u){return 64==(64&u[2])}function Mo(u,d){return null==d?null:u[d]}function Eh(u){u[18]=0}function Ya(u,d){u[5]+=d;let p=u,_=u[3];for(;null!==_&&(1===d&&1===p[5]||-1===d&&0===p[5]);)_[5]+=d,p=_,_=_[3]}const ri={lFrame:Ph(null),bindingsEnabled:!0};function Au(){return ri.bindingsEnabled}function Pt(){return ri.lFrame.lView}function mi(){return ri.lFrame.tView}function Du(u){return ri.lFrame.contextLView=u,u[8]}function Rc(u){return ri.lFrame.contextLView=null,u}function Vr(){let u=Ic();for(;null!==u&&64===u.type;)u=u.parent;return u}function Ic(){return ri.lFrame.currentTNode}function So(u,d){const p=ri.lFrame;p.currentTNode=u,p.isParent=d}function lp(){return ri.lFrame.isParent}function Fc(){ri.lFrame.isParent=!1}function vs(){const u=ri.lFrame;let d=u.bindingRootIndex;return-1===d&&(d=u.bindingRootIndex=u.tView.bindingStartIndex),d}function Oc(){return ri.lFrame.bindingIndex++}function pa(u){const d=ri.lFrame,p=d.bindingIndex;return d.bindingIndex=d.bindingIndex+u,p}function up(u,d){const p=ri.lFrame;p.bindingIndex=p.bindingRootIndex=u,Rh(d)}function Rh(u){ri.lFrame.currentDirectiveIndex=u}function Vd(u){const d=ri.lFrame.currentDirectiveIndex;return-1===d?null:u[d]}function kc(){return ri.lFrame.currentQueryIndex}function hp(u){ri.lFrame.currentQueryIndex=u}function Ih(u){const d=u[1];return 2===d.type?d.declTNode:1===d.type?u[6]:null}function rg(u,d,p){if(p&Un.SkipSelf){let x=d,w=u;for(;!(x=x.parent,null!==x||p&Un.Host||(x=Ih(w),null===x||(w=w[15],10&x.type))););if(null===x)return!1;d=x,u=w}const _=ri.lFrame=sg();return _.currentTNode=d,_.lView=u,!0}function wl(u){const d=sg(),p=u[1];ri.lFrame=d,d.currentTNode=p.firstChild,d.lView=u,d.tView=p,d.contextLView=u,d.bindingIndex=p.bindingStartIndex,d.inI18n=!1}function sg(){const u=ri.lFrame,d=null===u?null:u.child;return null===d?Ph(u):d}function Ph(u){const d={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:u,child:null,inI18n:!1};return null!==u&&(u.child=d),d}function og(){const u=ri.lFrame;return ri.lFrame=u.parent,u.currentTNode=null,u.lView=null,u}const Ru=og;function dp(){const u=og();u.isParent=!0,u.tView=null,u.selectedIndex=-1,u.contextLView=null,u.elementDepthCount=0,u.currentDirectiveIndex=-1,u.currentNamespace=null,u.bindingRootIndex=-1,u.bindingIndex=-1,u.currentQueryIndex=0}function ss(){return ri.lFrame.selectedIndex}function Ka(u){ri.lFrame.selectedIndex=u}function nr(){const u=ri.lFrame;return Xl(u.tView,u.selectedIndex)}function zd(){ri.lFrame.currentNamespace="svg"}function fp(){!function lg(){ri.lFrame.currentNamespace=null}()}function pp(u,d){for(let p=d.directiveStart,_=d.directiveEnd;p<_;p++){const w=u.data[p].type.prototype,{ngAfterContentInit:D,ngAfterContentChecked:F,ngAfterViewInit:B,ngAfterViewChecked:G,ngOnDestroy:X}=w;D&&(u.contentHooks||(u.contentHooks=[])).push(-p,D),F&&((u.contentHooks||(u.contentHooks=[])).push(p,F),(u.contentCheckHooks||(u.contentCheckHooks=[])).push(p,F)),B&&(u.viewHooks||(u.viewHooks=[])).push(-p,B),G&&((u.viewHooks||(u.viewHooks=[])).push(p,G),(u.viewCheckHooks||(u.viewCheckHooks=[])).push(p,G)),null!=X&&(u.destroyHooks||(u.destroyHooks=[])).push(p,X)}}function cg(u,d,p){xv(u,d,3,p)}function bv(u,d,p,_){(3&u[2])===p&&xv(u,d,p,_)}function mp(u,d){let p=u[2];(3&p)===d&&(p&=2047,p+=1,u[2]=p)}function xv(u,d,p,_){const w=_??-1,D=d.length-1;let F=0;for(let B=void 0!==_?65535&u[18]:0;B<D;B++)if("number"==typeof d[B+1]){if(F=d[B],null!=_&&F>=_)break}else d[B]<0&&(u[18]+=65536),(F<w||-1==w)&&(Iu(u,p,d,B),u[18]=(4294901760&u[18])+B+2),B++}function Iu(u,d,p,_){const x=p[_]<0,w=p[_+1],F=u[x?-p[_]:p[_]];if(x){if(u[2]>>11<u[18]>>16&&(3&u[2])===d){u[2]+=2048;try{w.call(F)}finally{}}}else try{w.call(F)}finally{}}class Wd{constructor(d,p,_){this.factory=d,this.resolving=!1,this.canSeeViewProviders=p,this.injectImpl=_}}function Lh(u,d,p){let _=0;for(;_<p.length;){const x=p[_];if("number"==typeof x){if(0!==x)break;_++;const w=p[_++],D=p[_++],F=p[_++];u.setAttribute(d,D,F,w)}else{const w=x,D=p[++_];qd(w)?u.setProperty(d,w,D):u.setAttribute(d,w,D),_++}}return _}function _p(u){return 3===u||4===u||6===u}function qd(u){return 64===u.charCodeAt(0)}function Nc(u,d){if(null!==d&&0!==d.length)if(null===u||0===u.length)u=d.slice();else{let p=-1;for(let _=0;_<d.length;_++){const x=d[_];"number"==typeof x?p=x:0===p||wv(u,p,x,null,-1===p||2===p?d[++_]:null)}}return u}function wv(u,d,p,_,x){let w=0,D=u.length;if(-1===d)D=-1;else for(;w<u.length;){const F=u[w++];if("number"==typeof F){if(F===d){D=-1;break}if(F>d){D=w-1;break}}}for(;w<u.length;){const F=u[w];if("number"==typeof F)break;if(F===p){if(null===_)return void(null!==x&&(u[w+1]=x));if(_===u[w+1])return void(u[w+2]=x)}w++,null!==_&&w++,null!==x&&w++}-1!==D&&(u.splice(D,0,d),w=D+1),u.splice(w++,0,p),null!==_&&u.splice(w++,0,_),null!==x&&u.splice(w++,0,x)}function Mv(u){return-1!==u}function Oh(u){return 32767&u}function ys(u,d){let p=function tM(u){return u>>16}(u),_=d;for(;p>0;)_=_[15],p--;return _}let Sv=!0;function Ml(u){const d=Sv;return Sv=u,d}let dr=0;const Pi={};function Bn(u,d){const p=Bc(u,d);if(-1!==p)return p;const _=d[1];_.firstCreatePass&&(u.injectorIndex=d.length,Ks(_.data,u),Ks(d,null),Ks(_.blueprint,null));const x=jc(u,d),w=u.injectorIndex;if(Mv(x)){const D=Oh(x),F=ys(x,d),B=F[1].data;for(let G=0;G<8;G++)d[w+G]=F[D+G]|B[D+G]}return d[w+8]=x,w}function Ks(u,d){u.push(0,0,0,0,0,0,0,0,d)}function Bc(u,d){return-1===u.injectorIndex||u.parent&&u.parent.injectorIndex===u.injectorIndex||null===d[u.injectorIndex+8]?-1:u.injectorIndex}function jc(u,d){if(u.parent&&-1!==u.parent.injectorIndex)return u.parent.injectorIndex;let p=0,_=null,x=d;for(;null!==x;){if(_=ku(x),null===_)return-1;if(p++,x=x[15],-1!==_.injectorIndex)return _.injectorIndex|p<<16}return-1}function bs(u,d,p){!function Tn(u,d,p){let _;"string"==typeof p?_=p.charCodeAt(0)||0:p.hasOwnProperty(xe)&&(_=p[xe]),null==_&&(_=p[xe]=dr++);const x=255&_;d.data[u+(x>>5)]|=1<<x}(u,d,p)}function Yd(u,d,p){if(p&Un.Optional)return u;Dt()}function Nh(u,d,p,_){if(p&Un.Optional&&void 0===_&&(_=null),0==(p&(Un.Self|Un.Host))){const x=u[9],w=Li(void 0);try{return x?x.get(d,_,p&Un.Optional):ms(d,_,p&Un.Optional)}finally{Li(w)}}return Yd(_,0,p)}function Bh(u,d,p,_=Un.Default,x){if(null!==u){if(1024&d[2]){const D=function Fb(u,d,p,_,x){let w=u,D=d;for(;null!==w&&null!==D&&1024&D[2]&&!(256&D[2]);){const F=Uc(w,D,p,_|Un.Self,Pi);if(F!==Pi)return F;let B=w.parent;if(!B){const G=D[21];if(G){const X=G.get(p,Pi,_);if(X!==Pi)return X}B=ku(D),D=D[15]}w=B}return x}(u,d,p,_,Pi);if(D!==Pi)return D}const w=Uc(u,d,p,_,Pi);if(w!==Pi)return w}return Nh(d,p,_,x)}function Uc(u,d,p,_,x){const w=function dg(u){if("string"==typeof u)return u.charCodeAt(0)||0;const d=u.hasOwnProperty(xe)?u[xe]:void 0;return"number"==typeof d?d>=0?255&d:Tr:d}(p);if("function"==typeof w){if(!rg(d,u,_))return _&Un.Host?Yd(x,0,_):Nh(d,p,_,x);try{const D=w(_);if(null!=D||_&Un.Optional)return D;Dt()}finally{Ru()}}else if("number"==typeof w){let D=null,F=Bc(u,d),B=-1,G=_&Un.Host?d[16][6]:null;for((-1===F||_&Un.SkipSelf)&&(B=-1===F?jc(u,d):d[F+8],-1!==B&&Kd(_,!1)?(D=d[1],F=Oh(B),d=ys(B,d)):F=-1);-1!==F;){const X=d[1];if(Lu(w,F,X.data)){const ae=Fu(F,d,p,D,_,G);if(ae!==Pi)return ae}B=d[F+8],-1!==B&&Kd(_,d[1].data[F+8]===G)&&Lu(w,F,d)?(D=X,F=Oh(B),d=ys(B,d)):F=-1}}return x}function Fu(u,d,p,_,x,w){const D=d[1],F=D.data[u+8],X=tc(F,D,p,null==_?Ld(F)&&Sv:_!=D&&0!=(3&F.type),x&Un.Host&&w===F);return null!==X?Sn(d,D,X,F):Pi}function tc(u,d,p,_,x){const w=u.providerIndexes,D=d.data,F=1048575&w,B=u.directiveStart,X=w>>20,De=x?F+X:u.directiveEnd;for(let Ue=_?F:F+X;Ue<De;Ue++){const xt=D[Ue];if(Ue<B&&p===xt||Ue>=B&&xt.type===p)return Ue}if(x){const Ue=D[B];if(Ue&&Wo(Ue)&&Ue.type===p)return B}return null}function Sn(u,d,p,_){let x=u[p];const w=d.data;if(function Fh(u){return u instanceof Wd}(x)){const D=x;D.resolving&&function vn(u,d){const p=d?`. Dependency path: ${d.join(" > ")} > ${u}`:"";throw new yt(-200,`Circular dependency in DI detected for ${u}${p}`)}(function et(u){return"function"==typeof u?u.name||u.toString():"object"==typeof u&&null!=u&&"function"==typeof u.type?u.type.name||u.type.toString():dt(u)}(w[p]));const F=Ml(D.canSeeViewProviders);D.resolving=!0;const B=D.injectImpl?Li(D.injectImpl):null;rg(u,_,Un.Default);try{x=u[p]=D.factory(void 0,w,u,_),d.firstCreatePass&&p>=_.directiveStart&&function Hd(u,d,p){const{ngOnChanges:_,ngOnInit:x,ngDoCheck:w}=d.type.prototype;if(_){const D=Zl(d);(p.preOrderHooks||(p.preOrderHooks=[])).push(u,D),(p.preOrderCheckHooks||(p.preOrderCheckHooks=[])).push(u,D)}x&&(p.preOrderHooks||(p.preOrderHooks=[])).push(0-u,x),w&&((p.preOrderHooks||(p.preOrderHooks=[])).push(u,w),(p.preOrderCheckHooks||(p.preOrderCheckHooks=[])).push(u,w))}(p,w[p],d)}finally{null!==B&&Li(B),Ml(F),D.resolving=!1,Ru()}}return x}function Lu(u,d,p){return!!(p[d+(u>>5)]&1<<u)}function Kd(u,d){return!(u&Un.Self||u&Un.Host&&d)}class Da{constructor(d,p){this._tNode=d,this._lView=p}get(d,p,_){return Bh(this._tNode,this._lView,d,_,p)}}function Tr(){return new Da(Vr(),Pt())}function vp(u){return Ls(()=>{const d=u.prototype.constructor,p=d[rs]||Ou(d),_=Object.prototype;let x=Object.getPrototypeOf(u.prototype).constructor;for(;x&&x!==_;){const w=x[rs]||Ou(x);if(w&&w!==p)return w;x=Object.getPrototypeOf(x)}return w=>new w})}function Ou(u){return Kt(u)?()=>{const d=Ou(Ne(u));return d&&d()}:Su(u)}function ku(u){const d=u[1],p=d.type;return 2===p?d.declTNode:1===p?u[6]:null}function Vc(u){return function hg(u,d){if("class"===d)return u.classes;if("style"===d)return u.styles;const p=u.attrs;if(p){const _=p.length;let x=0;for(;x<_;){const w=p[x];if(_p(w))break;if(0===w)x+=2;else if("number"==typeof w)for(x++;x<_&&"string"==typeof p[x];)x++;else{if(w===d)return p[x+1];x+=2}}}return null}(Vr(),u)}const $a="__parameters__";function os(u,d,p){return Ls(()=>{const _=function jh(u){return function(...p){if(u){const _=u(...p);for(const x in _)this[x]=_[x]}}}(d);function x(...w){if(this instanceof x)return _.apply(this,w),this;const D=new x(...w);return F.annotation=D,F;function F(B,G,X){const ae=B.hasOwnProperty($a)?B[$a]:Object.defineProperty(B,$a,{value:[]})[$a];for(;ae.length<=X;)ae.push(null);return(ae[X]=ae[X]||[]).push(D),B}}return p&&(x.prototype=Object.create(p.prototype)),x.prototype.ngMetadataName=u,x.annotationCls=x,x})}class ei{constructor(d,p){this._desc=d,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof p?this.__NG_ELEMENT_ID__=p:void 0!==p&&(this.\u0275prov=Ui({token:this,providedIn:p.providedIn||"root",factory:p.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Xs(u,d){void 0===d&&(d=u);for(let p=0;p<u.length;p++){let _=u[p];Array.isArray(_)?(d===u&&(d=u.slice(0,p)),Xs(_,d)):d!==u&&d.push(_)}return d}function Eo(u,d){u.forEach(p=>Array.isArray(p)?Eo(p,d):d(p))}function ju(u,d,p){d>=u.length?u.push(p):u.splice(d,0,p)}function Uh(u,d){return d>=u.length-1?u.pop():u.splice(d,1)[0]}function Gc(u,d){const p=[];for(let _=0;_<u;_++)p.push(d);return p}function uo(u,d,p){let _=rc(u,d);return _>=0?u[1|_]=p:(_=~_,function Ti(u,d,p,_){let x=u.length;if(x==d)u.push(p,_);else if(1===x)u.push(_,u[0]),u[0]=p;else{for(x--,u.push(u[x-1],u[x]);x>d;)u[x]=u[x-2],x--;u[d]=p,u[d+1]=_}}(u,_,d,p)),_}function Zo(u,d){const p=rc(u,d);if(p>=0)return u[1|p]}function rc(u,d){return function zc(u,d,p){let _=0,x=u.length>>p;for(;x!==_;){const w=_+(x-_>>1),D=u[w<<p];if(d===D)return w<<p;D>d?x=w:_=w+1}return~(x<<p)}(u,d,1)}const zu={},Wc="__NG_DI_FLAG__",Ja="ngTempTokenPath",Hu=/\n/gm,oi="__source";let Al;function Yo(u){const d=Al;return Al=u,d}function qc(u,d=Un.Default){if(void 0===Al)throw new yt(-203,!1);return null===Al?ms(u,void 0,d):Al.get(u,d&Un.Optional?null:void 0,d)}function Yr(u,d=Un.Default){return(function _r(){return ao}()||qc)(Ne(u),d)}function $d(u,d=Un.Default){return"number"!=typeof d&&(d=0|(d.optional&&8)|(d.host&&1)|(d.self&&2)|(d.skipSelf&&4)),Yr(u,d)}function zh(u){const d=[];for(let p=0;p<u.length;p++){const _=Ne(u[p]);if(Array.isArray(_)){if(0===_.length)throw new yt(900,!1);let x,w=Un.Default;for(let D=0;D<_.length;D++){const F=_[D],B=j(F);"number"==typeof B?-1===B?x=F.token:w|=B:x=F}d.push(Yr(x,w))}else d.push(Yr(_))}return d}function sc(u,d){return u[Wc]=d,u.prototype[Wc]=d,u}function j(u){return u[Wc]}const Fe=sc(os("Optional"),8),Rt=sc(os("SkipSelf"),4);let pg,mg,rf;function ef(u){pg=u}function nf(u){return function tf(){if(void 0===mg&&(mg=null,un.trustedTypes))try{mg=un.trustedTypes.createPolicy("angular",{createHTML:u=>u,createScript:u=>u,createScriptURL:u=>u})}catch{}return mg}()?.createHTML(u)||u}function Ov(u){return function gg(){if(void 0===rf&&(rf=null,un.trustedTypes))try{rf=un.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:u=>u,createScript:u=>u,createScriptURL:u=>u})}catch{}return rf}()?.createHTML(u)||u}class Kc{constructor(d){this.changingThisBreaksApplicationSecurity=d}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Xc extends Kc{getTypeName(){return"HTML"}}class _g extends Kc{getTypeName(){return"Style"}}class vg extends Kc{getTypeName(){return"Script"}}class rM extends Kc{getTypeName(){return"URL"}}class kb extends Kc{getTypeName(){return"ResourceURL"}}function $c(u){return u instanceof Kc?u.changingThisBreaksApplicationSecurity:u}function qu(u,d){const p=function sM(u){return u instanceof Kc&&u.getTypeName()||null}(u);if(null!=p&&p!==d){if("ResourceURL"===p&&"URL"===d)return!0;throw new Error(`Required a safe ${d}, got a ${p} (see https://g.co/ng/security#xss)`)}return p===d}function Nb(u){return new Xc(u)}function Bb(u){return new _g(u)}function oM(u){return new vg(u)}function aM(u){return new rM(u)}function lM(u){return new kb(u)}class P{constructor(d){this.inertDocumentHelper=d}getInertBodyElement(d){d="<body><remove></remove>"+d;try{const p=(new window.DOMParser).parseFromString(nf(d),"text/html").body;return null===p?this.inertDocumentHelper.getInertBodyElement(d):(p.removeChild(p.firstChild),p)}catch{return null}}}class M{constructor(d){if(this.defaultDoc=d,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const p=this.inertDocument.createElement("html");this.inertDocument.appendChild(p);const _=this.inertDocument.createElement("body");p.appendChild(_)}}getInertBodyElement(d){const p=this.inertDocument.createElement("template");if("content"in p)return p.innerHTML=nf(d),p;const _=this.inertDocument.createElement("body");return _.innerHTML=nf(d),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(_),_}stripCustomNsAttrs(d){const p=d.attributes;for(let x=p.length-1;0<x;x--){const D=p.item(x).name;("xmlns:ns1"===D||0===D.indexOf("ns1:"))&&d.removeAttribute(D)}let _=d.firstChild;for(;_;)_.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(_),_=_.nextSibling}}const O=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,re=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Be(u){return(u=String(u)).match(O)||u.match(re)?u:"unsafe:"+u}function cn(u){const d={};for(const p of u.split(","))d[p]=!0;return d}function jn(...u){const d={};for(const p of u)for(const _ in p)p.hasOwnProperty(_)&&(d[_]=!0);return d}const di=cn("area,br,col,hr,img,wbr"),wr=cn("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Rl=cn("rp,rt"),sf=jn(di,jn(wr,cn("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),jn(Rl,cn("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),jn(Rl,wr)),af=cn("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),lf=cn("srcset"),Bv=jn(af,lf,cn("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),cn("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),jv=cn("script,style,template");class bg{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(d){let p=d.firstChild,_=!0;for(;p;)if(p.nodeType===Node.ELEMENT_NODE?_=this.startElement(p):p.nodeType===Node.TEXT_NODE?this.chars(p.nodeValue):this.sanitizedSomething=!0,_&&p.firstChild)p=p.firstChild;else for(;p;){p.nodeType===Node.ELEMENT_NODE&&this.endElement(p);let x=this.checkClobberedElement(p,p.nextSibling);if(x){p=x;break}p=this.checkClobberedElement(p,p.parentNode)}return this.buf.join("")}startElement(d){const p=d.nodeName.toLowerCase();if(!sf.hasOwnProperty(p))return this.sanitizedSomething=!0,!jv.hasOwnProperty(p);this.buf.push("<"),this.buf.push(p);const _=d.attributes;for(let x=0;x<_.length;x++){const w=_.item(x),D=w.name,F=D.toLowerCase();if(!Bv.hasOwnProperty(F)){this.sanitizedSomething=!0;continue}let B=w.value;af[F]&&(B=Be(B)),lf[F]&&(u=B,B=(u=String(u)).split(",").map(d=>Be(d.trim())).join(", ")),this.buf.push(" ",D,'="',Uv(B),'"')}var u;return this.buf.push(">"),!0}endElement(d){const p=d.nodeName.toLowerCase();sf.hasOwnProperty(p)&&!di.hasOwnProperty(p)&&(this.buf.push("</"),this.buf.push(p),this.buf.push(">"))}chars(d){this.buf.push(Uv(d))}checkClobberedElement(d,p){if(p&&(d.compareDocumentPosition(p)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${d.outerHTML}`);return p}}const Ub=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,xg=/([^\#-~ |!])/g;function Uv(u){return u.replace(/&/g,"&amp;").replace(Ub,function(d){return"&#"+(1024*(d.charCodeAt(0)-55296)+(d.charCodeAt(1)-56320)+65536)+";"}).replace(xg,function(d){return"&#"+d.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Vv;function m1(u,d){let p=null;try{Vv=Vv||function cM(u){const d=new M(u);return function E(){try{return!!(new window.DOMParser).parseFromString(nf(""),"text/html")}catch{return!1}}()?new P(d):d}(u);let _=d?String(d):"";p=Vv.getInertBodyElement(_);let x=5,w=_;do{if(0===x)throw new Error("Failed to sanitize html because the input is unstable");x--,_=w,w=p.innerHTML,p=Vv.getInertBodyElement(_)}while(_!==w);return nf((new bg).sanitizeChildren(Ep(p)||p))}finally{if(p){const _=Ep(p)||p;for(;_.firstChild;)_.removeChild(_.firstChild)}}}function Ep(u){return"content"in u&&function Vb(u){return u.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===u.nodeName}(u)?u.content:null}var ls=(()=>((ls=ls||{})[ls.NONE=0]="NONE",ls[ls.HTML=1]="HTML",ls[ls.STYLE=2]="STYLE",ls[ls.SCRIPT=3]="SCRIPT",ls[ls.URL=4]="URL",ls[ls.RESOURCE_URL=5]="RESOURCE_URL",ls))();function g1(u){const d=Gv();return d?Ov(d.sanitize(ls.HTML,u)||""):qu(u,"HTML")?Ov($c(u)):m1(function Ob(){return void 0!==pg?pg:typeof document<"u"?document:void 0}(),dt(u))}function Gb(u){const d=Gv();return d?d.sanitize(ls.URL,u)||"":qu(u,"URL")?$c(u):Be(dt(u))}function Gv(){const u=Pt();return u&&u[12]}const zv=new ei("ENVIRONMENT_INITIALIZER"),Il=new ei("INJECTOR",-1),dM=new ei("INJECTOR_DEF_TYPES");class fM{get(d,p=zu){if(p===zu){const _=new Error(`NullInjectorError: No provider for ${Oe(d)}!`);throw _.name="NullInjectorError",_}return p}}function wO(...u){return{\u0275providers:_1(0,u)}}function _1(u,...d){const p=[],_=new Set;let x;return Eo(d,w=>{const D=w;Tg(D,p,[],_)&&(x||(x=[]),x.push(D))}),void 0!==x&&pM(x,p),p}function pM(u,d){for(let p=0;p<u.length;p++){const{providers:x}=u[p];Eo(x,w=>{d.push(w)})}}function Tg(u,d,p,_){if(!(u=Ne(u)))return!1;let x=null,w=gl(u);const D=!w&&Re(u);if(w||D){if(D&&!D.standalone)return!1;x=u}else{const B=u.ngModule;if(w=gl(B),!w)return!1;x=B}const F=_.has(x);if(D){if(F)return!1;if(_.add(x),D.dependencies){const B="function"==typeof D.dependencies?D.dependencies():D.dependencies;for(const G of B)Tg(G,d,p,_)}}else{if(!w)return!1;{if(null!=w.imports&&!F){let G;_.add(x);try{Eo(w.imports,X=>{Tg(X,d,p,_)&&(G||(G=[]),G.push(X))})}finally{}void 0!==G&&pM(G,d)}if(!F){const G=Su(x)||(()=>new x);d.push({provide:x,useFactory:G,deps:li},{provide:dM,useValue:x,multi:!0},{provide:zv,useValue:()=>Yr(x),multi:!0})}const B=w.providers;null==B||F||Eo(B,X=>{d.push(X)})}}return x!==u&&void 0!==u.providers}const MO=st({provide:String,useValue:st});function wg(u){return null!==u&&"object"==typeof u&&MO in u}function Ap(u){return"function"==typeof u}const Dp=new ei("Set Injector scope."),zb={},SO={};let mM;function Hb(){return void 0===mM&&(mM=new fM),mM}class Rp{}class y1 extends Rp{constructor(d,p,_,x){super(),this.parent=p,this.source=_,this.scopes=x,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,_M(d,D=>this.processProvider(D)),this.records.set(Il,Qc(void 0,this)),x.has("environment")&&this.records.set(Rp,Qc(void 0,this));const w=this.records.get(Dp);null!=w&&"string"==typeof w.value&&this.scopes.add(w.value),this.injectorDefTypes=new Set(this.get(dM.multi,li,Un.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const d of this._ngOnDestroyHooks)d.ngOnDestroy();for(const d of this._onDestroyHooks)d()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(d){this._onDestroyHooks.push(d)}runInContext(d){this.assertNotDestroyed();const p=Yo(this),_=Li(void 0);try{return d()}finally{Yo(p),Li(_)}}get(d,p=zu,_=Un.Default){this.assertNotDestroyed();const x=Yo(this),w=Li(void 0);try{if(!(_&Un.SkipSelf)){let F=this.records.get(d);if(void 0===F){const B=function DO(u){return"function"==typeof u||"object"==typeof u&&u instanceof ei}(d)&&gr(d);F=B&&this.injectableDefInScope(B)?Qc(b1(d),zb):null,this.records.set(d,F)}if(null!=F)return this.hydrate(d,F)}return(_&Un.Self?Hb():this.parent).get(d,p=_&Un.Optional&&p===zu?null:p)}catch(D){if("NullInjectorError"===D.name){if((D[Ja]=D[Ja]||[]).unshift(Oe(d)),x)throw D;return function V(u,d,p,_){const x=u[Ja];throw d[oi]&&x.unshift(d[oi]),u.message=function Y(u,d,p,_=null){u=u&&"\n"===u.charAt(0)&&"\u0275"==u.charAt(1)?u.slice(2):u;let x=Oe(d);if(Array.isArray(d))x=d.map(Oe).join(" -> ");else if("object"==typeof d){let w=[];for(let D in d)if(d.hasOwnProperty(D)){let F=d[D];w.push(D+":"+("string"==typeof F?JSON.stringify(F):Oe(F)))}x=`{${w.join(", ")}}`}return`${p}${_?"("+_+")":""}[${x}]: ${u.replace(Hu,"\n  ")}`}("\n"+u.message,x,p,_),u.ngTokenPath=x,u[Ja]=null,u}(D,d,"R3InjectorError",this.source)}throw D}finally{Li(w),Yo(x)}}resolveInjectorInitializers(){const d=Yo(this),p=Li(void 0);try{const _=this.get(zv.multi,li,Un.Self);for(const x of _)x()}finally{Yo(d),Li(p)}}toString(){const d=[],p=this.records;for(const _ of p.keys())d.push(Oe(_));return`R3Injector[${d.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new yt(205,!1)}processProvider(d){let p=Ap(d=Ne(d))?d:Ne(d&&d.provide);const _=function gM(u){return wg(u)?Qc(void 0,u.useValue):Qc(Wv(u),zb)}(d);if(Ap(d)||!0!==d.multi)this.records.get(p);else{let x=this.records.get(p);x||(x=Qc(void 0,zb,!0),x.factory=()=>zh(x.multi),this.records.set(p,x)),p=d,x.multi.push(d)}this.records.set(p,_)}hydrate(d,p){return p.value===zb&&(p.value=SO,p.value=p.factory()),"object"==typeof p.value&&p.value&&function AO(u){return null!==u&&"object"==typeof u&&"function"==typeof u.ngOnDestroy}(p.value)&&this._ngOnDestroyHooks.add(p.value),p.value}injectableDefInScope(d){if(!d.providedIn)return!1;const p=Ne(d.providedIn);return"string"==typeof p?"any"===p||this.scopes.has(p):this.injectorDefTypes.has(p)}}function b1(u){const d=gr(u),p=null!==d?d.factory:Su(u);if(null!==p)return p;if(u instanceof ei)throw new yt(204,!1);if(u instanceof Function)return function CO(u){const d=u.length;if(d>0)throw Gc(d,"?"),new yt(204,!1);const p=function oo(u){const d=u&&(u[ha]||u[Br]);if(d){const p=function Cr(u){if(u.hasOwnProperty("name"))return u.name;const d=(""+u).match(/^function\s*([^\s(]+)/);return null===d?"":d[1]}(u);return console.warn(`DEPRECATED: DI is instantiating a token "${p}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${p}" class.`),d}return null}(u);return null!==p?()=>p.factory(u):()=>new u}(u);throw new yt(204,!1)}function Wv(u,d,p){let _;if(Ap(u)){const x=Ne(u);return Su(x)||b1(x)}if(wg(u))_=()=>Ne(u.useValue);else if(function v1(u){return!(!u||!u.useFactory)}(u))_=()=>u.useFactory(...zh(u.deps||[]));else if(function Mg(u){return!(!u||!u.useExisting)}(u))_=()=>Yr(Ne(u.useExisting));else{const x=Ne(u&&(u.useClass||u.provide));if(!function EO(u){return!!u.deps}(u))return Su(x)||b1(x);_=()=>new x(...zh(u.deps))}return _}function Qc(u,d,p=!1){return{factory:u,value:d,multi:p?[]:void 0}}function RO(u){return!!u.\u0275providers}function _M(u,d){for(const p of u)Array.isArray(p)?_M(p,d):RO(p)?_M(p.\u0275providers,d):d(p)}class x1{}class LO{resolveComponentFactory(d){throw function PO(u){const d=Error(`No component factory found for ${Oe(u)}. Did you add it to @NgModule.entryComponents?`);return d.ngComponent=u,d}(d)}}let Ip=(()=>{class u{}return u.NULL=new LO,u})();function w1(){return cf(Vr(),Pt())}function cf(u,d){return new uf(qo(u,d))}let uf=(()=>{class u{constructor(p){this.nativeElement=p}}return u.__NG_ELEMENT_ID__=w1,u})();function OO(u){return u instanceof uf?u.nativeElement:u}class M1{}let kO=(()=>{class u{}return u.__NG_ELEMENT_ID__=()=>function Wb(){const u=Pt(),p=co(Vr().index,u);return(Zs(p)?p:u)[11]}(),u})(),S1=(()=>{class u{}return u.\u0275prov=Ui({token:u,providedIn:"root",factory:()=>null}),u})();class vM{constructor(d){this.full=d,this.major=d.split(".")[0],this.minor=d.split(".")[1],this.patch=d.split(".").slice(2).join(".")}}const qv=new vM("14.1.3"),Sg={};function Zb(u){return u.ngOriginalError}class Cg{constructor(){this._console=console}handleError(d){const p=this._findOriginalError(d);this._console.error("ERROR",d),p&&this._console.error("ORIGINAL ERROR",p)}_findOriginalError(d){let p=d&&Zb(d);for(;p&&Zb(p);)p=Zb(p);return p||null}}const MM=new Map;let F1=0;const Yv="__ngContext__";function Ko(u,d){Zs(d)?(u[Yv]=d[20],function L1(u){MM.set(u[20],u)}(d)):u[Yv]=d}function Pp(u){const d=u[Yv];return"number"==typeof d?function CM(u){return MM.get(u)||null}(d):d||null}function Kv(u){const d=Pp(u);return d?Zs(d)?d:d.lView:null}const Do=(()=>(typeof requestAnimationFrame<"u"&&requestAnimationFrame||setTimeout).bind(un))();function Wh(u){return u instanceof Function?u():u}var Zu=(()=>((Zu=Zu||{})[Zu.Important=1]="Important",Zu[Zu.DashCase=2]="DashCase",Zu))();function V1(u,d){return undefined(u,d)}function $v(u){const d=u[3];return qr(d)?d[3]:d}function PM(u){return z1(u[13])}function FM(u){return z1(u[4])}function z1(u){for(;null!==u&&!qr(u);)u=u[4];return u}function Fp(u,d,p,_,x){if(null!=_){let w,D=!1;qr(_)?w=_:Zs(_)&&(D=!0,_=_[0]);const F=ar(_);0===u&&null!==p?null==x?ak(d,p,F):qh(d,p,F,x||null,!0):1===u&&null!==p?qh(d,p,F,x||null,!0):2===u?function Zh(u,d,p){const _=BM(u,d);_&&function ck(u,d,p,_){u.removeChild(d,p,_)}(u,_,d,p)}(d,F,D):3===u&&d.destroyNode(F),null!=w&&function bz(u,d,p,_,x){const w=p[7];w!==ar(p)&&Fp(d,u,_,w,x);for(let F=10;F<p.length;F++){const B=p[F];Dg(B[1],B,u,d,_,w)}}(d,u,w,p,x)}}function kM(u,d,p){return u.createElement(d,p)}function sk(u,d){const p=u[9],_=p.indexOf(d),x=d[3];512&d[2]&&(d[2]&=-513,Ya(x,-1)),p.splice(_,1)}function nt(u,d){if(u.length<=10)return;const p=10+d,_=u[p];if(_){const x=_[17];null!==x&&x!==u&&sk(x,_),d>0&&(u[p-1][4]=_[4]);const w=Uh(u,10+d);!function H1(u,d){Dg(u,d,d[11],2,null,null),d[0]=null,d[6]=null}(_[1],_);const D=w[19];null!==D&&D.detachView(w[1]),_[3]=null,_[4]=null,_[2]&=-65}return _}function pr(u,d){if(!(128&d[2])){const p=d[11];p.destroyNode&&Dg(u,d,p,3,null,null),function nk(u){let d=u[13];if(!d)return Qv(u[1],u);for(;d;){let p=null;if(Zs(d))p=d[13];else{const _=d[10];_&&(p=_)}if(!p){for(;d&&!d[4]&&d!==u;)Zs(d)&&Qv(d[1],d),d=d[3];null===d&&(d=u),Zs(d)&&Qv(d[1],d),p=d&&d[4]}d=p}}(d)}}function Qv(u,d){if(!(128&d[2])){d[2]&=-65,d[2]|=128,function W1(u,d){let p;if(null!=u&&null!=(p=u.destroyHooks))for(let _=0;_<p.length;_+=2){const x=d[p[_]];if(!(x instanceof Wd)){const w=p[_+1];if(Array.isArray(w))for(let D=0;D<w.length;D+=2){const F=x[w[D]],B=w[D+1];try{B.call(F)}finally{}}else try{w.call(x)}finally{}}}}(u,d),function Eg(u,d){const p=u.cleanup,_=d[7];let x=-1;if(null!==p)for(let w=0;w<p.length-1;w+=2)if("string"==typeof p[w]){const D=p[w+1],F="function"==typeof D?D(d):ar(d[D]),B=_[x=p[w+2]],G=p[w+3];"boolean"==typeof G?F.removeEventListener(p[w],B,G):G>=0?_[x=G]():_[x=-G].unsubscribe(),w+=2}else{const D=_[x=p[w+1]];p[w].call(D)}if(null!==_){for(let w=x+1;w<_.length;w++)(0,_[w])();d[7]=null}}(u,d),1===d[1].type&&d[11].destroy();const p=d[17];if(null!==p&&qr(d[3])){p!==d[3]&&sk(p,d);const _=d[19];null!==_&&_.detachView(u)}!function gz(u){MM.delete(u[20])}(d)}}function ok(u,d,p){return function q1(u,d,p){let _=d;for(;null!==_&&40&_.type;)_=(d=_).parent;if(null===_)return p[0];if(2&_.flags){const x=u.data[_.directiveStart].encapsulation;if(x===Ai.None||x===Ai.Emulated)return null}return qo(_,p)}(u,d.parent,p)}function qh(u,d,p,_,x){u.insertBefore(d,p,_,x)}function ak(u,d,p){u.appendChild(d,p)}function lk(u,d,p,_,x){null!==_?qh(u,d,p,_,x):ak(u,d,p)}function BM(u,d){return u.parentNode(d)}function uk(u,d,p){return dk(u,d,p)}let dk=function hk(u,d,p){return 40&u.type?qo(u,p):null};function jM(u,d,p,_){const x=ok(u,_,d),w=d[11],F=uk(_.parent||d[6],_,d);if(null!=x)if(Array.isArray(p))for(let B=0;B<p.length;B++)lk(w,x,p[B],F,!1);else lk(w,x,p,F,!1)}function UM(u,d){if(null!==d){const p=d.type;if(3&p)return qo(d,u);if(4&p)return Jc(-1,u[d.index]);if(8&p){const _=d.child;if(null!==_)return UM(u,_);{const x=u[d.index];return qr(x)?Jc(-1,x):ar(x)}}if(32&p)return V1(d,u)()||ar(u[d.index]);{const _=Fi(u,d);return null!==_?Array.isArray(_)?_[0]:UM($v(u[16]),_):UM(u,d.next)}}return null}function Fi(u,d){return null!==d?u[16][6].projection[d.projection]:null}function Jc(u,d){const p=10+u+1;if(p<d.length){const _=d[p],x=_[1].firstChild;if(null!==x)return UM(_,x)}return d[7]}function Ag(u,d,p,_,x,w,D){for(;null!=p;){const F=_[p.index],B=p.type;if(D&&0===d&&(F&&Ko(ar(F),_),p.flags|=4),64!=(64&p.flags))if(8&B)Ag(u,d,p.child,_,x,w,!1),Fp(d,u,x,F,w);else if(32&B){const G=V1(p,_);let X;for(;X=G();)Fp(d,u,x,X,w);Fp(d,u,x,F,w)}else 16&B?GM(u,d,_,p,x,w):Fp(d,u,x,F,w);p=D?p.projectionNext:p.next}}function Dg(u,d,p,_,x,w){Ag(p,_,u.firstChild,d,x,w,!1)}function GM(u,d,p,_,x,w){const D=p[16],B=D[6].projection[_.projection];if(Array.isArray(B))for(let G=0;G<B.length;G++)Fp(d,u,x,B[G],w);else Ag(u,d,B,D[3],x,w,!0)}function Y1(u,d,p){u.setAttribute(d,"style",p)}function HM(u,d,p){""===p?u.removeAttribute(d,"class"):u.setAttribute(d,"class",p)}function pk(u,d,p){let _=u.length;for(;;){const x=u.indexOf(d,p);if(-1===x)return x;if(0===x||u.charCodeAt(x-1)<=32){const w=d.length;if(x+w===_||u.charCodeAt(x+w)<=32)return x}p=x+1}}const K1="ng-template";function xz(u,d,p){let _=0;for(;_<u.length;){let x=u[_++];if(p&&"class"===x){if(x=u[_],-1!==pk(x.toLowerCase(),d,0))return!0}else if(1===x){for(;_<u.length&&"string"==typeof(x=u[_++]);)if(x.toLowerCase()===d)return!0;return!1}}return!1}function mk(u){return 4===u.type&&u.value!==K1}function Tz(u,d,p){return d===(4!==u.type||p?u.value:K1)}function wz(u,d,p){let _=4;const x=u.attrs||[],w=function Cz(u){for(let d=0;d<u.length;d++)if(_p(u[d]))return d;return u.length}(x);let D=!1;for(let F=0;F<d.length;F++){const B=d[F];if("number"!=typeof B){if(!D)if(4&_){if(_=2|1&_,""!==B&&!Tz(u,B,p)||""===B&&1===d.length){if(Ku(_))return!1;D=!0}}else{const G=8&_?B:d[++F];if(8&_&&null!==u.attrs){if(!xz(u.attrs,G,p)){if(Ku(_))return!1;D=!0}continue}const ae=Mz(8&_?"class":B,x,mk(u),p);if(-1===ae){if(Ku(_))return!1;D=!0;continue}if(""!==G){let De;De=ae>w?"":x[ae+1].toLowerCase();const Ue=8&_?De:null;if(Ue&&-1!==pk(Ue,G,0)||2&_&&G!==De){if(Ku(_))return!1;D=!0}}}}else{if(!D&&!Ku(_)&&!Ku(B))return!1;if(D&&Ku(B))continue;D=!1,_=B|1&_}}return Ku(_)||D}function Ku(u){return 0==(1&u)}function Mz(u,d,p,_){if(null===d)return-1;let x=0;if(_||!p){let w=!1;for(;x<d.length;){const D=d[x];if(D===u)return x;if(3===D||6===D)w=!0;else{if(1===D||2===D){let F=d[++x];for(;"string"==typeof F;)F=d[++x];continue}if(4===D)break;if(0===D){x+=4;continue}}x+=w?1:2}return-1}return function Ez(u,d){let p=u.indexOf(4);if(p>-1)for(p++;p<u.length;){const _=u[p];if("number"==typeof _)return-1;if(_===d)return p;p++}return-1}(d,u)}function gk(u,d,p=!1){for(let _=0;_<d.length;_++)if(wz(u,d[_],p))return!0;return!1}function Az(u,d){e:for(let p=0;p<d.length;p++){const _=d[p];if(u.length===_.length){for(let x=0;x<u.length;x++)if(u[x]!==_[x])continue e;return!0}}return!1}function _k(u,d){return u?":not("+d.trim()+")":d}function Dz(u){let d=u[0],p=1,_=2,x="",w=!1;for(;p<u.length;){let D=u[p];if("string"==typeof D)if(2&_){const F=u[++p];x+="["+D+(F.length>0?'="'+F+'"':"")+"]"}else 8&_?x+="."+D:4&_&&(x+=" "+D);else""!==x&&!Ku(D)&&(d+=_k(w,x),x=""),_=D,w=w||!Ku(_);p++}return""!==x&&(d+=_k(w,x)),d}const wi={};function vk(u){yk(mi(),Pt(),ss()+u,!1)}function yk(u,d,p,_){if(!_)if(3==(3&d[2])){const w=u.preOrderCheckHooks;null!==w&&cg(d,w,p)}else{const w=u.preOrderHooks;null!==w&&bv(d,w,0,p)}Ka(p)}function wk(u,d=null,p=null,_){const x=Mk(u,d,p,_);return x.resolveInjectorInitializers(),x}function Mk(u,d=null,p=null,_,x=new Set){const w=[p||li,wO(u)];return _=_||("object"==typeof u?void 0:Oe(u)),new y1(w,d||Hb(),_||null,x)}let Rg=(()=>{class u{static create(p,_){if(Array.isArray(p))return wk({name:""},_,p,"");{const x=p.name??"";return wk({name:x},p.parent,p.providers,x)}}}return u.THROW_IF_NOT_FOUND=zu,u.NULL=new fM,u.\u0275prov=Ui({token:u,providedIn:"any",factory:()=>Yr(Il)}),u.__NG_ELEMENT_ID__=-1,u})();function df(u,d=Un.Default){const p=Pt();return null===p?Yr(u,d):Bh(Vr(),p,Ne(u),d)}function Q1(){throw new Error("invalid")}function Kb(u,d){return u<<17|d<<2}function lc(u){return u>>17&32767}function KM(u){return 2|u}function Yh(u){return(131068&u)>>2}function Xo(u,d){return-131069&u|d<<2}function Xb(u){return 1|u}function hD(u,d){const p=u.contentQueries;if(null!==p)for(let _=0;_<p.length;_+=2){const x=p[_],w=p[_+1];if(-1!==w){const D=u.data[w];hp(x),D.contentQueries(2,d[w],w)}}}function ix(u,d,p,_,x,w,D,F,B,G,X){const ae=d.blueprint.slice();return ae[0]=x,ae[2]=76|_,(null!==X||u&&1024&u[2])&&(ae[2]|=1024),Eh(ae),ae[3]=ae[15]=u,ae[8]=p,ae[10]=D||u&&u[10],ae[11]=F||u&&u[11],ae[12]=B||u&&u[12]||null,ae[9]=G||u&&u[9]||null,ae[6]=w,ae[20]=function SM(){return F1++}(),ae[21]=X,ae[16]=2==d.type?u[16]:ae,ae}function Pg(u,d,p,_,x){let w=u.data[d];if(null===w)w=function iS(u,d,p,_,x){const w=Ic(),D=lp(),B=u.data[d]=function tH(u,d,p,_,x,w){return{type:p,index:_,insertBeforeIndex:null,injectorIndex:d?d.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:x,attrs:w,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:d,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,D?w:w&&w.parent,p,d,_,x);return null===u.firstChild&&(u.firstChild=B),null!==w&&(D?null==w.child&&null!==B.parent&&(w.child=B):null===w.next&&(w.next=B)),B}(u,d,p,_,x),function vv(){return ri.lFrame.inI18n}()&&(w.flags|=64);else if(64&w.type){w.type=p,w.value=_,w.attrs=x;const D=function Pc(){const u=ri.lFrame,d=u.currentTNode;return u.isParent?d:d.parent}();w.injectorIndex=null===D?-1:D.injectorIndex}return So(w,!0),w}function Fg(u,d,p,_){if(0===p)return-1;const x=d.length;for(let w=0;w<p;w++)d.push(_),u.blueprint.push(_),u.data.push(null);return x}function rx(u,d,p){wl(d);try{const _=u.viewQuery;null!==_&&ho(1,_,p);const x=u.template;null!==x&&rS(u,d,x,1,p),u.firstCreatePass&&(u.firstCreatePass=!1),u.staticContentQueries&&hD(u,d),u.staticViewQueries&&ho(2,u.viewQuery,p);const w=u.components;null!==w&&function jk(u,d){for(let p=0;p<d.length;p++)ux(u,d[p])}(d,w)}catch(_){throw u.firstCreatePass&&(u.incompleteFirstPass=!0,u.firstCreatePass=!1),_}finally{d[2]&=-5,dp()}}function mf(u,d,p,_){const x=d[2];if(128!=(128&x)){wl(d);try{Eh(d),function ig(u){return ri.lFrame.bindingIndex=u}(u.bindingStartIndex),null!==p&&rS(u,d,p,2,_);const D=3==(3&x);if(D){const G=u.preOrderCheckHooks;null!==G&&cg(d,G,null)}else{const G=u.preOrderHooks;null!==G&&bv(d,G,0,null),mp(d,0)}if(function Rn(u){for(let d=PM(u);null!==d;d=FM(d)){if(!d[2])continue;const p=d[9];for(let _=0;_<p.length;_++){const x=p[_],w=x[3];0==(512&x[2])&&Ya(w,1),x[2]|=512}}}(d),function Xh(u){for(let d=PM(u);null!==d;d=FM(d))for(let p=10;p<d.length;p++){const _=d[p],x=_[1];$l(_)&&mf(x,_,x.template,_[8])}}(d),null!==u.contentQueries&&hD(u,d),D){const G=u.contentCheckHooks;null!==G&&cg(d,G)}else{const G=u.contentHooks;null!==G&&bv(d,G,1),mp(d,1)}!function Nk(u,d){const p=u.hostBindingOpCodes;if(null!==p)try{for(let _=0;_<p.length;_++){const x=p[_];if(x<0)Ka(~x);else{const w=x,D=p[++_],F=p[++_];up(D,w),F(2,d[w])}}}finally{Ka(-1)}}(u,d);const F=u.components;null!==F&&function Bk(u,d){for(let p=0;p<d.length;p++)cS(u,d[p])}(d,F);const B=u.viewQuery;if(null!==B&&ho(2,B,_),D){const G=u.viewCheckHooks;null!==G&&cg(d,G)}else{const G=u.viewHooks;null!==G&&bv(d,G,2),mp(d,2)}!0===u.firstUpdatePass&&(u.firstUpdatePass=!1),d[2]&=-41,512&d[2]&&(d[2]&=-513,Ya(d[3],-1))}finally{dp()}}}function dD(u,d,p,_){const x=d[10],D=Dc(d);try{!D&&x.begin&&x.begin(),D&&rx(u,d,_),mf(u,d,p,_)}finally{!D&&x.end&&x.end()}}function rS(u,d,p,_,x){const w=ss(),D=2&_;try{Ka(-1),D&&d.length>22&&yk(u,d,22,!1),p(_,x)}finally{Ka(w)}}function sx(u,d,p){if(Sc(d)){const x=d.directiveEnd;for(let w=d.directiveStart;w<x;w++){const D=u.data[w];D.contentQueries&&D.contentQueries(1,p[w],w)}}}function sS(u,d,p){!Au()||(function iH(u,d,p,_){const x=p.directiveStart,w=p.directiveEnd;u.firstCreatePass||Bn(p,d),Ko(_,d);const D=p.initialInputs;for(let F=x;F<w;F++){const B=u.data[F],G=Wo(B);G&&Jk(d,p,B);const X=Sn(d,u,F,p);Ko(X,d),null!==D&&rH(0,F-x,X,B,0,D),G&&(co(p.index,d)[8]=X)}}(u,d,p,qo(p,d)),128==(128&p.flags)&&function lS(u,d,p){const _=p.directiveStart,x=p.directiveEnd,w=p.index,D=function Ud(){return ri.lFrame.currentDirectiveIndex}();try{Ka(w);for(let F=_;F<x;F++){const B=u.data[F],G=d[F];Rh(F),(null!==B.hostBindings||0!==B.hostVars||null!==B.hostAttrs)&&qk(B,G)}}finally{Ka(-1),Rh(D)}}(u,d,p))}function oS(u,d,p=qo){const _=d.localNames;if(null!==_){let x=d.index+1;for(let w=0;w<_.length;w+=2){const D=_[w+1],F=-1===D?p(d,u):u[D];u[x++]=F}}}function fD(u){const d=u.tView;return null===d||d.incompleteFirstPass?u.tView=ox(1,null,u.template,u.decls,u.vars,u.directiveDefs,u.pipeDefs,u.viewQuery,u.schemas,u.consts):d}function ox(u,d,p,_,x,w,D,F,B,G){const X=22+_,ae=X+x,De=function pD(u,d){const p=[];for(let _=0;_<d;_++)p.push(_<u?null:wi);return p}(X,ae),Ue="function"==typeof G?G():G;return De[1]={type:u,blueprint:De,template:p,queries:null,viewQuery:F,declTNode:d,data:De.slice().fill(null,X),bindingStartIndex:X,expandoStartIndex:ae,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof w?w():w,pipeRegistry:"function"==typeof D?D():D,firstChild:null,schemas:B,consts:Ue,incompleteFirstPass:!1}}function aS(u,d,p,_){const x=xD(d);null===p?x.push(_):(x.push(p),u.firstCreatePass&&mS(u).push(_,x.length-1))}function gD(u,d,p){for(let _ in u)if(u.hasOwnProperty(_)){const x=u[_];(p=null===p?{}:p).hasOwnProperty(_)?p[_].push(d,x):p[_]=[d,x]}return p}function Vk(u,d){const _=d.directiveEnd,x=u.data,w=d.attrs,D=[];let F=null,B=null;for(let G=d.directiveStart;G<_;G++){const X=x[G],ae=X.inputs,De=null===w||mk(d)?null:sH(ae,w);D.push(De),F=gD(ae,G,F),B=gD(X.outputs,G,B)}null!==F&&(F.hasOwnProperty("class")&&(d.flags|=16),F.hasOwnProperty("style")&&(d.flags|=32)),d.initialInputs=D,d.inputs=F,d.outputs=B}function Fa(u,d,p,_,x,w,D,F){const B=qo(d,p);let X,G=d.inputs;!F&&null!=G&&(X=G[_])?(hx(u,p,X,_,x),Ld(d)&&Gk(p,d.index)):3&d.type&&(_=function nH(u){return"class"===u?"className":"for"===u?"htmlFor":"formaction"===u?"formAction":"innerHtml"===u?"innerHTML":"readonly"===u?"readOnly":"tabindex"===u?"tabIndex":u}(_),x=null!=D?D(x,d.value||"",_):x,w.setProperty(B,_,x))}function Gk(u,d){const p=co(d,u);16&p[2]||(p[2]|=32)}function ax(u,d,p,_){let x=!1;if(Au()){const w=function Zk(u,d,p){const _=u.directiveRegistry;let x=null;if(_)for(let w=0;w<_.length;w++){const D=_[w];gk(p,D.selectors,!1)&&(x||(x=[]),bs(Bn(p,d),u,D.type),Wo(D)?(Yk(u,p),x.unshift(D)):x.push(D))}return x}(u,d,p),D=null===_?null:{"":-1};if(null!==w){x=!0,$k(p,u.data.length,w.length);for(let X=0;X<w.length;X++){const ae=w[X];ae.providersResolver&&ae.providersResolver(ae)}let F=!1,B=!1,G=Fg(u,d,w.length,null);for(let X=0;X<w.length;X++){const ae=w[X];p.mergedAttrs=Nc(p.mergedAttrs,ae.hostAttrs),Qk(u,p,d,G,ae),Xk(G,ae,D),null!==ae.contentQueries&&(p.flags|=8),(null!==ae.hostBindings||null!==ae.hostAttrs||0!==ae.hostVars)&&(p.flags|=128);const De=ae.type.prototype;!F&&(De.ngOnChanges||De.ngOnInit||De.ngDoCheck)&&((u.preOrderHooks||(u.preOrderHooks=[])).push(p.index),F=!0),!B&&(De.ngOnChanges||De.ngDoCheck)&&((u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(p.index),B=!0),G++}Vk(u,p)}D&&function Kk(u,d,p){if(d){const _=u.localNames=[];for(let x=0;x<d.length;x+=2){const w=p[d[x+1]];if(null==w)throw new yt(-301,!1);_.push(d[x],w)}}}(p,_,D)}return p.mergedAttrs=Nc(p.mergedAttrs,p.attrs),x}function lx(u,d,p,_,x,w){const D=w.hostBindings;if(D){let F=u.hostBindingOpCodes;null===F&&(F=u.hostBindingOpCodes=[]);const B=~d.index;(function cx(u){let d=u.length;for(;d>0;){const p=u[--d];if("number"==typeof p&&p<0)return p}return 0})(F)!=B&&F.push(B),F.push(_,x,D)}}function qk(u,d){null!==u.hostBindings&&u.hostBindings(1,d)}function Yk(u,d){d.flags|=2,(u.components||(u.components=[])).push(d.index)}function Xk(u,d,p){if(p){if(d.exportAs)for(let _=0;_<d.exportAs.length;_++)p[d.exportAs[_]]=u;Wo(d)&&(p[""]=u)}}function $k(u,d,p){u.flags|=1,u.directiveStart=d,u.directiveEnd=d+p,u.providerIndexes=d}function Qk(u,d,p,_,x){u.data[_]=x;const w=x.factory||(x.factory=Su(x.type)),D=new Wd(w,Wo(x),df);u.blueprint[_]=D,p[_]=D,lx(u,d,0,_,Fg(u,p,x.hostVars,wi),x)}function Jk(u,d,p){const _=qo(d,u),x=fD(p),w=u[10],D=gf(u,ix(u,x,null,p.onPush?32:16,_,d,w,w.createRenderer(_,p),null,null,null));u[d.index]=D}function Kh(u,d,p,_,x,w){const D=qo(u,d);!function _D(u,d,p,_,x,w,D){if(null==w)u.removeAttribute(d,x,p);else{const F=null==D?dt(w):D(w,_||"",x);u.setAttribute(d,x,F,p)}}(d[11],D,w,u.value,p,_,x)}function rH(u,d,p,_,x,w){const D=w[d];if(null!==D){const F=_.setInput;for(let B=0;B<D.length;){const G=D[B++],X=D[B++],ae=D[B++];null!==F?_.setInput(p,ae,G,X):p[X]=ae}}}function sH(u,d){let p=null,_=0;for(;_<d.length;){const x=d[_];if(0!==x)if(5!==x){if("number"==typeof x)break;u.hasOwnProperty(x)&&(null===p&&(p=[]),p.push(x,u[x],d[_+1])),_+=2}else _+=2;else _+=4}return p}function vD(u,d,p,_){return new Array(u,!0,!1,d,null,0,_,p,null,null)}function cS(u,d){const p=co(d,u);if($l(p)){const _=p[1];48&p[2]?mf(_,p,_.template,p[8]):p[5]>0&&gi(p)}}function gi(u){for(let _=PM(u);null!==_;_=FM(_))for(let x=10;x<_.length;x++){const w=_[x];if($l(w))if(512&w[2]){const D=w[1];mf(D,w,D.template,w[8])}else w[5]>0&&gi(w)}const p=u[1].components;if(null!==p)for(let _=0;_<p.length;_++){const x=co(p[_],u);$l(x)&&x[5]>0&&gi(x)}}function ux(u,d){const p=co(d,u),_=p[1];(function uS(u,d){for(let p=d.length;p<u.blueprint.length;p++)d.push(u.blueprint[p])})(_,p),rx(_,p,p[8])}function gf(u,d){return u[13]?u[14][4]=d:u[13]=d,u[14]=d,d}function hS(u){for(;u;){u[2]|=32;const d=$v(u);if(rp(u)&&!d)return u;u=d}return null}function bD(u){!function yD(u){for(let d=0;d<u.components.length;d++){const p=u.components[d],_=Kv(p);if(null!==_){const x=_[1];dD(x,_,x.template,p)}}}(u[8])}function ho(u,d,p){hp(0),d(u,p)}const e2=(()=>Promise.resolve(null))();function xD(u){return u[7]||(u[7]=[])}function mS(u){return u.cleanup||(u.cleanup=[])}function gS(u,d,p){return(null===u||Wo(u))&&(p=function Nd(u){for(;Array.isArray(u);){if("object"==typeof u[1])return u;u=u[0]}return null}(p[d.index])),p[11]}function TD(u,d){const p=u[9],_=p?p.get(Cg,null):null;_&&_.handleError(d)}function hx(u,d,p,_,x){for(let w=0;w<p.length;){const D=p[w++],F=p[w++],B=d[D],G=u.data[D];null!==G.setInput?G.setInput(B,x,_,F):B[F]=x}}function Op(u,d,p){let _=p?u.styles:null,x=p?u.classes:null,w=0;if(null!==d)for(let D=0;D<d.length;D++){const F=d[D];"number"==typeof F?w=F:1==w?x=ct(x,F):2==w&&(_=ct(_,F+": "+d[++D]+";"))}p?u.styles=_:u.stylesWithoutHost=_,p?u.classes=x:u.classesWithoutHost=x}function ay(u,d,p,_,x=!1){for(;null!==p;){const w=d[p.index];if(null!==w&&_.push(ar(w)),qr(w))for(let F=10;F<w.length;F++){const B=w[F],G=B[1].firstChild;null!==G&&ay(B[1],B,G,_)}const D=p.type;if(8&D)ay(u,d,p.child,_);else if(32&D){const F=V1(p,d);let B;for(;B=F();)_.push(B)}else if(16&D){const F=Fi(d,p);if(Array.isArray(F))_.push(...F);else{const B=$v(d[16]);ay(B[1],B,F,_,!0)}}p=x?p.projectionNext:p.next}return _}class fo{constructor(d,p){this._lView=d,this._cdRefInjectingView=p,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const d=this._lView,p=d[1];return ay(p,d,p.firstChild,[])}get context(){return this._lView[8]}set context(d){this._lView[8]=d}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const d=this._lView[3];if(qr(d)){const p=d[8],_=p?p.indexOf(this):-1;_>-1&&(nt(d,_),Uh(p,_))}this._attachedToViewContainer=!1}pr(this._lView[1],this._lView)}onDestroy(d){aS(this._lView[1],this._lView,null,d)}markForCheck(){hS(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){!function fS(u,d,p){const _=d[10];_.begin&&_.begin();try{mf(u,d,u.template,p)}catch(x){throw TD(d,x),x}finally{_.end&&_.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new yt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function NM(u,d){Dg(u,d,d[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(d){if(this._attachedToViewContainer)throw new yt(902,!1);this._appRef=d}}class _S extends fo{constructor(d){super(d),this._view=d}detectChanges(){bD(this._view)}checkNoChanges(){}get context(){return null}}class $o extends Ip{constructor(d){super(),this.ngModule=d}resolveComponentFactory(d){const p=Re(d);return new Lg(p,this.ngModule)}}function vS(u){const d=[];for(let p in u)u.hasOwnProperty(p)&&d.push({propName:u[p],templateName:p});return d}class yS{constructor(d,p){this.injector=d,this.parentInjector=p}get(d,p,_){const x=this.injector.get(d,Sg,_);return x!==Sg||p===Sg?x:this.parentInjector.get(d,p,_)}}class Lg extends x1{constructor(d,p){super(),this.componentDef=d,this.ngModule=p,this.componentType=d.type,this.selector=function Rz(u){return u.map(Dz).join(",")}(d.selectors),this.ngContentSelectors=d.ngContentSelectors?d.ngContentSelectors:[],this.isBoundToModule=!!p}get inputs(){return vS(this.componentDef.inputs)}get outputs(){return vS(this.componentDef.outputs)}create(d,p,_,x){let w=(x=x||this.ngModule)instanceof Rp?x:x?.injector;w&&null!==this.componentDef.getStandaloneInjector&&(w=this.componentDef.getStandaloneInjector(w)||w);const D=w?new yS(d,w):d,F=D.get(M1,null);if(null===F)throw new yt(407,!1);const B=D.get(S1,null),G=F.createRenderer(null,this.componentDef),X=this.componentDef.selectors[0][0]||"div",ae=_?function mD(u,d,p){return u.selectRootElement(d,p===Ai.ShadowDom)}(G,_,this.componentDef.encapsulation):kM(F.createRenderer(null,this.componentDef),X,function wD(u){const d=u.toLowerCase();return"svg"===d?"svg":"math"===d?"math":null}(X)),De=this.componentDef.onPush?288:272,Ue=function SD(u,d){return{components:[],scheduler:u||Do,clean:e2,playerHandler:d||null,flags:0}}(),xt=ox(0,null,null,1,0,null,null,null,null,null),Ht=ix(null,xt,Ue,De,null,null,F,G,B,D,null);let hn,An;wl(Ht);try{const si=function n2(u,d,p,_,x,w){const D=p[1];p[22]=u;const B=Pg(D,22,2,"#host",null),G=B.mergedAttrs=d.hostAttrs;null!==G&&(Op(B,G,!0),null!==u&&(Lh(x,u,G),null!==B.classes&&HM(x,u,B.classes),null!==B.styles&&Y1(x,u,B.styles)));const X=_.createRenderer(u,d),ae=ix(p,fD(d),null,d.onPush?32:16,p[22],B,_,X,w||null,null,null);return D.firstCreatePass&&(bs(Bn(B,p),D,d.type),Yk(D,B),$k(B,p.length,1)),gf(p,ae),p[22]=ae}(ae,this.componentDef,Ht,F,G);if(ae)if(_)Lh(G,ae,["ng-version",qv.full]);else{const{attrs:kt,classes:Xn}=function Iz(u){const d=[],p=[];let _=1,x=2;for(;_<u.length;){let w=u[_];if("string"==typeof w)2===x?""!==w&&d.push(w,u[++_]):8===x&&p.push(w);else{if(!Ku(x))break;x=w}_++}return{attrs:d,classes:p}}(this.componentDef.selectors[0]);kt&&Lh(G,ae,kt),Xn&&Xn.length>0&&HM(G,ae,Xn.join(" "))}if(An=Xl(xt,22),void 0!==p){const kt=An.projection=[];for(let Xn=0;Xn<this.ngContentSelectors.length;Xn++){const Oi=p[Xn];kt.push(null!=Oi?Array.from(Oi):null)}}hn=function Og(u,d,p,_,x){const w=p[1],D=function Wk(u,d,p){const _=Vr();u.firstCreatePass&&(p.providersResolver&&p.providersResolver(p),Qk(u,_,d,Fg(u,d,1,null),p),Vk(u,_));const x=Sn(d,u,_.directiveStart,_);Ko(x,d);const w=qo(_,d);return w&&Ko(w,d),x}(w,p,d);if(_.components.push(D),u[8]=D,null!==x)for(const B of x)B(D,d);if(d.contentQueries){const B=Vr();d.contentQueries(1,D,B.directiveStart)}const F=Vr();return!w.firstCreatePass||null===d.hostBindings&&null===d.hostAttrs||(Ka(F.index),lx(p[1],F,0,F.directiveStart,F.directiveEnd,d),qk(d,D)),D}(si,this.componentDef,Ht,Ue,[xS]),rx(xt,Ht,null)}finally{dp()}return new bS(this.componentType,hn,cf(An,Ht),Ht,An)}}class bS extends class IO{}{constructor(d,p,_,x,w){super(),this.location=_,this._rootLView=x,this._tNode=w,this.instance=p,this.hostView=this.changeDetectorRef=new _S(x),this.componentType=d}setInput(d,p){const _=this._tNode.inputs;let x;if(null!==_&&(x=_[d])){const w=this._rootLView;hx(w[1],w,x,d,p),Gk(w,this._tNode.index)}}get injector(){return new Da(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(d){this.hostView.onDestroy(d)}}function xS(){const u=Vr();pp(Pt()[1],u)}function dx(u){let d=function CD(u){return Object.getPrototypeOf(u.prototype).constructor}(u.type),p=!0;const _=[u];for(;d;){let x;if(Wo(u))x=d.\u0275cmp||d.\u0275dir;else{if(d.\u0275cmp)throw new yt(903,!1);x=d.\u0275dir}if(x){if(p){_.push(x);const D=u;D.inputs=ly(u.inputs),D.declaredInputs=ly(u.declaredInputs),D.outputs=ly(u.outputs);const F=x.hostBindings;F&&s2(u,F);const B=x.viewQuery,G=x.contentQueries;if(B&&TS(u,B),G&&wS(u,G),Tt(u.inputs,x.inputs),Tt(u.declaredInputs,x.declaredInputs),Tt(u.outputs,x.outputs),Wo(x)&&x.data.animation){const X=u.data;X.animation=(X.animation||[]).concat(x.data.animation)}}const w=x.features;if(w)for(let D=0;D<w.length;D++){const F=w[D];F&&F.ngInherit&&F(u),F===dx&&(p=!1)}}d=Object.getPrototypeOf(d)}!function fx(u){let d=0,p=null;for(let _=u.length-1;_>=0;_--){const x=u[_];x.hostVars=d+=x.hostVars,x.hostAttrs=Nc(x.hostAttrs,p=Nc(p,x.hostAttrs))}}(_)}function ly(u){return u===gs?{}:u===li?[]:u}function TS(u,d){const p=u.viewQuery;u.viewQuery=p?(_,x)=>{d(_,x),p(_,x)}:d}function wS(u,d){const p=u.contentQueries;u.contentQueries=p?(_,x,w)=>{d(_,x,w),p(_,x,w)}:d}function s2(u,d){const p=u.hostBindings;u.hostBindings=p?(_,x)=>{d(_,x),p(_,x)}:d}let px=null;function kp(){if(!px){const u=un.Symbol;if(u&&u.iterator)px=u.iterator;else{const d=Object.getOwnPropertyNames(Map.prototype);for(let p=0;p<d.length;++p){const _=d[p];"entries"!==_&&"size"!==_&&Map.prototype[_]===Map.prototype.entries&&(px=_)}}}return px}function $h(u){return!!SS(u)&&(Array.isArray(u)||!(u instanceof Map)&&kp()in u)}function SS(u){return null!==u&&("function"==typeof u||"object"==typeof u)}function Pl(u,d,p){return u[d]=p}function Ro(u,d,p){return!Object.is(u[d],p)&&(u[d]=p,!0)}function mx(u,d,p,_){const x=Pt();return Ro(x,Oc(),d)&&(mi(),Kh(nr(),x,u,d,p,_)),mx}function Ng(u,d,p,_){return Ro(u,Oc(),p)?d+dt(p)+_:wi}function ID(u,d,p,_,x,w,D,F){const B=Pt(),G=mi(),X=u+22,ae=G.firstCreatePass?function AS(u,d,p,_,x,w,D,F,B){const G=d.consts,X=Pg(d,u,4,D||null,Mo(G,F));ax(d,p,X,Mo(G,B)),pp(d,X);const ae=X.tViews=ox(2,X,_,x,w,d.directiveRegistry,d.pipeRegistry,null,d.schemas,G);return null!==d.queries&&(d.queries.template(d,X),ae.queries=d.queries.embeddedTView(X)),X}(X,G,B,d,p,_,x,w,D):G.data[X];So(ae,!1);const De=B[11].createComment("");jM(G,B,De,ae),Ko(De,B),gf(B,B[X]=vD(De,B,De,ae)),Cc(ae)&&sS(G,B,ae),null!=D&&oS(B,ae,F)}function RS(u){return Za(function Jl(){return ri.lFrame.contextLView}(),22+u)}function IS(u,d,p){const _=Pt();return Ro(_,Oc(),d)&&Fa(mi(),nr(),_,u,d,_[11],p,!1),IS}function jg(u,d,p,_,x){const D=x?"class":"style";hx(u,p,d.inputs[D],D,_)}function Ug(u,d,p,_){const x=Pt(),w=mi(),D=22+u,F=x[11],B=x[D]=kM(F,d,function yv(){return ri.lFrame.currentNamespace}()),G=w.firstCreatePass?function PS(u,d,p,_,x,w,D){const F=d.consts,G=Pg(d,u,2,x,Mo(F,w));return ax(d,p,G,Mo(F,D)),null!==G.attrs&&Op(G,G.attrs,!1),null!==G.mergedAttrs&&Op(G,G.mergedAttrs,!0),null!==d.queries&&d.queries.elementStart(d,G),G}(D,w,x,0,d,p,_):w.data[D];So(G,!0);const X=G.mergedAttrs;null!==X&&Lh(F,B,X);const ae=G.classes;null!==ae&&HM(F,B,ae);const De=G.styles;return null!==De&&Y1(F,B,De),64!=(64&G.flags)&&jM(w,x,B,G),0===function Ah(){return ri.lFrame.elementDepthCount}()&&Ko(B,x),function tg(){ri.lFrame.elementDepthCount++}(),Cc(G)&&(sS(w,x,G),sx(w,G,x)),null!==_&&oS(x,G),Ug}function hy(){let u=Vr();lp()?Fc():(u=u.parent,So(u,!1));const d=u;!function Dh(){ri.lFrame.elementDepthCount--}();const p=mi();return p.firstCreatePass&&(pp(p,u),Sc(u)&&p.queries.elementEnd(u)),null!=d.classesWithoutHost&&function Ys(u){return 0!=(16&u.flags)}(d)&&jg(p,d,Pt(),d.classesWithoutHost,!0),null!=d.stylesWithoutHost&&function ug(u){return 0!=(32&u.flags)}(d)&&jg(p,d,Pt(),d.stylesWithoutHost,!1),hy}function FS(u,d,p,_){return Ug(u,d,p,_),hy(),FS}function fy(u,d,p){const _=Pt(),x=mi(),w=u+22,D=x.firstCreatePass?function dy(u,d,p,_,x){const w=d.consts,D=Mo(w,_),F=Pg(d,u,8,"ng-container",D);return null!==D&&Op(F,D,!0),ax(d,p,F,Mo(w,x)),null!==d.queries&&d.queries.elementStart(d,F),F}(w,x,_,d,p):x.data[w];So(D,!0);const F=_[w]=_[11].createComment("");return jM(x,_,F,D),Ko(F,_),Cc(D)&&(sS(x,_,D),sx(x,D,_)),null!=p&&oS(_,D),fy}function py(){let u=Vr();const d=mi();return lp()?Fc():(u=u.parent,So(u,!1)),d.firstCreatePass&&(pp(d,u),Sc(u)&&d.queries.elementEnd(u)),py}function my(){return Pt()}function OS(u){return!!u&&"function"==typeof u.then}function PD(u){return!!u&&"function"==typeof u.subscribe}const Vp=PD;function kS(u,d,p,_){const x=Pt(),w=mi(),D=Vr();return BS(w,x,x[11],D,u,d,0,_),kS}function NS(u,d){const p=Vr(),_=Pt(),x=mi();return BS(x,_,gS(Vd(x.data),p,_),p,u,d),NS}function BS(u,d,p,_,x,w,D,F){const B=Cc(_),X=u.firstCreatePass&&mS(u),ae=d[8],De=xD(d);let Ue=!0;if(3&_.type||F){const hn=qo(_,d),An=F?F(hn):hn,si=De.length,kt=F?Oi=>F(ar(Oi[_.index])):_.index;let Xn=null;if(!F&&B&&(Xn=function Gp(u,d,p,_){const x=u.cleanup;if(null!=x)for(let w=0;w<x.length-1;w+=2){const D=x[w];if(D===p&&x[w+1]===_){const F=d[7],B=x[w+2];return F.length>B?F[B]:null}"string"==typeof D&&(w+=2)}return null}(u,d,x,_.index)),null!==Xn)(Xn.__ngLastListenerFn__||Xn).__ngNextListenerFn__=w,Xn.__ngLastListenerFn__=w,Ue=!1;else{w=jS(_,d,ae,w,!1);const Oi=p.listen(An,x,w);De.push(w,Oi),X&&X.push(x,kt,si,si+1)}}else w=jS(_,d,ae,w,!1);const xt=_.outputs;let Ht;if(Ue&&null!==xt&&(Ht=xt[x])){const hn=Ht.length;if(hn)for(let An=0;An<hn;An+=2){const zr=d[Ht[An]][Ht[An+1]].subscribe(w),dd=De.length;De.push(w,zr),X&&X.push(x,_.index,dd,-(dd+1))}}}function gy(u,d,p,_){try{return!1!==p(_)}catch(x){return TD(u,x),!1}}function jS(u,d,p,_,x){return function w(D){if(D===Function)return _;hS(2&u.flags?co(u.index,d):d);let B=gy(d,0,_,D),G=w.__ngNextListenerFn__;for(;G;)B=gy(d,0,G,D)&&B,G=G.__ngNextListenerFn__;return x&&!1===B&&(D.preventDefault(),D.returnValue=!1),B}}function Vg(u=1){return function ag(u){return(ri.lFrame.contextLView=function Gd(u,d){for(;u>0;)d=d[15],u--;return d}(u,ri.lFrame.contextLView))[8]}(u)}function FD(u,d){let p=null;const _=function Sz(u){const d=u.attrs;if(null!=d){const p=d.indexOf(5);if(0==(1&p))return d[p+1]}return null}(u);for(let x=0;x<d.length;x++){const w=d[x];if("*"!==w){if(null===_?gk(u,w,!0):Az(_,w))return x}else p=x}return p}function va(u){const d=Pt()[16][6];if(!d.projection){const _=d.projection=Gc(u?u.length:1,null),x=_.slice();let w=d.child;for(;null!==w;){const D=u?FD(w,u):0;null!==D&&(x[D]?x[D].projectionNext=w:_[D]=w,x[D]=w),w=w.next}}}function US(u,d=0,p){const _=Pt(),x=mi(),w=Pg(x,22+u,16,null,p||null);null===w.projection&&(w.projection=d),Fc(),64!=(64&w.flags)&&function VM(u,d,p){GM(d[11],0,d,p,ok(u,p,d),uk(p.parent||d[6],p,d))}(x,_,w)}function zp(u,d,p){return Gg(u,"",d,"",p),zp}function Gg(u,d,p,_,x){const w=Pt(),D=Ng(w,d,p,_);return D!==wi&&Fa(mi(),nr(),w,u,D,w[11],x,!1),Gg}function OD(u,d,p,_,x){const w=u[p+1],D=null===d;let F=_?lc(w):Yh(w),B=!1;for(;0!==F&&(!1===B||D);){const X=u[F+1];WS(u[F],d)&&(B=!0,u[F+1]=_?Xb(X):KM(X)),F=_?lc(X):Yh(X)}B&&(u[p+1]=_?KM(w):Xb(w))}function WS(u,d){return null===u||null==d||(Array.isArray(u)?u[1]:u)===d||!(!Array.isArray(u)||"string"!=typeof d)&&rc(u,d)>=0}const Ts={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Tx(u){return u.substring(Ts.key,Ts.keyEnd)}function kD(u){return u.substring(Ts.value,Ts.valueEnd)}function Hg(u,d){const p=Ts.textEnd;let _=Ts.key=Jh(u,d,p);return p===_?-1:(_=Ts.keyEnd=function Hp(u,d,p){let _;for(;d<p&&(45===(_=u.charCodeAt(d))||95===_||(-33&_)>=65&&(-33&_)<=90||_>=48&&_<=57);)d++;return d}(u,_,p),_=wx(u,_,p),_=Ts.value=Jh(u,_,p),_=Ts.valueEnd=function h2(u,d,p){let _=-1,x=-1,w=-1,D=d,F=D;for(;D<p;){const B=u.charCodeAt(D++);if(59===B)return F;34===B||39===B?F=D=Mx(u,B,D,p):d===D-4&&85===w&&82===x&&76===_&&40===B?F=D=Mx(u,41,D,p):B>32&&(F=D),w=x,x=_,_=-33&B}return F}(u,_,p),wx(u,_,p))}function Jh(u,d,p){for(;d<p&&u.charCodeAt(d)<=32;)d++;return d}function wx(u,d,p,_){return(d=Jh(u,d,p))<p&&d++,d}function Mx(u,d,p,_){let x=-1,w=p;for(;w<_;){const D=u.charCodeAt(w++);if(D==d&&92!==x)return w;x=92==D&&92===x?0:D}throw new Error}function by(u,d,p){return il(u,d,p,!1),by}function ed(u,d){return il(u,d,null,!0),ed}function cc(u){!function rl(u,d,p,_){const x=mi(),w=pa(2);x.firstUpdatePass&&YS(x,null,w,_);const D=Pt();if(p!==wi&&Ro(D,w,p)){const F=x.data[ss()];if(nd(F,_)&&!xy(x,w)){let B=_?F.classesWithoutHost:F.stylesWithoutHost;null!==B&&(p=ct(B,p||"")),jg(x,F,D,p,_)}else!function g2(u,d,p,_,x,w,D,F){x===wi&&(x=li);let B=0,G=0,X=0<x.length?x[0]:null,ae=0<w.length?w[0]:null;for(;null!==X||null!==ae;){const De=B<x.length?x[B+1]:void 0,Ue=G<w.length?w[G+1]:void 0;let Ht,xt=null;X===ae?(B+=2,G+=2,De!==Ue&&(xt=ae,Ht=Ue)):null===ae||null!==X&&X<ae?(B+=2,xt=X):(G+=2,xt=ae,Ht=Ue),null!==xt&&BD(u,d,p,_,xt,Ht,D,F),X=B<x.length?x[B]:null,ae=G<w.length?w[G]:null}}(x,F,D,D[11],D[w+1],D[w+1]=function m2(u,d,p){if(null==p||""===p)return li;const _=[],x=$c(p);if(Array.isArray(x))for(let w=0;w<x.length;w++)u(_,x[w],!0);else if("object"==typeof x)for(const w in x)x.hasOwnProperty(w)&&u(_,w,x[w]);else"string"==typeof x&&d(_,x);return _}(u,d,p),_,w)}}(KS,d2,u,!1)}function d2(u,d){for(let p=function u2(u){return function ZS(u){Ts.key=0,Ts.keyEnd=0,Ts.value=0,Ts.valueEnd=0,Ts.textEnd=u.length}(u),Hg(u,Jh(u,0,Ts.textEnd))}(d);p>=0;p=Hg(d,p))KS(u,Tx(d),kD(d))}function il(u,d,p,_){const x=Pt(),w=mi(),D=pa(2);w.firstUpdatePass&&YS(w,u,D,_),d!==wi&&Ro(x,D,d)&&BD(w,w.data[ss()],x,x[11],u,x[D+1]=function Ty(u,d){return null==u||("string"==typeof d?u+=d:"object"==typeof u&&(u=Oe($c(u)))),u}(d,p),_,D)}function xy(u,d){return d>=u.expandoStartIndex}function YS(u,d,p,_){const x=u.data;if(null===x[p+1]){const w=x[ss()],D=xy(u,p);nd(w,_)&&null===d&&!D&&(d=!1),d=function Kr(u,d,p,_){const x=Vd(u);let w=_?d.residualClasses:d.residualStyles;if(null===x)0===(_?d.classBindings:d.styleBindings)&&(p=td(p=qp(null,u,d,p,_),d.attrs,_),w=null);else{const D=d.directiveStylingLast;if(-1===D||u[D]!==x)if(p=qp(x,u,d,p,_),null===w){let B=function Sx(u,d,p){const _=p?d.classBindings:d.styleBindings;if(0!==Yh(_))return u[lc(_)]}(u,d,_);void 0!==B&&Array.isArray(B)&&(B=qp(null,u,d,B[1],_),B=td(B,d.attrs,_),function f2(u,d,p,_){u[lc(p?d.classBindings:d.styleBindings)]=_}(u,d,_,B))}else w=function p2(u,d,p){let _;const x=d.directiveEnd;for(let w=1+d.directiveStylingLast;w<x;w++)_=td(_,u[w].hostAttrs,p);return td(_,d.attrs,p)}(u,d,_)}return void 0!==w&&(_?d.residualClasses=w:d.residualStyles=w),p}(x,w,d,_),function _y(u,d,p,_,x,w){let D=w?d.classBindings:d.styleBindings,F=lc(D),B=Yh(D);u[_]=p;let X,G=!1;if(Array.isArray(p)){const ae=p;X=ae[1],(null===X||rc(ae,X)>0)&&(G=!0)}else X=p;if(x)if(0!==B){const De=lc(u[F+1]);u[_+1]=Kb(De,F),0!==De&&(u[De+1]=Xo(u[De+1],_)),u[F+1]=function Rk(u,d){return 131071&u|d<<17}(u[F+1],_)}else u[_+1]=Kb(F,0),0!==F&&(u[F+1]=Xo(u[F+1],_)),F=_;else u[_+1]=Kb(B,0),0===F?F=_:u[B+1]=Xo(u[B+1],_),B=_;G&&(u[_+1]=KM(u[_+1])),OD(u,X,_,!0),OD(u,X,_,!1),function LD(u,d,p,_,x){const w=x?u.residualClasses:u.residualStyles;null!=w&&"string"==typeof d&&rc(w,d)>=0&&(p[_+1]=Xb(p[_+1]))}(d,X,u,_,w),D=Kb(F,B),w?d.classBindings=D:d.styleBindings=D}(x,w,d,p,D,_)}}function qp(u,d,p,_,x){let w=null;const D=p.directiveEnd;let F=p.directiveStylingLast;for(-1===F?F=p.directiveStart:F++;F<D&&(w=d[F],_=td(_,w.hostAttrs,x),w!==u);)F++;return null!==u&&(p.directiveStylingLast=F),_}function td(u,d,p){const _=p?1:2;let x=-1;if(null!==d)for(let w=0;w<d.length;w++){const D=d[w];"number"==typeof D?x=D:x===_&&(Array.isArray(u)||(u=void 0===u?[]:["",u]),uo(u,D,!!p||d[++w]))}return void 0===u?null:u}function KS(u,d,p){uo(u,d,$c(p))}function BD(u,d,p,_,x,w,D,F){if(!(3&d.type))return;const B=u.data,G=B[F+1];Cx(function ey(u){return 1==(1&u)}(G)?jD(B,d,p,x,Yh(G),D):void 0)||(Cx(w)||function eD(u){return 2==(2&u)}(G)&&(w=jD(B,null,p,x,F,D)),function zM(u,d,p,_,x){if(d)x?u.addClass(p,_):u.removeClass(p,_);else{let w=-1===_.indexOf("-")?void 0:Zu.DashCase;null==x?u.removeStyle(p,_,w):("string"==typeof x&&x.endsWith("!important")&&(x=x.slice(0,-10),w|=Zu.Important),u.setStyle(p,_,x,w))}}(_,D,Bd(ss(),p),x,w))}function jD(u,d,p,_,x,w){const D=null===d;let F;for(;x>0;){const B=u[x],G=Array.isArray(B),X=G?B[1]:B,ae=null===X;let De=p[x+1];De===wi&&(De=ae?li:void 0);let Ue=ae?Zo(De,_):X===_?De:void 0;if(G&&!Cx(Ue)&&(Ue=Zo(B,_)),Cx(Ue)&&(F=Ue,D))return F;const xt=u[x+1];x=D?lc(xt):Yh(xt)}if(null!==d){let B=w?d.residualClasses:d.residualStyles;null!=B&&(F=Zo(B,_))}return F}function Cx(u){return void 0!==u}function nd(u,d){return 0!=(u.flags&(d?16:32))}function XS(u,d=""){const p=Pt(),_=mi(),x=u+22,w=_.firstCreatePass?Pg(_,x,1,d,null):_.data[x],D=p[x]=function LM(u,d){return u.createText(d)}(p[11],d);jM(_,p,D,w),So(w,!1)}function Ex(u){return wy("",u,""),Ex}function wy(u,d,p){const _=Pt(),x=Ng(_,u,d,p);return x!==wi&&function tu(u,d,p){const _=Bd(d,u);!function OM(u,d,p){u.setValue(d,p)}(u[11],_,p)}(_,ss(),x),wy}function Ix(u,d,p){const _=Pt();return Ro(_,Oc(),d)&&Fa(mi(),nr(),_,u,d,_[11],p,!0),Ix}function aC(u,d,p){const _=Pt();if(Ro(_,Oc(),d)){const w=mi(),D=nr();Fa(w,D,_,u,d,gS(Vd(w.data),D,_),p,!0)}return aC}const id=void 0;var XD=["en",[["a","p"],["AM","PM"],id],[["AM","PM"],id,id],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],id,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],id,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",id,"{1} 'at' {0}",id],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Ay(u){const p=Math.floor(Math.abs(u)),_=u.toString().replace(/^[^.]*\.?/,"").length;return 1===p&&0===_?1:5}];let xf={};function Px(u){const d=function JD(u){return u.toLowerCase().replace(/_/g,"-")}(u);let p=QD(d);if(p)return p;const _=d.split("-")[0];if(p=QD(_),p)return p;if("en"===_)return XD;throw new yt(701,!1)}function Dy(u){return Px(u)[Yn.PluralCase]}function QD(u){return u in xf||(xf[u]=un.ng&&un.ng.common&&un.ng.common.locales&&un.ng.common.locales[u]),xf[u]}var Yn=(()=>((Yn=Yn||{})[Yn.LocaleId=0]="LocaleId",Yn[Yn.DayPeriodsFormat=1]="DayPeriodsFormat",Yn[Yn.DayPeriodsStandalone=2]="DayPeriodsStandalone",Yn[Yn.DaysFormat=3]="DaysFormat",Yn[Yn.DaysStandalone=4]="DaysStandalone",Yn[Yn.MonthsFormat=5]="MonthsFormat",Yn[Yn.MonthsStandalone=6]="MonthsStandalone",Yn[Yn.Eras=7]="Eras",Yn[Yn.FirstDayOfWeek=8]="FirstDayOfWeek",Yn[Yn.WeekendRange=9]="WeekendRange",Yn[Yn.DateFormat=10]="DateFormat",Yn[Yn.TimeFormat=11]="TimeFormat",Yn[Yn.DateTimeFormat=12]="DateTimeFormat",Yn[Yn.NumberSymbols=13]="NumberSymbols",Yn[Yn.NumberFormats=14]="NumberFormats",Yn[Yn.CurrencyCode=15]="CurrencyCode",Yn[Yn.CurrencySymbol=16]="CurrencySymbol",Yn[Yn.CurrencyName=17]="CurrencyName",Yn[Yn.Currencies=18]="Currencies",Yn[Yn.Directionality=19]="Directionality",Yn[Yn.PluralCase=20]="PluralCase",Yn[Yn.ExtraData=21]="ExtraData",Yn))();const Tf="en-US";let uC=Tf;function ya(u,d,p,_,x){if(u=Ne(u),Array.isArray(u))for(let w=0;w<u.length;w++)ya(u[w],d,p,_,x);else{const w=mi(),D=Pt();let F=Ap(u)?u:Ne(u.provide),B=Wv(u);const G=Vr(),X=1048575&G.providerIndexes,ae=G.directiveStart,De=G.providerIndexes>>20;if(Ap(u)||!u.multi){const Ue=new Wd(B,x,df),xt=jx(F,d,x?X:X+De,ae);-1===xt?(bs(Bn(G,D),w,F),Bx(w,u,d.length),d.push(F),G.directiveStart++,G.directiveEnd++,x&&(G.providerIndexes+=1048576),p.push(Ue),D.push(Ue)):(p[xt]=Ue,D[xt]=Ue)}else{const Ue=jx(F,d,X+De,ae),xt=jx(F,d,X,X+De),Ht=Ue>=0&&p[Ue],hn=xt>=0&&p[xt];if(x&&!hn||!x&&!Ht){bs(Bn(G,D),w,F);const An=function Mr(u,d,p,_,x){const w=new Wd(u,p,df);return w.multi=[],w.index=d,w.componentProviders=0,Cf(w,x,_&&!p),w}(x?Ux:Cs,p.length,x,_,B);!x&&hn&&(p[xt].providerFactory=An),Bx(w,u,d.length,0),d.push(F),G.directiveStart++,G.directiveEnd++,x&&(G.providerIndexes+=1048576),p.push(An),D.push(An)}else Bx(w,u,Ue>-1?Ue:xt,Cf(p[x?xt:Ue],B,!x&&_));!x&&_&&hn&&p[xt].componentProviders++}}}function Bx(u,d,p,_){const x=Ap(d),w=function Hv(u){return!!u.useClass}(d);if(x||w){const B=(w?Ne(d.useClass):d).prototype.ngOnDestroy;if(B){const G=u.destroyHooks||(u.destroyHooks=[]);if(!x&&d.multi){const X=G.indexOf(p);-1===X?G.push(p,[_,B]):G[X+1].push(_,B)}else G.push(p,B)}}}function Cf(u,d,p){return p&&u.componentProviders++,u.multi.push(d)-1}function jx(u,d,p,_){for(let x=p;x<_;x++)if(d[x]===u)return x;return-1}function Cs(u,d,p,_){return mo(this.multi,[])}function Ux(u,d,p,_){const x=this.multi;let w;if(this.providerFactory){const D=this.providerFactory.componentProviders,F=Sn(p,p[1],this.providerFactory.index,_);w=F.slice(0,D),mo(x,w);for(let B=D;B<F.length;B++)w.push(F[B])}else w=[],mo(x,w);return w}function mo(u,d){for(let p=0;p<u.length;p++)d.push((0,u[p])());return d}function xC(u,d=[]){return p=>{p.providersResolver=(_,x)=>function k2(u,d,p){const _=mi();if(_.firstCreatePass){const x=Wo(u);ya(p,_.data,_.blueprint,x,!0),ya(d,_.data,_.blueprint,x,!1)}}(_,x?x(u):u,d)}}class iu{}class ol{}function N2(u,d){return new gR(u,d??null)}class gR extends iu{constructor(d,p){super(),this._parent=p,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new $o(this);const _=gt(d);this._bootstrapComponents=Wh(_.bootstrap),this._r3Injector=Mk(d,p,[{provide:iu,useValue:this},{provide:Ip,useValue:this.componentFactoryResolver}],Oe(d),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(d)}get injector(){return this._r3Injector}destroy(){const d=this._r3Injector;!d.destroyed&&d.destroy(),this.destroyCbs.forEach(p=>p()),this.destroyCbs=null}onDestroy(d){this.destroyCbs.push(d)}}class Qu extends ol{constructor(d){super(),this.moduleType=d}create(d){return new gR(this.moduleType,d)}}class Es extends iu{constructor(d,p,_){super(),this.componentFactoryResolver=new $o(this),this.instance=null;const x=new y1([...d,{provide:iu,useValue:this},{provide:Ip,useValue:this.componentFactoryResolver}],p||Hb(),_,new Set(["environment"]));this.injector=x,x.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(d){this.injector.onDestroy(d)}}function sd(u,d,p=null){return new Es(u,d,p).injector}function MC(u,d,p){const _=vs()+u,x=Pt();return x[_]===wi?Pl(x,_,p?d.call(p):d()):function _f(u,d){return u[d]}(x,_)}function SC(u,d,p,_){return Dr(Pt(),vs(),u,d,p,_)}function Dr(u,d,p,_,x,w){const D=d+p;return Ro(u,D,x)?Pl(u,D+1,w?_.call(w,x):_(x)):function e_(u,d){const p=u[d];return p===wi?void 0:p}(u,D+1)}function t_(u,d){const p=mi();let _;const x=u+22;p.firstCreatePass?(_=function Hx(u,d){if(d)for(let p=d.length-1;p>=0;p--){const _=d[p];if(u===_.name)return _}}(d,p.pipeRegistry),p.data[x]=_,_.onDestroy&&(p.destroyHooks||(p.destroyHooks=[])).push(x,_.onDestroy)):_=p.data[x];const w=_.factory||(_.factory=Su(_.type)),D=Li(df);try{const F=Ml(!1),B=w();return Ml(F),function DS(u,d,p,_){p>=u.data.length&&(u.data[p]=null,u.blueprint[p]=null),d[p]=_}(p,Pt(),x,B),B}finally{Li(D)}}function AC(u,d,p){const _=u+22,x=Pt(),w=Za(x,_);return function Vy(u,d){return u[1].data[d].pure}(x,_)?Dr(x,vs(),d,w.transform,p,w):w.transform(p)}function DC(u){return d=>{setTimeout(u,void 0,d)}}const eh=class AR extends $.x{constructor(d=!1){super(),this.__isAsync=d}emit(d){super.next(d)}subscribe(d,p,_){let x=d,w=p||(()=>null),D=_;if(d&&"object"==typeof d){const B=d;x=B.next?.bind(B),w=B.error?.bind(B),D=B.complete?.bind(B)}this.__isAsync&&(w=DC(w),x&&(x=DC(x)),D&&(D=DC(D)));const F=super.subscribe({next:x,error:w,complete:D});return d instanceof c.w0&&d.add(F),F}};function G2(){return this._results[kp()]()}class Wx{constructor(d=!1){this._emitDistinctChangesOnly=d,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const p=kp(),_=Wx.prototype;_[p]||(_[p]=G2)}get changes(){return this._changes||(this._changes=new eh)}get(d){return this._results[d]}map(d){return this._results.map(d)}filter(d){return this._results.filter(d)}find(d){return this._results.find(d)}reduce(d,p){return this._results.reduce(d,p)}forEach(d){this._results.forEach(d)}some(d){return this._results.some(d)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(d,p){const _=this;_.dirty=!1;const x=Xs(d);(this._changesDetected=!function ic(u,d,p){if(u.length!==d.length)return!1;for(let _=0;_<u.length;_++){let x=u[_],w=d[_];if(p&&(x=p(x),w=p(w)),w!==x)return!1}return!0}(_._results,x,p))&&(_._results=x,_.length=x.length,_.last=x[this.length-1],_.first=x[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let uc=(()=>{class u{}return u.__NG_ELEMENT_ID__=DR,u})();const n_=uc,z2=class extends n_{constructor(d,p,_){super(),this._declarationLView=d,this._declarationTContainer=p,this.elementRef=_}createEmbeddedView(d,p){const _=this._declarationTContainer.tViews,x=ix(this._declarationLView,_,d,16,null,_.declTNode,null,null,null,null,p||null);x[17]=this._declarationLView[this._declarationTContainer.index];const D=this._declarationLView[19];return null!==D&&(x[19]=D.createEmbeddedView(_)),rx(_,x,d),new fo(x)}};function DR(){return Gy(Vr(),Pt())}function Gy(u,d){return 4&u.type?new z2(d,u,cf(u,d)):null}let hc=(()=>{class u{}return u.__NG_ELEMENT_ID__=RR,u})();function RR(){return Zx(Vr(),Pt())}const i_=hc,RC=class extends i_{constructor(d,p,_){super(),this._lContainer=d,this._hostTNode=p,this._hostLView=_}get element(){return cf(this._hostTNode,this._hostLView)}get injector(){return new Da(this._hostTNode,this._hostLView)}get parentInjector(){const d=jc(this._hostTNode,this._hostLView);if(Mv(d)){const p=ys(d,this._hostLView),_=Oh(d);return new Da(p[1].data[_+8],p)}return new Da(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(d){const p=qx(this._lContainer);return null!==p&&p[d]||null}get length(){return this._lContainer.length-10}createEmbeddedView(d,p,_){let x,w;"number"==typeof _?x=_:null!=_&&(x=_.index,w=_.injector);const D=d.createEmbeddedView(p||{},w);return this.insert(D,x),D}createComponent(d,p,_,x,w){const D=d&&!function Ra(u){return"function"==typeof u}(d);let F;if(D)F=p;else{const ae=p||{};F=ae.index,_=ae.injector,x=ae.projectableNodes,w=ae.environmentInjector||ae.ngModuleRef}const B=D?d:new Lg(Re(d)),G=_||this.parentInjector;if(!w&&null==B.ngModule){const De=(D?G:this.parentInjector).get(Rp,null);De&&(w=De)}const X=B.create(G,x,void 0,w);return this.insert(X.hostView,F),X}insert(d,p){const _=d._lView,x=_[1];if(function Eu(u){return qr(u[3])}(_)){const X=this.indexOf(d);if(-1!==X)this.detach(X);else{const ae=_[3],De=new RC(ae,ae[6],ae[3]);De.detach(De.indexOf(d))}}const w=this._adjustIndex(p),D=this._lContainer;!function ik(u,d,p,_){const x=10+_,w=p.length;_>0&&(p[x-1][4]=d),_<w-10?(d[4]=p[x],ju(p,10+_,d)):(p.push(d),d[4]=null),d[3]=p;const D=d[17];null!==D&&p!==D&&function rk(u,d){const p=u[9];d[16]!==d[3][3][16]&&(u[2]=!0),null===p?u[9]=[d]:p.push(d)}(D,d);const F=d[19];null!==F&&F.insertView(u),d[2]|=64}(x,_,D,w);const F=Jc(w,D),B=_[11],G=BM(B,D[7]);return null!==G&&function tk(u,d,p,_,x,w){_[0]=x,_[6]=d,Dg(u,_,p,1,x,w)}(x,D[6],B,_,G,F),d.attachToViewContainerRef(),ju(zy(D),w,d),d}move(d,p){return this.insert(d,p)}indexOf(d){const p=qx(this._lContainer);return null!==p?p.indexOf(d):-1}remove(d){const p=this._adjustIndex(d,-1),_=nt(this._lContainer,p);_&&(Uh(zy(this._lContainer),p),pr(_[1],_))}detach(d){const p=this._adjustIndex(d,-1),_=nt(this._lContainer,p);return _&&null!=Uh(zy(this._lContainer),p)?new fo(_):null}_adjustIndex(d,p=0){return d??this.length+p}};function qx(u){return u[8]}function zy(u){return u[8]||(u[8]=[])}function Zx(u,d){let p;const _=d[u.index];if(qr(_))p=_;else{let x;if(8&u.type)x=ar(_);else{const w=d[11];x=w.createComment("");const D=qo(u,d);qh(w,BM(w,D),x,function yz(u,d){return u.nextSibling(d)}(w,D),!1)}d[u.index]=p=vD(_,d,x,u),gf(d,p)}return new RC(p,u,d)}class Jp{constructor(d){this.queryList=d,this.matches=null}clone(){return new Jp(this.queryList)}setDirty(){this.queryList.setDirty()}}class Yx{constructor(d=[]){this.queries=d}createEmbeddedView(d){const p=d.queries;if(null!==p){const _=null!==d.contentQueries?d.contentQueries[0]:p.length,x=[];for(let w=0;w<_;w++){const D=p.getByIndex(w);x.push(this.queries[D.indexInDeclarationView].clone())}return new Yx(x)}return null}insertView(d){this.dirtyQueriesWithMatches(d)}detachView(d){this.dirtyQueriesWithMatches(d)}dirtyQueriesWithMatches(d){for(let p=0;p<this.queries.length;p++)null!==nm(d,p).matches&&this.queries[p].setDirty()}}class Kx{constructor(d,p,_=null){this.predicate=d,this.flags=p,this.read=_}}class Hy{constructor(d=[]){this.queries=d}elementStart(d,p){for(let _=0;_<this.queries.length;_++)this.queries[_].elementStart(d,p)}elementEnd(d){for(let p=0;p<this.queries.length;p++)this.queries[p].elementEnd(d)}embeddedTView(d){let p=null;for(let _=0;_<this.length;_++){const x=null!==p?p.length:0,w=this.getByIndex(_).embeddedTView(d,x);w&&(w.indexInDeclarationView=_,null!==p?p.push(w):p=[w])}return null!==p?new Hy(p):null}template(d,p){for(let _=0;_<this.queries.length;_++)this.queries[_].template(d,p)}getByIndex(d){return this.queries[d]}get length(){return this.queries.length}track(d){this.queries.push(d)}}class Xx{constructor(d,p=-1){this.metadata=d,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=p}elementStart(d,p){this.isApplyingToNode(p)&&this.matchTNode(d,p)}elementEnd(d){this._declarationNodeIndex===d.index&&(this._appliesToNextNode=!1)}template(d,p){this.elementStart(d,p)}embeddedTView(d,p){return this.isApplyingToNode(d)?(this.crossesNgTemplate=!0,this.addMatch(-d.index,p),new Xx(this.metadata)):null}isApplyingToNode(d){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const p=this._declarationNodeIndex;let _=d.parent;for(;null!==_&&8&_.type&&_.index!==p;)_=_.parent;return p===(null!==_?_.index:-1)}return this._appliesToNextNode}matchTNode(d,p){const _=this.metadata.predicate;if(Array.isArray(_))for(let x=0;x<_.length;x++){const w=_[x];this.matchTNodeWithReadOption(d,p,IR(p,w)),this.matchTNodeWithReadOption(d,p,tc(p,d,w,!1,!1))}else _===uc?4&p.type&&this.matchTNodeWithReadOption(d,p,-1):this.matchTNodeWithReadOption(d,p,tc(p,d,_,!1,!1))}matchTNodeWithReadOption(d,p,_){if(null!==_){const x=this.metadata.read;if(null!==x)if(x===uf||x===hc||x===uc&&4&p.type)this.addMatch(p.index,-2);else{const w=tc(p,d,x,!1,!1);null!==w&&this.addMatch(p.index,w)}else this.addMatch(p.index,_)}}addMatch(d,p){null===this.matches?this.matches=[d,p]:this.matches.push(d,p)}}function IR(u,d){const p=u.localNames;if(null!==p)for(let _=0;_<p.length;_+=2)if(p[_]===d)return p[_+1];return null}function PR(u,d,p,_){return-1===p?function H2(u,d){return 11&u.type?cf(u,d):4&u.type?Gy(u,d):null}(d,u):-2===p?function FR(u,d,p){return p===uf?cf(d,u):p===uc?Gy(d,u):p===hc?Zx(d,u):void 0}(u,d,_):Sn(u,u[1],p,d)}function PC(u,d,p,_){const x=d[19].queries[_];if(null===x.matches){const w=u.data,D=p.matches,F=[];for(let B=0;B<D.length;B+=2){const G=D[B];F.push(G<0?null:PR(d,w[G],D[B+1],p.metadata.read))}x.matches=F}return x.matches}function s_(u,d,p,_){const x=u.queries.getByIndex(p),w=x.matches;if(null!==w){const D=PC(u,d,x,p);for(let F=0;F<w.length;F+=2){const B=w[F];if(B>0)_.push(D[F/2]);else{const G=w[F+1],X=d[-B];for(let ae=10;ae<X.length;ae++){const De=X[ae];De[17]===De[3]&&s_(De[1],De,G,_)}if(null!==X[9]){const ae=X[9];for(let De=0;De<ae.length;De++){const Ue=ae[De];s_(Ue[1],Ue,G,_)}}}}}return _}function LR(u){const d=Pt(),p=mi(),_=kc();hp(_+1);const x=nm(p,_);if(u.dirty&&Dc(d)===(2==(2&x.metadata.flags))){if(null===x.matches)u.reset([]);else{const w=x.crossesNgTemplate?s_(p,d,_,[]):PC(p,d,x,_);u.reset(w,OO),u.notifyOnChanges()}return!0}return!1}function OR(u,d,p){const _=mi();_.firstCreatePass&&(Df(_,new Kx(u,d,p),-1),2==(2&d)&&(_.staticViewQueries=!0)),LC(_,Pt(),d)}function FC(u,d,p,_){const x=mi();if(x.firstCreatePass){const w=Vr();Df(x,new Kx(d,p,_),w.index),function kR(u,d){const p=u.contentQueries||(u.contentQueries=[]);d!==(p.length?p[p.length-1]:-1)&&p.push(u.queries.length-1,d)}(x,u),2==(2&p)&&(x.staticContentQueries=!0)}LC(x,Pt(),p)}function em(){return function tm(u,d){return u[19].queries[d].queryList}(Pt(),kc())}function LC(u,d,p){const _=new Wx(4==(4&p));aS(u,d,_,_.destroy),null===d[19]&&(d[19]=new Yx),d[19].queries.push(new Jp(_))}function Df(u,d,p){null===u.queries&&(u.queries=new Hy),u.queries.track(new Xx(d,p))}function nm(u,d){return u.queries.getByIndex(d)}function OC(u,d){return Gy(u,d)}function rm(u){const d=Re(u)||Se(u)||ye(u);return null!==d&&d.standalone}function Qy(...u){}const zC=new ei("Application Initializer");let nT=(()=>{class u{constructor(p){this.appInits=p,this.resolve=Qy,this.reject=Qy,this.initialized=!1,this.done=!1,this.donePromise=new Promise((_,x)=>{this.resolve=_,this.reject=x})}runInitializers(){if(this.initialized)return;const p=[],_=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let x=0;x<this.appInits.length;x++){const w=this.appInits[x]();if(OS(w))p.push(w);else if(Vp(w)){const D=new Promise((F,B)=>{w.subscribe({complete:F,error:B})});p.push(D)}}Promise.all(p).then(()=>{_()}).catch(x=>{this.reject(x)}),0===p.length&&_(),this.initialized=!0}}return u.\u0275fac=function(p){return new(p||u)(Yr(zC,8))},u.\u0275prov=Ui({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();const QR=new ei("AppId",{providedIn:"root",factory:function l_(){return`${HC()}${HC()}${HC()}`}});function HC(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const WC=new ei("Platform Initializer"),eI=new ei("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),qC=new ei("appBootstrapListener"),tI=new ei("AnimationModuleType");let nN=(()=>{class u{log(p){console.log(p)}warn(p){console.warn(p)}}return u.\u0275fac=function(p){return new(p||u)},u.\u0275prov=Ui({token:u,factory:u.\u0275fac,providedIn:"platform"}),u})();const ud=new ei("LocaleId",{providedIn:"root",factory:()=>$d(ud,Un.Optional|Un.SkipSelf)||function iN(){return typeof $localize<"u"&&$localize.locale||Tf}()}),c_=new ei("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class nI{constructor(d,p){this.ngModuleFactory=d,this.componentFactories=p}}let Oa=(()=>{class u{compileModuleSync(p){return new Qu(p)}compileModuleAsync(p){return Promise.resolve(this.compileModuleSync(p))}compileModuleAndAllComponentsSync(p){const _=this.compileModuleSync(p),w=Wh(gt(p).declarations).reduce((D,F)=>{const B=Re(F);return B&&D.push(new Lg(B)),D},[]);return new nI(_,w)}compileModuleAndAllComponentsAsync(p){return Promise.resolve(this.compileModuleAndAllComponentsSync(p))}clearCache(){}clearCacheFor(p){}getModuleId(p){}}return u.\u0275fac=function(p){return new(p||u)},u.\u0275prov=Ui({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();const aN=(()=>Promise.resolve(0))();function YC(u){typeof Zone>"u"?aN.then(()=>{u&&u.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",u)}class Ll{constructor({enableLongStackTrace:d=!1,shouldCoalesceEventChangeDetection:p=!1,shouldCoalesceRunChangeDetection:_=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new eh(!1),this.onMicrotaskEmpty=new eh(!1),this.onStable=new eh(!1),this.onError=new eh(!1),typeof Zone>"u")throw new yt(908,!1);Zone.assertZonePatched();const x=this;if(x._nesting=0,x._outer=x._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const w=Zone.AsyncStackTaggingZoneSpec;x._inner=x._inner.fork(new w("Angular"))}Zone.TaskTrackingZoneSpec&&(x._inner=x._inner.fork(new Zone.TaskTrackingZoneSpec)),d&&Zone.longStackTraceZoneSpec&&(x._inner=x._inner.fork(Zone.longStackTraceZoneSpec)),x.shouldCoalesceEventChangeDetection=!_&&p,x.shouldCoalesceRunChangeDetection=_,x.lastRequestAnimationFrameId=-1,x.nativeRequestAnimationFrame=function lN(){let u=un.requestAnimationFrame,d=un.cancelAnimationFrame;if(typeof Zone<"u"&&u&&d){const p=u[Zone.__symbol__("OriginalDelegate")];p&&(u=p);const _=d[Zone.__symbol__("OriginalDelegate")];_&&(d=_)}return{nativeRequestAnimationFrame:u,nativeCancelAnimationFrame:d}}().nativeRequestAnimationFrame,function hN(u){const d=()=>{!function uN(u){u.isCheckStableRunning||-1!==u.lastRequestAnimationFrameId||(u.lastRequestAnimationFrameId=u.nativeRequestAnimationFrame.call(un,()=>{u.fakeTopEventTask||(u.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{u.lastRequestAnimationFrameId=-1,XC(u),u.isCheckStableRunning=!0,KC(u),u.isCheckStableRunning=!1},void 0,()=>{},()=>{})),u.fakeTopEventTask.invoke()}),XC(u))}(u)};u._inner=u._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(p,_,x,w,D,F)=>{try{return iI(u),p.invokeTask(x,w,D,F)}finally{(u.shouldCoalesceEventChangeDetection&&"eventTask"===w.type||u.shouldCoalesceRunChangeDetection)&&d(),rI(u)}},onInvoke:(p,_,x,w,D,F,B)=>{try{return iI(u),p.invoke(x,w,D,F,B)}finally{u.shouldCoalesceRunChangeDetection&&d(),rI(u)}},onHasTask:(p,_,x,w)=>{p.hasTask(x,w),_===x&&("microTask"==w.change?(u._hasPendingMicrotasks=w.microTask,XC(u),KC(u)):"macroTask"==w.change&&(u.hasPendingMacrotasks=w.macroTask))},onHandleError:(p,_,x,w)=>(p.handleError(x,w),u.runOutsideAngular(()=>u.onError.emit(w)),!1)})}(x)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Ll.isInAngularZone())throw new yt(909,!1)}static assertNotInAngularZone(){if(Ll.isInAngularZone())throw new yt(909,!1)}run(d,p,_){return this._inner.run(d,p,_)}runTask(d,p,_,x){const w=this._inner,D=w.scheduleEventTask("NgZoneEvent: "+x,d,cN,Qy,Qy);try{return w.runTask(D,p,_)}finally{w.cancelTask(D)}}runGuarded(d,p,_){return this._inner.runGuarded(d,p,_)}runOutsideAngular(d){return this._outer.run(d)}}const cN={};function KC(u){if(0==u._nesting&&!u.hasPendingMicrotasks&&!u.isStable)try{u._nesting++,u.onMicrotaskEmpty.emit(null)}finally{if(u._nesting--,!u.hasPendingMicrotasks)try{u.runOutsideAngular(()=>u.onStable.emit(null))}finally{u.isStable=!0}}}function XC(u){u.hasPendingMicrotasks=!!(u._hasPendingMicrotasks||(u.shouldCoalesceEventChangeDetection||u.shouldCoalesceRunChangeDetection)&&-1!==u.lastRequestAnimationFrameId)}function iI(u){u._nesting++,u.isStable&&(u.isStable=!1,u.onUnstable.emit(null))}function rI(u){u._nesting--,KC(u)}class dN{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new eh,this.onMicrotaskEmpty=new eh,this.onStable=new eh,this.onError=new eh}run(d,p,_){return d.apply(p,_)}runGuarded(d,p,_){return d.apply(p,_)}runOutsideAngular(d){return d()}runTask(d,p,_,x){return d.apply(p,_)}}const sI=new ei(""),oI=new ei("");let iT,aI=(()=>{class u{constructor(p,_,x){this._ngZone=p,this.registry=_,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,iT||(function cI(u){iT=u}(x),x.addToWindow(_)),this._watchAngularEvents(),p.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ll.assertNotInAngularZone(),YC(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())YC(()=>{for(;0!==this._callbacks.length;){let p=this._callbacks.pop();clearTimeout(p.timeoutId),p.doneCb(this._didWork)}this._didWork=!1});else{let p=this.getPendingTasks();this._callbacks=this._callbacks.filter(_=>!_.updateCb||!_.updateCb(p)||(clearTimeout(_.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(p=>({source:p.source,creationLocation:p.creationLocation,data:p.data})):[]}addCallback(p,_,x){let w=-1;_&&_>0&&(w=setTimeout(()=>{this._callbacks=this._callbacks.filter(D=>D.timeoutId!==w),p(this._didWork,this.getPendingTasks())},_)),this._callbacks.push({doneCb:p,timeoutId:w,updateCb:x})}whenStable(p,_,x){if(x&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(p,_,x),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(p){this.registry.registerApplication(p,this)}unregisterApplication(p){this.registry.unregisterApplication(p)}findProviders(p,_,x){return[]}}return u.\u0275fac=function(p){return new(p||u)(Yr(Ll),Yr(lI),Yr(oI))},u.\u0275prov=Ui({token:u,factory:u.\u0275fac}),u})(),lI=(()=>{class u{constructor(){this._applications=new Map}registerApplication(p,_){this._applications.set(p,_)}unregisterApplication(p){this._applications.delete(p)}unregisterAllApplications(){this._applications.clear()}getTestability(p){return this._applications.get(p)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(p,_=!0){return iT?.findTestabilityInTree(this,p,_)??null}}return u.\u0275fac=function(p){return new(p||u)},u.\u0275prov=Ui({token:u,factory:u.\u0275fac,providedIn:"platform"}),u})(),Pf=null;const rT=new ei("AllowMultipleToken"),Js=new ei("PlatformDestroyListeners");class hI{constructor(d,p){this.name=d,this.token=p}}function Lf(u,d,p=[]){const _=`Platform: ${d}`,x=new ei(_);return(w=[])=>{let D=t0();if(!D||D.injector.get(rT,!1)){const F=[...p,...w,{provide:x,useValue:!0}];u?u(F):function fN(u){if(Pf&&!Pf.get(rT,!1))throw new yt(400,!1);Pf=u;const d=u.get(sT);(function e0(u){const d=u.get(WC,null);d&&d.forEach(p=>p())})(u)}(function h_(u=[],d){return Rg.create({name:d,providers:[{provide:Dp,useValue:"platform"},{provide:Js,useValue:new Set([()=>Pf=null])},...u]})}(F,_))}return function sm(u){const d=t0();if(!d)throw new yt(401,!1);return d}()}}function t0(){return Pf?.get(sT)??null}let sT=(()=>{class u{constructor(p){this._injector=p,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(p,_){const x=function fI(u,d){let p;return p="noop"===u?new dN:("zone.js"===u?void 0:u)||new Ll(d),p}(_?.ngZone,function QC(u){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!u||!u.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!u||!u.ngZoneRunCoalescing)||!1}}(_)),w=[{provide:Ll,useValue:x}];return x.run(()=>{const D=Rg.create({providers:w,parent:this.injector,name:p.moduleType.name}),F=p.create(D),B=F.injector.get(Cg,null);if(!B)throw new yt(402,!1);return x.runOutsideAngular(()=>{const G=x.onError.subscribe({next:X=>{B.handleError(X)}});F.onDestroy(()=>{om(this._modules,F),G.unsubscribe()})}),function pI(u,d,p){try{const _=p();return OS(_)?_.catch(x=>{throw d.runOutsideAngular(()=>u.handleError(x)),x}):_}catch(_){throw d.runOutsideAngular(()=>u.handleError(_)),_}}(B,x,()=>{const G=F.injector.get(nT);return G.runInitializers(),G.donePromise.then(()=>(function hC(u){Ci(u,"Expected localeId to be defined"),"string"==typeof u&&(uC=u.toLowerCase().replace(/_/g,"-"))}(F.injector.get(ud,Tf)||Tf),this._moduleDoBootstrap(F),F))})})}bootstrapModule(p,_=[]){const x=JC({},_);return function $C(u,d,p){const _=new Qu(p);return Promise.resolve(_)}(0,0,p).then(w=>this.bootstrapModuleFactory(w,x))}_moduleDoBootstrap(p){const _=p.injector.get(n0);if(p._bootstrapComponents.length>0)p._bootstrapComponents.forEach(x=>_.bootstrap(x));else{if(!p.instance.ngDoBootstrap)throw new yt(403,!1);p.instance.ngDoBootstrap(_)}this._modules.push(p)}onDestroy(p){this._destroyListeners.push(p)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new yt(404,!1);this._modules.slice().forEach(_=>_.destroy()),this._destroyListeners.forEach(_=>_());const p=this._injector.get(Js,null);p&&(p.forEach(_=>_()),p.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return u.\u0275fac=function(p){return new(p||u)(Yr(Rg))},u.\u0275prov=Ui({token:u,factory:u.\u0275fac,providedIn:"platform"}),u})();function JC(u,d){return Array.isArray(d)?d.reduce(JC,u):{...u,...d}}let n0=(()=>{class u{constructor(p,_,x){this._zone=p,this._injector=_,this._exceptionHandler=x,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const w=new J.y(F=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{F.next(this._stable),F.complete()})}),D=new J.y(F=>{let B;this._zone.runOutsideAngular(()=>{B=this._zone.onStable.subscribe(()=>{Ll.assertNotInAngularZone(),YC(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,F.next(!0))})})});const G=this._zone.onUnstable.subscribe(()=>{Ll.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{F.next(!1)}))});return()=>{B.unsubscribe(),G.unsubscribe()}});this.isStable=(0,je.T)(w,D.pipe((0,Ke.B)()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(p,_){const x=p instanceof x1;if(!this._injector.get(nT).done)throw!x&&rm(p),new yt(405,false);let D;D=x?p:this._injector.get(Ip).resolveComponentFactory(p),this.componentTypes.push(D.componentType);const F=function Ff(u){return u.isBoundToModule}(D)?void 0:this._injector.get(iu),G=D.create(Rg.NULL,[],_||D.selector,F),X=G.location.nativeElement,ae=G.injector.get(sI,null);return ae?.registerApplication(X),G.onDestroy(()=>{this.detachView(G.hostView),om(this.components,G),ae?.unregisterApplication(X)}),this._loadComponent(G),G}tick(){if(this._runningTick)throw new yt(101,!1);try{this._runningTick=!0;for(let p of this._views)p.detectChanges()}catch(p){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(p))}finally{this._runningTick=!1}}attachView(p){const _=p;this._views.push(_),_.attachToAppRef(this)}detachView(p){const _=p;om(this._views,_),_.detachFromAppRef()}_loadComponent(p){this.attachView(p.hostView),this.tick(),this.components.push(p),this._injector.get(qC,[]).concat(this._bootstrapListeners).forEach(x=>x(p))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(p=>p()),this._views.slice().forEach(p=>p.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(p){return this._destroyListeners.push(p),()=>om(this._destroyListeners,p)}destroy(){if(this._destroyed)throw new yt(406,!1);const p=this._injector;p.destroy&&!p.destroyed&&p.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return u.\u0275fac=function(p){return new(p||u)(Yr(Ll),Yr(Rp),Yr(Cg))},u.\u0275prov=Ui({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();function om(u,d){const p=u.indexOf(d);p>-1&&u.splice(p,1)}let mI=!0,eE=!1;function mN(){return eE=!0,mI}function gN(){if(eE)throw new Error("Cannot enable prod mode after platform setup.");mI=!1}let lm=(()=>{class u{}return u.__NG_ELEMENT_ID__=gI,u})();function gI(u){return function _N(u,d,p){if(Ld(u)&&!p){const _=co(u.index,d);return new fo(_,_)}return 47&u.type?new fo(d[16],d):null}(Vr(),Pt(),16==(16&u))}class hd{constructor(){}supports(d){return $h(d)}create(d){return new bN(d)}}const bI=(u,d)=>d;class bN{constructor(d){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=d||bI}forEachItem(d){let p;for(p=this._itHead;null!==p;p=p._next)d(p)}forEachOperation(d){let p=this._itHead,_=this._removalsHead,x=0,w=null;for(;p||_;){const D=!_||p&&p.currentIndex<l0(_,x,w)?p:_,F=l0(D,x,w),B=D.currentIndex;if(D===_)x--,_=_._nextRemoved;else if(p=p._next,null==D.previousIndex)x++;else{w||(w=[]);const G=F-x,X=B-x;if(G!=X){for(let De=0;De<G;De++){const Ue=De<w.length?w[De]:w[De]=0,xt=Ue+De;X<=xt&&xt<G&&(w[De]=Ue+1)}w[D.previousIndex]=X-G}}F!==B&&d(D,F,B)}}forEachPreviousItem(d){let p;for(p=this._previousItHead;null!==p;p=p._nextPrevious)d(p)}forEachAddedItem(d){let p;for(p=this._additionsHead;null!==p;p=p._nextAdded)d(p)}forEachMovedItem(d){let p;for(p=this._movesHead;null!==p;p=p._nextMoved)d(p)}forEachRemovedItem(d){let p;for(p=this._removalsHead;null!==p;p=p._nextRemoved)d(p)}forEachIdentityChange(d){let p;for(p=this._identityChangesHead;null!==p;p=p._nextIdentityChange)d(p)}diff(d){if(null==d&&(d=[]),!$h(d))throw new yt(900,!1);return this.check(d)?this:null}onDestroy(){}check(d){this._reset();let x,w,D,p=this._itHead,_=!1;if(Array.isArray(d)){this.length=d.length;for(let F=0;F<this.length;F++)w=d[F],D=this._trackByFn(F,w),null!==p&&Object.is(p.trackById,D)?(_&&(p=this._verifyReinsertion(p,w,D,F)),Object.is(p.item,w)||this._addIdentityChange(p,w)):(p=this._mismatch(p,w,D,F),_=!0),p=p._next}else x=0,function cy(u,d){if(Array.isArray(u))for(let p=0;p<u.length;p++)d(u[p]);else{const p=u[kp()]();let _;for(;!(_=p.next()).done;)d(_.value)}}(d,F=>{D=this._trackByFn(x,F),null!==p&&Object.is(p.trackById,D)?(_&&(p=this._verifyReinsertion(p,F,D,x)),Object.is(p.item,F)||this._addIdentityChange(p,F)):(p=this._mismatch(p,F,D,x),_=!0),p=p._next,x++}),this.length=x;return this._truncate(p),this.collection=d,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let d;for(d=this._previousItHead=this._itHead;null!==d;d=d._next)d._nextPrevious=d._next;for(d=this._additionsHead;null!==d;d=d._nextAdded)d.previousIndex=d.currentIndex;for(this._additionsHead=this._additionsTail=null,d=this._movesHead;null!==d;d=d._nextMoved)d.previousIndex=d.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(d,p,_,x){let w;return null===d?w=this._itTail:(w=d._prev,this._remove(d)),null!==(d=null===this._unlinkedRecords?null:this._unlinkedRecords.get(_,null))?(Object.is(d.item,p)||this._addIdentityChange(d,p),this._reinsertAfter(d,w,x)):null!==(d=null===this._linkedRecords?null:this._linkedRecords.get(_,x))?(Object.is(d.item,p)||this._addIdentityChange(d,p),this._moveAfter(d,w,x)):d=this._addAfter(new xN(p,_),w,x),d}_verifyReinsertion(d,p,_,x){let w=null===this._unlinkedRecords?null:this._unlinkedRecords.get(_,null);return null!==w?d=this._reinsertAfter(w,d._prev,x):d.currentIndex!=x&&(d.currentIndex=x,this._addToMoves(d,x)),d}_truncate(d){for(;null!==d;){const p=d._next;this._addToRemovals(this._unlink(d)),d=p}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(d,p,_){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(d);const x=d._prevRemoved,w=d._nextRemoved;return null===x?this._removalsHead=w:x._nextRemoved=w,null===w?this._removalsTail=x:w._prevRemoved=x,this._insertAfter(d,p,_),this._addToMoves(d,_),d}_moveAfter(d,p,_){return this._unlink(d),this._insertAfter(d,p,_),this._addToMoves(d,_),d}_addAfter(d,p,_){return this._insertAfter(d,p,_),this._additionsTail=null===this._additionsTail?this._additionsHead=d:this._additionsTail._nextAdded=d,d}_insertAfter(d,p,_){const x=null===p?this._itHead:p._next;return d._next=x,d._prev=p,null===x?this._itTail=d:x._prev=d,null===p?this._itHead=d:p._next=d,null===this._linkedRecords&&(this._linkedRecords=new xI),this._linkedRecords.put(d),d.currentIndex=_,d}_remove(d){return this._addToRemovals(this._unlink(d))}_unlink(d){null!==this._linkedRecords&&this._linkedRecords.remove(d);const p=d._prev,_=d._next;return null===p?this._itHead=_:p._next=_,null===_?this._itTail=p:_._prev=p,d}_addToMoves(d,p){return d.previousIndex===p||(this._movesTail=null===this._movesTail?this._movesHead=d:this._movesTail._nextMoved=d),d}_addToRemovals(d){return null===this._unlinkedRecords&&(this._unlinkedRecords=new xI),this._unlinkedRecords.put(d),d.currentIndex=null,d._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=d,d._prevRemoved=null):(d._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=d),d}_addIdentityChange(d,p){return d.item=p,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=d:this._identityChangesTail._nextIdentityChange=d,d}}class xN{constructor(d,p){this.item=d,this.trackById=p,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class TN{constructor(){this._head=null,this._tail=null}add(d){null===this._head?(this._head=this._tail=d,d._nextDup=null,d._prevDup=null):(this._tail._nextDup=d,d._prevDup=this._tail,d._nextDup=null,this._tail=d)}get(d,p){let _;for(_=this._head;null!==_;_=_._nextDup)if((null===p||p<=_.currentIndex)&&Object.is(_.trackById,d))return _;return null}remove(d){const p=d._prevDup,_=d._nextDup;return null===p?this._head=_:p._nextDup=_,null===_?this._tail=p:_._prevDup=p,null===this._head}}class xI{constructor(){this.map=new Map}put(d){const p=d.trackById;let _=this.map.get(p);_||(_=new TN,this.map.set(p,_)),_.add(d)}get(d,p){const x=this.map.get(d);return x?x.get(d,p):null}remove(d){const p=d.trackById;return this.map.get(p).remove(d)&&this.map.delete(p),d}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function l0(u,d,p){const _=u.previousIndex;if(null===_)return _;let x=0;return p&&_<p.length&&(x=p[_]),_+d+x}class rE{constructor(){}supports(d){return d instanceof Map||SS(d)}create(){return new wN}}class wN{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(d){let p;for(p=this._mapHead;null!==p;p=p._next)d(p)}forEachPreviousItem(d){let p;for(p=this._previousMapHead;null!==p;p=p._nextPrevious)d(p)}forEachChangedItem(d){let p;for(p=this._changesHead;null!==p;p=p._nextChanged)d(p)}forEachAddedItem(d){let p;for(p=this._additionsHead;null!==p;p=p._nextAdded)d(p)}forEachRemovedItem(d){let p;for(p=this._removalsHead;null!==p;p=p._nextRemoved)d(p)}diff(d){if(d){if(!(d instanceof Map||SS(d)))throw new yt(900,!1)}else d=new Map;return this.check(d)?this:null}onDestroy(){}check(d){this._reset();let p=this._mapHead;if(this._appendAfter=null,this._forEach(d,(_,x)=>{if(p&&p.key===x)this._maybeAddToChanges(p,_),this._appendAfter=p,p=p._next;else{const w=this._getOrCreateRecordForKey(x,_);p=this._insertBeforeOrAppend(p,w)}}),p){p._prev&&(p._prev._next=null),this._removalsHead=p;for(let _=p;null!==_;_=_._nextRemoved)_===this._mapHead&&(this._mapHead=null),this._records.delete(_.key),_._nextRemoved=_._next,_.previousValue=_.currentValue,_.currentValue=null,_._prev=null,_._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(d,p){if(d){const _=d._prev;return p._next=d,p._prev=_,d._prev=p,_&&(_._next=p),d===this._mapHead&&(this._mapHead=p),this._appendAfter=d,d}return this._appendAfter?(this._appendAfter._next=p,p._prev=this._appendAfter):this._mapHead=p,this._appendAfter=p,null}_getOrCreateRecordForKey(d,p){if(this._records.has(d)){const x=this._records.get(d);this._maybeAddToChanges(x,p);const w=x._prev,D=x._next;return w&&(w._next=D),D&&(D._prev=w),x._next=null,x._prev=null,x}const _=new TI(d);return this._records.set(d,_),_.currentValue=p,this._addToAdditions(_),_}_reset(){if(this.isDirty){let d;for(this._previousMapHead=this._mapHead,d=this._previousMapHead;null!==d;d=d._next)d._nextPrevious=d._next;for(d=this._changesHead;null!==d;d=d._nextChanged)d.previousValue=d.currentValue;for(d=this._additionsHead;null!=d;d=d._nextAdded)d.previousValue=d.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(d,p){Object.is(p,d.currentValue)||(d.previousValue=d.currentValue,d.currentValue=p,this._addToChanges(d))}_addToAdditions(d){null===this._additionsHead?this._additionsHead=this._additionsTail=d:(this._additionsTail._nextAdded=d,this._additionsTail=d)}_addToChanges(d){null===this._changesHead?this._changesHead=this._changesTail=d:(this._changesTail._nextChanged=d,this._changesTail=d)}_forEach(d,p){d instanceof Map?d.forEach(p):Object.keys(d).forEach(_=>p(d[_],_))}}class TI{constructor(d){this.key=d,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function wI(){return new aT([new hd])}let aT=(()=>{class u{constructor(p){this.factories=p}static create(p,_){if(null!=_){const x=_.factories.slice();p=p.concat(x)}return new u(p)}static extend(p){return{provide:u,useFactory:_=>u.create(p,_||wI()),deps:[[u,new Rt,new Fe]]}}find(p){const _=this.factories.find(x=>x.supports(p));if(null!=_)return _;throw new yt(901,!1)}}return u.\u0275prov=Ui({token:u,providedIn:"root",factory:wI}),u})();function __(){return new lT([new rE])}let lT=(()=>{class u{constructor(p){this.factories=p}static create(p,_){if(_){const x=_.factories.slice();p=p.concat(x)}return new u(p)}static extend(p){return{provide:u,useFactory:_=>u.create(p,_||__()),deps:[[u,new Rt,new Fe]]}}find(p){const _=this.factories.find(x=>x.supports(p));if(_)return _;throw new yt(901,!1)}}return u.\u0275prov=Ui({token:u,providedIn:"root",factory:__}),u})();const CN=Lf(null,"core",[]);let sE=(()=>{class u{constructor(p){}}return u.\u0275fac=function(p){return new(p||u)(Yr(n0))},u.\u0275mod=$t({type:u}),u.\u0275inj=Vi({}),u})();function Lo(u){return"boolean"==typeof u?u:null!=u&&"false"!==u}},3942:(kn,At,se)=>{se.d(At,{Z:()=>yt});var $=se(2090),c=se(4859),J=se(9681),je=se(1877);class Ke{constructor(dt,et){this._delegate=dt,this.firebase=et,(0,J._addComponent)(dt,new c.wA("app-compat",()=>this,"PUBLIC")),this.container=dt.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(dt){this._delegate.automaticDataCollectionEnabled=dt}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(dt=>{this._delegate.checkDestroyed(),dt()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,J.deleteApp)(this._delegate)))}_getService(dt,et=J._DEFAULT_ENTRY_NAME){var vn;this._delegate.checkDestroyed();const _n=this._delegate.container.getProvider(dt);return!_n.isInitialized()&&"EXPLICIT"===(null===(vn=_n.getComponent())||void 0===vn?void 0:vn.instantiationMode)&&_n.initialize(),_n.getImmediate({identifier:et})}_removeServiceInstance(dt,et=J._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(dt).clearInstance(et)}_addComponent(dt){(0,J._addComponent)(this._delegate,dt)}_addOrOverwriteComponent(dt){(0,J._addOrOverwriteComponent)(this._delegate,dt)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Tt=new $.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),Te=function ct(){const Pn=function Oe(Pn){const dt={},et={__esModule:!0,initializeApp:function Nt(ze,ot={}){const _t=J.initializeApp(ze,ot);if((0,$.r3)(dt,_t.name))return dt[_t.name];const ke=new Pn(_t,et);return dt[_t.name]=ke,ke},app:_n,registerVersion:J.registerVersion,setLogLevel:J.setLogLevel,onLog:J.onLog,apps:null,SDK_VERSION:J.SDK_VERSION,INTERNAL:{registerComponent:function wt(ze){const ot=ze.name,_t=ot.replace("-compat","");if(J._registerComponent(ze)&&"PUBLIC"===ze.type){const ke=(He=_n())=>{if("function"!=typeof He[_t])throw Tt.create("invalid-app-argument",{appName:ot});return He[_t]()};void 0!==ze.serviceProps&&(0,$.ZB)(ke,ze.serviceProps),et[_t]=ke,Pn.prototype[_t]=function(...He){return this._getService.bind(this,ot).apply(this,ze.multipleInstances?He:[])}}return"PUBLIC"===ze.type?et[_t]:null},removeApp:function vn(ze){delete dt[ze]},useAsService:function an(ze,ot){return"serverAuth"===ot?null:ot},modularAPIs:J}};function _n(ze){if(!(0,$.r3)(dt,ze=ze||J._DEFAULT_ENTRY_NAME))throw Tt.create("no-app",{appName:ze});return dt[ze]}return et.default=et,Object.defineProperty(et,"apps",{get:function Dt(){return Object.keys(dt).map(ze=>dt[ze])}}),_n.App=Pn,et}(Ke);return Pn.INTERNAL=Object.assign(Object.assign({},Pn.INTERNAL),{createFirebaseNamespace:ct,extendNamespace:function dt(et){(0,$.ZB)(Pn,et)},createSubscribe:$.ne,ErrorFactory:$.LL,deepExtend:$.ZB}),Pn}(),Me=new je.Yd("@firebase/app-compat");if((0,$.jU)()&&void 0!==self.firebase){Me.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Pn=self.firebase.SDK_VERSION;Pn&&Pn.indexOf("LITE")>=0&&Me.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const yt=Te;!function Ot(Pn){(0,J.registerVersion)("@firebase/app-compat","0.1.32",Pn)}()},9681:(kn,At,se)=>{se.r(At),se.d(At,{FirebaseError:()=>je.ZR,SDK_VERSION:()=>ha,_DEFAULT_ENTRY_NAME:()=>Ci,_addComponent:()=>sr,_addOrOverwriteComponent:()=>Ui,_apps:()=>er,_clearComponents:()=>za,_components:()=>Nr,_getProvider:()=>Vi,_registerComponent:()=>Mi,_removeServiceInstance:()=>gr,deleteApp:()=>Un,getApp:()=>Br,getApps:()=>_l,initializeApp:()=>Ca,onLog:()=>Li,registerVersion:()=>_r,setLogLevel:()=>ms});var $=se(5861),c=se(4859),J=se(1877),je=se(2090),Ke=se(8766);class st{constructor(Ae){this.container=Ae}getPlatformInfoString(){return this.container.getProviders().map(Ce=>{if(function Tt(ve){return"VERSION"===ve.getComponent()?.type}(Ce)){const Ct=Ce.getImmediate();return`${Ct.library}/${Ct.version}`}return null}).filter(Ce=>Ce).join(" ")}}const Oe="@firebase/app",Te=new J.Yd("@firebase/app"),Ci="[DEFAULT]",nn={[Oe]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},er=new Map,Nr=new Map;function sr(ve,Ae){try{ve.container.addComponent(Ae)}catch(Ce){Te.debug(`Component ${Ae.name} failed to register with FirebaseApp ${ve.name}`,Ce)}}function Ui(ve,Ae){ve.container.addOrOverwriteComponent(Ae)}function Mi(ve){const Ae=ve.name;if(Nr.has(Ae))return Te.debug(`There were multiple attempts to register component ${Ae}.`),!1;Nr.set(Ae,ve);for(const Ce of er.values())sr(Ce,ve);return!0}function Vi(ve,Ae){const Ce=ve.container.getProvider("heartbeat").getImmediate({optional:!0});return Ce&&Ce.triggerHeartbeat(),ve.container.getProvider(Ae)}function gr(ve,Ae,Ce=Ci){Vi(ve,Ae).clearInstance(Ce)}function za(){Nr.clear()}const Cr=new je.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class gl{constructor(Ae,Ce,Ct){this._isDeleted=!1,this._options=Object.assign({},Ae),this._config=Object.assign({},Ce),this._name=Ce.name,this._automaticDataCollectionEnabled=Ce.automaticDataCollectionEnabled,this._container=Ct,this.container.addComponent(new c.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Ae){this.checkDestroyed(),this._automaticDataCollectionEnabled=Ae}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(Ae){this._isDeleted=Ae}checkDestroyed(){if(this.isDeleted)throw Cr.create("app-deleted",{appName:this._name})}}const ha="9.9.3";function Ca(ve,Ae={}){"object"!=typeof Ae&&(Ae={name:Ae});const Ce=Object.assign({name:Ci,automaticDataCollectionEnabled:!1},Ae),Ct=Ce.name;if("string"!=typeof Ct||!Ct)throw Cr.create("bad-app-name",{appName:String(Ct)});const $t=er.get(Ct);if($t){if((0,je.vZ)(ve,$t.options)&&(0,je.vZ)(Ce,$t.config))return $t;throw Cr.create("duplicate-app",{appName:Ct})}const Qn=new c.H0(Ct);for(const Bi of Nr.values())Qn.addComponent(Bi);const Gi=new gl(ve,Ce,Qn);return er.set(Ct,Gi),Gi}function Br(ve=Ci){const Ae=er.get(ve);if(!Ae)throw Cr.create("no-app",{appName:ve});return Ae}function _l(){return Array.from(er.values())}function Un(ve){return ao.apply(this,arguments)}function ao(){return(ao=(0,$.Z)(function*(ve){const Ae=ve.name;er.has(Ae)&&(er.delete(Ae),yield Promise.all(ve.container.getProviders().map(Ce=>Ce.delete())),ve.isDeleted=!0)})).apply(this,arguments)}function _r(ve,Ae,Ce){var Ct;let $t=null!==(Ct=nn[ve])&&void 0!==Ct?Ct:ve;Ce&&($t+=`-${Ce}`);const Qn=$t.match(/\s|\//),Gi=Ae.match(/\s|\//);if(Qn||Gi){const Bi=[`Unable to register library "${$t}" with version "${Ae}":`];return Qn&&Bi.push(`library name "${$t}" contains illegal characters (whitespace or "/")`),Qn&&Gi&&Bi.push("and"),Gi&&Bi.push(`version name "${Ae}" contains illegal characters (whitespace or "/")`),void Te.warn(Bi.join(" "))}Mi(new c.wA(`${$t}-version`,()=>({library:$t,version:Ae}),"VERSION"))}function Li(ve,Ae){if(null!==ve&&"function"!=typeof ve)throw Cr.create("invalid-log-argument");(0,J.Am)(ve,Ae)}function ms(ve){(0,J.Ub)(ve)}const vr="firebase-heartbeat-store";let Os=null;function zl(){return Os||(Os=(0,Ke.X3)("firebase-heartbeat-database",1,{upgrade:(ve,Ae)=>{0===Ae&&ve.createObjectStore(vr)}}).catch(ve=>{throw Cr.create("idb-open",{originalErrorMessage:ve.message})})),Os}function un(){return(un=(0,$.Z)(function*(ve){var Ae;try{return(yield zl()).transaction(vr).objectStore(vr).get(gs(ve))}catch(Ce){if(Ce instanceof je.ZR)Te.warn(Ce.message);else{const Ct=Cr.create("idb-get",{originalErrorMessage:null===(Ae=Ce)||void 0===Ae?void 0:Ae.message});Te.warn(Ct.message)}}})).apply(this,arguments)}function Dn(ve,Ae){return Ea.apply(this,arguments)}function Ea(){return(Ea=(0,$.Z)(function*(ve,Ae){var Ce;try{const $t=(yield zl()).transaction(vr,"readwrite");return yield $t.objectStore(vr).put(Ae,gs(ve)),$t.done}catch(Ct){if(Ct instanceof je.ZR)Te.warn(Ct.message);else{const $t=Cr.create("idb-set",{originalErrorMessage:null===(Ce=Ct)||void 0===Ce?void 0:Ce.message});Te.warn($t.message)}}})).apply(this,arguments)}function gs(ve){return`${ve.name}!${ve.options.appId}`}class yr{constructor(Ae){this.container=Ae,this._heartbeatsCache=null;const Ce=this.container.getProvider("app").getImmediate();this._storage=new rs(Ce),this._heartbeatsCachePromise=this._storage.read().then(Ct=>(this._heartbeatsCache=Ct,Ct))}triggerHeartbeat(){var Ae=this;return(0,$.Z)(function*(){const Ct=Ae.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),$t=br();if(null===Ae._heartbeatsCache&&(Ae._heartbeatsCache=yield Ae._heartbeatsCachePromise),Ae._heartbeatsCache.lastSentHeartbeatDate!==$t&&!Ae._heartbeatsCache.heartbeats.some(Qn=>Qn.date===$t))return Ae._heartbeatsCache.heartbeats.push({date:$t,agent:Ct}),Ae._heartbeatsCache.heartbeats=Ae._heartbeatsCache.heartbeats.filter(Qn=>{const Gi=new Date(Qn.date).valueOf();return Date.now()-Gi<=2592e6}),Ae._storage.overwrite(Ae._heartbeatsCache)})()}getHeartbeatsHeader(){var Ae=this;return(0,$.Z)(function*(){if(null===Ae._heartbeatsCache&&(yield Ae._heartbeatsCachePromise),null===Ae._heartbeatsCache||0===Ae._heartbeatsCache.heartbeats.length)return"";const Ce=br(),{heartbeatsToSend:Ct,unsentEntries:$t}=function Hi(ve,Ae=1024){const Ce=[];let Ct=ve.slice();for(const $t of ve){const Qn=Ce.find(Gi=>Gi.agent===$t.agent);if(Qn){if(Qn.dates.push($t.date),xe(Ce)>Ae){Qn.dates.pop();break}}else if(Ce.push({agent:$t.agent,dates:[$t.date]}),xe(Ce)>Ae){Ce.pop();break}Ct=Ct.slice(1)}return{heartbeatsToSend:Ce,unsentEntries:Ct}}(Ae._heartbeatsCache.heartbeats),Qn=(0,je.L)(JSON.stringify({version:2,heartbeats:Ct}));return Ae._heartbeatsCache.lastSentHeartbeatDate=Ce,$t.length>0?(Ae._heartbeatsCache.heartbeats=$t,yield Ae._storage.overwrite(Ae._heartbeatsCache)):(Ae._heartbeatsCache.heartbeats=[],Ae._storage.overwrite(Ae._heartbeatsCache)),Qn})()}}function br(){return(new Date).toISOString().substring(0,10)}class rs{constructor(Ae){this.app=Ae,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,$.Z)(function*(){return!!(0,je.hl)()&&(0,je.eu)().then(()=>!0).catch(()=>!1)})()}read(){var Ae=this;return(0,$.Z)(function*(){return(yield Ae._canUseIndexedDBPromise)&&(yield function Ai(ve){return un.apply(this,arguments)}(Ae.app))||{heartbeats:[]}})()}overwrite(Ae){var Ce=this;return(0,$.Z)(function*(){var Ct;if(yield Ce._canUseIndexedDBPromise){const Qn=yield Ce.read();return Dn(Ce.app,{lastSentHeartbeatDate:null!==(Ct=Ae.lastSentHeartbeatDate)&&void 0!==Ct?Ct:Qn.lastSentHeartbeatDate,heartbeats:Ae.heartbeats})}})()}add(Ae){var Ce=this;return(0,$.Z)(function*(){var Ct;if(yield Ce._canUseIndexedDBPromise){const Qn=yield Ce.read();return Dn(Ce.app,{lastSentHeartbeatDate:null!==(Ct=Ae.lastSentHeartbeatDate)&&void 0!==Ct?Ct:Qn.lastSentHeartbeatDate,heartbeats:[...Qn.heartbeats,...Ae.heartbeats]})}})()}}function xe(ve){return(0,je.L)(JSON.stringify({version:2,heartbeats:ve})).length}!function we(ve){Mi(new c.wA("platform-logger",Ae=>new st(Ae),"PRIVATE")),Mi(new c.wA("heartbeat",Ae=>new yr(Ae),"PRIVATE")),_r(Oe,"0.7.31",ve),_r(Oe,"0.7.31","esm2017"),_r("fire-js","")}("")},4859:(kn,At,se)=>{se.d(At,{H0:()=>Oe,wA:()=>J});var $=se(5861),c=se(2090);class J{constructor(Te,Me,Ne){this.name=Te,this.instanceFactory=Me,this.type=Ne,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(Te){return this.instantiationMode=Te,this}setMultipleInstances(Te){return this.multipleInstances=Te,this}setServiceProps(Te){return this.serviceProps=Te,this}setInstanceCreatedCallback(Te){return this.onInstanceCreated=Te,this}}const je="[DEFAULT]";class Ke{constructor(Te,Me){this.name=Te,this.container=Me,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(Te){const Me=this.normalizeInstanceIdentifier(Te);if(!this.instancesDeferred.has(Me)){const Ne=new c.BH;if(this.instancesDeferred.set(Me,Ne),this.isInitialized(Me)||this.shouldAutoInitialize())try{const Kt=this.getOrInitializeService({instanceIdentifier:Me});Kt&&Ne.resolve(Kt)}catch{}}return this.instancesDeferred.get(Me).promise}getImmediate(Te){var Me;const Ne=this.normalizeInstanceIdentifier(Te?.identifier),Kt=null!==(Me=Te?.optional)&&void 0!==Me&&Me;if(!this.isInitialized(Ne)&&!this.shouldAutoInitialize()){if(Kt)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Ne})}catch(Ot){if(Kt)return null;throw Ot}}getComponent(){return this.component}setComponent(Te){if(Te.name!==this.name)throw Error(`Mismatching Component ${Te.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=Te,this.shouldAutoInitialize()){if(function Tt(ct){return"EAGER"===ct.instantiationMode}(Te))try{this.getOrInitializeService({instanceIdentifier:je})}catch{}for(const[Me,Ne]of this.instancesDeferred.entries()){const Kt=this.normalizeInstanceIdentifier(Me);try{const Ot=this.getOrInitializeService({instanceIdentifier:Kt});Ne.resolve(Ot)}catch{}}}}clearInstance(Te=je){this.instancesDeferred.delete(Te),this.instancesOptions.delete(Te),this.instances.delete(Te)}delete(){var Te=this;return(0,$.Z)(function*(){const Me=Array.from(Te.instances.values());yield Promise.all([...Me.filter(Ne=>"INTERNAL"in Ne).map(Ne=>Ne.INTERNAL.delete()),...Me.filter(Ne=>"_delete"in Ne).map(Ne=>Ne._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(Te=je){return this.instances.has(Te)}getOptions(Te=je){return this.instancesOptions.get(Te)||{}}initialize(Te={}){const{options:Me={}}=Te,Ne=this.normalizeInstanceIdentifier(Te.instanceIdentifier);if(this.isInitialized(Ne))throw Error(`${this.name}(${Ne}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Kt=this.getOrInitializeService({instanceIdentifier:Ne,options:Me});for(const[Ot,yt]of this.instancesDeferred.entries())Ne===this.normalizeInstanceIdentifier(Ot)&&yt.resolve(Kt);return Kt}onInit(Te,Me){var Ne;const Kt=this.normalizeInstanceIdentifier(Me),Ot=null!==(Ne=this.onInitCallbacks.get(Kt))&&void 0!==Ne?Ne:new Set;Ot.add(Te),this.onInitCallbacks.set(Kt,Ot);const yt=this.instances.get(Kt);return yt&&Te(yt,Kt),()=>{Ot.delete(Te)}}invokeOnInitCallbacks(Te,Me){const Ne=this.onInitCallbacks.get(Me);if(Ne)for(const Kt of Ne)try{Kt(Te,Me)}catch{}}getOrInitializeService({instanceIdentifier:Te,options:Me={}}){let Ne=this.instances.get(Te);if(!Ne&&this.component&&(Ne=this.component.instanceFactory(this.container,{instanceIdentifier:(ct=Te,ct===je?void 0:ct),options:Me}),this.instances.set(Te,Ne),this.instancesOptions.set(Te,Me),this.invokeOnInitCallbacks(Ne,Te),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,Te,Ne)}catch{}var ct;return Ne||null}normalizeInstanceIdentifier(Te=je){return this.component?this.component.multipleInstances?Te:je:Te}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Oe{constructor(Te){this.name=Te,this.providers=new Map}addComponent(Te){const Me=this.getProvider(Te.name);if(Me.isComponentSet())throw new Error(`Component ${Te.name} has already been registered with ${this.name}`);Me.setComponent(Te)}addOrOverwriteComponent(Te){this.getProvider(Te.name).isComponentSet()&&this.providers.delete(Te.name),this.addComponent(Te)}getProvider(Te){if(this.providers.has(Te))return this.providers.get(Te);const Me=new Ke(Te,this);return this.providers.set(Te,Me),Me}getProviders(){return Array.from(this.providers.values())}}},1877:(kn,At,se)=>{se.d(At,{Am:()=>ct,Ub:()=>Oe,Yd:()=>Tt,in:()=>c});const $=[];var c=(()=>{return(Te=c||(c={}))[Te.DEBUG=0]="DEBUG",Te[Te.VERBOSE=1]="VERBOSE",Te[Te.INFO=2]="INFO",Te[Te.WARN=3]="WARN",Te[Te.ERROR=4]="ERROR",Te[Te.SILENT=5]="SILENT",c;var Te})();const J={debug:c.DEBUG,verbose:c.VERBOSE,info:c.INFO,warn:c.WARN,error:c.ERROR,silent:c.SILENT},je=c.INFO,Ke={[c.DEBUG]:"log",[c.VERBOSE]:"log",[c.INFO]:"info",[c.WARN]:"warn",[c.ERROR]:"error"},st=(Te,Me,...Ne)=>{if(Me<Te.logLevel)return;const Kt=(new Date).toISOString(),Ot=Ke[Me];if(!Ot)throw new Error(`Attempted to log a message with an invalid logType (value: ${Me})`);console[Ot](`[${Kt}]  ${Te.name}:`,...Ne)};class Tt{constructor(Me){this.name=Me,this._logLevel=je,this._logHandler=st,this._userLogHandler=null,$.push(this)}get logLevel(){return this._logLevel}set logLevel(Me){if(!(Me in c))throw new TypeError(`Invalid value "${Me}" assigned to \`logLevel\``);this._logLevel=Me}setLogLevel(Me){this._logLevel="string"==typeof Me?J[Me]:Me}get logHandler(){return this._logHandler}set logHandler(Me){if("function"!=typeof Me)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=Me}get userLogHandler(){return this._userLogHandler}set userLogHandler(Me){this._userLogHandler=Me}debug(...Me){this._userLogHandler&&this._userLogHandler(this,c.DEBUG,...Me),this._logHandler(this,c.DEBUG,...Me)}log(...Me){this._userLogHandler&&this._userLogHandler(this,c.VERBOSE,...Me),this._logHandler(this,c.VERBOSE,...Me)}info(...Me){this._userLogHandler&&this._userLogHandler(this,c.INFO,...Me),this._logHandler(this,c.INFO,...Me)}warn(...Me){this._userLogHandler&&this._userLogHandler(this,c.WARN,...Me),this._logHandler(this,c.WARN,...Me)}error(...Me){this._userLogHandler&&this._userLogHandler(this,c.ERROR,...Me),this._logHandler(this,c.ERROR,...Me)}}function Oe(Te){$.forEach(Me=>{Me.setLogLevel(Te)})}function ct(Te,Me){for(const Ne of $){let Kt=null;Me&&Me.level&&(Kt=J[Me.level]),Ne.userLogHandler=null===Te?null:(Ot,yt,...Pn)=>{const dt=Pn.map(et=>{if(null==et)return null;if("string"==typeof et)return et;if("number"==typeof et||"boolean"==typeof et)return et.toString();if(et instanceof Error)return et.message;try{return JSON.stringify(et)}catch{return null}}).filter(et=>et).join(" ");yt>=(Kt??Ot.logLevel)&&Te({level:c[yt].toLowerCase(),message:dt,args:Pn,type:Ot.name})}}}},8766:(kn,At,se)=>{se.d(At,{Lj:()=>Nt,X3:()=>_n});var $=se(5861);let J,je;const Tt=new WeakMap,Oe=new WeakMap,ct=new WeakMap,Te=new WeakMap,Me=new WeakMap;let Ot={get(ot,_t,ke){if(ot instanceof IDBTransaction){if("done"===_t)return Oe.get(ot);if("objectStoreNames"===_t)return ot.objectStoreNames||ct.get(ot);if("store"===_t)return ke.objectStoreNames[1]?void 0:ke.objectStore(ke.objectStoreNames[0])}return et(ot[_t])},set:(ot,_t,ke)=>(ot[_t]=ke,!0),has:(ot,_t)=>ot instanceof IDBTransaction&&("done"===_t||"store"===_t)||_t in ot};function dt(ot){return"function"==typeof ot?function Pn(ot){return ot!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function st(){return je||(je=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(ot)?function(..._t){return ot.apply(vn(this),_t),et(Tt.get(this))}:function(..._t){return et(ot.apply(vn(this),_t))}:function(_t,...ke){const He=ot.call(vn(this),_t,...ke);return ct.set(He,_t.sort?_t.sort():[_t]),et(He)}}(ot):(ot instanceof IDBTransaction&&function Kt(ot){if(Oe.has(ot))return;const _t=new Promise((ke,He)=>{const Ze=()=>{ot.removeEventListener("complete",ut),ot.removeEventListener("error",Xe),ot.removeEventListener("abort",Xe)},ut=()=>{ke(),Ze()},Xe=()=>{He(ot.error||new DOMException("AbortError","AbortError")),Ze()};ot.addEventListener("complete",ut),ot.addEventListener("error",Xe),ot.addEventListener("abort",Xe)});Oe.set(ot,_t)}(ot),((ot,_t)=>_t.some(ke=>ot instanceof ke))(ot,function Ke(){return J||(J=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(ot,Ot):ot)}function et(ot){if(ot instanceof IDBRequest)return function Ne(ot){const _t=new Promise((ke,He)=>{const Ze=()=>{ot.removeEventListener("success",ut),ot.removeEventListener("error",Xe)},ut=()=>{ke(et(ot.result)),Ze()},Xe=()=>{He(ot.error),Ze()};ot.addEventListener("success",ut),ot.addEventListener("error",Xe)});return _t.then(ke=>{ke instanceof IDBCursor&&Tt.set(ke,ot)}).catch(()=>{}),Me.set(_t,ot),_t}(ot);if(Te.has(ot))return Te.get(ot);const _t=dt(ot);return _t!==ot&&(Te.set(ot,_t),Me.set(_t,ot)),_t}const vn=ot=>Me.get(ot);function _n(ot,_t,{blocked:ke,upgrade:He,blocking:Ze,terminated:ut}={}){const Xe=indexedDB.open(ot,_t),zt=et(Xe);return He&&Xe.addEventListener("upgradeneeded",zn=>{He(et(Xe.result),zn.oldVersion,zn.newVersion,et(Xe.transaction))}),ke&&Xe.addEventListener("blocked",()=>ke()),zt.then(zn=>{ut&&zn.addEventListener("close",()=>ut()),Ze&&zn.addEventListener("versionchange",()=>Ze())}).catch(()=>{}),zt}function Nt(ot,{blocked:_t}={}){const ke=indexedDB.deleteDatabase(ot);return _t&&ke.addEventListener("blocked",()=>_t()),et(ke).then(()=>{})}const Dt=["get","getKey","getAll","getAllKeys","count"],wt=["put","add","delete","clear"],an=new Map;function ze(ot,_t){if(!(ot instanceof IDBDatabase)||_t in ot||"string"!=typeof _t)return;if(an.get(_t))return an.get(_t);const ke=_t.replace(/FromIndex$/,""),He=_t!==ke,Ze=wt.includes(ke);if(!(ke in(He?IDBIndex:IDBObjectStore).prototype)||!Ze&&!Dt.includes(ke))return;const ut=function(){var Xe=(0,$.Z)(function*(zt,...zn){const Ni=this.transaction(zt,Ze?"readwrite":"readonly");let Ci=Ni.store;return He&&(Ci=Ci.index(zn.shift())),(yield Promise.all([Ci[ke](...zn),Ze&&Ni.done]))[0]});return function(zn){return Xe.apply(this,arguments)}}();return an.set(_t,ut),ut}!function yt(ot){Ot=ot(Ot)}(ot=>({...ot,get:(_t,ke,He)=>ze(_t,ke)||ot.get(_t,ke,He),has:(_t,ke)=>!!ze(_t,ke)||ot.has(_t,ke)}))},5861:(kn,At,se)=>{function $(J,je,Ke,st,Tt,Oe,ct){try{var Te=J[Oe](ct),Me=Te.value}catch(Ne){return void Ke(Ne)}Te.done?je(Me):Promise.resolve(Me).then(st,Tt)}function c(J){return function(){var je=this,Ke=arguments;return new Promise(function(st,Tt){var Oe=J.apply(je,Ke);function ct(Me){$(Oe,st,Tt,ct,Te,"next",Me)}function Te(Me){$(Oe,st,Tt,ct,Te,"throw",Me)}ct(void 0)})}}se.d(At,{Z:()=>c})}},kn=>{kn(kn.s=4676)}]);